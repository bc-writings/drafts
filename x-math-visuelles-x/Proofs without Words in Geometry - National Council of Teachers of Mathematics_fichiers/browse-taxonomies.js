(function(){'use strict';$.fn.browsetaxonomies=function(){var checkedValues=[];var wrapper=$('.browse-taxonomies-wrapper');var querystringParam=$('.paging-properties');var filterBox=$('.filter-box');var filtersList=$('.filter-list ul');var filterPane=$('.filter-pane');var searchTerm=$('.txt-activity-search');filterBox.hide();$('.tab-content input[type=checkbox]').each(function(){var cb=$(this);var id=cb[0].id;var name=cb.next().html();if(cb.is(':checked')){checkedValues.push(id);filterBox.show();addFilterBoxItem(id,name);}});$('.tab-content input[type=checkbox]').change(function(){var cb=$(this);var id=cb[0].id;var name=cb.next().html();if(cb.is(':checked')){checkedValues.push(id);addFilterBoxItem(id,name);}else{var index=checkedValues.indexOf(id);if(index>-1){checkedValues.splice(index,1);}
removeFilterBoxItem(id);}});$('.filter-list').on('click','.remove-filter',function(){var id=$(this).data('id').toString();var index=checkedValues.indexOf(id);if(index>-1){checkedValues.splice(index,1);}
$(this).parent().remove();$('.tab-content input[id='+id+']').removeAttr('checked');});$('.btn-clear').click(function(){$('.tab-content input[type=checkbox]').removeAttr('checked');checkedValues.length=0;});$('.btn-apply').click(function(){var url=wrapper.data("url")+checkedValues.join('|');var qsSortOrder=qsdata["sortorder"];var qsSortBy=qsdata["sortby"];var searchBox=$('.form-control.txt-activity-search');var searchBoxVal="";if(searchBox.length>0&&searchBox.val()!=undefined){searchBoxVal=searchBox.val().split(',');if(searchBoxVal!=undefined&&searchBoxVal!=""&&searchBoxVal.length>0){searchBoxVal=searchBoxVal[searchBoxVal.length-1];}}
var searchTerm="";if(searchBox.length>0&&searchBox.val()!=undefined){var searchTerm=searchBox.val().split(',')[searchBox.val().split(',').length-1];}
var qWindowsHrefSortOrder=qsWindowHref["sortorder"];var qWindowsHrefSortBy=qsWindowHref["sortby"];var qWindowsHrefSearchTerm=qsWindowHref["searchterm"];if(qsSortOrder!=undefined&&qWindowsHrefSortOrder!=undefined){url=url.replace("&sortorder="+qWindowsHrefSortOrder,"&sortorder="+qsSortOrder);}
else if(qsSortOrder!=undefined){url=url+"&sortorder="+qsSortOrder;}
if(qsSortBy!=undefined&&qWindowsHrefSortBy!=undefined){url=url.replace("&sortby="+qWindowsHrefSortBy,"&sortby="+qsSortBy);}
else if(qsSortBy!=undefined){url=url+"&sortby="+qsSortBy;}
if(searchBoxVal!=undefined&&searchBoxVal!=""){if(qWindowsHrefSearchTerm!=undefined){url=url.replace("&searchterm="+qWindowsHrefSearchTerm,"");}
url=url+"&searchterm="+searchBoxVal;}
window.location.href=url;});$('.btn-activity').click(function(){var url=wrapper.data("url")+checkedValues.join('|');url=RemoveQSParams(url);window.location.href=url+"&type=activity";});$('.btn-unit').click(function(){var url=wrapper.data("url")+checkedValues.join('|');url=RemoveQSParams(url);window.location.href=url+"&type=unit";});$('.btn-lesson').click(function(){var url=wrapper.data("url")+checkedValues.join('|');url=RemoveQSParams(url);window.location.href=url+"&type=lesson";});function RemoveQSParams(url){var qsType=qsdata["type"];var qWindowsHrefType=qsWindowHref["type"];if(qsType!=undefined&&qWindowsHrefType!=undefined){url=url.replace("&type="+qWindowsHrefType,"");}
return url;}
function addFilterBoxItem(id,text){var format='<li>{0} <a href="#" data-id="{1}" class="remove-filter"><span class="glyphicon glyphicon-remove"></span></a></li>';filtersList.append(format.f(text,id));}
function removeFilterBoxItem(id){$('.remove-filter[data-id='+id+']').parent().remove();}
var qsdata=(function(a){if(a=="")return{};var b={};for(var i=0;i<a.length;++i){var p=a[i].split('=',2);if(p.length==1)
b[p[0]]="";else
b[p[0]]=decodeURIComponent(p[1].replace(/\+/g," "));}
return b;})(($('.paging-properties')!=undefined&&$('.paging-properties').length>0)?$('.paging-properties').data('querystring').substr(1).split('&'):new Array());var qsWindowHref=(function(a){if(a=="")return{};var b={};for(var i=0;i<a.length;++i){var p=a[i].split('=',2);if(p.length==1)
b[p[0]]="";else
b[p[0]]=decodeURIComponent(p[1].replace(/\+/g," "));}
return b;})(window.location.search.substr(1).split('&'));$('.browse-taxonomies-wrapper a').click(function(e){var filterType=$(this);filterType.siblings().addClass('collapsed');var targetId=filterType.data("target");var targetElem=$(targetId);if(targetElem!=undefined&&targetElem.length>0){targetElem.siblings().removeClass("in");if(targetElem[0].classList.value.indexOf("in")!=-1){targetElem.removeClass("in");filterType.addClass('collapsed');event.stopPropagation();}}
e.preventDefault();});};})();String.prototype.format=String.prototype.f=function(){var s=this,i=arguments.length;while(i--){s=s.replace(new RegExp('\\{'+i+'\\}','gm'),arguments[i]);}
return s;};(function(){'use strict';$.fn.filtertaxonomies=function(){var checkedValues=[];var wrapper=$('.filter-taxonomies-wrapper');var querystringParam=$('.paging-properties');var filterBox=$('.filter-box');var filtersList=$('.filter-list ul');var filterPane=$('.filter-pane');var searchTerm=$('.txt-activity-search');filterBox.hide();$('#btnFilterTaxonomyBottom, #btnFilterTaxonomyTop').click(function(){var selectedTax=$('ul.ektron-ui-tree-root li.selected').each(function(){var id=$(this).attr('data-ektron-id');checkedValues.push(id);});var url=$('.filter-taxonomies-wrapper').data("url");var searchText=$('.txt-activity-search').val();if(searchText!=='')
{var searchTerm=searchText;url=removeURLParameter(url,"searchterm");url=url.split('?');if(url.length>1){url=url[0]+"?searchterm="+searchTerm+'&'+url[1];}}
url+=checkedValues.join('|');window.location.href=url;});function removeURLParameter(url,parameter){var urlparts=url.split('?');if(urlparts.length>=2){var prefix=encodeURIComponent(parameter)+'=';var pars=urlparts[1].split(/[&;]/g);for(var i=pars.length;i-->0;){if(pars[i].lastIndexOf(prefix,0)!==-1){pars.splice(i,1);}}
return urlparts[0]+(pars.length>0?'?'+pars.join('&'):'');}
return url;}
$('.tab-content input[type=checkbox]').each(function(){var cb=$(this);var id=cb[0].id;var name=cb.next().html();if(cb.is(':checked')){checkedValues.push(id);filterBox.show();addFilterBoxItem(id,name);}});$('.tab-content input[type=checkbox]').change(function(){var cb=$(this);var id=cb[0].id;var name=cb.next().html();if(cb.is(':checked')){checkedValues.push(id);addFilterBoxItem(id,name);}else{var index=checkedValues.indexOf(id);if(index>-1){checkedValues.splice(index,1);}
removeFilterBoxItem(id);}});$('.filter-list').on('click','.remove-filter',function(){var id=$(this).data('id').toString();var index=checkedValues.indexOf(id);if(index>-1){checkedValues.splice(index,1);}
$(this).parent().remove();$('.tab-content input[id='+id+']').removeAttr('checked');});$('.btn-clear').click(function(){$('.tab-content input[type=checkbox]').removeAttr('checked');checkedValues.length=0;});function addFilterBoxItem(id,text){var format='<li>{0} <a href="#" data-id="{1}" class="remove-filter"><span class="glyphicon glyphicon-remove"></span></a></li>';filtersList.append(format.f(text,id));}
function removeFilterBoxItem(id){$('.remove-filter[data-id='+id+']').parent().remove();}
var qsdata=(function(a){if(a=="")return{};var b={};for(var i=0;i<a.length;++i){var p=a[i].split('=',2);if(p.length==1)
b[p[0]]="";else
b[p[0]]=decodeURIComponent(p[1].replace(/\+/g," "));}
return b;})(($('.paging-properties')!=undefined&&$('.paging-properties').length>0)?$('.paging-properties').data('querystring').substr(1).split('&'):new Array());var qsWindowHref=(function(a){if(a=="")return{};var b={};for(var i=0;i<a.length;++i){var p=a[i].split('=',2);if(p.length==1)
b[p[0]]="";else
b[p[0]]=decodeURIComponent(p[1].replace(/\+/g," "));}
return b;})(window.location.search.substr(1).split('&'));$('.filter-taxonomies-wrapper a').click(function(){var filterType=$(this);filterType.siblings().addClass('collapsed');var targetId=filterType.data("target");var targetElem=$(targetId);if(targetElem!=undefined&&targetElem.length>0){targetElem.siblings().removeClass("in");if(targetElem[0].classList.value.indexOf("in")!=-1){targetElem.removeClass("in");filterType.addClass('collapsed');event.stopPropagation();}}});};})();String.prototype.format=String.prototype.f=function(){var s=this,i=arguments.length;while(i--){s=s.replace(new RegExp('\\{'+i+'\\}','gm'),arguments[i]);}
return s;};