(window.webpackJsonp_spotim_580132258=window.webpackJsonp_spotim_580132258||[]).push([[49],{110:function(e,t,n){"use strict";var a=n(22),o=n.n(a),r=n(23),s=n.n(r),i=n(26),c=n(65),l=function(){var e=s()(o.a.mark((function e(t,n,a,r){var s,i,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.id.split("_c_")[0],e.next=3,Object(c.a)("moderation/conversation/".concat(s,"/message/").concat(t.id,"/feature"),{method:"POST"});case 3:i=e.sent,!(l=i.body).success&&l.result&&l.result.indexOf("should_top_feature")>-1?n():a&&a(),localStorage.setItem("__SPOTIM_HIDE_FEATURED_COMMENT_NEW_BADGE__","true");case 7:case"end":return e.stop()}}),e)})));return function(t,n,a,o){return e.apply(this,arguments)}}(),u=function(){var e=s()(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id.split("_c_")[0],e.next=3,Object(c.a)("moderation/conversation/".concat(n,"/message/").concat(t.id,"/feature"),{data:{should_top_feature:!0},method:"POST"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=s()(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id.split("_c_")[0],e.next=3,Object(c.a)("moderation/conversation/".concat(a,"/message/").concat(t.id,"/feature"),{data:{only_remove_top_featured:!("top"!==t.featuredComment)},method:"DELETE"});case 3:"function"==typeof n&&n();case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return h}));var p=function(e){return{type:i.Db,payload:e}};function m(e){return function(){var t=s()(o.a.mark((function t(n,a){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:i.bb,payload:e}),t.prev=1,t.next=4,d(e,(function(){p(!0)}));case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(e,n){return t.apply(this,arguments)}}()}function f(e){return function(){var t=s()(o.a.mark((function t(n,a){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a(),r.conversation.postId,n({type:i.Q,payload:e}),t.prev=2,t.next=5,u(e);case 5:t.next=9;break;case 7:t.prev=7,t.t0=t.catch(2);case 9:case"end":return t.stop()}}),t,null,[[2,7]])})));return function(e,n){return t.apply(this,arguments)}}()}function h(e,t){return function(){var n=s()(o.a.mark((function n(a,r){var s,c;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=r(),c=s.conversation.postId,a({type:i.a,payload:e}),n.prev=2,n.next=5,l(e,t,(function(){f(e)}),c);case 5:n.next=9;break;case 7:n.prev=7,n.t0=n.catch(2);case 9:case"end":return n.stop()}}),n,null,[[2,7]])})));return function(e,t){return n.apply(this,arguments)}}()}},257:function(e,t,n){"use strict";var a=n(24),o=n.n(a),r=n(25),s=n.n(r);function i(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}var c=function(){function e(){o()(this,e),this.events=void 0,this.events={}}return s()(e,[{key:"on",value:function(e,t){var n=this;return t&&"function"==typeof t?(this.events[e]=this.events[e]||[],this.events[e].push(t),function(){n.off(e,t)}):function(){}}},{key:"once",value:function(e,t){if(t&&"function"==typeof t)var n=this.on(e,(function(){t.apply(void 0,arguments),n()}))}},{key:"trigger",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var o=[];this.events&&this.events[e]&&this.events[e].length>0&&(o=this.events[e]),o.forEach((function(e){return e.apply(void 0,n)}))}},{key:"off",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.events[e]&&this.events[e].length>0&&(t?i(this.events[e],t):this.events[e]=[])}}]),e}();t.a=new c},258:function(e,t,n){"use strict";var a=n(22),o=n.n(a),r=n(23),s=n.n(r),i=n(26),c=n(67),l=function(e,t){return Object(c.h)("user-status/".concat(e),{method:"GET",postId:t,data:{}})};n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var u=function(e,t,n){return{type:i.J,payload:{message:{id:e.id},isUserAllowed:n,isUserBlocked:t}}},d=function(e){return function(){var t=s()(o.a.mark((function t(n,a){var r,s,i,c,d;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a(),s=r.conversation.postId,!1,t.next=4,l(e.user.id,s);case 4:i=t.sent,c=i.blocked,d=i.allowed,n(u(e,c,d));case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}},418:function(e,t,n){"use strict";var a=n(36),o=n.n(a),r=n(0),s=n.n(r),i=n(11),c=n.n(i),l=n(31),u=n(161),d=n(35),p=n(45),m=n(73),f=n(14),h=n(39),g=n(38),v=n(747),y=n.n(v),b=n(748),E=n.n(b),M=n(4),R=n(68),S=n(33),C=n(448);t.a=function(e){var t=e.show,n=e.onClose,a=e.message,i=e.spotName,v=e.currentUser,b=e.postId,O=Object(r.useState)(""),k=o()(O,2),w=k[0],I=k[1],x=Object(r.useState)(!1),T=o()(x,2),N=T[0],D=T[1],j=Object(r.useState)(""),L=o()(j,2),U=L[0],B=L[1],P=Object(u.a)().t,A=Object(d.useTracking)();function _(e,t){return'"'.concat(e,'" â€” ').concat(t)}function F(e,t){if(t.preventDefault(),"link"!==e){var n=function(e,t,n){var o=encodeURIComponent(t);switch(e){case"facebook":return"https://www.facebook.com/sharer/sharer.php?u=".concat(o);case"email":return"mailto:?subject=".concat(n,"&body=").concat(o);case"twitter":var r=Object(g.getCleanText)(a),s="@".concat(a.user.username),i=_("",s),c=_(r.substring(0,113-i.length)+"...",s),l=encodeURIComponent(c);return"https://twitter.com/intent/tweet?text=".concat(l,"&url=").concat(o)}}(e,w,U),o=["width=500","height=400","left="+(window.innerWidth-500)/2,"top="+(window.innerHeight-400)/2.5].join(",");if("email"===e){var r=h.a?"_top":"_blank";window.open(n,r)}else window.open(n,void 0,o)}else D(!0);A.trackEvent({type:"share-message-clicked",item_type:"main",target_type:e,user_id:v.id,is_registered:v.isRegistered})}return Object(r.useEffect)((function(){if(t&&!w){var e,n=Object(f.getDisplayName)(v);Object(C.a)({messageDepth:a.depth,messageId:a.id,postId:b}).then((function(e){I(e)})),e=P("share.emailSubject",{username:n,spotName:i}),B(e),M.a.send("share_modal_shown")}}),[t]),s.a.createElement(l.Modal,{disableCustomBodyScroll:S.j,shadowRootCssModules:R.c?["conversation"]:void 0,isLtr:S.t,closeButton:!0,className:y.a.shareModal,showModal:t,onClose:n,modalTitle:P("shareModal.title","Share Post"),size:"sm",fullScreenMobile:!1},!w&&s.a.createElement("div",{className:y.a.spinnerWrapper},s.a.createElement(m.a,null)),s.a.createElement("div",{className:c()(y.a.shareButtons,w&&y.a.show)},s.a.createElement("a",{href:"#",onClick:F.bind(null,"facebook"),className:y.a.shareButton},s.a.createElement(p.a,{className:c()(y.a.icon,y.a.facebookIcon),selector:"facebookIcon"})),s.a.createElement("a",{href:"#",onClick:F.bind(null,"twitter"),className:y.a.shareButton},s.a.createElement(p.a,{className:c()(y.a.icon,y.a.twitterIcon),selector:"twitterIcon"})),s.a.createElement("a",{href:"#",onClick:F.bind(null,"email"),className:y.a.shareButton},s.a.createElement(p.a,{className:c()(y.a.icon,y.a.emailIcon),selector:"emailIcon"})),s.a.createElement("a",{href:"#",onClick:F.bind(null,"link"),className:y.a.shareButton},s.a.createElement(p.a,{className:c()(y.a.icon,y.a.linkIcon),selector:"linkIcon"}))),N&&s.a.createElement("div",{className:y.a.linkWrapper},s.a.createElement("input",{className:y.a.linkInput,value:w}),s.a.createElement("button",{className:y.a.copyLinkButton,onClick:function(){E()(w)}},P("share.copy","Copy"))))}},420:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(22),o=n.n(a),r=n(23),s=n.n(r),i=n(4),c=n(26),l=n(110),u=n(67),d=n(70);function p(e){var t=e.message;return function(){var e=s()(o.a.mark((function e(n,a){var r,s,p,m,f,h;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r="delete_".concat(0===t.depth?"comment":"reply"),i.a.apm.start(r),n({type:c.t,payload:{message:t}}),s=a(),p=s.conversation.messagesCount,m=s.moduleOptions.postId,e.next=7,u.f(t.id,m);case 7:f=e.sent,o=f.body,g=void 0,g=d.a.map(o,{etag:"conversation.etag",messages_count:"conversation.messagesCount",comments_count:"conversation.commentsCount",soft_deleted:"rootMessage.isDeleted","comment.id":"rootMessage.id","comment.replies_count":"rootMessage.repliesCount"}),(h=g.conversation).messagesCount=p,n({type:c.s,payload:{conversation:h,starsRating:t.starsRating||0}}),"top"===t.featuredComment&&n(Object(l.d)(!0)),i.a.apm.end(r),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),n({type:c.s,payload:{error:e.t0},error:!0}),i.a.error("delete",e.t0);case 19:case"end":return e.stop()}var o,g}),e,null,[[0,15]])})));return function(t,n){return e.apply(this,arguments)}}()}},421:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(26);function o(e){var t=e.messageId,n=e.starsRating;return{type:a.N,payload:{messageId:t,starsRating:n}}}},422:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(22),o=n.n(a),r=n(23),s=n.n(r),i=n(67),c=n(258);function l(e,t){return function(){var n=s()(o.a.mark((function n(a,r){var s,l,u;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=r(),l=s.conversation.postId,"add"!==e){n.next=8;break}return n.next=4,i.a(t.user.id,l);case 4:(u=n.sent).isWhiteListed=!0,n.next=12;break;case 8:return n.next=10,i.j(t.user.id,l);case 10:(u=n.sent).isWhiteListed=!1;case 12:(u.isSuccess||u)&&a(Object(c.b)(t,t.user.isBlockListed,u.isWhiteListed));case 13:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}},423:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(55),o=n.n(a),r=n(50),s=n.n(r),i=n(0),c=n.n(i),l=n(765),u=n.n(l),d=n(11),p=n.n(d),m=function(e){var t=e.children,n=e.className,a=s()(e,["children","className"]);return c.a.createElement("button",o()({},a,{type:"button",className:p()(n,u.a.emptyButton)}),t)}},424:function(e,t,n){"use strict";var a=n(0),o=n.n(a),r=n(11),s=n.n(r),i=n(171),c=n(2),l=n.n(c),u=n(766),d=n.n(u);t.a=function(e){var t=e.className,n=void 0===t?"":t;return o.a.createElement("div",{className:s()(d.a.messageContentLoader,n)},o.a.createElement(i.a,{rtl:!l.a.get("init_data.config.ltr"),height:313,width:646,speed:2,backgroundColor:getComputedStyle(document.documentElement).getPropertyValue("--spotim-content-loader-primary-color"),foregroundColor:getComputedStyle(document.documentElement).getPropertyValue("--spotim-content-loaders-secondary-color")},o.a.createElement("circle",{cx:"62",cy:"69",r:"24"}),o.a.createElement("rect",{x:"104",y:"51",rx:"5",ry:"5",width:"174",height:"13"}),o.a.createElement("rect",{x:"104",y:"73",rx:"5",ry:"5",width:"139",height:"13"}),o.a.createElement("rect",{x:"39",y:"110",rx:"5",ry:"5",width:"499",height:"15"}),o.a.createElement("rect",{x:"39",y:"141",rx:"5",ry:"5",width:"431",height:"15"}),o.a.createElement("circle",{cx:"62",cy:"226",r:"24"}),o.a.createElement("rect",{x:"104",y:"208",rx:"5",ry:"5",width:"174",height:"13"}),o.a.createElement("rect",{x:"104",y:"230",rx:"5",ry:"5",width:"139",height:"13"}),o.a.createElement("rect",{x:"39",y:"267",rx:"5",ry:"5",width:"499",height:"15"}),o.a.createElement("rect",{x:"39",y:"298",rx:"5",ry:"5",width:"431",height:"15"})))}},425:function(e,t,n){"use strict";n.r(t);var a=n(24),o=n.n(a),r=n(25),s=n.n(r),i=n(27),c=n.n(i),l=n(28),u=n.n(l),d=n(29),p=n.n(d),m=n(0),f=n.n(m),h=n(32),g=n.n(h),v=n(11),y=n.n(v),b=n(45),E=n(423),M=n(424),R=n(768),S=n.n(R),C=n(34);function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var k=function(e){c()(n,e);var t=O(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).getMessagesCount=function(e){var t=e.numCollapsedChildren,n=e.forceMessagesCollapsed,a=e.allCount,o=e.numNewComments,r=e.moreCount;return t||(n?a-o:r)},e.handleShowMoreReplies=function(){e.props.showMoreReplies()},e}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.isLoading,n=e.moreCount,a=e.allCount,o=e.isLastMessageInThread,r=e.enableShowMore,s=e.numNewComments,i=e.forceMessagesCollapsed,c=e.numCollapsedChildren,l=e.messageStack,u=e.depth,d=l.hasNext&&0===l.childrenStackIds.length,p=y()(S.a.showMoreReplies,S.a["depth-".concat(u)],{[S.a.showMore]:d||c,[S.a.loading]:t,[S.a.lastMessage]:o||c||r&&d}),m=this.getMessagesCount({numCollapsedChildren:c,forceMessagesCollapsed:i,allCount:a,numNewComments:s,moreCount:n});return f.a.createElement("div",{className:p},t?f.a.createElement(M.a,null):(c||r&&d)&&f.a.createElement(E.a,{className:S.a.showMoreRepliesButton,onClick:this.handleShowMoreReplies},f.a.createElement("span",null,f.a.createElement("span",{className:S.a.showText},f.a.createElement(C.a,{i18nKey:"inpage.conversation.showMoreMessages",values:{messagesCount:m},count:m}),f.a.createElement(b.a,{selector:"chevronDownIcon",className:S.a.chevron})))))}}]),n}(m.Component);k.propTypes={showMoreReplies:g.a.func.isRequired,isLoading:g.a.bool,moreCount:g.a.number,isLastMessageInThread:g.a.bool,enableShowMore:g.a.bool,forceMessagesCollapsed:g.a.bool,onDoneLoading:g.a.func,numNewComments:g.a.number,numCollapsedChildren:g.a.number,depth:g.a.number},k.defaultProps={showMoreReplies:function(){},enableShowMore:!0},t.default=k},427:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(22),o=n.n(a),r=n(23),s=n.n(r),i=n(257),c=n(26);function l(e,t){return function(){var n=s()(o.a.mark((function n(a){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:setTimeout((function(){i.a.trigger("focusSayControl")}),0),a({type:c.T,payload:{starsRating:e,stackId:t}});case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},446:function(e,t,n){"use strict";var a=n(36),o=n.n(a),r=n(0),s=n.n(r),i=n(11),c=n.n(i),l=n(2),u=n.n(l),d=n(31),p=n(771),m=n.n(p),f=n(772),h=n.n(f),g=function(){return s.a.createElement("div",{className:h.a.loaderContainer},s.a.createElement("div",{className:h.a.loaderContent},s.a.createElement("div",{className:h.a.loaderHeader},"Sponsored"),s.a.createElement("div",{className:h.a.loaderSpinner})))},v=function(e){var t=e.ref,n=e.rootMargin,a=void 0===n?"0px":n,s=e.useOnce,i=Object(r.useState)(!1),c=o()(i,2),l=c[0],u=c[1],d=Object(r.useState)(!1),p=o()(d,2),m=p[0],f=p[1];return Object(r.useEffect)((function(){var e=new IntersectionObserver((function(e){var t=o()(e,1)[0];u(t.isIntersecting)}),{rootMargin:a,threshold:[.01]});return t&&e.observe(t),function(){t&&e.unobserve(t)}}),[t]),Object(r.useEffect)((function(){s?!m&&f(l):f(l)}),[l]),m};n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return C}));var y=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(84),n.e(86)]).then(n.bind(null,897))})),b=u.a.get("tenant_config.conversation.adsLazyLoadMargin","600px"),E=2===u.a.get("tenant_config.conversation.ads_style_version",1),M=E?10:25,R=E?10:25;function S(e,t){return e?0:E?t:t+M+R}var C=function(e){var t=e.index,n=e.onHideAd,a=Object(r.useState)(!1),i=o()(a,2),l=i[0],u=i[1],p=Object(r.useState)(!1),f=o()(p,2),h=f[0],C=f[1],O=Object(r.useState)(E?0:160),k=o()(O,2),w=k[0],I=k[1],x=Object(r.useState)(null),T=o()(x,2),N=T[0],D=T[1],j=Object(r.useCallback)((function(e){D(e)}),[]),L=v({ref:N,rootMargin:b,useOnce:!0});Object(r.useEffect)((function(){h&&setTimeout((function(){u(!0)}),2500)}),[h]);var U=Object(r.useCallback)((function(){l&&n()}),[l]);return s.a.createElement("li",{className:c()(m.a.conversationAdsUnit),"data-spotim-class":"conversation-ads-unit",onTransitionEnd:U,key:"ads-unit-".concat(t),style:{height:S(l,w),paddingTop:"".concat(M,"px"),paddingBottom:"".concat(R,"px")}},h?!l&&s.a.createElement("div",{id:"spotim-specific",className:m.a.hiddenAdPlacement},s.a.createElement("span",{className:m.a.checkboxIcon},s.a.createElement(d.Icon,{type:"fa-solid",name:"check-circle"})),s.a.createElement(d.Typography,{type:"modalBody"},"Ads will no longer be shown on this conversation."),s.a.createElement(d.Typography,{type:"infoMd"},"Thank you for your feedback!")):s.a.createElement(s.a.Fragment,null,s.a.createElement(r.Suspense,{fallback:E?null:s.a.createElement(g,null)},s.a.createElement("div",{ref:j,className:m.a.nativeAdWrapper},L&&s.a.createElement(y,{moduleName:"conversation",reportingModuleName:"conversation",onNoAdAvailable:function(){u(!0),C(!0)},onHideAd:function(){return C(!0)},onDimensionsChange:function(e){var t=e.height;I(t)},enableContextMenu:!E})))))}},59:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(0),o=n.n(a),r=n(161),s=n(359),i=["textKey","pluralValue","default","override","params","key","ref"],c=function(e){Object(r.a)();var t=Object.keys(e).filter((function(e){return-1===i.indexOf(e)})).reduce((function(t,n){return t[n]=e[n],t}),{});return e.override?o.a.createElement("span",t,e.override):o.a.createElement("span",t,o.a.createElement(s.a,{i18nKey:e.textKey,values:e.params||(null==e?void 0:e.values),count:e.pluralValue},e.children))}},893:function(e,t,n){"use strict";n.r(t);var a=n(24),o=n.n(a),r=n(25),s=n.n(r),i=n(27),c=n.n(i),l=n(28),u=n.n(l),d=n(29),p=n.n(d),m=n(40),f=n.n(m),h=n(0),g=n.n(h),v=n(32),y=n.n(v),b=n(11),E=n.n(b),M=n(12),R=n(5),S=n(35),C=n.n(S),O=n(2),k=n.n(O),w=n(31),I=n(83),x=n(45),T=n(621),N=n.n(T),D=n(59);function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var L=function(e){c()(n,e);var t=j(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).handleSendVerifyEmailKeyUp=function(t){13===t.keyCode&&e.sendVerifyEmail()},e}return s()(n,[{key:"sendVerifyEmail",value:function(){var e=this.props,t=e.currentUser,n=e.spotId,a=e.hostUrl,o=t.email,r=a;this.props.onVerifyEmailSend({email:o,spotId:n,url:r})}},{key:"getVerifyEmailComponent",value:function(){return g.a.createElement("div",{onKeyUp:this.handleSendVerifyEmailKeyUp,"data-spmark":"verify-email",className:E()(N.a.verifyEmailBar)},g.a.createElement(x.a,{selector:"exclamationCircleSolidIcon",className:N.a.icon}),g.a.createElement(w.Typography,{className:N.a.textWrapper},g.a.createElement(D.a,{textKey:"inpage.conversation.completeEmailRegistration.text"}),g.a.createElement(D.a,{className:N.a.link,onClick:this.sendVerifyEmail.bind(this),textKey:"inpage.conversation.completeEmailRegistration.button"})))}},{key:"getEmailSentComponent",value:function(e){return g.a.createElement("div",{className:N.a.emailSentBar},g.a.createElement(x.a,{selector:"faCircleCheck",className:N.a.icon}),g.a.createElement(D.a,{textKey:"inpage.conversation.completeEmailRegistration.succesMessage.first"}),g.a.createElement("span",null," ".concat(e,". ")),g.a.createElement(D.a,{textKey:"inpage.conversation.completeEmailRegistration.succesMessage.second"}))}},{key:"render",value:function(){var e=this.props,t=e.email,n=e.isEmailVerified,a=e.isVerificationEmailSent,o=null;return t&&!n&&(o=a?this.getEmailSentComponent(t):this.getVerifyEmailComponent()),o}}]),n}(h.Component);L.displayName="CompleteEmailRegistration",L.propTypes={email:y.a.string,isEmailVerified:y.a.bool.isRequired,isVerificationEmailSent:y.a.bool,spotId:y.a.string,onVerifyEmailSend:y.a.func.isRequired,hostUrl:y.a.string},L.defaultProps={isVerificationEmailSent:!1};var U=n(73),B=n(126),P=n(3),A=n(37),_=n(628),F=n.n(_);function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var K=function(e){c()(n,e);var t=V(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).onLoadMore=function(){var t=e.props,n=t.onLoadMore,a=t.isLoading,o=t.tracking;a||(n(),o.trackEvent({type:"load-more-comments-clicked"}),Object(P.dispatchSpotimEvent)(B.a))},e.handleLoadMoreKeyUp=function(t){13===t.keyCode&&e.onLoadMore()},e}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.isLoading,n=e.hasNext,a=e.loadMoreMessagesText,o=e.textKey,r=e.isLiveBlog;return n?g.a.createElement("div",{className:F.a.loadMoreCommentsContainer},g.a.createElement("div",{"data-spmark":"show-more",className:E()(F.a.loadMoreMessages,{[F.a.loading]:t}),onClick:this.onLoadMore,onKeyUp:this.handleLoadMoreKeyUp,"data-spot-im-class":"load-more-messages"},t&&g.a.createElement("div",{className:F.a.spinnerWrapper},g.a.createElement(U.a,{size:"small"})),a?g.a.createElement("span",null,a):r?g.a.createElement(D.a,{textKey:"liveBlog.loadMore"},"Load more updates..."):g.a.createElement(D.a,{textKey:o},"Show More Comments"))):null}}]),n}(g.a.Component),H=f()(Object(M.connect)((function(e){return{isLiveBlog:A.j(e)}})),C()({}))(K),q=n(672),W=n.n(q),z=function(e){var t=e.onClick;return g.a.createElement("span",{className:W.a.Disqus},g.a.createElement("span",{className:W.a.mobileText,onClick:t,onTouchStart:t},"Forum?"),g.a.createElement("span",{className:W.a.desktopText,onClick:t,onTouchStart:t},"Have a Forum Account?"))},G=n(397),Q=n(22),J=n.n(Q),Y=n(23),Z=n.n(Y),X=n(38),$=n(675),ee=n.n($),te=n(34);function ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var ae=function(e){c()(n,e);var t=ne(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.messagesCount,n=e.onClick,a=e.isLiveBlog,o=E()(ee.a.showNewButton,"brand-bg-color","brand-bg-color-hover");return g.a.createElement("div",{className:ee.a.showNewButtonWrapper},g.a.createElement("div",{className:ee.a.leftSeparator}),g.a.createElement(w.Button,{mode:"primary",className:o,onClick:n},g.a.createElement("span",null,t>1&&(a?g.a.createElement(te.a,{i18nKey:"liveBlog.showNewUpdates",values:{messagesCount:t}}):g.a.createElement(te.a,{i18nKey:"inpage.conversation.showNewMessages",values:{messagesCount:t}})),1===t&&(a?g.a.createElement(te.a,{i18nKey:"liveBlog.showNewUpdate",values:{messagesCount:t}},"Show 1 New Update"):g.a.createElement(te.a,{i18nKey:"inpage.conversation.showNewMessage",values:{messagesCount:t}},"Show 1 New Comment")))),g.a.createElement("div",{className:ee.a.rightSeparator}))}}]),n}(h.Component);ae.propTypes={messagesCount:y.a.number,onClick:y.a.func,isLiveBlog:y.a.bool},ae.defaultProps={messagesCount:"",onClick:function(){}};var oe=ae,re=n(158),se=n(100),ie=n(676),ce=n.n(ie),le=n(677),ue=n.n(le);function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var pe=function(e){c()(n,e);var t=de(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){var e=E()(ue.a.typingAnimation,{[ue.a.small]:this.props.isSmall,[ue.a.transparent]:this.props.transparent});return g.a.createElement("span",{className:e},g.a.createElement("span",null),g.a.createElement("span",null),g.a.createElement("span",null))}}]),n}(h.Component);pe.displayName="TypingAnimation",pe.propTypes={isSmall:y.a.bool},pe.defaultProps={isSmall:!1};var me=n(86),fe=n(81),he=n(33);function ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var ve=function(e){c()(n,e);var t=ge(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.users,n=e.className,a=e.size,o=e.typingUsersCount;e.spotId;if(o>0&&t.length>0){var r=t[t.length-1],s="large"===a?"medium":"normal",i=E()(n,ce.a.conversationTyping,{[ce.a.small]:"small"===a}),c=E()({[ce.a.userImageWrapper]:!he.l||o>1,[ce.a.counter]:o>1},ce.a[s]),l={height:"".concat(fe.USER_IMAGE_SIZE.NORMAL,"px"),width:"".concat(fe.USER_IMAGE_SIZE.NORMAL,"px")};return g.a.createElement("div",{className:i},g.a.createElement("div",{className:c,style:he.l&&o>1?l:{},"data-typing-users-count":o},g.a.createElement(me.a,{isOnline:!1,size:fe.USER_IMAGE_SIZE.NORMAL,disableUserImageUpload:!0,disableTooltip:!0,user:r})),g.a.createElement("div",{className:ce.a.details,"data-spot-im-class":"typing-animation-box"},g.a.createElement(pe,{transparent:!0})))}return null}}]),n}(h.Component);ve.defaultProps={size:"large",users:[]};var ye=n(687),be=n.n(ye);function Ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Me=function(e){c()(n,e);var t=Ee(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.typingUsers,n=e.messagesCount,a=e.onShowMore,o=e.typingUsersCount,r=e.spotId,s=e.isLiveBlog,i=E()(be.a.topActivityBar,{[be.a.hasTyping]:o>0,[be.a.hasShowNew]:n>0});return g.a.createElement("li",{className:be.a.blitzItem},o>0||n>0?g.a.createElement("div",{className:i},g.a.createElement("div",{className:be.a.messageSection},g.a.createElement(ve,{users:t,typingUsersCount:o,size:39,spotId:r})),n>0&&g.a.createElement(oe,{messagesCount:n,onClick:a,isLiveBlog:s})):g.a.createElement("div",null))}}]),n}(h.Component);Me.propTypes={currentUserId:y.a.string.isRequired,typingUsers:y.a.array.isRequired,messagesCount:y.a.number,onShowMore:y.a.func,spotId:y.a.string,isLiveBlog:y.a.bool},Me.defaultProps={messagesCount:0,onShowMore:function(){},isLiveBlog:!1};var Re=Object(M.connect)((function(e){return{spotId:e.moduleOptions.spotId,currentUserId:e.currentUser.id,typingUsers:Object(se.c)(e),typingUsersCount:Object(se.d)(e),isLiveBlog:e.moduleOptions.isConversationLiveBlog}}),{onShowMore:re.b})(Me),Se=n(76),Ce=n(30),Oe=n.n(Ce),ke=n(55),we=n.n(ke),Ie=n(39),xe=n(688),Te=n.n(xe),Ne=n(401);function De(e){var t=e.offsetHeight,n=getComputedStyle(e);return t+=parseInt(n.marginTop)+parseInt(n.marginBottom)}function je(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Le=function(e){e&&"function"==typeof e&&e()},Ue=function(e){c()(r,e);var t,n,a=je(r);function r(){return o()(this,r),a.apply(this,arguments)}return s()(r,[{key:"enter",value:(n=Z()(J.a.mark((function e(t){var n,a;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Ie.b&&!this.props.mobileEnabled||this.props.enterAnimationDisabled)){e.next=3;break}return Le(t),e.abrupt("return");case 3:return n=Object(R.findDOMNode)(this),a="".concat(De(n),"px"),n.style.opacity=0,n.style.height=0,e.next=9,Object(Ne.a)(n,{opacity:1,height:a},{duration:432,easing:"cubic-bezier(0.86,0,0.07,1)"});case 9:n.style.opacity="",n.style.height="",Le(t);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"leave",value:(t=Z()(J.a.mark((function e(t){var n,a;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ie.b||this.props.mobileEnabled){e.next=3;break}return Le(t),e.abrupt("return");case 3:return n=Object(R.findDOMNode)(this),a=De(n),n.style.opacity=1,n.style.height=a,e.next=9,Object(Ne.a)(n,{opacity:0,height:"0px"},{duration:432,easing:"cubic-bezier(0.86, 0, 0.07, 1)"});case 9:n.style.opacity="",n.style.height="",Le(t);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this.props,t=e.className,n=e.children,a=e.depth,o=e.user,r=E()(Te.a.appearanceComponent,{[Te.a.isReply]:a>0,[Te.a.isHighlighted]:o.isJournalist||o.isAdmin||o.isModerator},t);return g.a.createElement("div",{className:r},n)}}]),r}(h.Component);Ue.propTypes={children:y.a.any,className:y.a.string,mobileEnabled:y.a.bool,enterAnimationDisabled:y.a.bool,user:y.a.object,depth:y.a.number},Ue.defaultProps={mobileEnabled:!0,enterAnimationDisabled:!1,className:void 0};var Be=n(137),Pe=n(68);function Ae(e){var t,n;return 0===e.message.depth?(t=Be.default.t("message.contextMenu.delete.confirmation.titleComment"),n=e.currentUser.isModerator&&e.message.repliesCount>0?Be.default.t("message.contextMenu.delete.confirmation.relatedReplies",{params:{repliesCount:"props.message.repliesCount"}}):Be.default.t("message.contextMenu.delete.confirmation.comment")):(t=Be.default.t("message.contextMenu.delete.confirmation.titleReply"),n=Be.default.t("message.contextMenu.delete.confirmation.reply")),g.a.createElement(w.Modal,{disableCustomBodyScroll:he.j,shadowRootCssModules:Pe.c?["conversation"]:void 0,isLtr:he.t,fullScreenMobile:!1,showModal:e.showModal,onClose:function(){return e.onClose()},size:"md",bottomActions:g.a.createElement(w.Gutter,null,g.a.createElement(w.Button,{mode:"secondary",onClick:function(){return e.onClose()},id:"spotim-delete-message-cancel"},Be.default.t("message.contextMenu.delete.confirmation.cancelButton")),g.a.createElement(w.Button,{mode:"primary",onClick:function(){e.onClose(!0)},id:"spotim-delete-message-ok"},Be.default.t("message.contextMenu.delete.confirmation.okButton"))),modalTitle:t},n)}var _e=n(36),Fe=n.n(_e),Ve=n(738),Ke=n.n(Ve),He=n(65);function qe(e){var t=Object(h.useState)(!1),n=Fe()(t,2),a=n[0],o=n[1],r=e.message,s=r.id,i=r.conversationId,c=function(){var t=Z()(J.a.mark((function t(n){return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o(!0),t.next=3,Object(He.a)("moderation/conversation/".concat(i,"/message/").concat(s,"/feature"),{data:{should_top_feature:n},method:"POST"});case 3:o(!1),n?e.onClose("top-featured"):e.onClose("leave-tagged");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return g.a.createElement(w.Modal,{disableCustomBodyScroll:he.j,shadowRootCssModules:Pe.c?["conversation"]:void 0,isLtr:he.t,closeButton:!0,showModal:e.showFeaturedCommentModal,onClose:function(){return e.onClose("closed")},modalTitle:"Pin Featured Comment",className:Ke.a.featureCommentModal,size:"md",bottomActions:g.a.createElement(w.Gutter,null,g.a.createElement(w.Button,{mode:"secondary",disabled:a,onClick:function(){return c(!1)}},"No"),g.a.createElement(w.Button,{mode:"primary",disabled:a,onClick:function(){return c(!0)}},"Yes"))},g.a.createElement("div",{className:Ke.a.text},"Would you like to pin this featured comment at the top of the conversation?"),g.a.createElement("div",{className:Ke.a.imageWrapper},g.a.createElement("img",{className:Ke.a.image,src:"http://publisher-assets.spot.im/featured-comment/set-post-as-featured.svg"})))}qe.propTypes={message:y.a.object,showFeaturedCommentModal:y.a.bool,onClose:y.a.func};var We=qe,ze=n(161),Ge=n(739),Qe=n.n(Ge);function Je(e){var t=e.label,n=e.showSpinner;return g.a.createElement("div",{className:E()(Qe.a.wrapper,n&&Qe.a.showSpinner)},g.a.createElement("div",{className:Qe.a.label},t),g.a.createElement("div",{className:Qe.a.spinnerWrapper},g.a.createElement(U.a,null)))}function Ye(e){var t=Object(ze.a)().t,n=Object(h.useState)(!1),a=Fe()(n,2),o=a[0],r=a[1];return g.a.createElement(w.Modal,{disableCustomBodyScroll:he.j,shadowRootCssModules:Pe.c?["conversation"]:void 0,isLtr:he.t,fullScreenMobile:!1,showModal:e.showModal,onClose:function(){return e.onClose()},size:"md",bottomActions:g.a.createElement(w.Gutter,null,g.a.createElement(w.Button,{mode:"secondary",onClick:function(){e.onClose("cancel")}},t("message.contextMenu.delete.confirmation.cancelButton","No")),g.a.createElement(w.Button,{mode:"primary",onClick:function(){r(!0),e.onClose("ok")}},g.a.createElement(Je,{label:t("message.contextMenu.delete.confirmation.okButton","Yes"),showSpinner:o}))),modalTitle:t("reportMessageModal.title","Report Message")},g.a.createElement(te.a,{i18nKey:"reportMessageModal.body"},"Would you like to report this comment as inappropriate? The reported comment will not be displayed in your view."))}var Ze=n(173),Xe=n(740),$e=n.n(Xe);function et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var tt=function(e){c()(n,e);var t=et(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).wrapperRef=g.a.createRef(),e.state={startAnimation:!1,expanderStyle:{height:"0px"},demarginStyle:{marginTop:"-60px"}},e.maxHeight=void 0,e.startAnimation=function(){setTimeout((function(){e.setState({startAnimation:!0})}),1e3),setTimeout((function(){e.setState({animationDone:!0})}),3e3),e.setState({expanderStyle:{height:"0px"}}),e.interval=setInterval((function(){if(e.wrapperRef.current){var t=e.wrapperRef.current.getBoundingClientRect().height;if(t<e.maxHeight)return;e.maxHeight=t;var n=t+"px";n!==e.state.expanderStyle.height&&e.setState({expanderStyle:{height:n}}),"0px"!==e.state.demarginStyle.marginTop&&e.setState({demarginStyle:{marginTop:"0px"}})}}),100)},e}return s()(n,[{key:"componentDidMount",value:function(){this.props.animate&&this.startAnimation()}},{key:"componentDidUpdate",value:function(e){this.props.animate&&this.props.animate!==e.animate&&this.startAnimation()}},{key:"render",value:function(){return this.props.animate?g.a.createElement("div",{className:E()($e.a.animateInWrapper,this.state.startAnimation&&$e.a.startAnimation,this.state.animationDone&&$e.a.animationDone)},g.a.createElement("div",{className:$e.a.demargin,style:this.state.demarginStyle},g.a.createElement("div",{className:$e.a.expander,style:this.state.expanderStyle},g.a.createElement("div",{ref:this.wrapperRef,className:$e.a.animateIn},this.props.children)))):this.props.children}}]),n}(g.a.Component),nt=n(741),at=n.n(nt),ot=n(71);function rt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var st=function(e){c()(n,e);var t=rt(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"renderTranslatedText",value:function(){var e=this.props,t=e.isReported,n=e.isDeleted;return t?g.a.createElement(D.a,{textKey:"message.reported"}):n?g.a.createElement(D.a,{textKey:"message.deleted"}):g.a.createElement(D.a,{textKey:"message.muted"})}},{key:"render",value:function(){var e=this.props,t=e.userImageSize,n=e.innerRef,a=Object(ot.a)();return g.a.createElement("div",{ref:n,className:E()(at.a.messageDetails,at.a.deletedMessage)},g.a.createElement(me.a,{size:t,user:a,disableTooltip:!0}),g.a.createElement(w.Typography,{type:"infoMd",className:at.a.isDeleted},this.renderTranslatedText()))}}]),n}(h.Component);st.displayName="DeletedMessage",st.propTypes={spotName:y.a.string.isRequired,userImageSize:y.a.number.isRequired,isReported:y.a.bool.isRequired,isDeleted:y.a.bool.isRequired,innerRef:y.a.object.isRequired},st.defaultProps={userImageSize:"medium"};var it=Object(M.connect)((function(e){return{spotName:e.moduleOptions.spotName,moderatorBadgeText:e.moduleOptions.textsOverrides.moderatorBadgeText,reporterBadgeText:e.moduleOptions.textsOverrides.reporterBadgeText}}))(st),ct=n(26);function lt(e){var t=e.messageId;return function(){var e=Z()(J.a.mark((function e(n,a){var o,r;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=a(),r=A.j(o),n({type:ct.P,payload:{messageId:t,isLiveBlog:r}});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}var ut=n(742),dt=n.n(ut),pt=n(80);function mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var ft=function(e){c()(n,e);var t=mt(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){return g.a.createElement(w.Button,{onClick:this.props.onReply,className:dt.a.replyButton},g.a.createElement(pt.a,{className:dt.a.messageReply},g.a.createElement(D.a,{"data-spot-im-class":"message-reply",role:"button",textKey:"message.reply"},"Reply")))}}]),n}(h.Component);ft.defaultProps={onReply:function(){},messageReplyGotFocus:function(){}};var ht,gt=Object(M.connect)((function(e){return{spotId:e.moduleOptions.spotId}}))(ft),vt=n(398);!function(e){e.Like="like",e.UpDown="updown",e.Recommend="recommend"}(ht||(ht={}));var yt=k.a.get("tenant_config.shared.votes_type",ht.Like),bt=n(743),Et=n.n(bt);function Mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Rt=function(e){c()(n,e);var t=Mt(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={activeNoAnimation:e.props.active},e}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.active,n=e.type,a=e.isReply;return g.a.createElement("div",{"data-spot-im-class":"animated-vote-".concat(n),id:"spotim-animated-vote-".concat(n,"-").concat(a?"reply":"comment"),className:E()(Et.a.voteIconWrapper,{[Et.a.active]:t})},g.a.createElement(x.a,{selector:this.icon}))}},{key:"icon",get:function(){var e=this.props,t=e.active,n=e.type;switch(yt){case ht.UpDown:return"up"===n?t?"upVoteFull":"upVote":t?"downVoteFull":"downVote";case ht.Recommend:return t?"recommended":"recommend";case ht.Like:default:return"up"===n?t?"voteUpIconFull":"voteUpIcon":t?"voteDownIconFull":"voteDownIcon"}}}]),n}(h.Component);Rt.contextTypes={toastMessage:y.a.object.isRequired};var St=Object(vt.a)()(Rt),Ct=n(744),Ot=n.n(Ct),kt=n(4),wt=n(44);function It(e){return xt.apply(this,arguments)}function xt(){return(xt=Z()(J.a.mark((function e(t){var n,a,o;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.messageId,a=t.operation,o=a,e.next=4,Object(He.a)("rank/reply/".concat(n),{method:"POST",data:o});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tt(e){return Nt.apply(this,arguments)}function Nt(){return(Nt=Z()(J.a.mark((function e(t){var n,a,o;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,a=t.postId,o=t.isReply,he.k){e.next=7;break}return e.next=4,Object(wt.a)("v1.0.0/rank/rank/message",{method:"POST",data:n,postId:a});case 4:return e.abrupt("return",e.sent);case 7:if(!o){e.next=13;break}return e.next=10,It({messageId:n.message_id,operation:{operation:n.operation}});case 10:e.t0=e.sent,e.next=16;break;case 13:return e.next=15,Object(He.a)("rank/comment/".concat(n.message_id),{method:"POST",data:{operation:n.operation}});case 15:e.t0=e.sent;case 16:return e.abrupt("return",e.t0);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Dt=n(43);function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(n),!0).forEach((function(t){Oe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ut(e,t){var n=t.operation,a=t.message,o=t.conversationId,r=void 0===o?null:o,s=t.userId,i={userId:void 0===s?null:s,conversationId:r,messageId:a.id};a.featuredComment&&(i.target_type="featured-comment",i.segment="top"===a.featuredComment?"top-featured-comment":"in-conversation-featured"),"up"===n?a.isVotedUp?i.type="liked-cancelled":i.type="liked":a.isVotedDown?i.type="disliked-cancelled":i.type="disliked",kt.a.send(i.type)}function Bt(e,t,n){var a;switch(!0){case"up"===n&&!e&&!t:a="like";break;case"up"===n&&e&&!t:a="toggle-like";break;case"up"===n&&!e&&t:a="swap-to-like";break;case"down"===n&&!e&&!t:a="dislike";break;case"down"===n&&!e&&t:a="toggle-dislike";break;case"down"===n&&e&&!t:a="swap-to-dislike"}return{operation:a}}var Pt=n(14),At=n(66),_t=n(886),Ft=n(94),Vt=n(171),Kt=n(417),Ht=n.n(Kt),qt=function(){return g.a.createElement("div",{className:Ht.a.activityIndicator},g.a.createElement(Vt.a,{baseUrl:Object(P.getLocation)().href,rtl:!k.a.get("init_data.config.ltr"),height:98,width:224,speed:2,backgroundColor:getComputedStyle(document.documentElement).getPropertyValue("--spotim-content-loader-primary-color"),foregroundColor:getComputedStyle(document.documentElement).getPropertyValue("--spotim-content-loaders-secondary-color")},g.a.createElement("rect",{x:"52",y:"11",rx:"8",ry:"8",width:"153",height:"13"}),g.a.createElement("circle",{cx:"27",cy:"17",r:"12"}),g.a.createElement("rect",{x:"52",y:"44",rx:"8",ry:"8",width:"153",height:"13"}),g.a.createElement("circle",{cx:"27",cy:"50",r:"12"}),g.a.createElement("rect",{x:"52",y:"77",rx:"8",ry:"8",width:"153",height:"13"}),g.a.createElement("circle",{cx:"27",cy:"83",r:"12"})))},Wt={[ht.Like]:"likersList",[ht.UpDown]:"upDownList",[ht.Recommend]:"recommendList"},zt=Object(M.connect)((function(e){return{direction:e.moduleOptions.direction,disableUserProfileModal:e.moduleOptions.disableUserProfileModal}}),(function(e){return{dispatch:e}}))((function(e){var t=e.users,n=void 0===t?[]:t,a=e.dispatch,o=e.scheduleUpdate,r=e.upVotesCount,s=e.onLoadMore,i=e.disableUserProfileModal,c=Object(ze.a)().t,l=Object(_t.a)(),u=Fe()(l,2),d=u[0],p=u[1];function m(e,t){t.preventDefault(),he.m||a(Object(Ft.a)({user:e}))}Object(h.useEffect)((function(){o&&o()}),[n]),Object(h.useEffect)((function(){d.isIntersecting&&s()}),[d]);var f=0===n.length,v=E()(Ht.a.user,{[Ht.a.notClickable]:i||he.m}),y=c("".concat(Wt[yt],".header"),{numUsers:r,count:r});return g.a.createElement("div",{className:E()(Ht.a.usersList,f&&Ht.a.isLoading)},g.a.createElement("div",{className:Ht.a.header},y),g.a.createElement("div",{className:Ht.a.list},f&&g.a.createElement(qt,null),!f&&n.map((function(e){return g.a.createElement("a",{href:"spotim-user",className:v,key:e.id,onClick:m.bind(null,e)},g.a.createElement("div",{className:E()(!he.l&&Ht.a.userImage)},g.a.createElement(me.a,{user:e,isOnline:e.isOnline,size:33,disableUserImageUpload:!0})),g.a.createElement("div",{className:Ht.a.userDetails},g.a.createElement("div",{className:E()(Ht.a.displayName,{[Ht.a.notClickable]:he.m})},Object(Pt.getDisplayName)(e)),g.a.createElement("div",{className:E()(Ht.a.username,{[Ht.a.notClickable]:he.m})},"@",e.username)))})),g.a.createElement("div",{ref:p})))})),Gt=n(74),Qt=n.n(Gt),Jt=n(746),Yt=n.n(Jt);function Zt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0,s={message_type:0===e?"comment":"reply",message_id:t,spot_id:n,offset:a,count:o};return Object(wt.a)("v1.0.0/conversation/rank/message/users",{postId:r,method:"POST",data:s})}var Xt=n(138),$t=n(70);function en(e){var t=e.messageDepth,n=e.messageId,a=e.conversationId,o=e.offset,r=e.count;return function(){var e=Z()(J.a.mark((function e(s,i){var c,l,u,d,p,m,f;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=i().conversation.postId,s({type:ct.db,payload:{messageDepth:t,messageId:n,conversationId:a,spotId:he.x,offset:o,count:r}}),e.next=5,Zt(t,n,he.x,o,r,c);case 5:l=e.sent,u=i(),d=u.comments.list.messages,p=u.currentUser,m=d[n],f=$t.a.map(l.Users,Object(Xt.a)("",l.Users)),m.message.isVotedUp&&(f=Yt()([].concat(Qt()(f),[p]),"id")),s({type:ct.gb,payload:{users:f,messageDepth:t,conversationId:a,messageId:n,spotId:he.x,offset:o,count:r}}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),s({type:ct.gb,payload:{error:e.t0},error:!0}),kt.a.error("getUpvotes",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}()}function tn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var nn=k.a.get("tenant_config.conversation.disable_vote_up"),an=k.a.get("tenant_config.conversation.disable_vote_down"),on=function(e){c()(n,e);var t=tn(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={offset:0,isVotedUp:e.props.message.isVotedUp,isVotedDown:e.props.message.isVotedDown,showVotersList:!1},e.toggleVoteUp=function(){var t=e.props,n=t.allowGuestVoting,a=t.showLoginSelectorModal;if(n){var o=e.state.isVotedUp,r=e.state.isVotedDown;r&&(r=!r),e.setState({isVotedUp:!o,isVotedDown:r}),e.props.onToggleVote({operation:"up"}),Object(P.dispatchSpotimEvent)(Dt.c)}else a()},e.toggleVoteDown=function(){var t=e.props,n=t.allowGuestVoting,a=t.showLoginSelectorModal;if(n){var o=e.state.isVotedUp,r=e.state.isVotedDown;o&&(o=!o),e.setState({isVotedUp:o,isVotedDown:!r}),e.props.onToggleVote({operation:"down"}),Object(P.dispatchSpotimEvent)(Dt.b)}else a()},e.loadVotedUsers=function(){var t=e.state.offset,n=e.props,a=n.message;(0,n.loadVotedUsers)({messageDepth:a.depth,messageId:a.id,offset:t})},e.handleLoadMore=function(){e.setState((function(e){return{offset:e.offset+10}}),(function(){e.loadVotedUsers()}))},e.handleShowMenuChange=function(t){e.setState({showVotersList:t})},e.getUpVoteButton=function(){var t=e.props,n=t.message,a=t.message.upVotesCount,o=e.state.isVotedUp,r=n.depth>0,s=yt===ht.Recommend;return g.a.createElement(pt.a,{disableHover:!a&&!s,isIcon:!a&&!s,onClick:e.toggleVoteUp,className:E()(Ot.a.votesWrapper,{[Ot.a.voteSelected]:o})},g.a.createElement(St,{type:"up",isReply:r,active:o}),(!!a||s)&&g.a.createElement("span",{className:Ot.a.votesCounter},s?o?g.a.createElement(te.a,{className:Ot.a.recommendedText,i18nKey:"message.recommended",values:{count:a}},"Recommended (",a,")"):g.a.createElement(te.a,{className:Ot.a.recommendedText,i18nKey:"message.".concat(a?"recommend":"recommend_0"),values:{count:a}},"Recommend (",a,")"):a))},e}return s()(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({isVotedUp:e.message.isVotedUp,isVotedDown:e.message.isVotedDown})}},{key:"componentDidUpdate",value:function(e,t){var n=this,a=this.state.showVotersList;a&&t.showVotersList!==a&&this.setState({offset:0},(function(){n.loadVotedUsers()}))}},{key:"render",value:function(){var e=this.props,t=e.votedUsers,n=e.message,a=e.message,o=a.upVotesCount,r=a.downVotesCount,s=this.state.isVotedDown,i=n.depth>0;return g.a.createElement("div",{className:Ot.a.votesContainer,"data-spot-im-class":"vote-links"},!nn&&g.a.createElement(w.Menu,{isLtr:he.t,isMobile:Ie.a,placement:"bottom",onShowChange:this.handleShowMenuChange,trigger:0===o||Ie.a?"none":"hover",mobileCancelButtonContent:g.a.createElement(te.a,{i18nKey:"menu.closeButton"},"Done"),delayShow:300,menuButton:this.getUpVoteButton(),disabled:!o},g.a.createElement(zt,{users:t,scheduleUpdate:function(){},upVotesCount:o,onLoadMore:this.handleLoadMore})),!an&&yt!==ht.Recommend&&g.a.createElement(pt.a,{disableHover:!r,isIcon:!r,onClick:this.toggleVoteDown,className:E()(Ot.a.votesWrapper,{[Ot.a.voteSelected]:s})},g.a.createElement(St,{type:"down",isReply:i,active:s}),!!r&&g.a.createElement("span",{className:Ot.a.votesCounter},r)))}}]),n}(h.Component);on.defaultProps={allowGuestVoting:!0};var rn=Object(M.connect)((function(e){var t=e.currentUser,n=e.moduleOptions.enableGuestVoting,a=e.upVotesList.users;return{allowGuestVoting:Object(Pt.isLoggedIn)(t)||n,votedUsers:a}}),(function(e,t){return{onToggleVote(n){var a=n.operation;e(function(e){var t=e.operation,n=e.message;return function(){var e=Z()(J.a.mark((function e(a,o){var r,s,i,c,l,u,d,p,m,f,h;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=o(),s=r.moduleOptions.postId,i=r.conversation,c=i.id,l=i.contentType,u=r.currentUser.id,d=n.id,p=n.isVotedUp,m=n.isVotedDown,"up"!==t||p?"down"!==t||m||Object(P.dispatchSpotimEvent)(Dt.w):Object(P.dispatchSpotimEvent)(Dt.y),a({type:ct.Gb,payload:{operation:t,message:n}}),f=n.depth>0,h=Bt(p,m,t),e.next=9,Tt({postId:s,isReply:f,data:Lt(Lt({},h),{},{message_id:d,source:l})});case 9:Ut(o,{operation:t,message:n,conversationId:c,userId:u}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),a({type:ct.Fb,payload:{error:e.t0,operation:t,rootMessageId:rootMessageId,id:id},error:!0}),kt.a.error("toggleVoteMessage",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}()}({operation:a,message:t.message}))},showLoginSelectorModal(){e(Object(At.a)())},loadVotedUsers(t){var n=t.messageDepth,a=t.messageId,o=t.offset,r=void 0===o?0:o,s=t.count;e(en({messageDepth:n,messageId:a,offset:r,count:void 0===s?10:s}))}}}))(on),sn=n(418),cn=n(749),ln=n.n(cn);function un(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var dn=function(e){c()(n,e);var t=un(n);function n(e){var a;return o()(this,n),(a=t.call(this,e)).handleMessageReplyGotFocus=function(){a.props.messageReplyGotFocus()},a.onReply=function(){var e=a.props.conversationId;Object(P.dispatchSpotimEvent)(Dt.v),a.props.onReply(a.props.message,event),a.props.tracking.trackEvent({type:"editor-reply-focus",ugc_post_id:e})},a.handleCloseShareModal=function(){a.setState({showShareModal:!1})},a.state={showShareModal:!1},a}return s()(n,[{key:"componentWillUnmount",value:function(){clearTimeout(this.isEditableTimeout)}},{key:"share",value:function(){var e=this;Ie.a&&"function"==typeof navigator.share?navigator.share({title:document.title,url:Object(P.getLocation)().href}).catch((function(){e.setState({showShareModal:!0})})):this.setState({showShareModal:!0}),this.hideDroplist()}},{key:"render",value:function(){var e=this.props,t=e.message,n=e.currentUser,a=e.depth,o=e.enableVotes,r=e.isDisabled,s=e.enableReply,i=e.isLiveBlog,c=e.spotName,l=e.spotId,u=e.postId,d=this.state.showShareModal,p=E()(ln.a.messageActions,ln.a["depth-".concat(a)],{[ln.a.isDisabled]:r,[ln.a.isLiveBlog]:i,[ln.a.isFullyVoted]:t.upVotesCount&&t.downVotesCount});return g.a.createElement("div",{className:p},i&&g.a.createElement(g.a.Fragment,null,g.a.createElement(D.a,{onClick:this.share.bind(this),className:ln.a.shareMessageText,textKey:"message.share"}),g.a.createElement(sn.a,{currentUser:n,spotId:l,spotName:c,message:t,show:d,onClose:this.handleCloseShareModal,postId:u})),s&&g.a.createElement(gt,{messageReplyGotFocus:this.handleMessageReplyGotFocus,onReply:this.onReply}),o&&g.a.createElement(rn,{message:t}))}}]),n}(h.Component);dn.displayName="MessageActions",dn.propTypes={message:y.a.object.isRequired,spotName:y.a.string.isRequired,currentUser:y.a.object.isRequired,depth:y.a.number,onReply:y.a.func,enableReply:y.a.bool,enableVotes:y.a.bool,messageReplyGotFocus:y.a.func,isDisabled:y.a.bool,spotId:y.a.string.isRequired,postId:y.a.string.isRequired,conversationId:y.a.string.isRequired},dn.defaultProps={depth:3,enableReply:!0,enableVotes:!0,onReply:function(){},messageReplyGotFocus:function(){}};var pn=f()(Object(M.connect)((function(e){var t=A.j(e),n=e.isReadOnly;return{isLiveBlog:e.moduleOptions.isConversationLiveBlog,spotName:e.moduleOptions.spotName,spotId:e.moduleOptions.spotId,postId:e.moduleOptions.postId,conversationId:e.moduleOptions.conversationId,currentUser:e.currentUser,enableReply:!t&&!n,isMobileDevice:A.l(e)||e.moduleOptions.isMobile}}),(function(e){return{onReply:function(t){e(lt({messageId:t.id}))}}})),Object(S.track)({}))(dn),mn=n(750),fn=n.n(mn);function hn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var gn=function(e){c()(n,e);var t=hn(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.url,a=e.onClick;return t=E()(fn.a.messageUrl,t),g.a.createElement("span",{className:t},g.a.createElement("a",{href:n,className:fn.a.link,onClick:function(e){return a(e,n)}},g.a.createElement(D.a,{textKey:"message.conversationLinkText"})))}}]),n}(h.Component);gn.displayName="MessageUrl",gn.propTypes={className:y.a.string,url:y.a.string,onClick:y.a.func},gn.defaultProps={className:void 0,url:"",onClick:function(){}};var vn=n(69),yn=n(751),bn=n.n(yn);function En(e){var t=e.message,n=Object(Pt.getDisplayName)({id:t.replyToUserId||"",username:t.replyToUsername||"",displayName:t.replyToDisplayName||"",isRegistered:!1});return n?g.a.createElement(g.a.Fragment,null,g.a.createElement(x.a,{className:bn.a.replyToIcon,selector:"chevronRightIcon"}),g.a.createElement(w.Typography,{type:"infoSm",className:bn.a.replyUsername},n)):null}var Mn=n(419),Rn=n.n(Mn),Sn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{onlyBadge:!1,isMobile:!1,inline:!1},n=t.onlyBadge,a=t.isMobile,o=t.inline;if(!e)return null;function r(){return n?null:g.a.createElement(x.a,{className:Rn.a.FeaturedIcon,selector:"thumbtackIcon"})}function s(){return n&&!a?null:g.a.createElement("span",{className:Rn.a.Space},"Â·")}function i(){return g.a.createElement("span",{className:E()([Rn.a.Badge,{[Rn.a.Badge_OnlyBadgeNotInline]:n&&!o}])},g.a.createElement(D.a,{textKey:"featuredComment.".concat(a?"featured":"featuredBy"),params:{spotName:e.toUpperCase()}}))}return a?g.a.createElement(fe.Row,{className:Rn.a.featuredBadgeRow},s(),r(),i()):g.a.createElement(fe.Row,null,s(),r(),i())},Cn=n(50),On=n.n(Cn);var kn=function(e){return e===(new Date).getFullYear()},wn=n(752),In=n.n(wn);var xn=function(e){var t=Object(ze.a)().t;function n(){var n=e.date;return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"short",a=e.getMonth()+1;return"".concat(e.getDate()," ").concat(t("".concat("prettyDate.","months.").concat(a,".").concat(n)),", ").concat(e.getUTCFullYear()," ").concat(e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))}("number"==typeof n?new Date(1e3*n):n,t)}e.longDate;var a=On()(e,["longDate"]);return g.a.createElement(w.Typography,{className:In.a.dateFormat,type:"infoSm"},g.a.createElement("time",we()({},a,{"aria-label":n(),title:n()}),function(){var n=e.date,a=e.longDate;return function(e,t,n){var a=e.getTime(),o=(Date.now()-a)/1e3,r=null,s=t?"long":"short",i=kn(e.getUTCFullYear());if(!a||isNaN(o))r="";else if(o<14)r=n("".concat("prettyDate.","now"));else if(o<60){var c=Math.floor(o);r=n("".concat("prettyDate.").concat(s,"Second"),{count:c,seconds:c})}else if(o<3600){var l=Math.floor(o/60);r=n("".concat("prettyDate.").concat(s,"Minute"),{count:l,minutes:l})}else if(o<86400){var u=Math.floor(o/3600);r=n("".concat("prettyDate.").concat(s,"Hour"),{count:u,hours:u})}else{var d=e.getUTCMonth()+1,p=Math.floor(o/86400);if(p<3)r=n("".concat("prettyDate.").concat(s,"Day"),{count:p,days:p});else if(he.n){r=new Intl.DateTimeFormat(he.g,{year:"numeric",month:"long",day:"numeric"}).format(e)}else r="".concat(e.getDate()," ").concat(n("".concat("prettyDate.","months.").concat(d,".").concat(s))).concat(t||!i?", ".concat(e.getUTCFullYear()):"")}return r}("number"==typeof n?new Date(1e3*n):n,a,t)}()))};function Tn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Nn=function(e){c()(n,e);var t=Tn(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={isVisible:!1},e.handleUsernameMouseOver=function(){e.props.tracking.trackEvent({type:"user-profile-hovered",item_type:"main",message_id:e.props.message.id,target_id:e.props.user.id})},e.handleOpenUserProfile=function(t){var n=e.props,a=n.message,o=n.user,r=n.currentUser,s=n.tracking,i=Object(Pt.isSameUser)(r,o);s.trackEvent({type:"user-profile-clicked",item_type:"main",target_type:"tooltip"===t?"profile-preview":"message",native:0===a.depth?"comment":"reply",segment:"name",target_id:i?"my-profile":o.id,message_id:a.id,related_message_id:a.rootMessageId,ugc_post_id:e.props.conversationId})},e.renderFeaturedComment=function(t){var n=e.props,a=n.message,o=n.spotName,r=n.isMobileDevice,s=void 0!==r&&r;return"top"===a.featuredComment?Sn(o,{onlyBadge:!1,isMobile:s,inline:t}):a.featured?Sn(o,{onlyBadge:!0,isMobile:s,inline:t}):null},e}return s()(n,[{key:"componentDidMount",value:function(){this.setState({isVisible:!0})}},{key:"render",value:function(){var e=this.props,t=e.message,n=e.user,a=e.messageUrl,o=e.reporters,r=(e.spotName,e.currentUser),s=e.onMessageUrlClick,i=(e.reporterBadgeText,e.moderatorBadgeText,e.communityModeratorBadgeText,e.adminBadgeText,e.journalistBadgeText,e.enableHideMessage),c=e.messageContextMenu,l=(e.enableGamificationBadges,e.isMobileDevice),u=e.innerRef,d=e.t,p=e.isDisabled,m=e.children,f=this.state.isVisible,h=Array.isArray(o)&&(o.indexOf(n.username)>-1||o.indexOf(n.id)>-1),v=null;a&&(v=g.a.createElement(gn,{url:a,onClick:s}));var y=E()(Rn.a.username,{[Rn.a.brandFill]:h,[Rn.a.isUserProfileDisabled]:he.m,[Rn.a.isDisabled]:p}),b=[];(r.id===t.user.id||r.isModerator)&&(b.push(d("delete")),i&&b.push(d("hide")));var M=t.depth>0,R=n.isRegistered&&he.r&&!Object(vn.d)(n);return g.a.createElement(fe.Column,{ref:u,className:E()(Rn.a.messageDetails,{[Rn.a.depth0]:0===t.depth})},g.a.createElement(fe.Row,{className:Rn.a.messageDetailsRow},g.a.createElement(fe.Username,{"data-spot-im-class":"message-username",className:y,user:this.props.user,onMouseOver:this.handleUsernameMouseOver,onOpenUserProfile:this.handleOpenUserProfile,truncated:!0}),R&&g.a.createElement(fe.Reputation,{user:n}),g.a.createElement(fe.Badge,{user:n,forceReporter:h}),!l&&g.a.createElement(g.a.Fragment,null,g.a.createElement(En,{message:t,isMobile:l}),this.renderFeaturedComment(!1))),g.a.createElement(fe.Row,null,l&&g.a.createElement(g.a.Fragment,null,g.a.createElement(En,{message:t,isMobile:l}),M&&g.a.createElement("span",{className:Rn.a.middleDot})),g.a.createElement("div",{className:Rn.a.stats},m,l&&this.renderFeaturedComment(!0),f&&g.a.createElement(xn,{"data-spot-im-class":"message-timestamp",id:"spotim-message-timestamp-".concat(M?"reply":"comment"),date:t.postedAt||t.publishedAt,longDate:!l}),null,v)),c)}}]),n}(h.Component);Nn.defaultProps={reporters:[],enableProfileHover:!0,spotName:"",showReplyTo:!1,messageUrl:null,onMessageUrlClick:function(){},onLogin:function(){},messageContextMenu:null,enableGamificationBadges:!0,featuredComment:null,journalistBadgeText:null,convId:""};var Dn=f()(Object(M.connect)((function(e){var t=e.moduleOptions,n=t.conversationId,a=t.enableGamificationBadges,o=t.enableSSO,r=t.spotName,s=t.textsOverrides,i=s.moderatorBadgeText,c=s.communityModeratorBadgeText,l=s.reporterBadgeText,u=t.isConnectEnabled,d=t.isMobile,p=e.conversation,m=p.contentType,f=p.id;return{conversationId:n,enableGamificationBadges:a,token:e.authentication.token,enableSSO:o,spotName:r,moderatorBadgeText:i,communityModeratorBadgeText:c,reporterBadgeText:l,reporters:A.h(e),currentUser:e.currentUser,showUserImageButton:u&&!o,isMobileDevice:A.l(e)||d,contentType:m,convId:f}}),{onLogin:At.a}),C()({}),Object(vt.a)())(Nn);function jn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Ln=function(e){c()(n,e);var t=jn(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).onLoadFrameButtonClick=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];P.dispatchSpotimEvent.apply(void 0,[Dt.n].concat(t))},e}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.message,n=e.maxChars,a=e.maxLines,o=e.depth,r=e.shortenText,s=e.showFullText,i=e.innerRef,c=e.isDisabled,l=e.isLiveBlog,u=(e.showLoadFrameEntityButton,e.allowFrameEntityLoad),d=e.direction,p=e.forceEntityShow,m=e.t;return g.a.createElement(X.MessageEntities,{message:t,isLtr:"ltr"===d,depth:o,innerRef:i,isDisabled:c,isLiveBlog:l,seeMoreTranslatedText:m("general.seeMore.long"),showPostText:m("general.showPost"),editedTranslatedText:m("message.edited"),showLoadFrameEntityButton:!1,onLoadFrameButtonClick:this.onLoadFrameButtonClick,allowFrameEntityLoad:u,direction:d,forceEntityShow:p,maxChars:n,maxLines:a,shortenText:r,showFullText:s,shadowRootCssModules:Pe.c?["conversation"]:void 0})}}]),n}(h.Component);Ln.displayName="MessageEntities",Ln.propTypes={message:y.a.object.isRequired,direction:y.a.oneOf(["rtl","ltr"]).isRequired,flexDirection:y.a.oneOf(["column","row"]),showAttachment:y.a.bool,showSeeMoreButton:y.a.bool,noImageAnchors:y.a.bool,maxChars:y.a.number,maxLines:y.a.number,allowFrameEntityLoad:y.a.bool,depth:y.a.number,noAnchors:y.a.bool,shortenText:y.a.bool,richText:y.a.bool,preserveLinebreaks:y.a.bool,showLoadFrameEntityButton:y.a.bool,isMobileDevice:y.a.bool,showFullText:y.a.bool,forceEntityShow:y.a.bool,size:y.a.string,padMessage:y.a.bool,isModal:y.a.object,innerRef:y.a.object.isRequired,isDisabled:y.a.bool,isLiveBlog:y.a.bool},Ln.defaultProps={showSeeMoreButton:!0,showAttachment:!1,maxChars:0,noAnchors:!1,noImageAnchors:!1,seeMoreTranslate:"long",shortenText:!1,depth:3,richText:!0,preserveLinebreaks:!0,showLoadFrameEntityButton:!0,forceEntityShow:!1,isMobileDevice:!1,size:"normal",padMessage:!0,flexDirection:"row"};var Un=f()(Object(M.connect)((function(e){return{noImageAnchors:e.moduleOptions.conversationImageAnchorsDisabled,allowFrameEntityLoad:e.moduleOptions.allowFrameEntityLoad,direction:e.moduleOptions.direction,isMobileDevice:A.l(e)||e.moduleOptions.isMobile,isLiveBlog:A.j(e)}})),Object(vt.a)())(Ln),Bn=n(753),Pn=n.n(Bn);function An(e){var t=g.a.createElement(te.a,{i18nKey:"message.contextMenu.muteUser.confirmation.mute.title"}),n=g.a.createElement(te.a,{i18nKey:"message.contextMenu.muteUser.confirmation.mute.message"}),a=g.a.createElement(te.a,{i18nKey:"message.contextMenu.muteUser.confirmation.mute.modalConfirm"}),o=g.a.createElement(te.a,{i18nKey:"message.contextMenu.muteUser.confirmation.mute.cancelButton"});return g.a.createElement(w.Modal,{disableCustomBodyScroll:he.j,shadowRootCssModules:Pe.c?["conversation"]:void 0,isLtr:he.t,closeButton:!0,showModal:e.showMuteUserModal,className:Pn.a.userMutingModal,onClose:function(){return e.onClose()},modalTitle:t,size:"md",bottomActions:g.a.createElement(w.Gutter,null,g.a.createElement(w.Button,{mode:"secondary",onClick:function(){return e.onClose()}},o),g.a.createElement(w.Button,{mode:"primary",onMouseEnter:e.muteUserHovered,onClick:function(){var t=e.message;(0,e.muteUser)(t.user.id),e.onClose(!0)}},a))},g.a.createElement("div",{className:Pn.a.text,style:{fontFamily:"Open Sans, Open Sans Hebrew, Arial",fontSize:"15px",lineHeight:"1.4",marginBottom:"24px"}},n))}var _n=n(754),Fn=n.n(_n);function Vn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Kn=function(e){c()(n,e);var t=Vn(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.userImageSize,n=e.message,a=e.currentUser.id===n.user.id?"rejected":"defaultRejected";return g.a.createElement("div",{className:E()(Fn.a.messageDetails,Fn.a.rejectedMessage)},g.a.createElement(me.a,{size:t,user:n.user,disableTooltip:!0}),g.a.createElement("div",{className:Fn.a.isRejected},g.a.createElement(te.a,{i18nKey:"message.".concat(a)})))}}]),n}(h.Component);Kn.defaultProps={userImageSize:"medium"};var Hn=f()(Object(M.connect)((function(e){return{spotName:e.moduleOptions.spotName,currentUser:e.currentUser,moderatorBadgeText:e.moduleOptions.textsOverrides.moderatorBadgeText,reporterBadgeText:e.moduleOptions.textsOverrides.reporterBadgeText}})))(Kn),qn=n(755),Wn=n.n(qn);function zn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zn(Object(n),!0).forEach((function(t){Oe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Jn=Object(h.lazy)((function(){return Promise.all([n.e(0),n.e(23),n.e(53)]).then(n.bind(null,898))})),Yn=Object(h.lazy)((function(){return Promise.all([n.e(0),n.e(23),n.e(25),n.e(88)]).then(n.bind(null,888))})),Zn=Object(h.lazy)((function(){return Promise.all([n.e(0),n.e(22)]).then(n.bind(null,883))})),Xn=function(e){c()(n,e);var t=Qn(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).messageRef=g.a.createRef(),e.messageDetailsRef=g.a.createRef(),e.messageEntitiesRef=g.a.createRef(),e.deletedMessageRef=g.a.createRef(),e.messageMarkerRef=g.a.createRef(),e.state={collapsed:!1,showFeaturedCommentModal:!1,showMuteUserModal:!1,showDeletedMessageModal:!1,showReportMessageModal:!1},e.handleEdit=function(){e.props.onEdit(e.props.message.id)},e.onDelete=Z()(J.a.mark((function t(){return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.deleteAction();case 1:case"end":return t.stop()}}),t)}))),e.deleteAction=function(){e.props.onDelete()},e.hasContextMenu=function(e){return!0===e.isAdmin||!0===e.isModerator||!0===e.isJournalist||!0===e.isSuperAdmin||!0===e.isCommunityModerator},e.isMyMessage=function(e,t){return t.user.id===e.id},e.handleMessageReplyGotFocus=function(){},e.openFeaturedCommentModal=function(){e.setState({showFeaturedCommentModal:!0})},e.openMuteUserModal=function(){e.setState({showMuteUserModal:!0})},e.closeMuteUserModal=function(t){e.setState({showMuteUserModal:!1});var n={type:"user-prompt-message-clicked",item_type:"mute-user-prompt-message",target_type:t?"mute":"cancel",post_id:e.props.postId};e.props.tracking.trackEvent(n)},e.muteUserHovered=function(){var t={type:"user-prompt-message-viewed",item_type:"mute-user-prompt-message",target_type:"mute",post_id:e.props.postId};e.props.tracking.trackEvent(t)},e.closeFeaturedCommentModal=function(t){var n=e.props,a=n.pinFeaturedComment,o=n.message;"top-featured"===t&&a(o),e.setState({showFeaturedCommentModal:!1})},e.closeDeletedMessageModal=function(t){t&&e.onDelete(),e.setState({showDeletedMessageModal:!1})},e.handleCloseReportMessageModal=function(){var t=Z()(J.a.mark((function t(n){var a,o,r,s,i,c;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.props,o=a.message,r=a.tracking,"ok"!==n){t.next=4;break}return t.next=4,e.onReport();case 4:s=o.featuredComment?"featured-comment":"main",i=function(){if(o.featuredComment)return"top"===e.props.featuredComment?"top-featured-comment":"in-conversation-featured"}(),c={type:"report-message-clicked",target_type:s,segment:i,message_id:o.id,post_id:e.props.postId},r.trackEvent(c),e.setState({showReportMessageModal:!1});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleReport=function(){e.setState({showReportMessageModal:!0})},e.onDeletedMessageModalOpen=function(){e.setState({showDeletedMessageModal:!0})},e.sendFailedMessage=function(){var t=e.props,n=t.failedMessageTemp,a=t.dispatch;n.message&&a(Object(Ze.a)(Gn(Gn({},n.message),{},{isRetry:!0})))},e}return s()(n,[{key:"getDetailsHeight",value:function(){return(this.props.message.isDeleted?this.deletedMessageRef:this.messageDetailsRef).current.offsetHeight}},{key:"getEntitiesOriginalHeight",value:function(){var e,t;return this.props.message.isDeleted?0:null===(e=this.messageEntitiesRef)||void 0===e||null===(t=e.current)||void 0===t?void 0:t.offsetHeight}},{key:"setMessageEntitiesHeight",value:function(e){var t=this.props.message.isDeleted,n=this.messageEntitiesRef.current;!t&&n&&(n.style.height=e)}},{key:"onReport",value:function(){var e=this.props,t=e.onReport,n=e.message;return Object(P.dispatchSpotimEvent)(Dt.a,n),t({message:n},!0)}},{key:"isPendingOrBlocked",value:function(e){return e.status===(X.statuses.PENDING&&!e.isPublished)||e.status===X.statuses.BLOCKED}},{key:"isHidden",value:function(e){return this.isPendingOrBlocked(e)}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.message,a=e.currentUser,o=e.userImageSize,r=e.messageIndex,s=e.enterAnimationDisabled,i=e.noAnchors,c=e.depth,l=e.enableVotesMessageAction,u=e.onImageUpload,d=e.showFullText,p=e.reporterBadgeText,m=e.adminBadgeText,f=e.journalistBadgeText,v=e.moderatorBadgeText,y=e.communityModeratorBadgeText,b=e.featuredComment,M=e.userToken,R=e.muteUser,S=e.isStaffMember,C=e.isFailedMessage,O=e.disableProfileHover,w=e.spotName,I=this.state.showMuteUserModal,x=k.a.get("tenant_config.conversation.enableUsersMuting",!1)&&n.user.isMuted,T=this.isMyMessage(a,n),N=this.state,D=N.showFeaturedCommentModal,j=N.showDeletedMessageModal,L=N.showReportMessageModal,U=(C||n.status===X.statuses.BLOCKED||n.status===X.statuses.PENDING)&&(T||S)&&!n.isDeleted&&!x&&!n.isPublished||n.messageModeratingStage,B=a&&a.id===n.user.id?Gn(Gn({},a),{},{points:n.user.points}):n.user;t=E()(Wn.a.messageView,Wn.a["depth-".concat(c)],{[Wn.a.messageWithStatus]:U,[Wn.a.temporary]:n.isTempId},t);var P,A,_=E()({[Wn.a.collapsed]:this.state.collapsed}),F=null;if(n.starsRating&&(F=g.a.createElement(h.Suspense,{fallback:null},g.a.createElement(Zn,{starsRating:n.starsRating,disabled:!0,descriptionKey:null,editing:!1,inSayControl:!0}))),!C&&this.props.hasMenu){var V=this.isHidden(n);P=g.a.createElement(h.Suspense,{fallback:null},g.a.createElement(Jn,{onShow:this.props.onContextMenuShow,message:n,onEdit:this.handleEdit,onReport:this.handleReport,isHidden:V,featuredComment:b,openFeaturedCommentModal:this.openFeaturedCommentModal,openMuteUserModal:this.openMuteUserModal,onDeletedMessageModalOpen:this.onDeletedMessageModalOpen}))}if(U||n.status!==X.statuses.BLOCKED)if(U||!n.isDeleted&&!x){var K=U;A=g.a.createElement("div",{className:Wn.a.messageContainer},g.a.createElement(fe.Row,{alignItems:"center",className:Wn.a.messageDataWrapper},g.a.createElement(me.a,{user:B,className:Wn.a.messageUserImage,size:fe.USER_IMAGE_SIZE.NORMAL,disableTooltip:O,onImageUpload:u,isDisabled:K}),g.a.createElement(Dn,{innerRef:this.messageDetailsRef,adminBadgeText:m,journalistBadgeText:f,communityModeratorBadgeText:y,message:n,isDisabled:K,user:B,userImageSize:o,messageIndex:r,onImageUpload:u,profileHoverUser:B,messageContextMenu:P,featuredComment:b,messageStatus:n.status,enableProfileHover:!O})),F,g.a.createElement(Un,{innerRef:this.messageEntitiesRef,message:n,noAnchors:i,shortenText:this.props.shortenText,maxChars:this.props.maxChars,depth:c,isDisabled:K,maxLines:this.props.maxLines,showFullText:d}),g.a.createElement(pn,{depth:c,currentUser:a,isDisabled:K,message:n,spotName:w,enableVotes:l,messageReplyGotFocus:this.handleMessageReplyGotFocus}))}else A=g.a.createElement("div",{className:Wn.a.messageContainer},g.a.createElement(it,{isReported:n.isReported,isDeleted:n.isDeleted,isMuted:x,innerRef:this.deletedMessageRef,adminBadgeText:m,journalistBadgeText:f,message:n,userImageSize:fe.USER_IMAGE_SIZE.NORMAL,messageIndex:r}));else A=g.a.createElement("div",{className:Wn.a.messageContainer},g.a.createElement(Hn,{moderatorBadgeText:v,reporterBadgeText:p,adminBadgeText:m,journalistBadgeText:f,message:n,userImageSize:fe.USER_IMAGE_SIZE.NORMAL,messageIndex:r}));var H=null;0===c&&(H=g.a.createElement("div",{"data-ad-placeholder":"ad-placeholder-".concat(n.id)}));var q=null,W=E()(t,{[Wn.a.isMessageStatus]:!!q});return U&&(q=g.a.createElement(h.Suspense,{fallback:null},g.a.createElement("div",{className:E()(Wn.a.messageStatusClickable,W)},g.a.createElement(Yn,{message:n,isFailedMessage:C,onRetry:this.sendFailedMessage,isModerated:S,showMessageStatus:U,messageModeratingStage:n.messageModeratingStage})))),g.a.createElement(tt,{animate:"top"===n.featuredComment},g.a.createElement(Ue,{mobileEnabled:!1,enterAnimationDisabled:s,className:_,depth:c,user:B},q,H,g.a.createElement("div",{ref:this.messageRef,className:t,"data-message-id":n.id,"data-message-depth":c,"data-spot-im-class":"message-view"},A)),g.a.createElement(We,{message:n,showFeaturedCommentModal:D,onClose:this.closeFeaturedCommentModal,ConfigProvider:k.a,userToken:M}),g.a.createElement(An,{muteUserHovered:this.muteUserHovered,showMuteUserModal:I,onClose:this.closeMuteUserModal,muteUser:R,message:n}),g.a.createElement(Ae,{onClose:this.closeDeletedMessageModal,showModal:j,message:n,currentUser:a}),g.a.createElement(Ye,{showModal:L,onClose:this.handleCloseReportMessageModal}))}}]),n}(h.Component);Xn.defaultProps={className:"",hasMenu:!0,maxChars:null,userImageSize:"medium",maxLines:null,enterAnimationDisabled:!1,shortenText:!1,messageIndex:-1,featuredComment:null,isStaffMember:!1,tracking:function(){},dispatch:function(){},onMessageUnmark:function(){},onDelete:function(){},onImageUpload:function(){},onEdit:function(){},onReport:function(){},onContextMenuShow:function(){},pinFeaturedComment:function(){}};var $n=C()({})(Xn),ea=n(420),ta=n(421),na=n(149),aa=n(67);function oa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ra(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oa(Object(n),!0).forEach((function(t){Oe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sa(e){var t={[e.id]:!0},n=window.localStorage.getItem("SPOTIM_REPORTED_COMMENTS");n=ra(ra({},n&&JSON.parse(n)),t),window.localStorage.setItem("SPOTIM_REPORTED_COMMENTS",JSON.stringify(n))}var ia=n(405),ca=n(404);function la(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,a){var o=a().moduleOptions.elementId;Object(ia.b)(e,o,t),n(Object(ca.a)({id:e}))}}var ua=n(49),da=n(110);function pa(e){return function(t,n){var a=n().conversation.postId;!function(e){var t=e.userId,n=e.postId;Object(wt.a)("v1.0.0/user/mute-user",{method:"POST",postId:n,data:{user_id:t}})}({userId:e,postId:a}),t({type:ct.K,payload:{userId:e}})}}var ma=n(756),fa=n.n(ma);var ha=n(258),ga=n(422),va=!1;function ya(e){"undefined"!=typeof window?window.addEventListener("load",e):e()}ya((function(){va=!0}));var ba=function(e){e&&"function"==typeof e&&(va||"complete"===document.readyState?e():ya(e))};function Ea(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ma(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ea(Object(n),!0).forEach((function(t){Oe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ea(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ra(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Sa=function(e){c()(n,e);var t=Ra(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"componentDidMount",value:function(){var e=this.props.conversationId;this.props.disableMessageSayCtrlFocusOnMount||this.props.message.id!==this.props.highlightedReplyId&&this.props.message.id!==this.props.highlightedCommentId||(this.props.onReply(),this.props.tracking.trackEvent({type:"editor-reply-focus",ugc_post_id:e}))}},{key:"enableShowText",value:function(){var e=this.props,t=e.isLiveBlog,n=e.enableSeeMoreButton,a=e.isRootMessage;return t&&a?!!Object(Ie.d)()||(!Object(Ie.b)()||!n):!n}},{key:"render",value:function(){var e=this.props,t=e.message,n=e.conversationLongerComments,a=e.currentUser,o=e.isConnectEnabled,r=e.isMobileDevice,s=e.isLiveBlog,i=e.repliesMaxDepth,c=e.isTheFirstMessage,l=e.shouldLimitFirstMessageLength,u=e.maxCharsCountDesktop,d=e.maxCharsCountMobile,p=e.maxLinesCount,m=e.shouldLimitMessageLength,f=e.enableNewMessageSticky,h=e.enableRealtimeCommentsSticky,v=e.dispatch,y=e.enableSSO,b=n?750:void 0,M=8;c&&l&&(b=r?d:u,M=p),m&&(b=r?d:u,M=p);var R={maxChars:b,maxLines:M,shortenText:!0,showUserImageButton:o&&!y,showLoadFrameEntityButton:!1,depth:Math.min(t.depth,i),message:t,currentUser:a,showFullText:this.enableShowText(),isTheFirstMessage:c,placeholderTextKey:"richEditor.placeholder.replyTo",enableNewMessageSticky:f,enableRealtimeCommentsSticky:h,dispatch:v},S=E()(fa.a.conversationMessage,{[fa.a.padded]:s});return g.a.createElement($n,we()({className:S},this.props,R))}}]),n}(h.Component),Ca=f()(Object(M.connect)((function(e,t){var n,a=e.moduleOptions,o=e.currentUser,r=e.profileHover,s=e.comments,i=a.direction,c=a.isConnectEnabled,l=a.allowFrameEntityLoad,u=a.repliesMaxDepth,d=a.conversationLongerComments,p=a.enableSSO,m=a.conversationImageAnchorsDisabled,f=a.spotId,h=a.postId,g=a.conversationId,v=a.enableNewMessageSticky,y=a.enableSeeMoreButton,b=a.textsOverrides,E=b.communityModeratorBadgeText,M=b.moderatorBadgeText,R=b.reporterBadgeText,S=b.adminBadgeText,C=b.journalistBadgeText,O=a.isMobile,k=a.enableHighlightMessageSticky,w=a.shouldLimitFirstMessageLength,I=a.maxCharsCountDesktop,x=a.maxCharsCountMobile,T=a.maxLinesCount,N=a.shouldLimitMessageLength,D=a.highlightedReplyId,j=a.highlightedCommentId,L=a.enableRealtimeCommentsSticky,U=a.enableSegmentedCategory,B=a.disableProfileHover,P=a.spotName,_=t.message,F=_.id===_.rootMessageId,V=A.j(e),K=!V,H=o.isAdmin||o.isCommunityModerator||o.isModerator||o.isSuperAdmin,q=(null==s||null===(n=s.failedMessageTemp)||void 0===n?void 0:n.message.id)===(null==_?void 0:_.id),W=null==s?void 0:s.failedMessageTemp;return{direction:i,isConnectEnabled:c,allowFrameEntityLoad:l,repliesMaxDepth:u,currentUser:o,conversationLongerComments:d,enableSSO:p,spotId:f,postId:h,conversationId:g,noImageAnchors:m,communityModeratorBadgeText:E,moderatorBadgeText:M,reporterBadgeText:R,adminBadgeText:S,journalistBadgeText:C,enableCategoryModeration:U,profileHoverUser:r.user,enableNewMessageSticky:v,isMobileDevice:A.l(e)||O,enableSeeMoreButton:y,enableHighlightMessageSticky:k,isLiveBlog:V,enableReplies:K,shouldLimitFirstMessageLength:w,maxCharsCountDesktop:I,maxCharsCountMobile:x,maxLinesCount:T,shouldLimitMessageLength:N,highlightedReplyId:D,highlightedCommentId:j,isRootMessage:F,userToken:e.authentication.token,href:a.href,referTraffic:a.referTraffic,enableRealtimeCommentsSticky:L,isStaffMember:H,isFailedMessage:q,failedMessageTemp:W,disableProfileHover:B,disableMessageSayCtrlFocusOnMount:a.isSayControlExpanded,spotName:P}}),(function(e,t){var n=t.message;return{onLoadFrameButtonClick(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];P.dispatchSpotimEvent.apply(void 0,["spot-im-frame-entity-load"].concat(t))},onReply:function(){e(lt({messageId:n.id}))},onMessageUnmark(){e(function(e){var t=e.id;return{type:ct.xb,payload:{message:{id:t,isMarked:!1}}}}({id:n.id}))},onDelete(){e(Object(ea.a)({message:n}))},onEdit(t){var a=n.id,o=n.starsRating;"string"==typeof t&&(a=t),e(Object(ta.a)({messageId:a,starsRating:o}))},onReport(t){return e(function(e){var t=e.message;return function(){var e=Z()(J.a.mark((function e(n,a){var o,r,s,i;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=0===t.depth?"comment":"reply",r="show_report_".concat(o,"_modal"),kt.a.apm.start(r),s=a(),i=s.conversation.postId,n({type:ct.wb,payload:!0}),e.next=8,aa.l(t.id,i);case 8:sa(t),n({type:ct.cb,payload:{message:t}}),n(Object(na.b)({[t.id]:!0})),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),n({type:ct.cb,payload:{error:e.t0},error:!0}),kt.a.error("reportMessage",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}()}({message:n}))},onUserWhiteList(t){e(Object(ga.a)(t,n))},loadVotedUsers(t){var n=t.messageDepth,a=t.messageId,o=t.offset,r=void 0===o?0:o,s=t.count;e(en({messageDepth:n,messageId:a,offset:r,count:void 0===s?10:s}))},onOpenUserProfileModal(t){e(Object(Ft.a)(t))},onVotesSummaryTooltipHide(){e({type:ct.fb})},onLogin(){e(Object(At.a)())},highlightMessage(){ba((function(){e(la(n.id))}))},pinFeaturedComment(t){e(Object(da.b)(t))},muteUser(t){e(pa(t))},dispatch:e}}),(function(e,t,n){var a=t.dispatch,o=e.currentUser,r=e.enableCategoryModeration;return Ma(Ma(Ma(Ma({},e),t),n),{},{onContextMenuShow:function(e){var t=o.isAdmin,n=o.isModerator,s=e.user.id===o.id;(t||n)&&e.user.isRegistered&&!s&&a(Object(ha.a)(e)),r&&a(Object(ua.c)())},onImageUpload:function(e){a(Object(ua.e)({rawImage:e}))}})})),Object(vt.a)(),Object(S.track)({}))(Sa),Oa=n(172);var ka=n(78),wa=n(174);function Ia(){return function(){var e=Z()(J.a.mark((function e(t,n){var a,o,r,s,i,c,l;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=n(),o=a.moduleOptions.postId,r=a.userSuspension.isFetched,s=Object(ka.f)(),!r&&s){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,Object(wa.c)(o);case 7:i=e.sent,c=i.suspended,l=i.suspension_expiration,t({type:ct.z,payload:{isUserSuspended:c,expirationTime:l}}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),t({type:ct.z,payload:{isUserSuspended:!1}}),kt.a.error("fetchUserSuspensionStatus",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}()}var xa={LINEAR:function(e){return e},IN_OUT_QUART:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e}};var Ta=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:xa.LINEAR;return new Promise((function(o){var r=window===e;if(n<=0)o();else{var s=r?e.pageYOffset:e.scrollTop,i=t-s,c=Date.now()+n;requestAnimationFrame((function e(){var r=1-(c-Date.now())/n;if(r>=0&&r<=1){var u=a(r)*i;l(Math.floor(s+u)),requestAnimationFrame(e)}else l(t),o()}))}function l(t){r?e.scroll(0,t):e.scrollTop=t}}))};function Na(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.element,n=e.stackId,a=void 0===n?null:n,o=e.depth;return function(e,n){if(Object(P.dispatchSpotimEvent)(Dt.m),Ie.a){var r=document.body.getBoundingClientRect(),s=t.getBoundingClientRect().top-r.top;Ta(window,s-20,200)}var i=n(),c=i.currentUser,l=i.moduleOptions.loginUponSayControlFocus,u=Object(ua.d)(c);l&&!u&&e(Object(At.a)()),e(Ia()),e({type:ct.A,payload:{stackId:a,depth:o}})}}var Da=n(106);function ja(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.stackId,n=void 0===t?null:t;return function(){var e=Z()(J.a.mark((function e(t,a){var o,r;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=a(),(null==(r=o.communityView)?void 0:r.focusSayControlOnSwitchTab)&&t(Object(Da.b)(!1)),Object(P.dispatchSpotimEvent)(Dt.l),t({type:ct.i,payload:{stackId:n}});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}var La=n(247),Ua=n.n(La),Ba=n(217);var Pa=n(84),Aa={};function _a(e){return function(t,n){try{var a=n().conversation.id;Aa[e]?Aa[e]():Aa[e]=Ua()((function(){var t,n;t=a,n=e,Object(wt.a)("v1.0.0/conversation/typing/create",{method:"POST",postId:Object(Ba.a)(t),data:{conversation_id:t,message_id:n}})}),Pa.g,null,{trailing:!1})}catch(e){kt.a.error("notifyTyping",e)}}}var Fa=n(118),Va=n(298),Ka=n(175);function Ha(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function qa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ha(Object(n),!0).forEach((function(t){Oe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ha(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wa(e){var t=$t.a.map(e,Object(Ka.a)("message"),{conversation_id:"conversation.id",etag:"conversation.etag"}),n=t.message,a=t.conversation,o=t.users;return o&&Object(Va.a)(n,o),{message:n,conversation:a,users:o}}function za(e,t){return function(){var n=Z()(J.a.mark((function n(a){var o;return J.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:try{o=e,a(t?{type:ct.U,payload:{starsRating:o,messageId:t}}:{type:ct.T,payload:{starsRating:o}})}catch(e){a({type:ct.T,payload:{error:error},error:!0}),kt.a.error("updateStarsRating",e)}case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}function Ga(e){return{type:ct.o,payload:{parentMessageId:e}}}var Qa=n(443),Ja=n(150);function Ya(e){var t=e.entities,n=void 0===t?[]:t,a=e.starsRating,o=void 0===a?0:a,r=e.parentMessageId;return function(){var e=Z()(J.a.mark((function e(t,a){var s,i,c,l,u,d;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,s=a(),i=s.moduleOptions.postId,!(0===n.length||1===n.length&&n.find((function(e){return"text"===e.type&&""===e.text})))){e.next=6;break}return t({type:ct.X,payload:{verdict:Ja.a.APPROVE_ALL,tags:[],parentMessageId:r}}),e.abrupt("return");case 6:return c=Object(Qa.a)(n),e.next=9,Object(wa.b)(i,{content:c,stars:o,metadata:{}});case 9:l=e.sent,u=l.verdict,d=l.tags,t({type:ct.X,payload:{verdict:u,tags:d,parentMessageId:r}}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),t({type:ct.X,payload:{error:e.t0,parentMessageId:r}}),kt.a.error("realtimeModerate",e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,n){return e.apply(this,arguments)}}()}var Za=n(757),Xa=n.n(Za),$a=n(758),eo=n.n($a),to=function(e){var t,n,a=e.total,o=void 0===a?1:a,r=e.isLtr,s=void 0===r||r;return g.a.createElement("div",{className:eo.a.pointsWrapper},g.a.createElement("span",{className:eo.a.dotSeparator}),g.a.createElement(w.Tooltip,{isLtr:s,placement:"bottom",trigger:Object(Ie.b)()?"click":"hover",onShowChange:function(e){return e&&void 0},tooltipContent:g.a.createElement("div",{className:eo.a.tooltipWrapper},g.a.createElement(w.Typography,{type:"infoXs",color:"#fff"},g.a.createElement(te.a,{i18nKey:"user.reputation.description"},"Reputation points are measured by how other community members respond to your contributions. The more positive impact you make, the more points you gain.")),g.a.createElement(w.Button,{className:eo.a.learnMoreBtn,onClick:function(){var e,t,n;null===(e=window)||void 0===e||null===(t=e.__OPEN_WEB__)||void 0===t||null===(n=t.renderReputationDescriptionModal)||void 0===n||n.call(t)}},g.a.createElement(w.Typography,{type:"infoXs",weight:"bold",color:"#fff"},g.a.createElement(te.a,{i18nKey:"realtimeModeration.learnMore"},"Learn More"))))},g.a.createElement(w.Typography,{type:"infoSm"},(t=Object(P.parseNumber)(o),n=o,g.a.createElement(te.a,{i18nKey:"user.reputation.point",count:n,values:{points:t}},t," Points")))))},no=n(51),ao=Object(M.connect)((function(e){var t=e.moduleOptions.spotName,n=e.liveBlogConfig.reporters,a=e.conversation;return{contentType:a.contentType,convId:a.id,spotName:t,reporters:n}}))((function(e){var t,n=e.currentUser,a=e.handleUploadProfileImage,o=e.handleUserProfileClick,r=e.contentType,s=e.convId,i=e.reporters,c=n.isRegistered&&he.r&&!Object(vn.d)(n),l=Object(S.useTracking)();function u(){r===no.b.Post&&l.trackEvent({type:"my-profile-clicked",item_type:"post-card",ugc_post_id:s})}var d=Object(Pt.getDisplayName)(n),p=d&&!he.m?Xa.a.username:Xa.a.emptyUsername,m=Array.isArray(i)&&(i.some((function(e){return e===n.username}))||i.some((function(e){return e===n.id})));return g.a.createElement(fe.Row,{className:E()({[Xa.a.usernameWrapper]:!he.l})},g.a.createElement(me.a,{className:Xa.a.richEditorUserAvatar,isOnline:n.isOnline,size:fe.USER_IMAGE_SIZE.NORMAL,onImageUpload:a,user:n,onClick:function(){u()}}),g.a.createElement(w.Button,{onClick:function(){he.m||(u(),o())},className:E()({[Xa.a.emptyUsername]:!d||he.m})},g.a.createElement(w.Typography,{type:"username",className:p,"data-open-web-class":"user-name"},d||g.a.createElement(te.a,{i18nKey:"richEditor.placeholder.displayName"},"Your Username"))),g.a.createElement(fe.Badge,{user:n,forceReporter:m}),!n.isRegistered&&(Object(vn.e)(n.id)?g.a.createElement("div",{className:Xa.a.guestBadge},g.a.createElement("span",{className:Xa.a.dotSeparator}),g.a.createElement(w.Typography,{type:"infoMd"},g.a.createElement(te.a,{i18nKey:"general.guest"},"Guest"))):null),c&&g.a.createElement(to,{total:(null===(t=n.reputation)||void 0===t?void 0:t.total)||1,isLtr:he.t}))})),oo=n(403),ro=n.n(oo),so=n(759),io=n.n(so),co=n(760),lo=n.n(co),uo=function(e){var t=e.onCancel;return g.a.createElement(w.Button,{className:lo.a.cancelButton,onClick:t,"data-spot-im-class":"rich-editor-cancel-button"},g.a.createElement(te.a,{i18nKey:"richEditor.cancel"},"Cancel"))},po=n(761),mo=n.n(po),fo=function(e){var t=e.isLoading,n=void 0!==t&&t,a=e.hasText,o=e.hasMediaEntity,r=e.onEdit,s=Object(h.useRef)(null),i=Object(h.useState)(0),c=Fe()(i,2),l=c[0],u=c[1];return Object(h.useEffect)((function(){if(s.current){var e=s.current.getBoundingClientRect();u(e.width)}}),[]),g.a.createElement(w.Button,{mode:"primary",className:mo.a.updateButton,disabled:!(a||o),onClick:r,"data-spot-im-class":"rich-editor-update-button",ref:s,style:n?{width:"".concat(l,"px")}:void 0},n?g.a.createElement(U.a,null):g.a.createElement(te.a,{i18nKey:"richEditor.update"},"Update"))},ho=n(105),go=n(762),vo=n.n(go);function yo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var bo=function(e){c()(n,e);var t=yo(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={sendMessageAfterConnect:0,buttonWidth:0,isPostPage:e.props.contentType===no.b.Post},e.buttonRef=g.a.createRef(),e.enableLoginButton=function(){var t=e.props,n=t.hasText,a=t.hasMediaEntity,o=t.isLoggedIn,r=t.isMustRegisterToComment;return!(n||a)&&r&&!o},e.handleSendButtonKeyUp=function(t){13===t.keyCode&&e.handleClick()},e}return s()(n,[{key:"componentDidMount",value:function(){if(this.buttonRef.current){var e=this.buttonRef.current.getBoundingClientRect();this.setState({buttonWidth:e.width})}}},{key:"componentDidUpdate",value:function(){var e=this,t=this.state,n=t.buttonWidth;if(2===t.sendMessageAfterConnect&&(this.setState({sendMessageAfterConnect:0}),setTimeout((function(){e.handleClick()}),1)),this.buttonRef.current){var a=this.buttonRef.current.getBoundingClientRect();n!==a.width&&this.setState({buttonWidth:a.width})}}},{key:"handleClick",value:function(){var e=this.props,t=e.isLoading,n=e.isLoggedIn,a=e.onCreate,o=e.isMustRegisterToComment,r=e.convId;t||(o&&!n||this.enableLoginButton()?Object(ho.d)():this.isDisabled()||(this.state.isPostPage&&this.props.tracking.trackEvent({type:"posted",ugc_post_id:r}),a()))}},{key:"isDisabled",value:function(){var e=this.props,t=e.hasText,n=e.hasMediaEntity,a=e.isUserDisplayNameEmpty,o=e.isLoggedIn,r=e.withTransition,s=e.isPostAnyway,i=e.isUserSuspended,c=e.isDisplayNameRequired,l=e.hasStarsRating;return e.disableButtonWithEmptyText&&(!(t||n||l)||i||r&&!s&&!l||a&&c&&!1===o)&&!this.enableLoginButton()}},{key:"render",value:function(){var e=this.props,t=e.isLoading,n=e.sendButtonText,a=e.signupButtonText,o=e.isMustRegisterToComment,r=e.isLoggedIn,s=(e.disableButtonWithEmptyText,e.isPostAnyway),i=e.withTransition,c=e.isUserSuspended,l=null;l=t?g.a.createElement(U.a,null):!r&&o?g.a.createElement(te.a,{i18nKey:"richEditor.mustRegisterToComment",textOverride:a},"Sign up to post"):s&&!c?g.a.createElement(te.a,{i18nKey:"richEditor.postAnyway"},"Post Anyway"):g.a.createElement(te.a,{i18nKey:"richEditor.post",textOverride:n},"Send");var u=E()(vo.a.sendButton,{[vo.a.disabled]:this.isDisabled(),[vo.a.slideDown]:i,[vo.a.postAnyway]:s});return g.a.createElement(w.Button,{className:u,mode:"primary",disabled:this.isDisabled(),onClick:this.handleClick.bind(this),"data-spot-im-class":"rich-editor-send-button",ref:this.buttonRef,style:t?{width:"".concat(this.state.buttonWidth,"px")}:void 0},l)}}]),n}(h.Component);bo.propTypes={},bo.defaultProps={isUserDisplayNameEmpty:!0,isLoading:!1,hasText:!1,disableButtonWithEmptyText:!0,sendButtonText:void 0,signupButtonText:void 0,isPostAnyway:!1,withTransition:!1,isDisplayNameRequired:!1,hasStarsRating:!1};var Eo=f()(Object(M.connect)((function(e){var t;return{isUserSuspended:null===(t=e.userSuspension)||void 0===t?void 0:t.isUserSuspended,spotId:e.moduleOptions.spotId,contentType:e.conversation.contentType,convId:e.conversation.id}})),C()({}))(bo),Mo=function(e){var t,n,a=e.hasText,o=e.isLoading,r=e.isEdit,s=e.showCancelButton,i=e.disableSendButtonWithEmptyText,c=e.displayName,l=e.isMustRegisterToComment,u=e.isLoggedIn,d=e.sendButtonText,p=e.signupButtonText,m=e.hasMediaEntity,f=e.isPostAnyway,v=e.moderationAlert,y=e.starsRatingAlert,b=e.isDisplayNameRequired,M=e.showErrorBorder,R=e.onCancel,S=void 0===R?function(){}:R,C=e.onEdit,O=void 0===C?function(){}:C,k=e.onCreate,w=e.onLogin,I=e.hasStarsRating,x=E()(io.a.mainButtonsWrapper,{[io.a.edit]:r}),T=Object(h.useMemo)((function(){return b&&function(e){return!e||0===e.trim().length}(c)}),[b,c]);if(r)t=g.a.createElement(uo,{onCancel:S}),n=g.a.createElement(fo,{isLoading:o,onEdit:O,hasMediaEntity:m,hasText:a});else{n=g.a.createElement(Eo,{disableButtonWithEmptyText:i,displayName:c,onCreate:k,onLogin:w,isMustRegisterToComment:l,isLoading:o,isLoggedIn:u,hasText:a,hasStarsRating:I,isUserDisplayNameEmpty:T,sendButtonText:d,signupButtonText:p,hasMediaEntity:m,withTransition:M,isPostAnyway:v&&f,isDisplayNameRequired:b});s&&(t=g.a.createElement(uo,{onCancel:S}))}return g.a.createElement("div",{className:x},y,v,t,n)},Ro=n(254),So=Ua()((function(e,t,n){localStorage.setItem("SPOTIM_GUEST_DISPLAY_NAME",JSON.stringify({[t.id]:n})),e({type:ct.k,payload:{displayName:n}})}),500);var Co,Oo=n(763),ko=n.n(Oo);function wo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Io=function(e){c()(n,e);var t=wo(n);function n(e){var a;return o()(this,n),(a=t.call(this,e)).input=g.a.createRef(),a.inputRef=g.a.createRef(),a.state={value:e.textEntity.text},a.simpleRef=g.a.createRef(),a}return s()(n,[{key:"componentDidMount",value:function(){var e=this;(Co=new IntersectionObserver((function(t){t[0].isIntersecting&&(e.props.onViewed(),Co.disconnect())}))).observe(this.simpleRef.current);var t=this.props,n=t.text,a=t.editorEventHandlers,o=this.input.current;n&&(o.value=n),Object.keys(a).forEach((function(e){"text-change"===e&&o.addEventListener("keyup",a["text-change"],!1)}))}},{key:"getMentionEntities",value:function(){return[]}},{key:"getTextEntity",value:function(){var e=this.input.current.value;return Object(X.createTextEntityObject)({text:e})}},{key:"focus",value:function(){}},{key:"blur",value:function(){this.input.current.blur()}},{key:"setText",value:function(e){this.input.current.value=e,this.setState({value:e})}},{key:"handleFocus",value:function(){this.props.onFocus(),this.input.current.removeAttribute("rows"),this.setState({isFocused:!0})}},{key:"handleChange",value:function(e){this.setText(e.target.value),this.props.onChange()}},{key:"render",value:function(){var e,t=this.props,n=t.placeholder,a=t.maxLength,o=t.onBlur,r=t.textEntity,s=t.requireDisplayName,i=t.displayName,c=t.displayNamePlaceHolder,l=this.state.isFocused,u={rows:1,className:E()(ko.a.simpleEditor,vn.c&&ko.a.isIE,l&&ko.a.focused),ref:this.input,onFocus:this.handleFocus.bind(this),onBlur:o,placeholder:n};return a>0&&(u.maxLength=a),g.a.createElement("div",{ref:this.simpleRef,className:ko.a.richEditor},g.a.createElement("div",{className:ko.a.container},s&&g.a.createElement("div",{className:ko.a.displayNameWrapper},g.a.createElement("div",{className:ko.a.displayNameInput},i?g.a.createElement("div",{ref:this.input,onFocus:this.handleFocus.bind(this),contentEditable:!0,dangerouslySetInnerHTML:{__html:i}}):g.a.createElement("div",we()({},u,{className:ko.a.placeholder,onClick:this.handleFocus.bind(this),contentEditable:!0,dangerouslySetInnerHTML:{__html:c}})))),g.a.createElement("div",we()({ref:this.input},u,{contentEditable:!0,"data-placeholder":n,className:ko.a.simpleEditor,id:"spotim-say-config",dangerouslySetInnerHTML:{__html:null===(e=Object(X.getTextEntity)(r))||void 0===e?void 0:e.text}})),g.a.createElement("div",{className:ko.a.panel},!Ie.a&&g.a.createElement(w.Button,{className:ko.a.icon},g.a.createElement(x.a,{selector:"emoji"})),g.a.createElement(w.Button,{className:ko.a.icon},g.a.createElement(x.a,{selector:"cameraIcon"})),g.a.createElement(w.Button,{className:ko.a.icon},g.a.createElement(x.a,{selector:"gifIcon"})))))}}]),n}(h.Component);Io.propTypes={placeholder:y.a.string,textEntity:y.a.object,maxLength:y.a.number,onFocus:y.a.func,onBlur:y.a.func,editorEventHandlers:y.a.object,requireDisplayName:y.a.bool,displayName:y.a.string,displayNamePlaceHolder:y.a.string},Io.defaultProps={placeholder:"Compose an epic...",textEntity:Object(X.createTextEntityObject)(),maxLength:0,onFocus:function(){},onBlur:function(){},editorEventHandlers:{}};var xo=n(93);var To=function(e){var t,n=document.querySelector(e);return n&&(t=n.getAttribute("src")),t};function No(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Do(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?No(Object(n),!0).forEach((function(t){Oe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):No(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Lo=g.a.lazy((function(){return n.e(82).then(n.t.bind(null,890,7))})),Uo=function(e){c()(a,e);var t,n=jo(a);function a(e){var t;return o()(this,a),(t=n.call(this,e)).isLoginOccurred=!1,t.addStarsRating=function(e){t.setState(Do(Do({},t.state),{},{hasStarsRating:e>0}))},t.onStarsRatingClick=function(e){t.props.onStarsRatingClick(e),t.addStarsRating(e)},t.moderateRT=function(){Object(ka.d)()&&t.props.onRealtimeModeration({entities:t.state.entities,starsRating:t.state.starsRating})},t.onChange=function(e){var n=e.entities,a=e.displayName,o=e.starsRating,r=e.isEmpty,s=e.length,i=e.postId,c=e.lastChar,l=t.state.shouldSendTypingEvent;t.setState({entities:null!=n?n:t.state.entities,displayName:null!=a?a:t.state.displayName,starsRating:null!=o?o:t.state.starsRating,hasText:!r&&"boolean"==typeof r||"boolean"!=typeof r&&t.state.hasText,length:null!=s?s:t.state.length}),l&&t.setState({shouldSendTypingEvent:!1},(function(){var e={type:"typing",post_id:i};Object(xo.analyticsTrack)(e)})),t.props.onChange({isEmpty:r}),t.props.onTyping(c),null!=a&&t.onDisplayNameChange(a),r||t.debouncedRTMessage()},t.handleBlur=Z()(J.a.mark((function e(){var n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.createMessagePayload(),t.props.onBlur({draftMessage:n});case 2:case"end":return e.stop()}}),e)}))),t.getInsertedKeyCode=function(e){var t;return(null===(t=(e.ops||[]).find((function(e){return e.insert})))||void 0===t?void 0:t.insert.charCodeAt(0))||-1},t.loadEditor=function(){t.setState({showEditor:!0})},t.setFocus=function(){t.state.ready||t.setState({ready:!0}),t.handleFocus()},t.handleFocus=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.focusOnDisplayName;t.setState({focusOnDisplayName:n}),t.callOnFocus(),t.setState({showToolTip:!1})},t.hasMediaEntity=function(){return!!t.state.mediaEntity},t.handleLogin=Z()(J.a.mark((function e(){var n;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.createMessagePayload(),t.isLoginOccurred=!0,t.props.login(n);case 3:case"end":return e.stop()}}),e)}))),t.createMessage=Z()(J.a.mark((function e(){var n,a,o;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.props.createMessage,a=t.state.mediaEntity,o=t.createMessagePayload(),t.setState({shouldSendTypingEvent:!0}),n(o).then((function(e){var n=e.payload.isMessageBlockedVerdict;!e.error&&n?t.setState({hasText:!0,mediaEntity:a}):(t.setState(t.getResetState()),t.ref.current.reset()),t.handleBlur()})),t.props.onChange&&t.props.onChange({isEmpty:!0}),t.props.onPost&&t.props.onPost();case 7:case"end":return e.stop()}}),e)}))),t.editMessage=Z()(J.a.mark((function e(){var n,a;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props.editMessage,e.next=3,t.createMessagePayload();case 3:a=e.sent,t.setState(t.getResetState()),n(a);case 6:case"end":return e.stop()}}),e)}))),t.createMessagePayload=function(){var e=t.props,n=e.starsRating,a=e.enableStarsRating,o=e.isLoggedIn,r=e.currentUser,s=e.requireDisplayName,i=t.state.entities,c=r.displayName,l={entities:i};return s&&!o&&(l.displayName=c),a&&(l.starsRating=n),l},t.onDisplayNameChange=function(e){var n=t.props.onUsernameChange;null==n||n(e)},t.closeRichEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=t.props,a=n.closeEditRichEditor,o=n.messageToEdit,r=n.isEditRichEditor;r?a({messageId:null==o?void 0:o.id}):e&&t.ref.current.reset()},t.isExpanded=function(){var e,n;return t.props.isExpanded||t.state.showStickyRTE||t.isSubmitting()||0===(null===(e=t.props.messageToEdit)||void 0===e||null===(n=e.id)||void 0===n?void 0:n.indexOf("sp_"))},t.isSubmitting=function(){var e=t.props,n=e.isRootMessage,a=e.isSubmittingComment,o=e.isSubmittingReply,r=e.isSubmittingEdit;return n&&a||!n&&o||!n&&r},t.handleSubmit=function(){var e=t.props.isEdit;t.props.requireDisplayName&&!t.props.currentUser.displayName||(e?t.editMessage():t.createMessage())},t.state=Do(Do({},t.getResetState()),{},{showTooltip:!1,ready:!1,shouldSendTypingEvent:!0,showStickyRTE:!1}),t.simpleEditorTextEntity=t.getDraftMessage()||e.messageToEdit,t.debouncedRTMessage=ro()(t.moderateRT,ka.a),t.ref=g.a.createRef(),t}return s()(a,[{key:"getResetState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.props,n=t.isExpanded,a=t.messageToEdit,o=t.currentUser;return{mediaEntity:void 0,hasText:!e&&Object(X.hasText)(a),isLoading:!1,isExpanded:n,length:0,displayName:Object(Pt.getDisplayName)(o),entities:[],starsRating:0,hasStarsRating:this.props.starsRating>0}}},{key:"getDraftMessage",value:function(){var e=this.props.draftKey;return Object(Oa.getDraftMessage)(e)}},{key:"UNSAFE_componentWillMount",value:function(){var e=Object(X.getMediaEntity)(this.props.messageToEdit);e&&this.setState({mediaEntity:e})}},{key:"componentDidMount",value:(t=Z()(J.a.mark((function e(){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,this.props.requestSetFocus)(this.setFocus),"object"==typeof window&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&this.loadEditor();case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"componentDidUpdate",value:function(e){this.isLoginOccurred&&!1===e.isLoggedIn&&!0===this.props.isLoggedIn&&(this.createMessage(),this.isLoginOccurred=!1);var t=this.props.currentUser;e.currentUser.id!==t.id&&(t.isRegistered||this.setState(this.getResetState(!0))),e.starsRating!==this.props.starsRating&&this.addStarsRating(this.props.starsRating)}},{key:"callOnFocus",value:function(){var e=this.props,t=e.isReply,n=e.autoFocus,a=this.state,o=a.showEditor,r=a.ready,s=this.shouldRenderRichEditor(o,n,r);(!s||s&&!this.isExpanded()||t&&!this.isExpanded())&&"function"==typeof this.props.onFocus&&this.props.onFocus({element:Object(R.findDOMNode)(this)})}},{key:"shouldRenderRichEditor",value:function(e,t,n){return e||t||n&&this.isExpanded()}},{key:"renderEditor",value:function(){var e=this,t=this.props,n=t.placeholderTextKey,a=t.placeholderReplyToName,o=t.autoFocus,r=t.isReply,s=t.t,i=t.preventScrollOnAutoFocus,c=t.requireDisplayName,l=t.animationRating,u=t.isUploadImageButtonVisible,d=t.currentUser,p=t.showErrorBorder,m=t.isUserSuspended,f=t.starsRating,v=t.enableStarsRating,y=t.draftKey,b=s(n,{displayName:a}),E=g.a.createElement(Io,{onViewed:this.loadEditor,displayNamePlaceHolder:s("richEditor.placeholder.displayName"),displayName:Object(Pt.getDisplayName)(d),requireDisplayName:c,maxLength:1500,placeholder:b,textEntity:this.simpleEditorTextEntity,onFocus:function(){e.setState({ready:!0}),e.handleFocus()},onBlur:this.handleBlur,editorEventHandlers:{"text-change":this.onChange,linkify:this.onLinkify}});return g.a.createElement(h.Suspense,{fallback:E},g.a.createElement(Lo,{isMobileDevice:Object(Ie.b)(),messageToEdit:this.props.messageToEdit,ref:this.ref,direction:this.props.direction,onChange:this.onChange,onBlur:this.handleBlur,onSubmit:this.handleSubmit,preventScrollOnOpen:i,requireDisplayName:c,currentUser:d,hasError:p,disabled:m,tabIndexType:"editor",isReply:r,isExpanded:this.isExpanded(),animationRating:l,isUploadImageButtonVisible:u,placeholderTextKey:b,displayNamePlaceHolder:s("richEditor.placeholder.displayName"),autoFocus:o,enableStarsRating:v,onFocus:function(){e.setState({ready:!0}),e.handleFocus()},starsRating:f,onStarsRatingClick:this.onStarsRatingClick,draftKey:y,maxLength:he.v,isLoadingMediaEntity:function(t){e.setState({isLoading:t})}}))}},{key:"render",value:function(){var e=this.props,t=e.isLoggedIn,n=e.uploadImage,a=e.disableSendButtonWithEmptyText,o=e.isMustRegisterToComment,r=e.sendButtonText,s=e.signupButtonText,i=e.currentUser,c=e.showCancelButton,l=e.showErrorBorder,u=e.moderationAlert,d=e.starsRatingAlert,p=e.isPostAnyway,m=e.isEdit,f=e.requireDisplayName,h=this.state,v=h.isLoading,y=h.mediaEntity,b=h.hasStarsRating,E=i.displayName;return g.a.createElement(g.a.Fragment,null,this.renderEditor(),this.isExpanded()&&g.a.createElement(Mo,{displayName:E,uploadImage:n,isMustRegisterToComment:o,isLoggedIn:t,onEdit:this.editMessage,onCancel:this.closeRichEditor,onCreate:this.createMessage,onLogin:this.handleLogin,isEdit:m,hasText:this.state.hasText,isLoading:v||this.isSubmitting(),sendButtonText:r,signupButtonText:s,disableSendButtonWithEmptyText:a,showCancelButton:c,hasMediaEntity:!!y,isPostAnyway:p,showErrorBorder:l,moderationAlert:u,starsRatingAlert:d,isDisplayNameRequired:f,hasStarsRating:b}))}}]),a}(h.Component);Uo.propTypes={spotId:y.a.string.isRequired,editMessage:y.a.func,createMessage:y.a.func.isRequired,direction:y.a.oneOf(["rtl","ltr"]).isRequired,onTyping:y.a.func,requireDisplayName:y.a.bool,onFocus:y.a.func,login:y.a.func,closeEditRichEditor:y.a.func,onBlur:y.a.func,cancel:y.a.func,isLoggedIn:y.a.bool,isMustRegisterToComment:y.a.bool,isExpanded:y.a.bool,hidePanel:y.a.bool,messageToEdit:y.a.object,replyToMessage:y.a.object,className:y.a.string,placeholderTextKey:y.a.string,starsRating:y.a.number,currentUser:y.a.object,sendButtonText:y.a.string,signupButtonText:y.a.string,findHashImageUrl:y.a.func,uploadImage:y.a.func,isUploadImageButtonVisible:y.a.bool,disableSendButtonWithEmptyText:y.a.bool,animationRating:y.a.oneOf(["y","g","pg","pg-13","none"]),blurOnFocusForGuestUser:y.a.bool,showCancelButton:y.a.bool,isEditRichEditor:y.a.bool,msnSocialLogin:y.a.func,openUserProfileModal:y.a.func,requestSetFocus:y.a.func,connectTypes:y.a.array.isRequired,isReply:y.a.bool,isRootMessage:y.a.bool,isSubmittingComment:y.a.bool,isSubmittingReply:y.a.bool,isSubmittingEdit:y.a.bool,t:y.a.func,moderationAlert:y.a.oneOfType([y.a.object,y.a.bool]),starsRatingAlert:y.a.oneOfType([y.a.object,y.a.bool]),showErrorBorder:y.a.bool,onRealtimeModeration:y.a.func,isPostAnyway:y.a.bool,postId:y.a.string,isEdit:y.a.bool,elementId:y.a.string,draftKey:y.a.string},Uo.defaultProps={placeholderTextKey:"richEditor.placeholder.hasMessages",messageToEdit:Object(X.createMessageObject)(),replyToMessage:Object(X.createMessageObject)(),isExpanded:!1,hidePanel:!1,cancel:function(){},editMessage:function(){},createMessage:function(){},closeEditRichEditor:function(){},direction:"ltr",onBlur:function(){},onFocus:function(){},onTyping:function(){},blurOnFocusForGuestUser:!1,openUserProfileModal:function(){},requestSetFocus:function(){},moderationAlert:null,starsRatingAlert:null,showErrorBorder:!1,onRealtimeModeration:function(){},isPostAnyway:!1,isEdit:!1};var Bo=f()(Object(M.connect)((function(e,t){var n,a,o=e.messageSayControls,r=e.moduleOptions,s=e.currentUser,i=e.ui,c=i.showStickyRichBar,l=i.showFloatingRichBar,u=e.moduleOptions,d=u.spotId,p=u.hashImageSelector,m=u.textsOverrides,f=u.postId,h=u.elementId,g=u.forceRegister,v=e.conversation,y=v.isSubmittingComment,b=v.isSubmittingReply,E=v.isSubmittingEdit,M=e.userSuspension.isUserSuspended,R=t.messageToEdit,S=t.replyToMessage,C=t.isEditRichEditor,O=Object(vn.b)({isRegistered:s.isRegistered,isForceRegister:g,userId:s.id}),k=o[C?R&&R.id:S&&S.id];return{isRendered:k&&k.isRendered,connectTypes:r.connectTypes,showStickyRichBar:c,showFloatingRichBar:l,spotId:d,sendButtonText:m.conversationSayControlSendButton,signupButtonText:m.conversationSayControlSignupButton,isSubmittingComment:y,isSubmittingReply:b,isSubmittingEdit:E,isUserSuspended:M,requireDisplayName:O,uploadImage:(a=Z()(J.a.mark((function e(t){var n,a,o,r;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ro.a.upload(t);case 2:return n=e.sent,a=n.public_id,o=n.height,r=n.width,e.abrupt("return",{publicId:a,height:o,width:r});case 7:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)}),findHashImageUrl:(n=Z()(J.a.mark((function e(t){var n,a,o,r;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.replace(/{HASH_ID}/g,t),e.next=3,To(n);case 3:return a=e.sent,o=Fe()(a,1),r=o[0],e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)}),postId:f,elementId:h}}),(function(e,t){return{openUserProfileModal:function(n){return e(t.openUserProfileModal({user:n}))},msnSocialLoginDispatcher:function(){return e(t.msnSocialLogin())},onUsernameChange:function(t){e(function(e){return function(t,n){var a=n().currentUser;So(t,a,e)}}(t))}}}),null,{forwardRef:!0}),Object(vt.a)(void 0,{withRef:!0}))(Uo);function Po(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ao(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Po(Object(n),!0).forEach((function(t){Oe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Po(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Fo=Object(h.lazy)((function(){return Promise.all([n.e(0),n.e(18),n.e(26)]).then(n.bind(null,903))})),Vo=function(e){c()(n,e);var t=_o(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).wrapperRef=void 0,e.getDraftKey=function(){var t=e.props,n=t.stackId,a=t.depth;return"conversation_".concat(n,"-depth-").concat(a)},e.handleFocus=function(t){var n=t.element,a=e.props,o=a.conversationId,r=a.stackId;e.props.onFocus({element:n,stackId:r}),e.props.tracking.trackEvent({type:"editor-reply-focus",ugc_post_id:o})},e.handleBlur=function(){var t=e.props.stackId;e.props.onBlur({stackId:t})},e.handleCloseEditSayControl=function(t){var n=t.messageId;e.props.closeEditSayControl({messageId:n})},e.handleUploadProfileImage=function(t){e.props.onProfileImageUpload({rawImage:t})},e.editMessage=function(t){var n=t.entities,a=t.displayName,o=t.starsRating,r=void 0===o?0:o,s=e.props,i=s.messageToEdit,c=s.editMessage,l=i.depth,u=i.status,d=i.starsRating;c({entities:n,oldEntities:i.entities,starsRating:r,oldStarsRating:d,depth:l,messageId:i.id,displayName:a,status:u})},e.createMessage=function(t){var n=t.entities,a=t.displayName,o=t.starsRating,r=void 0===o?0:o,s=e.props,i=s.replyToMessage,c=s.rootMessageId,l=s.replyToStackId,u=(s.conversationId,{entities:n,starsRating:r,rootMessageId:c});return a&&(u.displayName=a),l&&(u.replyToStackId=l),i&&(u.parentMessageId=i.id,u.replyToUserId=i.user.id,u.replyToUsername=i.user.username,u.replyToDisplayName=i.userDisplayName||i.user.displayName,u.depth=i.depth+1),Object(Oa.clearDraftMessage)(e.getDraftKey()),e.props.createMessage(u)},e.handleStarsRatingClick=function(t){var n=e.props.messageToEdit.id;e.props.onStarsRatingClick(t,n)},e.handleRichEditorContract=function(){e.props.onContract({messageId:e.props.replyToMessage.id})},e.onTyping=function(t){var n=e.props,a=n.isMessageBlocked,o=n.onTyping,r=n.closeModerationAlert,s=n.isModerationAlertVisible,i=n.isUserSuspended,c=n.currentUser,l=n.isAfterClickFeedback;!i&&a&&s&&ka.g(t)&&(r(),l&&e.props.tracking.trackEvent({item_type:"realtime-moderation",user_id:c.id,is_registered:c.isRegistered,type:"post-edited",target_type:"after-post"})),o()},e.onRealtimeModeration=function(t){var n=e.props,a=n.isMessageBlocked,o=n.onRealtimeModeration;a||o(t)},e.setWrapperRef=function(t){e.wrapperRef=t},e.handleClickOutside=function(t){var n=e.props.isModerationAlertVisible,a=null==t?void 0:t.composedPath();try{var o,r,s=a.some((function(e){var t;return null===(t=e.dataset)||void 0===t?void 0:t.spotimOverlay}));(null===(o=e.wrapperRef)||void 0===o?void 0:o.contains(a[1]))||s||(null===(r=e.state)||void 0===r?void 0:r.hasText)||n||e.handleRichEditorContract()}catch(e){}},e.onChange=function(t){var n=t.isEmpty;e.setState({hasText:!n})},e.handleUserProfileClick=function(){var t=e.props.currentUser;(t.isRegistered||t.displayName)&&e.props.onOpenUserProfileModal({user:t,mode:"main"})},e.shouldDisplayUsername=function(){var t=e.props,n=t.forceRegister,a=t.currentUser;return!n||a.isRegistered},e}return s()(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.isRendered,a=t.isEditRichEditor,o=t.replyToMessage,r=t.messageToEdit,s=t.onRendered,i=a?r.id:o.id;n||s(i),requestAnimationFrame((function(){return document.addEventListener("click",e.handleClickOutside)}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClickOutside)}},{key:"handleLogin",value:function(){var e=this.props,t=e.tracking,n=e.onLogin,a=e.postId;n();var o={item_type:"login",target_type:"commnet-sign-up",type:"login-clicked",post_id:a};t.trackEvent(o)}},{key:"render",value:function(){var e,t=this.props,n=(t.conversationId,t.currentUser),a=t.spotId,o=t.isUploadImageButtonVisible,r=t.className,s=t.animationRating,i=t.blurOnFocusForGuestUser,c=t.isStarsRatingEnabled,l=t.disableSendButtonWithEmptyText,u=t.forceRegister,d=t.placeholderTextKey,p=t.direction,m=t.messageToEdit,f=t.userImageSize,h=(t.onTyping,t.showButton),v=t.starsRating,y=t.enableRichToolbar,b=t.depth,E=t.isMobileDevice,M=t.useExpandButton,R=t.isEditRichEditor,S=t.placeholderReplyToName,C=t.replyToMessage,O=t.autoFocus,k=t.moderationAlert,w=t.isModerationAlertVisible,I=t.isModerationAlertRendered,x=t.isMessageBlocked,T=t.isUserSuspended,N=t.preventScrollOnAutoFocus,D=t.isDisableRichFormatting,j=t.onLogin;return g.a.createElement("div",{ref:this.setWrapperRef,className:r},this.shouldDisplayUsername()&&g.a.createElement(ao,{currentUser:n,handleUploadProfileImage:this.handleUploadProfileImage,handleUserProfileClick:this.handleUserProfileClick}),g.a.createElement(Bo,{isExpanded:this.props.isExpanded,isDisableRichFormatting:D,onChange:this.onChange,tabIndexType:"message-details",showButton:h,starsRating:v,spotId:a,useExpandButton:M,login:this.handleLogin.bind(this),onStarsRatingClick:this.handleStarsRatingClick,isLoggedIn:Object(ua.d)(n),isUploadImageButtonVisible:o,enableStarsRating:c&&0===b,isMustRegisterToComment:u,createMessage:this.createMessage,editMessage:this.editMessage,onTyping:this.onTyping,onFocus:this.handleFocus,onBlur:this.handleBlur,closeEditRichEditor:this.handleCloseEditSayControl,uploadProfileImage:this.handleUploadProfileImage,userImageSize:f,placeholderTextKey:d,placeholderReplyToName:S,direction:p,messageToEdit:m,currentUser:n,enableRichToolbar:y,isMobileDevice:E,animationRating:s,disableSendButtonWithEmptyText:l,blurOnFocusForGuestUser:i,isEditRichEditor:R,msnSocialLogin:j,replyToMessage:C,autoFocus:O,onContract:this.handleRichEditorContract,isReply:!0,moderationAlert:k,showErrorBorder:w&&I,isPostAnyway:x&&!T,onRealtimeModeration:this.onRealtimeModeration,isEdit:(null==m||null===(e=m.entities)||void 0===e?void 0:e.length)>0,preventScrollOnAutoFocus:N,draftKey:this.getDraftKey()}))}}]),n}(h.Component);Vo.defaultProps={isStarsRatingEnabled:!1,forceRegister:!1,isExpanded:!1,autoFocus:!1,onTyping:function(){},onFocus:function(){},onBlur:function(){},onLogin:function(){},onStarsRatingClick:function(){},createMessage:function(){},onRendered:function(){},editMessage:function(){},closeEditSayControl:function(){},placeholderTextKey:"richEditor.placeholder.hasMessages",userImageSize:"medium",showButton:!0,focusOnUpdate:!0,moderationAlert:null,isModerationAlertVisible:!1,isModerationAlertRendered:!1,isMessageBlocked:!1,preventScrollOnAutoFocus:!1};var Ko=f()(Object(M.connect)((function(e,t){var n,a=e.currentUser,o=e.moduleOptions,r=e.messageSayControls,s=e.userSuspension,i=o.spotId,c=o.enableSSO,l=o.animationRating,u=o.isConnectEnabled,d=o.isStarsRatingEnabled,p=o.forceRegister,m=o.direction,f=o.conversationRichToolbarEnabled,v=o.isMobile,y=o.disableSendButtonWithEmptyText,b=o.blurOnFocusForGuestUser,E=o.liveBlogRichToolbarEnabled,M=o.isConversationLiveBlog,R=o.postId,S=o.conversationId,C=t.messageToEdit,O=t.replyToMessage,w=t.isEditRichEditor,I=t.parentMessageId,x=r[w?C&&C.id:O&&O.id],T=null==x?void 0:x.isExpanded,N=null==x?void 0:x.isRendered,D=r.settings.isModerationAlertRendered,j=s.isUserSuspended,L=k.a.get("isConversationPageTriggered",!1),U=A.m(e,a.id),B=E&&M&&U,P=M?!he.i:!he.h,_=x||{},F=_.isModerationAlertVisible,V=_.verdict,K=_.moderationTags,H=_.isMessageBlocked,q=_.tempMessageId,W=F&&g.a.createElement(h.Suspense,{fallback:null},g.a.createElement(Fo,{verdict:V,moderationTags:K,isRealtimeFeedback:!H,sayControlSessionId:q})),z=k.a.get("tenant_config.conversation.forceSimpleEditor",!1),G=I&&(null===(n=r[I])||void 0===n?void 0:n.isMessageBlocked);return{conversationId:S,currentUser:a,spotId:i,isUploadImageButtonVisible:P,isStarsRatingEnabled:d,forceRegister:p,direction:m,disableSendButtonWithEmptyText:y,blurOnFocusForGuestUser:b,isMobileDevice:Ie.a||v,animationRating:l,showButton:u&&!c,enableRichToolbar:!Ie.a&&!v&&(f||B),enableSSO:c,isRendered:N,moderationAlert:W,isModerationAlertVisible:F,isModerationAlertRendered:D,isMessageBlocked:H,isUserSuspended:j,isExpanded:T,preventScrollOnAutoFocus:L,postId:R,isDisableRichFormatting:z,isAfterClickFeedback:G}}),(function(e,t){var n,a=t.isEditRichEditor,o=t.parentMessageId;return{onTyping:function(){a||e(_a(o))},onFocus:function(t){var n=t.element,r=t.stackId;a||e(_a(o)),e(Na({element:n,stackId:r,depth:1}))},onRendered:function(t){e(function(e){var t=e.messageId;return{type:ct.ib,payload:{messageId:t}}}({messageId:t}))},onBlur:function(t){var n=t.stackId;e(ja({stackId:n}))},onLogin:function(){e(Object(At.a)())},onStarsRatingClick:(n=Z()(J.a.mark((function t(n,a){return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e(za(n,a));case 1:case"end":return t.stop()}}),t)}))),function(e,t){return n.apply(this,arguments)}),closeEditSayControl:function(t){var n=t.messageId;e(function(e){var t=e.messageId;return{type:ct.n,payload:{messageId:t}}}({messageId:n}))},createMessage:function(t){return e(Object(Ze.a)(t))},editMessage:function(t){var n,a,o,r,s,i,c,l,u,d;e((a=(n=t).messageId,o=n.displayName,r=n.status,s=n.entities,i=n.oldEntities,c=n.starsRating,l=void 0===c?0:c,u=n.oldStarsRating,d=void 0===u?0:u,function(){var e=Z()(J.a.mark((function e(t,n){var c,u,p,m,f,h,g,v,y,b,E,M;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(kt.a.apm.start("edit_message"),c=n(),u=c.conversation,p=c.moduleOptions,m=p.enableBlindfold,f=p.postId,h=c.currentUser,g=s.filter((function(e){return"text"!==e.type||"text"===e.type&&""!==e.text})),v=u.starsRatingCount,y=u.averageStarsRating,l>0?(y=(y*v-d+l)/v,0===d&&(v+=1)):d>0&&0===l&&(y=(y*(v-=1)-d)/v),t({type:ct.v,payload:{message:{id:a,userDisplayName:o,isEdited:!0,entities:g,starsRating:l,oldStarsRating:d},conversation:{starsRatingCount:v,averageStarsRating:y}}}),e.prev=6,m&&(r===Fa.d||r===Fa.b)){e.next=17;break}return b={starsRating:l},h.isRegistered||(b=qa(qa({},b),{},{displayName:o})),e.next=13,aa.g({messageId:a,entities:g,displayName:Object(Pt.getDisplayName)(h),postId:f,starsRating:l});case 13:E=e.sent,M=Wa(E.body),Object.assign(M.message,{id:a,status:r}),t({type:ct.u,payload:qa({},M)});case 17:kt.a.apm.end("edit_message"),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(6),t({type:ct.u,payload:{error:e.t0,message:{id:a,isEdited:!1,entities:i,starsRating:d}},error:!0}),kt.a.error("editMessage",e.t0);case 24:case"end":return e.stop()}}),e,null,[[6,20]])})));return function(t,n){return e.apply(this,arguments)}}()))},onProfileImageUpload:function(t){var n=t.rawImage;e(Object(ua.e)({rawImage:n}))},onContract:function(t){var n=t.messageId;e(function(e){var t=e.messageId;return{type:ct.p,payload:{messageId:t}}}({messageId:n}))},onOpenUserProfileModal:function(t){var n=t.user,a=t.overrideDisplayName,o=t.overrideImageId,r=t.mode;e(Object(Ft.a)({user:n,overrideDisplayName:a,overrideImageId:o,mode:r}))},closeModerationAlert:function(){return e(Ga(o))},onRealtimeModeration:function(t){e(Ya(Ao(Ao({},t),{},{parentMessageId:o})))}}})),C()({}))(Vo),Ho=n(764),qo=n.n(Ho);function Wo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var zo=function(e){c()(n,e);var t=Wo(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"shouldComponentUpdate",value:function(e){return e.typingUsers.length!==this.props.typingUsers.length}},{key:"render",value:function(){var e=this.props,t=e.messageStack,n=e.typingUsers,a=e.repliesMaxDepth,o=e.typingUsersCount,r=e.spotId,s=Math.min(t.message.depth,a),i=E()(qo.a.typingUsers,qo.a["depth-".concat(s)]);return g.a.createElement(ve,{className:i,users:n,typingUsersCount:o,size:"small",spotId:r})}}]),n}(h.Component);zo.propTypes={messageStack:y.a.object.isRequired,typingUsers:y.a.arrayOf(y.a.object).isRequired,repliesMaxDepth:y.a.number,spotId:y.a.string};var Go=Object(M.connect)((function(e,t){var n=t.messageStack,a=Se.d(n).id,o=e.moduleOptions.spotId;return{repliesMaxDepth:e.moduleOptions.repliesMaxDepth,typingUsers:Object(se.c)(e,a),typingUsersCount:Object(se.d)(e,a),spotId:o}}))(zo),Qo=n(253),Jo=n(159),Yo=n(423),Zo=n(424),Xo=n(767),$o=n.n(Xo);function er(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var tr=function(e){c()(n,e);var t=er(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={isLoading:!1},e.showPreviousReplies=function(){var t=e.props,n=t.messageStack,a=t.onShowPreviousReplies;e.setState({isLoading:!0}),a(n)},e}return s()(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(){this.state.isLoading&&this.setState({isLoading:!1})}},{key:"render",value:function(){var e=this.props,t=e.messageStack,n=e.moreCount,a=e.repliesMaxDepth,o=this.state.isLoading;return n>0&&t.hasNext&&t.childrenStackIds.length>0?g.a.createElement("div",{className:E()($o.a.showPreviousReplies,$o.a["depth-".concat(Math.min(t.message.depth,a))],{[$o.a.loading]:o})},g.a.createElement(Yo.a,{className:$o.a.link,onClick:this.showPreviousReplies},g.a.createElement("span",{className:$o.a.showMoreRepliesText},g.a.createElement(te.a,{i18nKey:"inpage.conversation.showPreviousMessages",count:n,values:{messagesCount:n}})),g.a.createElement(x.a,{selector:"chevronDownIcon",className:$o.a.chevron})),o&&g.a.createElement(Zo.a,null)):null}}]),n}(h.Component);tr.defaultProps={moreCount:0,onShowPreviousReplies:function(){}};var nr=Object(M.connect)((function(e,t){var n=t.messageStack,a=e.comments,o=e.moduleOptions.repliesMaxDepth;return{moreCount:Object(Qo.d)(a,n),repliesMaxDepth:o}}),{onShowPreviousReplies:Jo.b})(tr),ar=n(102),or=n(425);function rr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var sr=function(e){c()(a,e);var t=rr(a);function a(e){var r;return o()(this,a),(r=t.call(this,e)).getShowMoreRepliesComponent=function(){return n(425).default},r.showMoreReplies=function(){var e=r.props,t=e.tracking,n=e.messageStack,a=e.postId,o=e.onShowMoreReplies,s=n.message.id,i={message_id:s,type:"load-more-replies-clicked",post_id:a};t.trackEvent(i),o(s),Object(P.dispatchSpotimEvent)(B.b,s)},r.ShowMoreReplies=r.getShowMoreRepliesComponent(),r}return s()(a,[{key:"componentDidUpdate",value:function(e){e.isLoading&&!this.props.isLoading&&this.props.onDoneLoading()}},{key:"render",value:function(){return g.a.createElement(or.default,we()({showMoreReplies:this.showMoreReplies},this.props))}}]),a}(h.Component);sr.propTypes={messageStack:y.a.object.isRequired,onShowMoreReplies:y.a.func,isLoading:y.a.bool,moreCount:y.a.number,isLastMessageInThread:y.a.bool,enableShowMore:y.a.bool,allCount:y.a.number,forceMessagesCollapsed:y.a.bool,onDoneLoading:y.a.func,numNewComments:y.a.number,numCollapsedChildren:y.a.number,onClick:y.a.func,depth:y.a.number},sr.defaultProps={onShowMoreReplies:function(){},onDoneLoading:function(){},enableShowMore:!0};var ir=f()(Object(M.connect)((function(e,t){var n=t.messageStack,a=t.isLastMessageInThread,o=t.numCollapsedChildren,r=Se.d(n),s=e.loadingReplies,i=!A.j(e),c=e.moduleOptions,l=c.spotId,u=c.postId;return{isLoading:!o&&s.isLoading&&s.rootMessageId===r.id,isLastMessageInThread:a,enableShowMore:i,moreCount:Object(Qo.d)(e.comments,n),allCount:Object(Qo.b)(e.comments,n),spotId:l,postId:u}}),{onShowMoreReplies:ar.d}),C()({}))(sr);function cr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var lr=Object(h.lazy)((function(){return Promise.all([n.e(0),n.e(25),n.e(57)]).then(n.bind(null,901))})),ur=function(e){c()(n,e);var t=cr(n);function n(e){return o()(this,n),t.call(this,e)}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.isLegacyEnabled,n=e.repliesMaxDepth,a=e.message,o=e.isConnectEnabled,r=e.enableSSO,s=e.disableSignupWizard,i=o&&!r&&!s,c=t&&k.a.get("tenant_config.conversation.signup_cta_enabled",!0),l=null;return i&&c&&(l=g.a.createElement(h.Suspense,{fallback:null},g.a.createElement(lr,{depth:Math.min(a.depth,n),isExpanded:!1,username:a.userDisplayName,message:a}))),l}}]),n}(h.Component);ur.displayName="PostMessageAction",ur.propTypes={message:y.a.object.isRequired,isLegacyEnabled:y.a.bool,repliesMaxDepth:y.a.number,spotId:y.a.string,enableSSO:y.a.bool,isConnectEnabled:y.a.bool,disableSignupWizard:y.a.bool.isRequired},ur.defaultProps={isEnabled:!0,repliesMaxDepth:Number.MAX_VALUE};var dr=Object(M.connect)((function(e){var t=e.moduleOptions;return{spotId:t.spotId,isConnectEnabled:t.isConnectEnabled,enableSSO:t.enableSSO,disableSignupWizard:t.disableSignupWizard}}))(ur);var pr=n(769),mr=n.n(pr),fr=n(96),hr=n.n(fr);function gr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var vr=k.a.get("isConversationPageTriggered",!1),yr=function(e){c()(n,e);var t=gr(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).showPostCommentAction=!1,e}return s()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.stack,n=e.highlightMessage,a=e.shouldHighlightImmediate;e.t;a&&n(t.message.id)}},{key:"render",value:function(){var e,t=this.props,n=t.stack,a=t.className,o=t.starsRating,r=t.enterAnimationDisabled,s=t.messageIndex,i=t.repliesMaxDepth,c=t.isEdit,l=t.showReplySayControl,u=t.isTheFirstMessage,d=t.isLastMessageInThread,p=t.isPostCommentActionEnabled;if(l&&(e=hr()(n,"message.userDisplayName")||hr()(n,"message.user.displayName")||hr()(n,"message.user.username")),n.isAggregated)return null;var m=E()(mr.a.messageStack,a),f=n.message;return f.isCollapsed?null:g.a.createElement("div",{className:m},!c&&g.a.createElement(Ca,{message:f,enterAnimationDisabled:r,messageIndex:s,isTheFirstMessage:u}),c&&g.a.createElement(Ko,{autoFocus:!0,stackId:n.id,className:E()(mr.a.replyWrapper,mr.a["depth-".concat(Math.min(f.depth,i)-1)]),rootMessageId:f.rootMessageId||f.id,messageToEdit:f,parentMessageId:f.parentMessageId,userImageSize:"medium",isCollapsed:!0,depth:f.depth,starsRating:o,isEditRichEditor:!0}),g.a.createElement(dr,{message:f,repliesMaxDepth:i,isLegacyEnabled:p&&f.isMine}),l&&g.a.createElement(Ko,{starsRating:o,autoFocus:!0,focusOnUpdate:!1,stackId:n.id,className:E()(mr.a.replyWrapper,mr.a["depth-".concat(Math.min(f.depth,i-1))]),rootMessageId:f.rootMessageId||f.id,replyToStackId:n.id,replyToMessage:f,parentMessageId:f.id,userImageSize:"medium",depth:f.depth+1,isEditRichEditor:!1,placeholderTextKey:"richEditor.placeholder.replyTo",placeholderReplyToName:e}),g.a.createElement(Go,{messageStack:n}),g.a.createElement(nr,{messageStack:n}),g.a.createElement(ir,{depth:f.depth,isLastMessageInThread:d,messageStack:n}))}}]),n}(h.Component);yr.defaultProps={isEdit:!1,starsRating:-1,messageIndex:-1,shouldHighlightImmediate:!1,isMobileDevice:!1,showReplySayControl:!0,highlightMessage:function(){},isTheFirstMessage:!1,onDoneLoadingReplies:function(){},shouldCollapseReplies:!1};var br=f()(Object(M.connect)((function(e,t){var n=e.moduleOptions,a=e.messageSayControls,o=e.comments,r=e.conversation,s=r.isSubmittingReply,i=r.submittedReplyParentMessageId,c=r.isSubmittingEdit,l=r.editedMessageId,u=t.stack,d=n.direction,p=n.repliesMaxDepth,m=n.highlightedCommentId,f=n.highlightedReplyId,h=n.highlightImmediate,g=n.isMobile,v=n.shouldCollapseReplies,y=u.message.id,b=o.isPostCommentActionEnabled,E=(y===m||y===f)&&h,M=a[y],R=A.l(e)||g,S=A.o(e,u.id),C=A.j(e),O=0===u.message.depth,k=!!(null==M?void 0:M.isEdit)||c&&l===y;return{showReplySayControl:!!(s&&i===y||M&&M.isCreate&&(!C||!O)),starsRating:M&&M.starsRating,isEdit:k,direction:d,repliesMaxDepth:p,isPostCommentActionEnabled:b,messageSayControl:M,enterAnimationDisabled:S,isMobileDevice:R,shouldHighlightImmediate:E,shouldCollapseReplies:v}}),(function(e){return{expandChildren:function(t){e(function(e){return{type:ct.w,payload:e}}(t))},highlightMessage(t){ba((function(){e(la(t,vr))}))}}})),Object(vt.a)())(yr),Er=n(770),Mr=n.n(Er);function Rr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Sr=function(e){c()(n,e);var t=Rr(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"createDateAriaLableText",value:function(e,t){var n=new Date(1e3*t),a=["January","February","March","April","May","June","July","August","September","October","November","December"][n.getMonth()],o=n.getDate();return"".concat(e," commented ").concat(a," ").concat(o)}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.root,a=e.children,o=e.messageIndex,r=e.showReplySayControl,s=e.useExpandButton,i=e.repliesMaxDepth,c=e.isTheFirstMessage,l=e.isLastMessage,u=e.lastMessageId,d=e.shouldCollapseReplies,p=e.isEdit,m=e.isLiveBlog,f=n.message.user,h=E()(Mr.a.rootMessage,t,{[Mr.a.isLastMessage]:l,[Mr.a.isEdit]:p,[Mr.a.isLiveBlog]:m}),v=E()(h,{[Mr.a.isLiveBlogNoUserImage]:he.l&&m,[Mr.a.isLastMessageNoUserImage]:he.l&&this.props.isLastMessage}),y=E()(Mr.a.childrenList,{[Mr.a.empty]:0===a.length}),b=Se.d(n),M=this.createDateAriaLableText(f.username,n.message.postedAt);return g.a.createElement("article",{className:v},g.a.createElement(br,{isTheFirstMessage:c,stack:n,messageIndex:o,"aria-labelledby":"comment-description-".concat(o),"aria-describedby":"comment-content-".concat(o),isLastMessageInThread:n.message.id===this.props.lastMessageId}),g.a.createElement("a",{className:Mr.a.accessibilityLabel,id:"comment-description-".concat(o),"aria-label":M}),g.a.createElement("ul",{className:y},a.map((function(e){return e.message.isNew&&d&&(e.isLastMessage=!1),g.a.createElement("li",{key:"message-stack-".concat(e.id),"aria-label":"Comment reply",role:"article"},g.a.createElement(br,{stack:e,messageIndex:o,isLastMessageInThread:e.message.id===u}))}))),r&&g.a.createElement(Ko,{autoFocus:!s,useExpandButton:s,stackId:n.id,className:Mr.a["depth-".concat(Math.min(b.depth,i-1))],rootMessageId:b.rootMessageId||b.id,replyToStackId:n.id,replyToMessage:b,parentMessageId:b.id,userImageSize:"normal",depth:b.depth+1}))}}]),n}(h.Component);Sr.defaultProps={children:[],showReplySayControl:!1,useExpandButton:!1,repliesMaxDepth:2,shouldCollapseReplies:!1};var Cr=Object(M.connect)((function(e,t){var n=e.messageSayControls,a=e.moduleOptions,o=e.comments,r=e.conversation,s=r.isSubmittingEdit,i=r.editedMessageId,c=t.root,l=a.repliesMaxDepth,u=a.pageSize,d=a.spotId,p=a.testOption,m=a.shouldCollapseReplies,f=c.message.id,h=n[f],g=!!(null==h?void 0:h.isEdit)||s&&i===f,v=!(h&&h.isCreate),y=A.j(e),b=I.f(o.list,c);return{spotId:d,showReplySayControl:!1,useExpandButton:v,repliesMaxDepth:l,pageSize:u,testOption:p,shouldCollapseReplies:m,lastMessageId:b?b.message.id:f,stackList:o.list,isEdit:g,isLiveBlog:y}}))(Sr),Or=n(410);function kr(e,t){return new Promise(function(){var n=Z()(J.a.mark((function n(a){var o,r;return J.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(wt.a)("v1.0.0/conversation/featured-message/".concat(e),{postId:Object(Ba.a)(e),method:"POST",data:{sortBy:t}});case 2:if((o=n.sent)&&o.messages){n.next=6;break}return a(null),n.abrupt("return");case 6:r=o.messages[0].user_id,o.messages[0].users[r]=o.users[r],o.messages[0].featuredComment="top",a(o.messages[0]);case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}var wr,Ir=n(446),xr=n(176);!function(e){e.CONSTANT="CONSTANT",e.NONE="NONE"}(wr||(wr={}));var Tr=k.a.get("tenant_config.conversation.ads_enabled",!1),Nr=k.a.get("tenant_config.conversation.adsPositionRate",7),Dr=k.a.get("tenant_config.conversation.ads_start_position",7),jr=n(104),Lr=n(773),Ur=n.n(Lr);function Br(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Pr=function(e){c()(a,e);var t,n=Br(a);function a(){var e;o()(this,a);for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return(e=n.call.apply(n,[this].concat(r))).state={shouldFetchFeaturedComment:!1,hasFeaturedComment:!1,adsHidden:e.props.isLiveBlog||!1},e.onHideAd=function(){e.setState({adsHidden:!0})},e}return s()(a,[{key:"componentDidMount",value:function(){kt.a.apm.end("critical_flow"),this.prepareFeaturedComment()}},{key:"prepareFeaturedComment",value:(t=Z()(J.a.mark((function e(){var t,n,a,o,r,s,i,c;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.conversationID,a=t.addMessage,o=t.updateMessageToBeFeatured,r=t.messages,s=t.updateShouldFetchFeaturedComment,i=t.sortBy,s(),e.next=4,kr(n,i);case 4:(c=e.sent)&&(r[c.id]?o(c):a(c),this.setState({hasFeaturedComment:!0}));case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"componentDidUpdate",value:function(){this.props.shouldFetchFeaturedComment&&this.prepareFeaturedComment()}},{key:"generateV2AdsSeparator",value:function(e){return e?g.a.createElement("div",{className:Ur.a.separator}):g.a.createElement("div",{className:Ur.a.adsSeparator},g.a.createElement(w.Typography,{className:Ur.a.adsSeparatorText,type:"infoMd"},g.a.createElement(te.a,{i18nKey:"ads.separator"},"The conversation continues below the ad")))}},{key:"render",value:function(){var e,t=this,n=this.props,a=n.className,o=n.stackList,r=n.commentsCount,s=n.showTopActivityBar,i=n.onShowMore,c=n.hasNextComments,l=n.isLiveBlog,u=n.messageSayControls,d=n.isSubmittingEdit,p=n.editedMessageId,m=this.state.adsHidden,f=[];if(s&&(e=g.a.createElement(Re,{key:"1"})),I.a(o)>0){var h=-1;r>-1&&(h=r);var v=I.e(o),y=I.g(o);if(s){if(v){var b=v,M=b.length,R=b.filter((function(e){return 0===e.message.depth})).length;e=g.a.createElement(Re,{key:"2",messagesCount:M}),h-=R}}else{var S=v,C=S.length,O=S.filter((function(e){return 0===e.message.depth})).length;f.push(g.a.createElement(oe,{key:S[0].id,messagesCount:C,onClick:i})),h-=O}if(y){var k=function(e){var t=e.stackLength;if((Tr?wr.CONSTANT:wr.NONE)===wr.NONE)return[];var n=Object(xr.a)(),a=n<=Dr?n:Dr<=Nr?Dr:Nr,o=Math.floor((t-a)/Nr),r=o>0?o:0,s=Qt()(Array(r)).map((function(e,t){return a+(t+1)*(Nr+1)}));return[a].concat(Qt()(s))}({stackLength:y.length}),w=y.filter((function(e){return e.message.status!==X.statuses.REPORTED&&!e.isAggregated&&!e.message.isCollapsed})).filter((function(e){return!Object(jr.a)(e.message)}));w.forEach((function(e,n){var a;n>0&&(a=y[n-1]);var r=E()({[Ur.a.topMessage]:0===n}),s=n===w.length-1,i=e.message.id,v=u[i],b=!!(null==v?void 0:v.isEdit)||d&&p===i,M=g.a.createElement(Cr,{root:e,children:I.h(o,e),messageIndex:h,className:r,previousRoot:a,isTheFirstMessage:0===n,isLastMessage:s}),R=!m&&(null==k?void 0:k.some((function(e,t){return e-t-1===f.length}))),S=!m&&!c&&f.length<=k[k.length-1]&&s,C=S||R&&Ir.b,O=E()(Ur.a.listItem,{[Ur.a.isLastMessage]:s&&!R,[Ur.a.isEdit]:b,[Ur.a.isLiveBlog]:l,[Ur.a.hideSeparator]:C||l});f.push(g.a.createElement("li",{key:"message-stack-".concat(e.id),className:O,"aria-label":"Comment"},g.a.createElement("div",{className:Ur.a.safariPadder}),M,C&&t.generateV2AdsSeparator(S)))})),m||l||k.forEach((function(e){f.splice(e,0,g.a.createElement(Ir.a,{key:e,index:e,onHideAd:t.onHideAd}))}))}}return g.a.createElement("ul",{className:E()([Ur.a.messagesList,a,{[Ur.a.theEarliestMessages]:!c,[Ur.a.isLiveBlog]:l}]),"data-spot-im-class":"messages-list",role:"feed","aria-label":"List of Comments"},e,f)}}]),a}(h.Component);Pr.defaultProps={commentsCount:-1,showTopActivityBar:!0,onShowMore:function(){}};var Ar=f()(Object(M.connect)((function(e){return{postId:e.conversation.postId,conversationID:e.conversation.id,messages:e.comments.list.messages,shouldFetchFeaturedComment:e.conversation.shouldFetchFeaturedComment,sortBy:e.comments.pagination.sortBy,isMobile:e.isMobile.isMobile,isLiveBlog:A.j(e),messageSayControls:e.messageSayControls,isSubmittingEdit:e.conversation.isSubmittingEdit,editedMessageId:e.conversation.editedMessageId}}),(function(e){return{onShowMore:re.b,addMessage:function(t){return e(Object(Or.a)(t))},updateMessageToBeFeatured:function(t){return e((n=t,function(e){e({type:ct.Bb,payload:n})}));var n},updateShouldFetchFeaturedComment:function(){return e(Object(da.d)(!1))}}}),null,{forwardRef:!0}),C()({},{forwardRef:!0}))(Pr),_r=n(257),Fr=n(426),Vr=n.n(Fr);function Kr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Hr=Object(h.lazy)((function(){return Promise.all([n.e(0),n.e(18),n.e(26)]).then(n.bind(null,903))})),qr=Object(h.lazy)((function(){return Promise.all([n.e(0),n.e(90)]).then(n.bind(null,891))})),Wr=k.a.get("isConversationPageTriggered",!1),zr=k.a.get("tenant_config.conversation.forceSimpleEditor",!1),Gr=function(e){c()(n,e);var t=Kr(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).mainSayControl=g.a.createRef(),e.wrapperRef=void 0,e.getContentsMethod=function(){},e.setContentsMethod=function(e){},e.setFocusMethod=function(){},e.hanldeSetFocus=function(t){var n=e.props,a=n.postId,o=n.instanceId;if(t.data&&"object"==typeof t.data&&t.data.__SPOTIM_MESSAGE&&"set-main-say-control-focus"===t.data.type){var r=t.data.instanceId===o,s=t.data.postId===a;(!t.data.postId||!!t.data.instanceId&&r||s)&&e.setFocus()}},e.setFocus=function(){var t,n;null===(t=e.mainSayControl)||void 0===t||null===(n=t.current)||void 0===n||n.setFocus()},e.handleUploadProfileImage=function(t){var n=e.props.currentUser;e.props.onProfileImageUpload({userId:n.id,rawImage:t})},e.createMessage=function(t){var n=t.entities,a=t.displayName,o=t.starsRating,r={entities:n,starsRating:void 0===o?0:o};return a&&(r.displayName=a),Object(Oa.clearDraftMessage)(e.getDraftKey()),e.props.createMessage(r)},e.handleLogin=function(){var t=e.props,n=t.tracking,a=t.postId;(0,t.onLogin)();var o={item_type:"login",target_type:"commnet-sign-up",type:"login-clicked",post_id:a};n.trackEvent(o)},e.requestGetContents=function(t){e.getContentsMethod=t},e.requestSetContents=function(t){e.setContentsMethod=t},e.requestSetFocus=function(t){e.setFocusMethod=t},e.onTyping=function(t){var n=e.props,a=n.isMessageBlocked,o=n.isModerationAlertVisible,r=n.closeModerationAlert,s=n.isUserSuspended,i=n.currentUser;a&&!s&&o&&ka.g(t)&&(r(),e.props.tracking.trackEvent({item_type:"realtime-moderation",user_id:i.id,is_registered:i.isRegistered,type:"post-edited",target_type:"after-post"})),e.props.onTyping()},e.onRealtimeModeration=function(t){var n=e.props,a=n.isMessageBlocked,o=n.onRealtimeModeration;a||o(t)},e.setWrapperRef=function(t){e.wrapperRef=t},e.handleClickOutside=function(t){var n=e.props,a=n.isModerationAlertVisible,o=n.isExpanded,r=null==t?void 0:t.composedPath();try{var s,i,c=r.some((function(e){var t;return null===(t=e.dataset)||void 0===t?void 0:t.spotimOverlay})),l=r.some((function(e){var t;return null===(t=e.className)||void 0===t?void 0:t.toString().endsWith("stars-rating")}));(null===(s=e.wrapperRef)||void 0===s?void 0:s.contains(r[1]))||(null===(i=e.state)||void 0===i?void 0:i.hasText)||c||a||o&&l||e.props.onUnfocus()}catch(e){}},e.onChange=function(t){var n=t.isEmpty;e.setState({hasText:!n})},e.handleBlur=function(){e.props.onBlur()},e.handleFocus=function(t){var n=e.props.conversationId;e.props.onFocus(t),e.props.tracking.trackEvent({type:"editor-comment-focus",ugc_post_id:n})},e.getDraftKey=function(){var t=e.props.conversationId;return"conversation_".concat(t,"_main-say-ctrl")},e}return s()(n,[{key:"componentDidMount",value:function(){var e=this.props.autoFocus;_r.a.on("focusSayControl",this.setFocus),this.subscribeToSetFocusMessage(),e&&!Object(Ie.b)()&&this.setFocus(),document.addEventListener("click",this.handleClickOutside)}},{key:"subscribeToSetFocusMessage",value:function(){window.addEventListener("message",this.hanldeSetFocus)}},{key:"componentWillUnmount",value:function(){_r.a.off("focusSayControl",this.setFocus),window.removeEventListener("message",this.hanldeSetFocus),document.removeEventListener("click",this.handleClickOutside)}},{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.isStarsRatingEnabled,a=e.forceRegister,o=e.moderationAlert,r=e.isModerationAlertVisible,s=e.isModerationAlertRendered,i=e.isMessageBlocked,c=e.isUserSuspended,l=e.shouldAutoFocus,u=e.preventScrollOnAutoFocus,d=e.isDisableRichFormatting,p=e.isStarsRatingFailed,m=e.starsRatingAlert,f=e.isUploadImageButtonVisible;return g.a.createElement("div",{ref:this.setWrapperRef},g.a.createElement(Bo,we()({},this.props,{isUploadImageButtonVisible:f,ref:this.mainSayControl,onChange:this.onChange,onBlur:this.handleBlur.bind(this),onFocus:this.handleFocus,isDisableRichFormatting:d,tabIndexType:"editor",login:this.handleLogin,isLoggedIn:Object(ua.d)(t),createMessage:this.createMessage,uploadProfileImage:this.handleUploadProfileImage,isRichBarVisibleOnMount:!0,enableStarsRating:n,isMustRegisterToComment:a,openUserProfileModal:Ft.a,requestGetContents:this.requestGetContents,requestSetContents:this.requestSetContents,requestSetFocus:this.requestSetFocus,socialReviewsStyles:Vr.a,isRootMessage:!0,moderationAlert:o,starsRatingAlert:m,onTyping:this.onTyping,onRealtimeModeration:this.onRealtimeModeration,showErrorBorder:r&&s||p,isPostAnyway:i&&!c,isEdit:!1,autoFocus:l,preventScrollOnAutoFocus:u,draftKey:this.getDraftKey()})))}}]),n}(h.Component);Gr.defaultProps={isUploadImageButtonVisible:!1,isStarsRatingEnabled:!1,forceRegister:!1,isExpanded:!1,autoFocus:!1,onTyping:function(){},onFocus:function(){},onBlur:function(){},onLogin:function(){},onStarsRatingClick:function(){},createMessage:function(){},closeModerationAlert:function(){},onRealtimeModeration:function(){},placeholderTextKey:"richEditor.placeholder.hasMessages",userImageSize:"medium",moderationAlert:null,isModerationAlertVisible:!1,isModerationAlertRendered:!1,isMessageBlocked:!1,isUserSuspended:!1,shouldAutoFocus:!1,preventScrollOnAutoFocus:!1,isStarsRatingFailed:!1,starsRatingAlert:null};var Qr=f()(Object(M.connect)((function(e){var t=e.currentUser,n=e.moduleOptions,a=e.mainSayControl,o=e.conversation,r=e.userSuspension,s=e.communityView,i=n.enableSSO,c=n.editableSSO,l=n.isConnectEnabled,u=n.isStarsRatingEnabled,d=n.forceRegister,p=n.direction,m=n.conversationRichToolbarEnabled,f=n.isMobile,v=n.disableSendButtonWithEmptyText,y=n.animationRating,b=n.blurOnFocusForGuestUser,E=n.transliterationLanguage,M=n.liveBlogRichToolbarEnabled,R=n.isConversationLiveBlog,S=n.postId,C=n.conversationId,O=(n.highlightedCommentId,n.instanceId),k=n.focusMainSayCtrlOnMount,w=a.starsRating,I=a.isStarsRatingFailed,x=a.expanded,T=a.isMessageBlocked,N=a.isModerationAlertVisible,D=a.isModerationAlertRendered,j=a.moderationTags,L=a.verdict,U=a.tempMessageId,B=s.focusSayControlOnSwitchTab,P=r.isUserSuspended,_=o.hasCommented,F=A.m(e,t.id),V=M&&R&&F,K=R?!he.i:!he.h,H=N&&g.a.createElement(h.Suspense,{fallback:null},g.a.createElement(Hr,{moderationTags:j,verdict:L,isRealtimeFeedback:!T,sayControlSessionId:U})),q=I&&g.a.createElement(h.Suspense,{fallback:null},g.a.createElement(qr,null,g.a.createElement(te.a,{i18nKey:"general.failedConversation.title"},"Oops, something went wrong :("))),W=k||B;return{conversationId:C,currentUser:t,isUploadImageButtonVisible:K,starsRating:w,isStarsRatingEnabled:u,forceRegister:d,direction:p,isExpanded:x,disableSendButtonWithEmptyText:v,isMobileDevice:Object(Ie.b)()||f,blurOnFocusForGuestUser:b,showButton:l&&(!i||!!c),animationRating:y,enableRichToolbar:!Object(Ie.b)()&&!f&&(m||V),transliterationLanguage:E,enableSSO:i,editableSSO:c,hasCommented:_,moderationAlert:H,isModerationAlertVisible:N,isModerationAlertRendered:D,isMessageBlocked:T,isUserSuspended:P,shouldAutoFocus:W,preventScrollOnAutoFocus:Wr,postId:S,instanceId:O,isDisableRichFormatting:zr,isStarsRatingFailed:I,starsRatingAlert:q}}),(function(e){return{onTyping:function(){return e(_a())},onFocus:function(t){var n=t.element;e(_a()),e(Na({element:n,depth:0}))},onBlur:function(){e(ja())},onLogin:function(){e(Object(At.a)({mode:"signup"}))},onStarsRatingClick:(t=Z()(J.a.mark((function t(n){return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e(za(n));case 1:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)}),createMessage:function(t){var n=t.entities,a=t.displayName,o=t.starsRating;return e(Object(Ze.a)({entities:n,displayName:a,starsRating:o}))},onProfileImageUpload:function(t){var n=t.rawImage;e(Object(ua.e)({rawImage:n}))},closeModerationAlert:function(){e(Ga())},onRealtimeModeration:function(t){e(Ya(t))},onUnfocus:function(){e({type:ct.yb})}};var t})),C()({}))(Gr),Jr=n(198),Yr=n(95),Zr=n(449),Xr=n(349);function $r(e,t,n,a){return es.apply(this,arguments)}function es(){return(es=Z()(J.a.mark((function e(t,n,a,o){var r,s,i,c,l,u,d,p,m,f,h,g,v,y,b,E,M,R,S,C;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.href,s=o.canonicalHref,i=o.offset,c=void 0===i?0:i,l=o.commentsRead,u=void 0===l?0:l,d=o.pageSize,p=void 0===d?Pa.d:d,m=o.sortBy,f=void 0===m?Yr.a.BEST:m,h=o.highlight,g=o.depth,r=decodeURIComponent(r),r=Object(Xr.a)(r),s=decodeURIComponent(s),s=Object(Xr.a)(s),e.next=7,Jr.b(t,n,a,r,s,c,u,p,f,g);case 7:return v=e.sent,y=Object(Zr.a)(v.conversation),b=y.conversation,E=y.followersIds,M=y.pagination,R=y.comments,S=y.followers,C=Object(ot.b)(v.user),e.abrupt("return",{currentUser:C,conversation:b,followersIds:E,pagination:M,comments:R,followers:S,highlight:h});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ts=n(260);function ns(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function as(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ns(Object(n),!0).forEach((function(t){Oe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ns(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function os(e){var t=e.spotId,n=e.postId,a=e.conversationId,o=e.href,r=e.canonicalHref,s=e.offset,i=e.commentsRead,c=e.pageSize,l=e.sortBy,u=e.highlight,d=e.depth,p=e.isFromShowMore;return function(){var e=Z()(J.a.mark((function e(m,f){var h,g,v;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return kt.a.apm.start("fetch_conversation"),h=f(),g=h.conversation,Object(ts.b)(l),m({type:ct.y,payload:{isFromShowMore:p}}),e.next=6,$r(t,n,a,{href:o,canonicalHref:r,offset:s,commentsRead:i,pageSize:c,sortBy:l,highlight:u,depth:d}).catch((function(e){m({type:ct.x,payload:{error:e},error:!0}),kt.a.error("fetchConversation",e)}));case 6:v=e.sent,kt.a.apm.end("fetch_conversation"),m({type:ct.x,payload:as({currentConversation:g},v)}),m(Object(da.d)(!0));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}var rs=n(774),ss=n.n(rs);function is(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var cs={[Yr.a.BEST]:"inpage.conversation.sortMenu.best",[Yr.a.NEWEST]:"inpage.conversation.sortMenu.newest",[Yr.a.OLDEST]:"inpage.conversation.sortMenu.oldest",[Yr.a.SOCIAL]:"inpage.conversation.sortMenu.social"},ls=function(e){c()(n,e);var t=is(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={showMenu:!1},e.onSortChanged=function(t){if(e.props.sortBy!==t){var n=e.props,a=n.tracking,o=n.pageSize,r=n.conversation,s=n.href,i=n.canonicalHref,c=r.spotId,l=r.postId,u=r.id;kt.a.send("sort_by_clicked");var d={type:"sorting-menu-clicked",target_type:t,item_type:"sort-menu",post_id:l};a.trackEvent(d),e.props.onSortChange({spotId:c,postId:l,conversationId:u,href:s,canonicalHref:i,pageSize:o,sortBy:t}),e.hideMenu(),Object(P.dispatchSpotimEvent)(Dt.t,{sortedBy:t})}},e.handleSortByClick=function(t,n){13===t.keyCode&&e.onSortChanged(n)},e.toggleMenu=function(t){e.setState({showMenu:t}),Object(P.dispatchSpotimEvent)(Dt.s)},e.isChecked=function(t){return e.props.sortBy===t?"checked":""},e.handleSortMenuTitleGotFocus=function(){var e=document.querySelector('[class*="faces-list"]');if(e){var t=e.querySelectorAll('[class*="user-image"]');t[t.length-1].focus()}},e.getSortItem=function(t){var n=t.action,a=t.handler,o=t.label,r=t.sortKey,s=e.isChecked(r);return g.a.createElement(w.MenuItem,{"data-spmark":o,key:r,onClick:function(){return n(r,e.refs)},onKeyUp:a,className:E()(ss.a.menuItem,{[ss.a.selected]:s}),id:"spotim-sort-by-list"},g.a.createElement(te.a,{i18nKey:"".concat(cs[r])}),s&&g.a.createElement("span",{className:ss.a.iconWrapper},g.a.createElement(w.Icon,{name:"check",type:"fa-solid",className:ss.a.checkedIcon})))},e}return s()(n,[{key:"hideMenu",value:function(){this.setState({showMenu:!1})}},{key:"getSortItems",value:function(){var e=this,t=[this.getSortItem({action:this.onSortChanged,handler:function(t){return e.handleSortByClick(t,Yr.a.BEST)},label:Yr.a.BEST,sortKey:Yr.a.BEST}),this.getSortItem({action:this.onSortChanged,handler:function(t){return e.handleSortByClick(t,Yr.a.NEWEST)},label:Yr.a.NEWEST,sortKey:Yr.a.NEWEST}),this.getSortItem({action:this.onSortChanged,handler:function(t){return e.handleSortByClick(t,Yr.a.OLDEST)},label:Yr.a.OLDEST,sortKey:Yr.a.OLDEST})];return k.a.get("tenant_config.conversation.social_enable",!1)&&t.push(this.getSortItem({action:this.onSortChanged,handler:function(t){return e.handleSortByClick(t,Yr.a.SOCIAL)},label:Yr.a.SOCIAL,sortKey:Yr.a.SOCIAL})),t}},{key:"render",value:function(){var e=this.state.showMenu,t=this.props,n=t.isLiveBlog,a=t.sortBy,o=t.isLoading,r=t.direction,s=t.expanded;if(n)return null;var i=this.getSortItems(),c=k.a.get("init_data.config.ltr")?"bottom-start":"bottom-end",l=E()(ss.a.sortContainer,{[ss.a.isExpended]:s});return g.a.createElement("div",{className:l},g.a.createElement(w.Typography,{type:"infoMd",className:ss.a.sortText,onFocus:this.handleSortMenuTitleGotFocus},g.a.createElement(te.a,{i18nKey:"inpage.conversation.sortMenu.sortBy"}),"Â "),g.a.createElement(w.Menu,{isLtr:"ltr"===r,isMobile:Ie.a,showMenu:e,placement:c,trigger:"click",onShowChange:this.toggleMenu,mobileCancelButtonContent:g.a.createElement(te.a,{i18nKey:"Cancel"},"Cancel"),menuButton:g.a.createElement(w.Button,{className:E()(ss.a.sortBy),id:"spotim-sort-by"},g.a.createElement(pt.a,{weight:"bold",disableHover:!0,className:ss.a.sortByText},g.a.createElement(te.a,{i18nKey:"".concat(cs[a])})),o?g.a.createElement("div",{className:ss.a.spinnerWrapper},g.a.createElement(U.a,null)):g.a.createElement(x.a,{selector:"chevronDownIcon",className:ss.a.chevronIcon}))},i))}}]),n}(h.Component);ls.defaultProps={sortBy:Yr.a.BEST,pageSize:Pa.d,isLiveBlog:!1};var us=f()(Object(M.connect)((function(e){var t=e.moduleOptions,n=e.mainSayControl,a=t.href,o=t.canonicalHref,r=t.spotId,s=t.direction,i=A.j(e),c=n.expanded;return{href:a,canonicalHref:o,isLiveBlog:i,spotId:r,isLoading:e.comments.loading,direction:s,expanded:c}}),{onSortChange:os}),C()({}))(ls),ds=n(170),ps=n(160),ms=n(415);function fs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var hs=k.a.get("tenant_config.conversation.disable_conversation_user_settings"),gs=function(e){c()(n,e);var t=fs(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).onProfileClick=function(){var t=e.props,n=t.tracking,a=t.currentUser,o=t.onOpenUserProfileModal,r=t.postId,s=t.userId;o(a);var i={type:"my-profile-clicked",post_id:r},c={type:"user-profile-clicked",target_type:"my-profile-dropdown",item_type:"user_profile",target_id:s,post_id:r};n.trackEvent(i),n.trackEvent(c),e.props.onClose()},e.onSettingsClick=function(){var t=e.props,n=t.tracking,a=t.onOpenUserSettingsModal,o=t.currentUser,r=t.postId;a(o);var s={type:"edit-settings-clicked",post_id:r};n.trackEvent(s),Object(P.dispatchSpotimEvent)(Dt.g,o),e.props.onClose()},e.onLogoutClick=function(){e.props.onLogout(),e.props.onClose()},e.onPrivacyClick=function(){var t=e.props.currentUser;e.props.onOpenPrivacyModal(t),Object(P.dispatchSpotimEvent)(Dt.f,t)},e.setModerationToDefault=function(){e.props.setModerationDefaultPolicy("spot_policy"),e.props.onClose()},e.setModerationToStrict=function(){e.props.setModerationDefaultPolicy("require_approval"),e.props.onClose()},e.onCommunityQuestionClick=function(){var t=e.props,n=t.onCommunityQuestionModalStateChange,a=t.onClose;n(),a()},e.onHideConversationClick=function(){e.props.toggleHideConversation(),e.props.onClose()},e.getDropListItems=function(e){var t=e.profileItem,n=e.conversationHostOptions,a=e.settingsItem,o=e.showPrivacy,r=e.onPrivacyClick,s=e.disableUserProfileModal,i=[t].concat(Qt()(n),[a]);return s&&(i=Qt()(n)),o&&!hs&&i.push(g.a.createElement(w.MenuItem,{key:"privacy","data-spot-im-class":"privacy-item",onClick:r},g.a.createElement(D.a,{textKey:"general.privacy.short"},"Privacy"))),i},e.setIsReadOnly=Z()(J.a.mark((function t(){var n,a,o,r;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props,a=n.isReadOnly,o=n.setIsReadOnly,r=n.t,t.prev=1,t.next=4,o(!a);case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),e.context.addToast({onAction:function(){e.setIsReadOnly()},toastText:"".concat(r("readOnly.errorMessage","Couldn't save changes"),", "),mode:"error",closeButton:!0,actionText:r("general.tryAgain","try again")});case 9:case"end":return t.stop()}}),t,null,[[1,6]])}))),e}return s()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.isModerator,n=e.isAdmin,a=e.isSuperAdmin,o=e.isJournalist;(t||n||a||o)&&this.props.getModerationDefaultPolicy()}},{key:"conversationHostOptions",value:function(){var e=this.props,t=e.isModerator,n=e.showHideConversation,a=[];if(t&&n){var o=g.a.createElement(w.MenuItem,{key:"hide","data-spot-im-class":"hide-conversation-item",onClick:this.onHideConversationClick},g.a.createElement(D.a,{textKey:"userProfile.contextMenu.hide"}));a.push(o)}return a}},{key:"render",value:function(){var e=this.props,t=e.showLogout,n=e.conversationAuthorId,a=e.userId,o=e.isModerator,r=e.isAdmin,s=e.isSuperAdmin,i=e.isJournalist,c=e.enableCommunityQuestion,l=e.defaultPolicy,u=e.showPrivacy,d=e.isReadOnly,p=e.disableUserProfileModal,m=g.a.createElement(D.a,{textKey:"userProfile.contextMenu.profile"}),f=!he.m&&g.a.createElement(w.MenuItem,{key:"profile","data-spot-im-class":"profile-item",onClick:this.onProfileClick},m),h=!hs&&g.a.createElement(w.MenuItem,{key:"settings","data-spot-im-class":"settings-item",onClick:this.onSettingsClick},g.a.createElement(D.a,{textKey:"userProfile.contextMenu.settings"})),v=this.conversationHostOptions(),y=this.getDropListItems({profileItem:f,conversationHostOptions:v,settingsItem:h,showPrivacy:u,onPrivacyClick:this.onPrivacyClick,disableUserProfileModal:p});return c&&(n===a||r||s||i)&&y.unshift(g.a.createElement(w.MenuItem,{key:"communityQuestion","data-spot-im-class":"community-question-item",onClick:this.onCommunityQuestionClick},g.a.createElement(D.a,{textKey:"user.setCommunityQuestion"}))),t&&y.push(g.a.createElement(w.MenuItem,{key:"logout","data-spot-im-class":"logout-item",onClick:this.onLogoutClick},g.a.createElement(D.a,{textKey:"user.logout"}))),(o||r||s||i)&&(l?y.push(g.a.createElement(w.MenuItem,{key:"setModerationTo","data-spot-im-class":"set-moderation-item",onClick:"spot_policy"==l?this.setModerationToStrict:this.setModerationToDefault},g.a.createElement(D.a,{textKey:"spot_policy"==l?"user.setModerationStrict":"user.setModerationDefault"}))):y.push(g.a.createElement(w.MenuItem,{key:"setModerationLoading","data-spot-im-class":"set-moderation-item",disabled:!0},g.a.createElement(te.a,{i18nKey:"message.contextMenu.whiteList.item.loading"},"Fetching Info...")))),he.o&&(o||r||s)&&y.push(g.a.createElement(w.MenuItem,{key:"setReadOnly",onClick:this.setIsReadOnly},g.a.createElement(D.a,{textKey:d?"readOnly.turnOnCommenting":"readOnly.turnOffCommenting"}))),y}}]),n}(h.Component);gs.displayName="RegisteredUserDropdown",gs.contextType=ms.ToastContext,gs.defaultProps={onClose:function(){},showPrivacy:!0,onCommunityQuestionModalStateChange:function(){}};var vs=f()(Object(M.connect)((function(e){return{isReadOnly:e.isReadOnly,token:(e.authentication||{}).token,currentUser:e.currentUser,unseenNotificationsCount:e.currentUser.unseenNotificationsCount,defaultPolicy:(e.conversation||{}).defaultPolicy,spotId:e.moduleOptions.spotId,disableUserProfileModal:e.moduleOptions.disableUserProfileModal,postId:e.moduleOptions.postId}}),{getModerationDefaultPolicy:function(){return function(){var e=Z()(J.a.mark((function e(t,n){var a,o,r,s,i;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=n(),o=a.moduleOptions.spotId,r=a.conversation.id,t({type:"GET_MODERATION_DEFAULT_POLICY",payload:{defaultPolicy:""}}),e.next=5,Object(ds.a)({spotId:o,conversationId:r});case 5:s=e.sent,i=s.defaultPolicy,t({type:"GET_MODERATION_DEFAULT_POLICY",payload:{defaultPolicy:i}}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),kt.a.error("getModerationDefaultPolicy",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}()},setModerationDefaultPolicy:function(e){return function(){var t=Z()(J.a.mark((function t(n,a){var o,r,s;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o=a(),r=o.moduleOptions.spotId,s=o.conversation.id,t.next=4,Object(ds.c)({spotId:r,conversationId:s,newPolicy:e});case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),kt.a.error("setConversationDefaultPolicy",t.t0);case 9:n({type:"SET_MODERATION_DEFAULT_POLICY",payload:{}});case 10:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,n){return t.apply(this,arguments)}}()},setIsReadOnly:function(e){return function(){var t=Z()(J.a.mark((function t(n,a){var o,r,s,i;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=a(),r=o.moduleOptions,s=r.conversationId,i=r.postId,t.prev=1,t.next=4,Object(wt.a)("v1.0.0/conversation/metadata/read_only",{method:"POST",postId:i,data:{read_only:e,conversation_id:s}});case 4:n(Object(ps.b)({isReadOnly:e})),t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(1),t.t0;case 10:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e,n){return t.apply(this,arguments)}}()}}),Object(vt.a)(),C()({}))(gs),ys=n(775),bs=n.n(ys);function Es(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Ms=function(e){c()(n,e);var t=Es(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={showMenu:!1},e.handleTooltipClick=function(t){13===t.keyCode&&e.onTooltipToggle()},e.onTooltipToggle=function(){var t=e.props,n=t.tracking,a=t.currentUser,o=t.postId;Object(P.dispatchSpotimEvent)(Dt.q,a);var r={type:"profile-main-clicked",post_id:o};!e.state.showMenu&&n.trackEvent(r),e.setState({showMenu:!e.state.showMenu})},e.hide=function(){e.setState({showMenu:!1})},e.handleCloseTooltip=function(){e.setState({showMenu:!1})},e}return s()(n,[{key:"render",value:function(){var e,t=this.props,n=t.onLogout,a=t.onOpenPrivacyModal,o=t.onOpenUserProfileModal,r=t.showHideConversation,s=t.enableCommunityQuestion,i=t.onSetCommunityQuestion,c=t.onOpenUserSettingsModal,l=t.isLoggedIn,u=t.userId,d=t.isAdmin,p=t.isSuperAdmin,m=t.isModerator,f=t.isJournalist,h=t.toggleHideConversation,v=t.conversationAuthorId,y=t.showLogout,b=t.size,M=t.className,R=t.token,S=t.showPrivacy,C=t.onCommunityQuestionModalStateChange;M=E()(bs.a.currentUserMenu,bs.a.textTrigger,bs.a.conversation,M,{[bs.a.small]:"small"===b,[bs.a.medium]:"medium"===b,[bs.a.regular]:"regular"===b});var O=k.a.get("init_data.config.ltr")?"bottom-end":"bottom-start";return l&&(e=g.a.createElement(vs,{token:R,userId:u,isAdmin:d,isSuperAdmin:p,isModerator:m,isJournalist:f,onClose:this.hide,onLogout:n,onOpenPrivacyModal:a,showLogout:y,onOpenUserProfileModal:o,onOpenUserSettingsModal:c,showHideConversation:r,enableCommunityQuestion:s,toggleHideConversation:h,onSetCommunityQuestion:i,conversationAuthorId:v,showPrivacy:S,onCommunityQuestionModalStateChange:C})),g.a.createElement(w.Menu,{isMobile:Ie.a,isLtr:he.t,placement:O,onShowChange:this.onTooltipToggle,mobileCancelButtonContent:g.a.createElement(te.a,{i18nKey:"menu.closeButton"},"Done"),menuButton:g.a.createElement("span",{className:bs.a.currentUserMenuWrapper,"data-spot-im-class":"handler"},this.props.children)},e)}}]),n}(h.Component);Ms.displayName="CurrentUserMenu",Ms.defaultProps={className:"",showPrivacy:!0,onOpenPrivacyModal:function(){},onCommunityQuestionModalStateChange:function(){}};var Rs=f()(Object(M.connect)((function(e){var t=e.moduleOptions,n=t.spotId,a=t.postId;return{currentUser:e.currentUser,spotId:n,postId:a}})),C()({}))(Ms),Ss=n(776),Cs=n.n(Ss);function Os(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var ks=function(e){c()(n,e);var t=Os(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).handleLoginButtonKeyUp=function(t){13===t.keyCode&&e.handleClick(t)},e}return s()(n,[{key:"handleClick",value:function(e){var t=this.props,n=t.tracking,a=t.onClick,o=t.postId;a(e);var r={item_type:"login",target_type:"main-login",type:"login-clicked",post_id:o};n.trackEvent(r),Object(P.dispatchSpotimEvent)(Dt.d)}},{key:"render",value:function(){var e=this.props.className;return e=E()(Cs.a.loginButton,e),g.a.createElement(pt.a,{className:e,onClick:this.handleClick.bind(this),onKeyUp:this.handleLoginButtonKeyUp},g.a.createElement(D.a,{textKey:"general.login"}))}}]),n}(h.Component);ks.displayName="LoginButton",ks.defaultProps={tracking:function(){throw new Error("Tracking is not defined")}};var ws=C()({})(ks),Is=n(408),xs=n(777),Ts=n.n(xs),Ns=n(778),Ds=n.n(Ns);var js=Object(M.connect)((function(e){return{communityQuestion:e.moduleOptions.communityQuestion,isSettingCommunityQuestion:e.conversation.isSettingCommunityQuestion}}),(function(e){return{setCommunityQuestion:function(t){return e(function(e){return function(){var t=Z()(J.a.mark((function t(n,a){var o,r,s,i;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=a(),r=o.moduleOptions.spotId,s=o.conversation,n({type:ct.pb,payload:{isSettingCommunityQuestion:!0}}),t.next=4,Object(ds.e)({spotId:r,conversationId:s.id,communityQuestion:e});case 4:i=t.sent,i.isSuccess&&n({type:ct.kb,payload:{moduleOptions:{communityQuestion:e}}}),n({type:ct.pb,payload:{isSettingCommunityQuestion:!1}});case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t))}}}))((function(e){var t=Object(h.useState)(""),n=Fe()(t,2),a=n[0],o=n[1],r=Object(h.useState)(!0),s=Fe()(r,2),i=s[0],c=s[1],l=Object(h.useState)(!1),u=Fe()(l,2),d=u[0],p=u[1];Object(h.useEffect)((function(){a!==e.communityQuestion&&o(e.communityQuestion)}),[]);var m=Object(h.useMemo)((function(){var t=e.communityQuestion;return"string"==typeof t&&t.length>0}),[e.communityQuestion]);function f(){return(f=Z()(J.a.mark((function t(){return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p(!1),t.prev=1,t.next=4,e.setCommunityQuestion(a.trim());case 4:return t.prev=4,e.onClose(),t.finish(4);case 7:case"end":return t.stop()}}),t,null,[[1,,4,7]])})))).apply(this,arguments)}function v(){return(v=Z()(J.a.mark((function t(){return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p(!0),t.prev=1,t.next=4,e.setCommunityQuestion("");case 4:return t.prev=4,e.onClose(),t.finish(4);case 7:case"end":return t.stop()}}),t,null,[[1,,4,7]])})))).apply(this,arguments)}return g.a.createElement(w.Modal,{disableCustomBodyScroll:he.j,shadowRootCssModules:Pe.c?["conversation"]:void 0,isLtr:he.t,className:Ds.a.communityQuestionModal,closeButton:!0,showModal:e.showModal,onClose:function(){return e.onClose()},size:"md",modalTitle:Be.default.t("communityQuestion.title"),bottomActions:g.a.createElement(w.Gutter,null,g.a.createElement(w.Button,{mode:"secondary",onClick:function(){return v.apply(this,arguments)},disabled:!m},g.a.createElement(Je,{label:Be.default.t("delete","Delete"),showSpinner:d&&e.isSettingCommunityQuestion})),g.a.createElement(w.Button,{mode:"primary",onClick:function(){return f.apply(this,arguments)},disabled:i||e.isSettingCommunityQuestion},g.a.createElement(Je,{label:Be.default.t("Post"),showSpinner:!d&&e.isSettingCommunityQuestion})))},g.a.createElement("div",{className:Ds.a.description},Be.default.t("communityQuestion.description")),g.a.createElement("textarea",{className:Ds.a.textarea,placeholder:Be.default.t("communityQuestion.ask"),value:a,onChange:function(e){o(e.currentTarget.value),c(!e.currentTarget.value)}}))}));function Ls(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Us=k.a.get("tenant_config.shared.disable_user_profile_privacy",!1),Bs=/[&?]spot_im_open_profile_followers=true/,Ps=function(e){c()(n,e);var t=Ls(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={showCommunityQuestionModal:!1},e.handleOpenUserProfile=function(){var t=e.props;(0,t.onOpenUserProfileModal)(t.currentUser)},e.onCommunityQuestionModalStateChange=function(){e.setState({showCommunityQuestionModal:!0})},e.handleCommunityQuestionModalClose=function(){e.setState({showCommunityQuestionModal:!1})},e.handleLogout=function(){e.setState({isLoggingOut:!0}),e.props.onLogout()},e}return s()(n,[{key:"componentDidUpdate",value:function(e){e.currentUser!==this.props.currentUser&&this.state.isLoggingOut&&this.setState({isLoggingOut:!1})}},{key:"componentDidMount",value:function(){window&&!window.__SPOTIM__.isViewUserProfileFollowersConsumed&&Bs.test(Object(P.getLocation)().search)&&(this.props.onOpenUserProfileFollowers(this.props.userId),window.__SPOTIM__.isViewUserProfileFollowersConsumed=!0)}},{key:"render",value:function(){var e=this.props,t=e.userId,n=e.isAdmin,a=e.isSuperAdmin,o=e.isModerator,r=e.isJournalist,s=e.isLoggedIn,i=e.allowLogin,c=e.onOpenPrivacyModal,l=e.onLoginSelector,u=e.conversationAuthorId,d=e.onOpenUserProfileModal,p=e.onOpenUserSettingsModal,m=e.direction,f=e.toggleHideConversation,h=e.postId,v=e.enableSSO,y=e.isLiveBlog,b=this.state,E=b.showCommunityQuestionModal,M=b.isLoggingOut,R=null;return s?R=g.a.createElement(g.a.Fragment,null,g.a.createElement(Rs,{size:"medium",showLogout:i||he.q,conversationAuthorId:u,enableCommunityQuestion:!0,showHideConversation:!0,userId:t,isAdmin:n,isSuperAdmin:a,isModerator:o,isJournalist:r,isLoggedIn:s,onLogout:this.handleLogout,onOpenPrivacyModal:c,onOpenUserProfileModal:d,onOpenUserSettingsModal:p,direction:m,toggleHideConversation:f,onCommunityQuestionModalStateChange:this.onCommunityQuestionModalStateChange,showPrivacy:!(v&&Us)},M?g.a.createElement("div",{className:Ts.a.loginSpinnerWrapper},g.a.createElement(U.a,null)):g.a.createElement(pt.a,{disableHover:!0,isIcon:!0,className:Ts.a.cogMenuIcon},g.a.createElement(w.Icon,{name:"cog",type:"fa-regular"}))),g.a.createElement(js,{showModal:E,onClose:this.handleCommunityQuestionModalClose})):i&&!y&&(R=g.a.createElement(ws,{postId:h,onClick:function(){return l()}})),R}}]),n}(h.Component),As=Object(M.connect)((function(e){var t=e.currentUser,n=e.moduleOptions,a=n.isConnectEnabled,o=n.enableSSO,r=(n.editableSSO,n.direction),s=n.conversationAuthorId,i=n.connectTypes,c=n.spotId,l=n.postId,u=n.isConversationLiveBlog,d=n.isConversationPage;return{enableSSO:o,isConnectEnabled:a,currentUser:t,direction:r,userId:t.id,isAdmin:t.isAdmin,isSuperAdmin:t.isSuperAdmin,isJournalist:t.isJournalist,isModerator:t.isModerator,isLoggedIn:Object(ua.d)(t),userDisplayName:Object(ua.b)(t),allowLogin:a&&!o||he.p,conversationAuthorId:s,connectTypes:i,spotId:c,postId:l,isLiveBlog:u,isConversationPage:d}}),(function(e){return{onLogout:ho.b,onOpenPrivacyModal:function(t){return e(Object(Ft.a)({user:t,mode:"privacy"}))},onOpenUserProfileFollowers:function(t){e(Object(Ft.a)({user:{id:t},mode:"main-followers"}))},onOpenUserProfileModal:function(t){e(Object(Ft.a)({user:t,mode:"main"}))},onOpenUserSettingsModal:function(t){return e(Object(Ft.a)({user:t,mode:"settings"}))},onLoginSelector:function(){var t=function(){return e(Object(At.a)())};if(!document.requestStorageAccess)return e(Object(At.a)());var n=function(){document.requestStorageAccess().then((function(){return t()}),(function(){return t()}))};document.hasStorageAccess().then((function(e){!0===e?t():n()}),(function(){return n()}))},toggleHideConversation:function(){return e(Object(Is.a)())}}}))(Ps),_s=n(256),Fs=function(e){var t=k.a.get("tenant_config.conversation.message_fetch_count",Pa.c);return e?Pa.e:t};var Vs,Ks,Hs,qs,Ws=0,zs=[5,10,15,20,30,40,50,60,70,80,90,120,240],Gs={};function Qs(){if(0!==Ws){var e={type:"reading",item_type:"main",count:Ws,is_active_view:!0};Hs?Hs.trackEvent(e):kt.a.error("trackEvent","trying to log reading event before reading-service initialization")}}function Js(){Ws++,-1!==zs.indexOf(Ws)&&(Qs(),Gs={hasMouseMoved:!1,hasMouseScrolled:!1,hasKeyboardClicked:!1})}function Ys(){!0,Vs=setInterval((function(){Js()}),Ks)}function Zs(){!1,clearInterval(Vs)}function Xs(e){"hidden"==document.visibilityState?Zs():$s(e)&&Ys()}function $s(e){var t=e.getBoundingClientRect();return t.top<window.innerHeight&&t.bottom>0}window.addEventListener("message",(function(e){if("object"==typeof e.data&&e.data.__SPOTIM_MESSAGE)switch(e.data.type){case"scroll":Gs.hasMouseScrolled=!0;break;case"keydown":Gs.hasKeyboardClicked=!0;break;case"mousemove":Gs.hasMouseMoved=!0}}));var ei=n(82);function ti(e){var t={offset:e.offset,count:e.count};return Object(He.a)("notifications/my-notifications",{data:t})}function ni(e){var t=e.notificationId;return Object(He.a)("notifications/mark_as_read",{method:"POST",data:{notifications_ids:[t]}})}var ai=n(114);function oi(e){var t=$t.a.map(e,{total_unread:"unreadCount",total_unseen:"unseenCount",total:"totalCount",notifications:{"~":"notifications",id:"id",type:"type",read:"read",updated_at:"updatedAt",conversation_id:"conversationId",conversation_url:"conversationUrl",conversation_title:"conversationTitle",total_count:"totalCount",replier_id:"userId",liker_id:"userId",mentioner_id:"userId",reply:Object(Ka.a)("message"),message:Object(Ka.a)("message"),users:Object(Xt.a)("users")}});return t.notifications=t.notifications||[],t.notifications=t.notifications.map((function(e){return e.messageId=e.message.id,e.message.depth="comment"===e.message.type?0:1,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(n||(n=e.userId),e.user=t.find((function(e){return e.id===n})),e.entities&&e.entities.forEach((function(e){"user-mention"===e.type.toLowerCase()&&(e.user=t.find((function(t){return t.id===e.userId})))})),e.replyToUserId&&!e.replyToDisplayName){var a=t.find((function(t){return e.replyToUserId===t.id}));a&&(e.replyToDisplayName=a.displayName||a.username)}}(e.message,e.users),e})),t}var ri=!1;function si(){return function(){var e=Z()(J.a.mark((function e(t){var n,a,o;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ri){e.next=22;break}return ri=!0,t({type:ei.b}),e.prev=3,kt.a.apm.start("fetch_get_and_reset_notifications"),e.next=7,Object(He.a)("notifications/my-notifications-and-reset-unseen",{});case 7:if(n=e.sent,a=n.body,kt.a.apm.end("fetch_get_and_reset_notifications"),a.notifications.forEach((function(e){e&&e.message&&e.message.content&&(e.message.content=e.message.content.filter((function(e){return"user-mention"!==e.type})))})),o=oi(a)){e.next=14;break}return e.abrupt("return");case 14:t({type:ei.a,payload:{notifications:o.notifications,unreadCount:o.unreadCount,totalCount:o.totalCount}}),ri=!1,e.next=22;break;case 18:e.prev=18,e.t0=e.catch(3),ri=!1,kt.a.error("getAndResetNotifications",e.t0);case 22:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(t){return e.apply(this,arguments)}}()}var ii=n(779),ci=n.n(ii);function li(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var ui=function(e){c()(n,e);var t=li(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.count,n=e.active,a=e.onClick,o=e.onIndicatorHover,r=e.showCircleIcon,s=null;t>0&&(s=g.a.createElement("span",{className:ci.a.counter}));var i=E()(ci.a.indicator,{[ci.a.active]:t||n});return g.a.createElement("div",{onMouseEnter:o,className:i,onClick:a},r?g.a.createElement(x.a,{className:ci.a.icon,selector:"bellIcon"}):g.a.createElement(pt.a,{isIcon:!0,disableHover:!0,className:ci.a.icon},g.a.createElement(x.a,{selector:"regularBellIcon"})),s)}}]),n}(h.Component);ui.defaultProps={count:0,active:!1,onClick:function(){}};var di=n(780),pi=n.n(di);function mi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var fi=function(e){c()(n,e);var t=mi(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).handleMarkAsReadKeyUp=function(t){var n=e.props.onMarkAllAsRead;13===t.keyCode&&(t.stopPropagation(),n())},e}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.unreadCount,n=e.onMarkAllAsRead,a=null;return t>0&&(a=g.a.createElement(D.a,{textKey:"notifications.markAsRead",className:pi.a.markAsRead,onClick:n,onKeyUp:this.handleMarkAsReadKeyUp})),g.a.createElement("header",{className:pi.a.notificationsTooltipHeader},g.a.createElement(D.a,{textKey:"notifications.title",className:pi.a.title}),t>0&&g.a.createElement("div",{className:pi.a.counter},t),a)}}]),n}(h.Component);fi.displayName="NotificationsHeader",fi.propTypes={unreadCount:y.a.number,onMarkAllAsRead:function(){}},fi.defaultProps={unreadCount:0,onMarkAllAsRead:function(){}};var hi=n(781),gi=n.n(hi);function vi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var yi=function(e){c()(n,e);var t=vi(n);function n(e){var a;return o()(this,n),(a=t.call(this,e)).getMentionEndingKey=function(e){var t="more";switch(e){case 0:t="zero";break;case 1:t="one"}return t},a.getMessageComponent=function(){var e=a.props,t=e.message,n=e.hideNotification,o=null;if(t)try{var r=Object(X.getCleanText)(t);r=r.replace(/\n/gm," ").replace(/\&nbsp;/gm," "),o=g.a.createElement("em",{className:gi.a.message},r)}catch(e){n()}return o},a.getTitleComponent=function(){var e=a.props,t=e.item,n=e.user,o=e.message,r=t.totalCount,s="notifications.types.";t.type!==ai.a.LIKED_MESSAGE&&(s+=t.type),t.type===ai.a.MENTION&&(s+=".".concat(a.getMentionEndingKey(r)));var i=null,c="";switch(t.type){case ai.a.MENTION:case ai.a.REPLIED_YOUR_MESSAGE:n&&(c=o&&o.userDisplayName||Object(Pt.getDisplayName)(n)),i=g.a.createElement(D.a,{className:gi.a.description,textKey:s,params:{totalCount:r,username:c},pluralValue:r});break;case ai.a.LIKED_MESSAGE:switch(n&&(c=Object(Pt.getDisplayName)(n)),yt){case ht.Recommend:s+="recommended-message";break;case ht.UpDown:s+="up-voted-message";break;default:s+=t.type}i=g.a.createElement(D.a,{className:gi.a.description,textKey:s,params:{totalCount:r,username:c},pluralValue:r});break;default:i=g.a.createElement(D.a,{className:gi.a.description,textKey:s,params:{totalCount:r},pluralValue:r})}return i},a.state={messageComponent:null,titleComponent:null},a}return s()(n,[{key:"componentDidMount",value:function(){var e=this.getMessageComponent(),t=this.getTitleComponent();this.setState({messageComponent:e,titleComponent:t})}},{key:"render",value:function(){var e=this.props,t=e.item,n=e.message,a=this.state,o=a.messageComponent,r=a.titleComponent,s=t.conversationTitle,i=E()(gi.a.title,{[gi.a.noMessage]:!n});return g.a.createElement("div",{className:gi.a.content},r,g.a.createElement("span",{className:i},s),o)}}]),n}(h.Component),bi=n(782),Ei=n.n(bi);function Mi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Ri=function(e){c()(n,e);var t=Mi(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).getIcon=function(){var t=null;switch(e.props.item.type){case ai.a.REPLIED_YOUR_MESSAGE:case ai.a.ALSO_REPLIED:t="commentIcon";break;case ai.a.LIKED_MESSAGE:switch(yt){case ht.UpDown:t="upVote";break;case ht.Recommend:t="recommend";break;default:t="voteUpIcon"}break;case ai.a.MENTION:t="mentionIcon"}return t},e}return s()(n,[{key:"render",value:function(){var e=this.props.item,t=this.getIcon();return g.a.createElement("div",{className:E()(Ei.a.details,Ei.a[t])},g.a.createElement(x.a,{className:E()(Ei.a.icon,{[Ei.a.voteIcon]:e.type===ai.a.LIKED_MESSAGE}),selector:t}),g.a.createElement("div",{className:Ei.a.updatedAt},g.a.createElement(xn,{date:e.updatedAt,longDate:!0})))}}]),n}(h.Component),Si=n(783),Ci=n.n(Si);function Oi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var ki=function(e){c()(n,e);var t=Oi(n);function n(e){var a;return o()(this,n),(a=t.call(this,e)).onClick=function(e){var t=a.props,n=t.tracking,o=t.onMarkAsRead,r=t.item,s=t.onClick,i=t.postId,c=r.id,l=r.conversationUrl,u=r.message,d=r.spotId,p=r.conversationId,m=r.type;o({id:c}),s({conversationUrl:l,message:u,spotId:d,conversationId:p,newTab:"button"in e&&1===e.button||e.ctrlKey||e.metaKey});var f={type:"notification-click",item_type:"notifications",target_type:m,item_id:u&&u.id,conversation_id:p,post_id:i};n.trackEvent(f)},a.handleNotificationKeyUp=function(e){13===e.keyCode&&(e.stopPropagation(),a.onClick(e))},a.hideNotification=function(){a.setState({show:!1})},a.state={show:!0},a}return s()(n,[{key:"render",value:function(){var e=this.props.item,t=e.users[e.userId]||Object(ot.a)();return this.state.show?g.a.createElement("li",{className:E()(Ci.a.item,{[Ci.a.read]:e.read}),onClick:this.onClick,onKeyUp:this.handleNotificationKeyUp},g.a.createElement(me.a,{size:fe.USER_IMAGE_SIZE.NORMAL,disableUserImageUpload:!0,disableOnlineIndicator:!0,user:t}),g.a.createElement("div",{className:Ci.a.contentWrap},g.a.createElement(yi,{item:e,message:e.message,user:t,hideNotification:this.hideNotification}),g.a.createElement(Ri,{item:e}))):null}}]),n}(h.Component);ki.defaultProps={onClick:function(){},onMarkAsRead:function(){}};var wi=f()(Object(M.connect)((function(e){return{spotId:e.moduleOptions.spotId,postId:e.moduleOptions.postId}})),C()({}))(ki),Ii=n(784),xi=n.n(Ii);function Ti(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Ni=function(e){c()(n,e);var t=Ti(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).scrollWrapperRef=g.a.createRef(),e.onScroll=function(){var t=e.scrollWrapperRef.current;if(t){var n=t.scrollTop;if(t.scrollHeight-t.clientHeight-n<30){var a=e.props,o=a.hasNext,r=a.onLoadNext,s=a.isLoading;o&&!s&&r()}}},e}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.items,n=e.isEmpty,a=e.onMarkAsRead,o=e.onNotificationClick,r=e.isModal;return n?null:g.a.createElement("ul",{className:xi.a.list,ref:this.scrollWrapperRef,onScroll:this.onScroll},t.map((function(e){return g.a.createElement(wi,{key:e.id,onClick:o,onMarkAsRead:a,item:e,isModal:r})})))}}]),n}(h.Component);Ni.defaultProps={isEmpty:!1,hasNext:!1,isLoading:!1,onMarkAsRead:function(){},onNotificationClick:function(){},onLoadNext:function(){}};var Di=n(785),ji=n.n(Di),Li=function(){return g.a.createElement("div",{className:ji.a.notificationsEmptyState},g.a.createElement("div",{className:ji.a.placeholder},g.a.createElement("div",{className:ji.a.circle}),g.a.createElement("div",{className:ji.a.line1}),g.a.createElement("div",{className:ji.a.line2})),g.a.createElement("div",{className:ji.a.title},g.a.createElement(te.a,{i18nKey:"notification.emptyStateTitle"},"No Notifications Yet :(")),g.a.createElement("div",{className:ji.a.subtitle},g.a.createElement(te.a,{i18nKey:"notification.emptyStateBody"},"Start interacting with others and your inbox will be full in no time!")))},Ui=function(){return g.a.createElement(Vt.a,{rtl:!k.a.get("init_data.config.ltr"),width:310,height:280,speed:2,backgroundColor:getComputedStyle(document.documentElement).getPropertyValue("--spotim-content-loader-primary-color"),foregroundColor:getComputedStyle(document.documentElement).getPropertyValue("--spotim-content-loaders-secondary-color")},g.a.createElement("circle",{cx:"47",cy:"47",r:"17"}),g.a.createElement("rect",{x:"73",y:"30",rx:"8",ry:"8",width:"174",height:"13"}),g.a.createElement("rect",{x:"73",y:"50",rx:"8",ry:"8",width:"139",height:"13"}),g.a.createElement("circle",{cx:"47",cy:"138",r:"17"}),g.a.createElement("rect",{x:"73",y:"121",rx:"8",ry:"8",width:"174",height:"13"}),g.a.createElement("rect",{x:"73",y:"141",rx:"8",ry:"8",width:"139",height:"13"}),g.a.createElement("circle",{cx:"47",cy:"229",r:"17"}),g.a.createElement("rect",{x:"73",y:"212",rx:"8",ry:"8",width:"174",height:"13"}),g.a.createElement("rect",{x:"73",y:"232",rx:"8",ry:"8",width:"139",height:"13"}))},Bi=n(786),Pi=n.n(Bi);function Ai(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var _i=function(e){c()(n,e);var t=Ai(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){var e=this.props,t=e.notifications,n=e.className,a=e.isLoading,o=e.onMarkAsRead,r=e.onLoadNext,s=e.onNotificationClick,i=e.onMarkAllAsRead,c=e.isModal,l=t.items,u=t.order,d=Object(ai.d)(t),p=Object(ai.e)(t),m=E()(Pi.a.notificationsTooltip,{[Pi.a.noNotifications]:p},n),f=u.map((function(e){return l[e]}));return g.a.createElement("div",{className:m},!Object(Ie.b)()&&g.a.createElement(fi,{unreadCount:f.length,onMarkAllAsRead:i}),!p&&g.a.createElement(Ni,{items:f,isEmpty:p,hasNext:d,isLoading:a,onMarkAsRead:o,onNotificationClick:s,onLoadNext:r,isModal:c}),a&&p&&g.a.createElement(Ui,null),!a&&p&&g.a.createElement(Li,null))}}]),n}(h.Component);_i.defaultProps={isLoading:!1,onNotificationClick:function(){},onLoadNext:function(){},onMarkAsRead:function(){},onMarkAllAsRead:function(){},onHide:function(){},onShow:function(){},toggleObservable:void 0,showObservable:void 0,hideObservable:void 0,className:""};var Fi=n(787),Vi=n.n(Fi);function Ki(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var Hi=function(e){c()(n,e);var t=Ki(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={showMenu:!1,unseenCount:e.props.notifications.unseenCount,isPostPage:e.props.contentType===no.b.Post},e.onTooltipToggle=function(){e.props.onLoadAndReset(),e.setState({showMenu:!e.state.showMenu})},e.handleTooltipClick=function(t){13===t.keyCode&&(e.props.onLoadAndReset(),e.onTooltipToggle())},e.onIndicatorHover=function(){var t={type:"hovered",item_type:"header",target_type:"notifications-bell",post_id:e.props.postId};e.props.tracking.trackEvent(t)},e.onTooltipShow=Z()(J.a.mark((function t(){var n,a,o,r,s,i,c;return J.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.props,a=n.tracking,o=n.postId,r=n.isLoaded,s=n.convId,i=n.setNotificationLoaded,r||(e.props.getAndResetNotifications(),i()),e.setState({showMenu:!0,unseenCount:0}),c={type:"notifications-bell-clicked",item_type:"notifications",target_type:"on",post_id:o,ugc_post_id:s},a.trackEvent(c),Object(P.dispatchSpotimEvent)(Dt.e);case 6:case"end":return t.stop()}}),t)}))),e.onTooltipHide=function(){var t=e.props,n=t.tracking,a=t.postId,o=t.convId;e.setState({showMenu:!1});var r={type:"notifications-bell-clicked",item_type:"notifications",target_type:"off",post_id:a,ugc_post_id:o};n.trackEvent(r)},e.onNotificationClick=function(t){e.props.onNotificationClick(t),e.onTooltipToggle()},e.handleCloseTooltip=function(){e.setState({showMenu:!1})},e}return s()(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.notifications.unseenCount;this.props.notifications.unseenCount!==t&&this.setState({unseenCount:t})}},{key:"render",value:function(){var e=this,t=this.props,n=t.notifications,a=t.isLoading,o=t.connectEnabled,r=t.onLoadNext,s=t.onMarkAsRead,i=t.onMarkAllAsRead,c=t.className,l=t.showCircleIcon,u=t.isModal,d=t.isLiveBlog,p=t.currentUser,m=t.notificationsAlreadyLoaded,f=this.state,h=f.unseenCount,v=f.showMenu;c=E()(Vi.a.notifications,{[Vi.a.loginDisabled]:!o},c);var y=k.a.get("init_data.config.ltr")?"bottom-end":"bottom-start";return d&&!Object(ua.d)(p)?null:g.a.createElement("div",{className:c,id:"spotim-bell-notification"},g.a.createElement(w.Menu,{isLtr:he.t,isMobile:Ie.a,placement:y,showMenu:v,onShowChange:function(t){t?e.onTooltipShow():e.onTooltipHide()},mobileCancelButtonContent:g.a.createElement(te.a,{i18nKey:"menu.closeButton"},"Done"),menuButton:g.a.createElement(ui,{active:v,count:h,onIndicatorHover:this.onIndicatorHover,showCircleIcon:l})},g.a.createElement(_i,{notifications:n,isLoading:a||!m,onNotificationClick:this.onNotificationClick,onLoadNext:r,onMarkAsRead:s,onMarkAllAsRead:i,onShow:this.onTooltipShow,onHide:this.onTooltipHide,isModal:u})))}}]),n}(h.Component);Hi.defaultProps={connectEnabled:!0};var qi=f()(Object(M.connect)((function(e){var t=e.moduleOptions.postId,n=A.j(e),a=e.conversation,o=a.contentType,r=a.id;return{isLiveBlog:n,currentUser:A.c(e),postId:t,convId:r,notificationsAlreadyLoaded:e.notifications.isLoaded,contentType:o}}),(function(e){return{getAndResetNotifications:function(){e(si())},setNotificationLoaded:function(){e({type:ei.e,payload:{isLoaded:!0}})}}})),C()({}))(Hi);function Wi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var zi=function(e){c()(n,e);var t=Wi(n);function n(){return o()(this,n),t.apply(this,arguments)}return s()(n,[{key:"render",value:function(){return g.a.createElement(qi,this.props)}}]),n}(h.Component);zi.propTypes={notifications:y.a.object.isRequired,isLoading:y.a.bool,onMarkAllAsRead:y.a.func,onMarkAsRead:y.a.func,onLoadNext:y.a.func,onNotificationClick:y.a.func,direction:y.a.oneOf(["rtl","ltr"]).isRequired,showCircleIcon:y.a.bool.isRequired};var Gi=Object(M.connect)((function(e){var t=e.notifications,n=e.moduleOptions,a={isLoading:t.isLoading,notifications:t};if(n){var o=n.direction;a.direction=o}return a}),{onMarkAllAsRead:function(){return function(){var e=Z()(J.a.mark((function e(t,n){var a,o,r;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n(),o=a.notifications,r=o.items.filter((function(e){return!e.read})).map((function(e){return e.id})),e.next=4,s=void 0,s=r.notificationIds,Object(He.a)("notifications/mark_as_read",{method:"POST",data:{notifications_ids:s}});case 4:t({type:ei.c});case 5:case"end":return e.stop()}var s}),e)})));return function(t,n){return e.apply(this,arguments)}}()},onMarkAsRead:function(e){var t=e.id;return function(){var e=Z()(J.a.mark((function e(n){return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ni(t);case 2:n({type:ei.d,payload:{id:t}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},onLoadNext:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.reset,n=void 0!==t&&t;return function(){var e=Z()(J.a.mark((function e(t,a){var o,r,s,i,c,l,u,d,p,m,f;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a(),r=Object(ai.c)(o.notifications),s=r.offset,i=r.count,n&&(s=0,i=0),t({type:ei.b}),e.prev=4,e.next=7,ti({offset:s,count:i});case 7:c=e.sent,l=c.body,u=oi(l),d=u.unreadCount,p=u.unseenCount,m=u.totalCount,f=u.notifications,t({type:ei.a,payload:{notifications:f,unreadCount:d,unseenCount:p,totalCount:m,offset:s,reset:n}}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),kt.a.error("getNotifications",e.t0);case 16:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t,n){return e.apply(this,arguments)}}()},onLoadAndReset:si})(zi),Qi=n(427),Ji=function(e){var t=e.commentsRootCount,n=e.postId,a=Object(h.useRef)(null),o=function(e,t){var n,a;e&&(null===(n=window)||void 0===n||null===(a=n.__SPOTIM__)||void 0===a||a.renderSurvey({element:e,postId:t}))},r=Object(h.useMemo)((function(){var e=k.a.get("tenant_config.conversation-survey.enabled",!1),n=k.a.get("tenant_config.conversation-survey.minimum_num_of_comments",10);return e&&n<=t}),[t]);return Object(h.useEffect)((function(){return function(){if(null==a?void 0:a.current){var e=new IntersectionObserver((function(e,t){Fe()(e,1)[0].isIntersecting&&(t.disconnect(),o(a.current,n))}),{threshold:[.99],rootMargin:"0px 0px ".concat("-160px"," 0px")});return e.observe(a.current),function(){(null==a?void 0:a.current)&&e.unobserve(a.current)}}}()}),[r]),r&&g.a.createElement("div",{ref:a})},Yi=n(428),Zi=n.n(Yi);function Xi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return u()(this,n)}}var $i=k.a.get("tenant_config.conversation.isSocialValueEnabled",!1),ec=Object(h.lazy)((function(){return Promise.all([n.e(0),n.e(22),n.e(58)]).then(n.bind(null,902))})),tc=Object(h.lazy)((function(){return Promise.all([n.e(0),n.e(85)]).then(n.bind(null,887))})),nc=Object(h.lazy)((function(){return Promise.all([n.e(0),n.e(24)]).then(n.bind(null,884))})),ac=function(e){c()(n,e);var t=Xi(n);function n(){var e;o()(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).handleStarRatingModuleVote=function(t){var n=t.detail;e.props.conversation.id===n.conversationId&&e.props.onRatingsClick(n.rank)},e.subscribeToStarRating=function(){document.addEventListener("spot-im-star-rating-module-vote",e.handleStarRatingModuleVote)},e.unSubscribeToStarRating=function(){document.removeEventListener("spot-im-star-rating-module-vote",e.handleStarRatingModuleVote)},e.scrollToComments=function(){var t=Object(R.findDOMNode)(e.messagesStackElement).getBoundingClientRect().top;Ta(window,t,200)},e.renderUserMenu=function(t){var n=t.currentUser,a=t.useDisqusLogin,o=t.handleDisqusLogin,r=t.onNotificationClick,s=t.direction,i=t.claimDisqusForumAccount,c=t.postId;return g.a.createElement("div",{"data-spot-im-class":"registration-buttons",className:Zi.a.registrationButtons},!Object(ua.d)(n)&&a&&!e.props.isLiveBlog&&i&&g.a.createElement(z,{onClick:e.openDiscusForumAccount}),!Object(ua.d)(n)&&a&&!e.props.isLiveBlog&&g.a.createElement(G.a,{onClick:o,postId:c}),g.a.createElement(Gi,{onNotificationClick:r,direction:s,showCircleIcon:!1}),g.a.createElement(As,null))},e.openDiscusForumAccount=function(){Object(P.dispatchSpotimEvent)(B.d)},e.handleLogin=function(){var t=e.props,n=t.tracking,a=t.conversation;(0,t.onLogin)();var o={item_type:"login",target_type:"commnet-sign-up",type:"login-clicked",post_id:a.postId};n.trackEvent(o)},e.handleUploadProfileImage=function(t){var n=e.props.currentUser;e.props.onProfileImageUpload({userId:n.id,rawImage:t})},e.handleUserProfileClick=function(){var t=e.props.currentUser;(t.isRegistered||t.displayName)&&e.props.onOpenUserProfileModal({user:t,mode:"main"})},e.shouldDisplayUsername=function(){var t=e.props,n=t.forceRegister;return t.currentUser.isRegistered||!n},e.getSurveyComponent=function(){var t=e.props,n=t.hasNextComments,a=t.isLiveBlog,o=t.conversation,r=t.commentsList,s=o.postId;return n&&!a&&g.a.createElement(Ji,{commentsRootCount:r.rootOrder.length,postId:s})},e}return s()(n,[{key:"componentDidMount",value:function(){_r.a.on("scrollToComments",this.scrollToComments);var e=this.props,t=e.conversation.messagesCount,n=e.tracking;t>0&&function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;if(t){Hs=e,Ks=n,Ws=0,!0,qs=!1,clearInterval(Vs),Gs={hasMouseMoved:!0,hasMouseScrolled:!0,hasKeyboardClicked:!0};var a=new IntersectionObserver((function(e){var t=Fe()(e,1)[0];qs?t.isIntersecting?Ys():(Qs(),Zs()):qs=!0}),{threshold:.01});$s(t)&&Ys(),a?a.observe(t):console.warn("unable to initialize reading service intersection observer"),document.addEventListener("visibilitychange",(function(){return Xs(t)}),!1)}else console.error("initialized reading service without an element to observe")}(n,Object(R.findDOMNode)(this.messagesStackElement)),this.subscribeToStarRating()}},{key:"componentWillUnmount",value:function(){_r.a.off("scrollToComments",this.scrollToComments),this.unSubscribeToStarRating()}},{key:"render",value:function(){var e=this,t=this.props,n=t.spotId,a=t.comments,o=t.conversation,r=t.isStarsRatingEnabled,s=t.isConnectEnabled,i=t.enableSSO,c=t.editableSSO,l=t.onNotificationClick,u=t.verifyEmailSent,d=t.summaryWidget,p=t.pagination,m=t.pageSize,f=t.useDisqusLogin,v=t.isSafari,y=t.onVerifyEmailSend,b=t.currentUser,M=t.onLoadMore,R=t.handleDisqusLogin,S=t.loadMoreMessagesText,C=t.isLoadingMoreComments,O=t.hasNextComments,k=t.direction,x=t.isLiveBlog,T=t.isReporter,N=t.isLiveBlogOnline,D=t.href,j=(t.commentsList,t.liveBlogEndDate),U=t.liveBlogStartDate,B=t.isReadOnly,P=o.messagesCount,A=o.commentsCount,_=o.postId,F=P>0?r?"richEditor.placeholder.hasMessagesWithStarsRatingEnabled":"richEditor.placeholder.hasMessages":r?"richEditor.placeholder.noMessagesWithStarsRatingEnabled":"richEditor.placeholder.noMessages",V=I.e(a),K=0===P,q=E()(Zi.a.conversation,{[Zi.a.emptyState]:K,[Zi.a.safari]:v}),W=x?"liveBlog.loadMoreReplies":"inpage.conversation.loadMoreReplies";return g.a.createElement("div",{ref:function(t){return e.wrapper=t},"data-spot-im-class":"conversation-body",className:q},r&&g.a.createElement(h.Suspense,{fallback:null},g.a.createElement(ec,{summaryWidget:d,conversation:o})),g.a.createElement(h.Suspense,{fallback:null},x&&g.a.createElement("div",{className:Zi.a.topStrip,"data-spot-im-class":"top-strip"},g.a.createElement(g.a.Fragment,null,g.a.createElement(nc,{liveBlogEndDate:j,liveBlogStartDate:U,isEmpty:K,isReporter:T,isLiveBlogOnline:N}),!T&&this.renderUserMenu({currentUser:b,useDisqusLogin:f,handleDisqusLogin:R,onNotificationClick:l,direction:k,claimDisqusForumAccount:!1,postId:_})))),(!x||T)&&g.a.createElement("div",{className:E()(Zi.a.userAreaContainer,{[Zi.a.hasUserUsername]:this.shouldDisplayUsername()})},B?g.a.createElement(te.a,{i18nKey:"commentingEnded"},g.a.createElement(w.Typography,{type:"h4"},"Commenting on this article has ended")):this.shouldDisplayUsername()&&g.a.createElement(ao,{spotId:n,currentUser:b,enableSSO:i,editableSSO:c,handleLogin:this.handleLogin,handleUploadProfileImage:this.handleUploadProfileImage,handleUserProfileClick:this.handleUserProfileClick}),(!i||b.isRegistered||he.p)&&this.renderUserMenu({currentUser:b,useDisqusLogin:f,handleDisqusLogin:R,onNotificationClick:l,direction:k,claimDisqusForumAccount:!1,postId:_})),s&&!i&&g.a.createElement(L,{currentUser:b,email:b.email,isEmailVerified:b.isEmailVerified,onVerifyEmailSend:y,isVerificationEmailSent:u,spotId:n,hostUrl:D}),!B&&(!x||T)&&g.a.createElement(Qr,{placeholderTextKey:F}),!K&&g.a.createElement(us,{conversation:o,sortBy:p.sortBy,pageSize:m}),g.a.createElement(h.Suspense,{fallback:null},$i&&!x&&g.a.createElement(tc,{spotId:n})),g.a.createElement(Ar,{key:"messageStack",ref:function(t){e.messagesStackElement=t},stackList:a,commentsCount:A-V.length,currentUser:b,hasNextComments:O}),!he.u&&this.getSurveyComponent(),g.a.createElement(H,{hasNext:O,loadMoreMessagesText:S,isLoading:C,onLoadMore:M,textKey:W}),he.u&&this.getSurveyComponent())}}]),n}(h.Component);ac.propTypes={spotId:y.a.string.isRequired,direction:y.a.oneOf(["rtl","ltr"]).isRequired,currentUser:y.a.object.isRequired,isStarsRatingEnabled:y.a.bool,isConnectEnabled:y.a.bool.isRequired,useDisqusLogin:y.a.bool.isRequired,conversation:y.a.any.isRequired,enableSSO:y.a.bool,verifyEmailSent:y.a.bool.isRequired,pagination:y.a.object.isRequired,comments:y.a.object.isRequired,summaryWidget:y.a.object.isRequired,isSafari:y.a.bool,pageSize:y.a.number,onVerifyEmailSend:y.a.func.isRequired,onNotificationClick:y.a.func.isRequired,onLoadMore:y.a.func.isRequired,loadMoreMessagesText:y.a.string,isLoadingMoreComments:y.a.bool.isRequired,hasNextComments:y.a.bool.isRequired,handleDisqusLogin:y.a.func.isRequired,isReporter:y.a.bool,isLiveBlog:y.a.bool,isLiveBlogOnline:y.a.bool,hasCommunity:y.a.bool,href:y.a.string},ac.defaultProps={isSafari:!1,isReporter:!1,isLiveBlog:!1,isLiveBlogOnline:!1};t.default=f()(Object(M.connect)((function(e){var t=e.moduleOptions,n=e.currentUser,a=e.registration,o=e.comments,r=e.conversation,s=e.isReadOnly,i=t.spotId,c=t.isStarsRatingEnabled,l=t.isConnectEnabled,u=t.enableSSO,d=t.useDisqusLogin,p=t.textsOverrides,m=t.direction,f=t.isSafari,h=t.hasCommunity,g=t.href,v=t.conversationId,y=t.editableSSO,b=t.forceRegister,E=a.verifyEmailSent,M=o.loadingFromShowMore,R=o.pagination.hasNext,S=o.list,C=A.m(e,n.id),O=A.j(e),k=A.k(e),w=A.d(e),I=A.e(e);return{spotId:i,isStarsRatingEnabled:c,isConnectEnabled:l,enableSSO:u,useDisqusLogin:d,verifyEmailSent:E,currentUser:n,loadMoreMessagesText:p.conversationLoadMoreMessagesText,isLoadingMoreComments:M,hasNextComments:R,direction:m,isSafari:f,conversation:r,isReporter:C,isLiveBlog:O,isLiveBlogOnline:k,hasCommunity:h,href:g,commentsList:S,liveBlogEndDate:w,liveBlogStartDate:I,conversationId:v,editableSSO:y,forceRegister:b,isReadOnly:s}}),(function(e){return{onVerifyEmailSend:function(t){var n=t.email,a=t.spotId,o=t.url;return e(Object(_s.e)({email:n,spotId:a,url:o}))},onLoadMore:function(){return e(function(){var e=Z()(J.a.mark((function e(t,n){var a,o,r,s,i,c,l,u,d,p,m,f,h,g,v,y,b,E,M,R,S;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(kt.a.apm.start("load_more_comments"),a=n(),o=A.j(a),r=A.l(a),s=Fs(r),i=a.moduleOptions,c=i.spotId,l=i.postId,u=i.eventCode,d=i.conversationId,p=i.href,m=i.canonicalHref,f=i.shouldCollapseReplies,h=i.pageSize,g=void 0===h?s:h,v=a.comments,y=v.pagination,b=y.offset,E=y.commentsRead,M=y.sortBy,R=v.isLoading,S=f?1:2,!o&&R){e.next=11;break}return e.next=10,t(os({spotId:c,postId:o?u:l,conversationId:d,href:p,canonicalHref:m,offset:b,commentsRead:E,pageSize:g,sortBy:M,depth:S,isFromShowMore:!0}));case 10:kt.a.apm.end("load_more_comments");case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},handleDisqusLogin:ho.a,onRatingsClick:function(t){e(Object(Qi.a)(t))},onLogin:function(){e(Object(At.a)({mode:"signup"}))},onProfileImageUpload:function(t){var n=t.rawImage;e(Object(ua.e)({rawImage:n}))},onOpenUserProfileModal:function(t){var n=t.user,a=t.overrideDisplayName,o=t.overrideImageId,r=t.mode;e(Object(Ft.a)({user:n,overrideDisplayName:a,overrideImageId:o,mode:r}))}}}),null,{forwardRef:!0}),C()({},{forwardRef:!0}))(ac)}}]);
//# sourceMappingURL=conversation-component-bundle.js.map