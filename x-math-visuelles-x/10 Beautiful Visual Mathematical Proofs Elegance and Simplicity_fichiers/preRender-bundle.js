(window.webpackJsonp_spotim_580132258=window.webpackJsonp_spotim_580132258||[]).push([[55],{896:function(e,t,n){"use strict";n.r(t);var a=n(22),i=n.n(a),r=n(23),s=n.n(r),o=n(4),c=n(0),d=n.n(c),l=n(5),u=n.n(l),p=n(12),g=(n(416),n(68)),m=n(6),v=n(2),f=n.n(v),h=n(8),b=n(248),O=n(43),j=n(219),y=f.a.get("tenant_config.shared.defensiveJsMode",!1),_=f.a.get("tenant_config.conversation.cssModulesForShadowDOM","conversation conversation-survey @spotim/ui-components @spotim/ads @spotim/user-image feed @spotim/entities @spotim/user-info @spotim/rich-editor @spotim/toast-provider @spotim/content-entities"),I=function(e){var t=Object(p.useSelector)((function(e){return e.appState})),n=t.isUserInitialized,a=t.isTranslationInitialize,i=t.isTokenInitialized;return Object(c.useEffect)((function(){n&&a&&i&&Object(h.b)(e.element)}),[n,a,i]),n&&a&&i?d.a.createElement(c.Suspense,{fallback:null},d.a.createElement(g.a,{container:e.element})):null};function x(e,t,n){var a,r=document.createElement("div");!(e.getRootNode()instanceof ShadowRoot)&&g.b&&r.attachShadow&&window.__SPOTIM__.stylesheetElementAdded&&(r.attachShadow({mode:"open"}),Object(m.exposeAnimationEvents)(r,{defensiveMode:y})),r.setAttribute("data-spot-im-shadow-host",_),e.appendChild(r),a=Object(j.a)(e),Object(b.a)(a).addEventListener("click",function(){var e=s()(i.a.mark((function e(t){var n,a,r,s,o,c,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=null===(n=(a=null==t?void 0:t.target).getAttribute)||void 0===n?void 0:n.call(a,"data-spot-im-class"))&&(c=null===(s=(o=null==t?void 0:t.target).getBoundingClientRect)||void 0===s?void 0:s.call(o),d=new CustomEvent(O.u,{detail:{spotImClass:r,elementTop:c.top}}),document.dispatchEvent(d));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),!1),u.a.render(d.a.createElement(c.Suspense,{fallback:null},d.a.createElement(p.Provider,{store:t.store},d.a.createElement(I,{element:e}))),r.shadowRoot||r,n)}n(788);var w=n(44);function E(e,t,n){var a=t.href,i=t.ignoreHostUrl,r=t.canonicalHref,s=t.highlight,o=t.disqusIdentifier,c=t.disqusUrl,d=t.gigyaStreamId,l=t.gigyaCategoryId,u=t.wpImportEndpoint,p=t.facebookUrl,g=t.livefyreUrl,m=t.iosUrl,v=t.androidUrl,f=t.isRecommendedPost,h=t.conversationAuthorId,b=t.conversationArticleTags,O=t.isConversationLiveBlog,j={platform:n?"mobile":"desktop"};if(h||b){var y={};h&&Object.assign(y,{author_id:h}),b&&Object.assign(y,{article_tags:b.trim()}),Object.assign(j,{metadata:y})}m&&Object.assign(j,{ios_url:m}),v&&Object.assign(j,{android_url:v}),f||Object.assign(j,{recommended_post:f}),a&&Object.assign(j,{host_url:a}),r&&Object.assign(j,{canonical_url:r}),s&&Object.assign(j,{highlight:s}),i&&Object.assign(j,{ignore_host_url:i}),O&&Object.assign(j,{is_conversation_live_blog:O});var _={};return o&&Object.assign(_,{disqus_identifier:o}),c&&Object.assign(_,{disqus_url:c}),d&&Object.assign(_,{gigya_streamid:d}),l&&Object.assign(_,{gigya_categoryid:l}),p&&Object.assign(_,{facebook_url:p}),g&&Object.assign(_,{livefyre_url:g}),u&&Object.assign(_,{wp_import_endpoint:u}),Object.keys(_).length>0&&Object.assign(j,{import_hints:_}),Object(w.a)("v1.0.0/conversation/async",{postId:e,method:"POST",data:j})}var T=n(355),S=n(249),k=n(37),C=n(444),R=n(74),M=n.n(R),A=n(194),B=["spsl","sections"];function P(e){var t,n={startTag:{startIndex:0,endIndex:0},endTag:{startIndex:e.length,endIndex:e.length},children:[],sections:[],parent:null,tagName:"root"},a=n,i=new A.Parser({onopentag(e,n){if(B.indexOf(e)>-1){var r=[];"sections"===e&&n.names&&r.push.apply(r,M()(n.names.split(","))),(t={children:[],sections:r,parent:a,tagName:e}).startTag={startIndex:i.startIndex,endIndex:i.endIndex+1},a.children.push(t),a=t}},onclosetag(e){B.indexOf(e)>-1&&a.tagName===e&&(a.endTag={startIndex:i.startIndex,endIndex:i.endIndex+1},a=a.parent)}},{recognizeSelfClosing:!1,xmlMode:!1});return i.write(e),i.end(),function e(t,n,a){var i=n.startTag,r=n.endTag,s=n.children,o=n.sections,c=i.endIndex,d=[],l={"*":""},u=[].concat(M()(a),M()(o)).filter((function(e,t,n){return n.indexOf(e)===t}));if(s.forEach((function(n){var a=t.substring(c,n.startTag.startIndex);d.push(a.trim());var i=e(t,n,u);c=n.endTag.endIndex,Object.keys(i).forEach((function(e){l[e]=l[e]||"",l[e]+=i[e]}))})),c<r.startIndex){var p=t.substring(c,r.startIndex);d.push(p.trim())}return(d=d.join("").trim()).length>0&&(u.length>0?u.forEach((function(e){l[e]=l[e]||"",l[e]=d+l[e]})):l["*"]=d+l["*"]),l}(e,n,[])}function U(e,t){var n=P(e);return n["*"]+(n[t]||"")}function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.id;if(!n||!document.getElementById(n)){var a=document.createElement("style");a.type="text/css",n&&(a.id=n),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e));var i=document.head||document.getElementsByTagName("head")[0];i.appendChild(a)}}var q=n(406),z=n(789),L=n.n(z);function H(){var e=L.a.stringify(),t=document.querySelector("div[data-svg-sprite]");t||(t=document.createElement("div")).setAttribute("data-svg-sprite","true"),t.innerHTML=e,document.body.appendChild(t)}var J=n(51);function D(e,t){return F.apply(this,arguments)}function F(){return(F=s()(i.a.mark((function e(t,n){var a,r,s,c,d,l,u,p,g,m,v;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Object(j.a)(t),r=n.store.getState(),s=n.postId,c=n.isConversationPage,d=n.isLiveBlog,l=n.contentType,u=Object(C.a)(r,a),p=u.styleBlock,g=u.scriptBlock,m=u.isMobile;try{c||(v=S.a&&!d&&Object(k.b)(r),Object(T.a)(s).startObservingOn(t,v||"conversation"))}catch(e){o.a.error("preRender","time-spent not properly initialized")}if(g)try{g=U(g,"conversation-frame"),Object(q.a)(t,void 0,{content:g})}catch(e){o.a.error("preRender",e)}if(p)try{N(p=U(p,"conversation-frame"))}catch(e){o.a.error("preRender",e)}x(t,n,(function(){g&&(g=U(g,"conversation-frame"),Object(q.a)(t,void 0,{content:g})),p&&N(p=U(p,"conversation-frame"));var e=Object(C.a)(n.store.getState(),a);l&&l!==J.b.Post&&E(s,e,m)})),H();case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n.d(t,"preRender",(function(){return D}))}}]);
//# sourceMappingURL=preRender-bundle.js.map