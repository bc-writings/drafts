(window.webpackJsonp_spotim_580132258=window.webpackJsonp_spotim_580132258||[]).push([[14],{170:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m}));var r=n(22),a=n.n(r),o=n(23),i=n.n(o),s=n(65);function c(e,t){var n={spot_id:e,conversation_id:t};return Object(s.a)("moderation/toggle-hide/spot/".concat(e,"/conversation/").concat(t),{data:n,method:"POST"})}function u(e){return l.apply(this,arguments)}function l(){return(l=i()(a.a.mark((function e(t){var n,r,o,i,c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spotId,r=t.conversationId,o=t.communityQuestion,e.next=3,Object(s.a)("moderation/community-question/spot/".concat(n,"/conversation/").concat(r),{data:{community_question:o},method:"POST"});case 3:return i=e.sent,c=i.body,u=c.success,e.abrupt("return",{isSuccess:!1!==u});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){var t=e.messageId;return Object(s.a)("moderation/internal/mark-as-global-spam/".concat(t),{method:"POST"})}function p(e){return f.apply(this,arguments)}function f(){return(f=i()(a.a.mark((function e(t){var n,r,o,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spotId,r=t.conversationId,e.next=3,Object(s.a)("moderation/conversation-default-policy/spot/".concat(n,"/conversation/").concat(r),{});case 3:return o=e.sent,i=o.body,c=i.default_policy,e.abrupt("return",{defaultPolicy:c});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=i()(a.a.mark((function e(t){var n,r,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.spotId,r=t.conversationId,o=t.newPolicy,e.next=3,Object(s.a)("moderation/conversation-default-policy/spot/".concat(n,"/conversation/").concat(r,"/").concat(o),{method:"POST"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},173:function(e,t,n){"use strict";var r=n(22),a=n.n(r),o=n(23),i=n.n(o),s=n(38),c=n(26),u=n(49),l=n(442),d=n(4),p=n(443),f=n(78),m=n(412);var v=n(115),g=n(44);function h(e,t){return y.apply(this,arguments)}function y(){return(y=i()(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={stars:t},e.next=3,Object(g.a)("v1.0.0/conversation/rate",{postId:n,method:"POST",data:r});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var b=n(69);function O(e){var t=e.rootMessageId,n=void 0===t?null:t,r=e.replyId,o=void 0===r?null:r,g=e.depth,h=void 0===g?0:g,y=e.entities,O=e.replyToStackId,I=void 0===O?null:O,k=e.parentMessageId,E=void 0===k?null:k,_=e.replyToUserId,C=void 0===_?null:_,j=e.replyToUsername,T=void 0===j?null:j,x=e.replyToDisplayName,S=void 0===x?null:x,P=e.displayName,M=void 0===P?null:P,R=e.starsRating,D=void 0===R?0:R,U=e.isRetry,N=void 0!==U&&U,L=e.id,B=void 0===L?void 0:L,A=e.dontModerate,V=void 0!==A&&A;return function(){var e=i()(a.a.mark((function e(t,r){var i,g,O,k,_,j,x,P,R,U,L,A;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r(),g=i.comments,O=i.currentUser,k=i.moduleOptions.forceRegister,_=D>0,j=!V&&!N&&Object(f.h)(i,E),x=g.failedMessageTemp,!N&&x&&t((q={message:null==x?void 0:x.message},{type:c.l,payload:q})),y&&0!==y.length||_){e.next=8;break}return e.abrupt("return",t({type:c.r,payload:{error:"Create message: no entities"},error:!0}));case 8:if((P=!!y.find((function(e){return e.type===m.a.TEXT&&e.text.length>0||e.type!==m.a.TEXT})))||_){e.next=11;break}return e.abrupt("return",t({type:c.r,payload:{error:"Create message: no content"},error:!0}));case 11:if(!k||O.isRegistered){e.next=13;break}return e.abrupt("return",t({type:c.r,payload:{error:"Force register to comment"},error:!0}));case 13:if(R=B||Object(v.a)(),U=y.map((function(e){switch(e.type){case m.a.TEXT:return Object(s.textToBackendJson)(e);case m.a.MENTION:return Object(s.mentionToBackendJson)(e);case m.a.IMAGE:return Object(s.imageToBackendJson)(e);case m.a.LINK:return Object(s.linkToBackendJson)(e);case m.a.VIDEO:return Object(s.videoToBackendJson)(e);case m.a.FRAME:return Object(s.frameToBackendJson)(e);case m.a.ANIMATION:return Object(s.animationToBackendJson)(e);default:return null}})),L={id:R,isTempId:!0,rootMessageId:n,postedAt:(a=new Date,a.getTime()/1e3),replyId:o,entities:y,userDisplayName:M,user:O,parentMessageId:E,replyToUserId:C,replyToUsername:T,replyToDisplayName:S,starsRating:D,depth:h},A="create_".concat(0===h?"comment":"reply"),d.a.apm.start(A),t({type:c.r,payload:{currentUser:O,isLoggedIn:Object(u.d)(O),message:L,replyToStackId:I,isRetry:N}}),Object(b.f)(O.id),P||!_){e.next=24;break}return e.abrupt("return",t(w({tempMessageId:R,message:L})));case 24:if(!j){e.next=26;break}return e.abrupt("return",t(Object(p.b)({entities:U,message:L,tempId:R,isRetry:N})));case 26:return e.abrupt("return",t(Object(l.a)({tempMessageId:R,message:L,isRetry:N})));case 27:case"end":return e.stop()}var a,q}),e)})));return function(t,n){return e.apply(this,arguments)}}()}function w(e){e.tempMessageId;var t=e.message;return function(){var e=i()(a.a.mark((function e(n,r){var o,i,s,l,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.starsRating,i=r(),s=i.currentUser,l=i.moduleOptions.postId,e.prev=2,d.a.apm.start("create_stars_rating"),e.next=6,h(o,l);case 6:if(p=e.sent,d.a.apm.end("create_stars_rating"),"ok"!==(null==p?void 0:p.status)){e.next=12;break}return e.abrupt("return",n({type:c.q,payload:{message:t,isLoggedIn:Object(u.d)(s)}}));case 12:return d.a.error("create_stars_rating","Create stars rating failed"),n({type:c.M,payload:{message:t}}),e.abrupt("return",n({type:c.q,payload:{error:"Create stars rating failed"},error:!0}));case 15:e.next=22;break;case 17:return e.prev=17,e.t0=e.catch(2),d.a.error("create_stars_rating",e.t0),n({type:c.M,payload:{message:t}}),e.abrupt("return",n({type:c.q,payload:{error:"Create stars rating failed",message:t},error:!0}));case 22:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t,n){return e.apply(this,arguments)}}()}n.d(t,"a",(function(){return O}))},174:function(e,t,n){"use strict";var r=n(44),a=function(e,t){return Object(r.a)("v1.0.0/moderation/verdict/afterclick",{method:"POST",postId:e,data:t})},o=function(e,t){return Object(r.a)("v1.0.0/moderation/verdict/realtime",{method:"POST",postId:e,data:t})},i=function(e){return Object(r.a)("v1.0.0/moderation/verdict/user-suspended",{method:"GET",postId:e,data:{}})};n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}))},248:function(e,t,n){"use strict";function r(e){return document.querySelector('[data-module-element-id="'.concat(e,'"] [data-spot-im-shadow-host]'))}function a(e){var t,n;return null!==(t=null===(n=r(e))||void 0===n?void 0:n.shadowRoot)&&void 0!==t?t:document}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},249:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),a=n.n(r).a.get("tenant_config.conversation.enable_community_view",!1)},397:function(e,t,n){"use strict";var r=n(24),a=n.n(r),o=n(25),i=n.n(o),s=n(27),c=n.n(s),u=n(28),l=n.n(u),d=n(29),p=n.n(d),f=n(40),m=n.n(f),v=n(0),g=n.n(v),h=n(38),y=n(673),b=n.n(y),O=n(398),w=n(11),I=n.n(w),k=n(45),E=n(39),_=n(34),C=n(35),j=n.n(C),T=n(80);function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var a=p()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return l()(this,n)}}var S=function(e){c()(n,e);var t=x(n);function n(){var e;a()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).handleClick=function(t){var n=e.props,r=n.tracking,a=n.onClick,o=n.postId;a({connectType:h.connectTypes.DISQUS,event:t});var i={type:"disqus-login-clicked",post_id:o};r.trackEvent(i)},e.handleDisqusLogin=function(t){13===t.keyCode&&e.handleClick(t)},e}return i()(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.t;return t=I()(t,b.a.disqusTitle),g.a.createElement("span",{className:t,onKeyUp:this.handleDisqusLogin,onClick:this.handleClick,"data-title":n("connectWithDisqus","Connect With Disqus"),"aria-label":n("connectWithDisqus","Connect With Disqus"),"data-balloon-pos":"up"},Object(E.b)()?g.a.createElement(k.a,{className:b.a.DisqusIcon,selector:"disqusIcon"}):g.a.createElement(T.a,{disableHover:!0,className:b.a.disqusText},g.a.createElement(_.a,{i18nKey:"connectWithDisqus"},"Connect With Disqus")),g.a.createElement("div",{className:b.a.disqusSpacer}))}}]),n}(v.Component);t.a=m()(j()({}),Object(O.a)())(S)},401:function(e,t,n){"use strict";function r(e,t,r){var a=r.duration,o=void 0===a?1e3:a,i=r.easing,s=void 0===i?"linear":i,c=r.delay,u=void 0===c?0:c,l=n(402)(e);return new Promise((function(e){window.requestAnimationFrame((function(){for(var n in t)t.hasOwnProperty(n)&&(l="scale"===n?l.scale(t[n]):l.set(n,t[n]));l=l.duration(o).ease(s).delay(u).end(e)}))}))}n.d(t,"a",(function(){return r}))},404:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(26);function a(e){var t=e.id;return{type:r.xb,payload:{message:{id:t,isMarked:!0}}}}},405:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n(22),a=n.n(r),o=n(23),i=n.n(o),s=n(248),c=n(401);function u(e){return l.apply(this,arguments)}function l(){return(l=i()(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.a)(t,{opacity:.5},{duration:133,easing:"linear"});case 2:return e.next=4,Object(c.a)(t,{opacity:1},{duration:133,easing:"linear",delay:133});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e,t){var n=Object(s.b)(t),r=function(e){return'[data-message-id="'.concat(e,'"]')}(e);return n.shadowRoot?n.shadowRoot.querySelector(r):n.querySelector(r)}function p(e,t){return f.apply(this,arguments)}function f(){return(f=i()(a.a.mark((function e(t,n){var r,o,i=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>2&&void 0!==i[2]&&i[2],o=d(t,n)){e.next=4;break}return e.abrupt("return");case 4:r||o.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout((function(){u(o)}),3e3);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},406:function(e,t,n){"use strict";t.a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.content,a=n.attributes;return new Promise((function(n,o){var i=document.createElement("script");if(i.type="text/javascript",t&&(i.addEventListener("load",n,!1),i.addEventListener("error",o,!1),i.src=t),r&&(i.text=r),a&&Object.keys(a).forEach((function(e){i.setAttribute(e,a[e])})),e.appendChild(i),!t)return n()}))}},408:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(22),a=n.n(r),o=n(23),i=n.n(o),s=n(26),c=n(4),u=n(170);function l(){return function(){var e=i()(a.a.mark((function e(t,n){var r,o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=n(),o=r.conversation.id,i=r.moduleOptions.spotId,t({type:s.eb}),e.next=5,Object(u.d)(i,o);case 5:t({type:s.hb}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),t({type:s.hb,payload:{error:e.t0,spotId:spotId,conversationId:conversationId},error:!0}),c.a.error("toggleHideConversation",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}()}},410:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(26),a=n(37),o=n(83),i=n(76),s=n(345),c=n(3),u=n(43);function l(e){return function(t,n){var l=n(),d=l.conversation,p=l.comments.list,f=l.moduleOptions.isConversationLiveBlog,m=l.liveBlogConfig,v=Object(s.a)(e),g=v.user,h=v.message;if(!o.c(p,h.id)){h.isNew=!0;var y=i.b({message:h,id:h.id});t({type:r.W,payload:{user:g,message:h,shouldAggregate:Object(a.n)(l),messageStack:y}})}var b={source:f?"live-blog":"conversation",[f?"eventCode":"postId"]:d.postId,fromUser:{id:g.id,username:g.username,displayName:g.displayName},message:{type:0===h.depth?"comment":"reply",time:new Date(1e3*h.postedAt).getTime()}};if(f){var O=m.reporters.includes(g.id);b.fromUser.isReporter=O}Object(c.dispatchSpotimEvent)(u.r,b)}}},412:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.TEXT="text",e.IMAGE="image",e.LINK="link",e.VIDEO="video",e.MENTION="user-mention",e.FRAME="frame",e.ANIMATION="animation"}(r||(r={}))},413:function(e,t,n){"use strict";var r=n(2),a=n.n(r);t.a=function(){return"dark"===a.a.get("init_data.config.inpage_skin")}},442:function(e,t,n){"use strict";var r=n(22),a=n.n(r),o=n(30),i=n.n(o),s=n(23),c=n.n(s),u=n(26),l=n(49),d=n(4),p=n(2),f=n.n(p),m=n(118),v=n(174),g=n(93),h=n(67),y=n(38),b=function(e,t){return Object(h.h)("message/".concat(t,"/status"),{method:"GET",postId:e,data:{}})},O=f.a.get("tenant_config.conversation.status_fetch_interval_in_ms",300),w=f.a.get("tenant_config.conversation.status_fetch_timeout_in_ms",3e3),I=f.a.get("tenant_config.conversation.status_fetch_retry_count",12),k=f.a.get("tenant_config.conversation.status_fetch_default_fallback_status",y.statuses.APPROVED);function E(e,t){return _.apply(this,arguments)}function _(){return(_=c()(a.a.mark((function e(t,n){var r,o,i,s=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>2&&void 0!==s[2]?s[2]:0,e.prev=1,!(++r<=I)){e.next=15;break}return e.next=6,b(n,t);case 6:if(o=e.sent,"processing"!==(i=o.status)){e.next=12;break}return e.next=11,C(O);case 11:return e.abrupt("return",E(t,n,r));case 12:return e.abrupt("return",i);case 15:if(status){e.next=19;break}return e.abrupt("return",k);case 19:return e.abrupt("return",status);case 20:e.next=26;break;case 22:return e.prev=22,e.t0=e.catch(1),d.a.error("runFetchMessageStatus",e.t0),e.abrupt("return",E(t,n,r));case 26:case"end":return e.stop()}}),e,null,[[1,22]])})))).apply(this,arguments)}function C(e){return j.apply(this,arguments)}function j(){return(j=c()(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,t)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,t){return new Promise(function(){var n=c()(a.a.mark((function n(r){var o,i;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=setTimeout((function(){r(k)}),w),n.next=3,E(e,t);case 3:i=n.sent,r(i),clearTimeout(o);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}var x=function(e,t){return Object(h.h)("retry-status/".concat(e),{method:"GET",postId:t,data:{}})};function S(e,t,n,r){return Object.assign(e,{entities:e.entities?e.entities:e.content,type:t,commenter_id:r,metadata:{scope:n},stars:e.stars,users:[],starsRating:e.stars}),delete e.content,e}function P(e){return e&&"processing"!==e?e:""}var M=n(3),R=n(43);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n.d(t,"a",(function(){return L}));var N=f.a.get("tenant_config.moderation.retry_debug_enabled",!1);function L(e){var t=e.tempMessageId,n=e.message,r=e.isRetry,o=void 0!==r&&r;return function(){var e=c()(a.a.mark((function e(r,i){var s,c,p,g,y,b,O,w,I,k,E,_,C,j,D,L,V,q,H,W,F,G,K,Q,J,z;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=(s=n).rootMessageId,p=s.replyId,g=s.depth,y=s.entities,b=s.replyToStackId,O=s.parentMessageId,w=s.replyToUserId,I=s.replyToUsername,k=s.replyToDisplayName,E=s.userDisplayName,_=s.starsRating,C=i(),j=C.currentUser,D=C.conversation,L=C.moduleOptions.postId,V=f.a.get("tenant_config.moderation.content_aware_events",!1),q=A(i,n),H=y.filter((function(e){return"text"!==e.type||"text"===e.type&&""!==e.text})),W=g>0?"reply":"comment",Object(M.dispatchSpotimEvent)(R.k,{postId:L}),G=!0,!o){e.next=21;break}return e.prev=9,e.next=12,x(t,L);case 12:K=e.sent,Q=K.message_id,J=K.status,Q&&(G=!1,r((Z={tempMessageId:t,messageId:Q},{type:u.j,payload:Z})),n.id=Q,n.status=P(J),F=U(U({},F),{},{body:n})),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(9),d.a.error("publishMessage",e.t0);case 21:if(e.prev=21,!G){e.next=35;break}if(!(g>0)){e.next=30;break}return z=g>1?O:null,e.next=27,h.e({conversationId:D.id,rootMessageId:c,replyToMessageId:z,entities:H,postId:L,displayName:E,contentType:D.contentType,tempMessageId:t,starsRating:_});case 27:F=e.sent,e.next=33;break;case 30:return e.next=32,h.d({conversationId:D.id,postId:L,entities:H,displayName:E,tempMessageId:t,contentType:D.contentType,starsRating:_});case 32:F=e.sent;case 33:if(!N){e.next=35;break}throw new Error("Retry Debug Error");case 35:e.next=41;break;case 37:return e.prev=37,e.t1=e.catch(21),d.a.error("publishMessage",e.t1),e.abrupt("return",r({type:u.q,payload:{error:e.t1,message:{id:t,rootMessageId:c,parentMessageId:O,replyId:p,depth:g,entities:H,replyToStackId:b,replyToUserId:w,replyToUsername:I,replyToDisplayName:k,displayName:E,starsRating:_,user:j},isRetry:o},error:!0}));case 41:if(e.prev=41,!F){e.next=53;break}if(""!==(n=S(F.body,W,D.contentType,j.id)).status){e.next=48;break}return e.next=47,T(n.id,L);case 47:n.status=e.sent;case 48:return Object.assign(n,{depth:g,tempMessageId:t,isTempId:!1,isNew:!0,parentMessageId:O,replyToUserId:w,replyToUsername:I,replyToDisplayName:k,rootMessageId:c,user:j}),V&&Object(v.a)(L,{content:H,stars:_,metadata:{},unique_content_id:q.tempMessageId||t,actual_message_id:n.id}),B(i,{message:n,currentUser:j,tempMessageId:t}),n.status=(a=n.status,X=void 0,Y=void 0,X=a,Y=f.a.get("init_data.config.policy.roger_mode",!1),"require_approval"===a&&(X=m.d),"block_all"===a&&(X=m.b),X!==m.a&&Y&&(X=m.a),X),e.abrupt("return",r({type:u.q,payload:{message:n,isLoggedIn:Object(l.d)(j),isRetry:o}}));case 53:e.next=58;break;case 55:e.prev=55,e.t2=e.catch(41),d.a.error("publishMessage",e.t2);case 58:case"end":return e.stop()}var a,X,Y,Z}),e,null,[[9,18],[21,37],[41,55]])})));return function(t,n){return e.apply(this,arguments)}}()}function B(e,t){var n=t.message,r=t.currentUser,a=t.tempMessageId,o=A(e,n),i=e(),s=i.moduleOptions.postId,c=i.conversation,u=U({message_id:n.id,user_id:r.id,is_registered:r.isRegistered,conversation_id:c.id,post_id:s,native:o.tempMessageId||a},function(e,t){return{item_id:(n=t,r=n.isMessageBlocked,a=n.isModerationAlertVisible,r?a?"post-anyway":"after-edit":"first-try"),segment:e.status};var n,r,a}(n,o));0===n.depth?Object.assign(u,{type:"commented"}):n.depth>0&&Object.assign(u,{type:"replied",relatedMessageId:n.parentMessageId}),Object(g.analyticsTrack)(u)}function A(e,t){var n=e(),r=n.mainSayControl,a=n.messageSayControls;return t.depth>0&&t.parentMessageId?a[t.parentMessageId]:r}},443:function(e,t,n){"use strict";var r=n(22),a=n.n(r),o=n(23),i=n.n(o),s=n(442),c=n(26),u=n(30),l=n.n(u),d=n(50),p=n.n(d),f=n(93);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var v=function(e){return function(t,n){var r,a=null===(r=n())||void 0===r?void 0:r.moduleOptions,o=a.spotId,i=a.postId;Object(f.analyticsTrack)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({spot_id:o,post_id:i},e))}};function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var h=function(e){return function(t,n){var r=n().currentUser,a=r.isRegistered,o=r.id;t(v(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({item_type:"realtime-moderation",user_id:o,is_registered:a},e)))}};function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e){var t=e.isUserSuspended,n=e.verdict,r=e.taggers,a=e.isMessageBlockedVerdict,o=p()(e,["isUserSuspended","verdict","taggers","isMessageBlockedVerdict"]);return function(e,i){return t&&e(h({type:"suspension-triggered"})),e({type:c.Eb,payload:b({isUserSuspended:t,verdict:n,taggers:r,isMessageBlockedVerdict:a},o)})}}var w=n(78),I=n(174),k=n(412),E=n(119),_=n(4),C=n(49);function j(e){var t=e.entities,n=void 0===t?[]:t,r=e.message,o=e.tempId,u=e.isRetry;return function(){var e=i()(a.a.mark((function e(t,i){var l,d,p,f,m,v,g,h,y;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l=r.starsRating,d=r.user,p=T(n),f=i(),m=f.moduleOptions.postId,e.next=6,Object(I.a)(m,{content:p,stars:l,metadata:{},unique_content_id:o});case 6:if(v=e.sent,g=v.verdict,h=v.tags,y=w.c(g,h),!(w.f()&&h.includes(E.a.SUSPENDED))){e.next=13;break}return e.abrupt("return",t(O({currentUser:d,isUserSuspended:!0,isLoggedIn:Object(C.d)(d),message:r,verdict:g,taggers:h,isMessageBlockedVerdict:y})));case 13:if(!y){e.next=15;break}return e.abrupt("return",t({type:c.I,payload:{currentUser:d,isLoggedIn:Object(C.d)(d),message:r,verdict:g,taggers:h,isMessageBlockedVerdict:y,tempId:o}}));case 15:return e.abrupt("return",t(Object(s.a)({tempMessageId:o,message:r,isRetry:u,isMessageBlockedVerdict:y,taggers:h,verdict:g})));case 18:return e.prev=18,e.t0=e.catch(0),_.a.error("moderateAndPublishMessage",e.t0),e.abrupt("return",t(Object(s.a)({tempMessageId:o,message:r,isRetry:u})));case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}()}function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.find((function(e){return e.type===k.a.TEXT&&0===e.text.length}));return e.length>1&&t?e.filter((function(e){return e.type!==k.a.TEXT})):e}n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return T}))},448:function(e,t,n){"use strict";var r=n(22),a=n.n(r),o=n(23),i=n.n(o),s=n(2),c=n.n(s),u=n(136),l=n(65);function d(e){var t=e.spotId,n=e.messageDepth,r={spot_id:t,message_type:0===(void 0===n?0:n)?"comment":"reply",message_id:e.messageId};return Object(l.a)("conversation-read/message-ref",{method:"POST",data:r})}var p=n(44);function f(e){var t=e.spotId,n=e.postId,r=e.messageDepth,a={spot_id:t,entity_type:0===(void 0===r?0:r)?"comment":"reply",entity_id:e.messageId};return Object(p.a)("v1.0.0/share/message",{method:"POST",postId:n,data:a})}var m=n(33);n.d(t,"a",(function(){return g}));var v=c.a.get("tenant_config.shared.share_api_version",1);function g(e){return h.apply(this,arguments)}function h(){return(h=i()(a.a.mark((function e(t){var n,r,o,i,s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.messageDepth,r=t.messageId,o=t.postId,1!==v){e.next=8;break}return e.next=4,d({spotId:m.x,messageDepth:n,messageId:r});case 4:i=e.sent,s=i.body.reference,e.next=12;break;case 8:return e.next=10,f({spotId:m.x,messageDepth:n,messageId:r,postId:o});case 10:i=e.sent,s=i.reference;case 12:return c=u.a.urls.share.replace("{REFERENCE_ID}",s),e.abrupt("return",c);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},66:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(22),a=n.n(r),o=n(23),i=n.n(o),s=n(49),c=n(4),u=n(105);function l(e){var t,n,r=null!==(t=null==e?void 0:e.mode)&&void 0!==t?t:"signin",o=null!==(n=null==e?void 0:e.username)&&void 0!==n?n:"";return function(){var e=i()(a.a.mark((function e(t,n){var i,l,d,p,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{i=n(),l=i.currentUser,d=i.moduleOptions,p=d.shouldOpenLogin,f=d.isConnectEnabled,!p||!f||Object(s.d)(l)&&"signin"===r||Object(u.c)({mode:r,username:o})}catch(e){c.a.error("openLoginSelectorModal",e)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}},67:function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return g})),n.d(t,"f",(function(){return y})),n.d(t,"l",(function(){return O})),n.d(t,"b",(function(){return I})),n.d(t,"k",(function(){return E})),n.d(t,"a",(function(){return C})),n.d(t,"j",(function(){return T})),n.d(t,"c",(function(){return S})),n.d(t,"i",(function(){return M})),n.d(t,"h",(function(){return D}));var r=n(22),a=n.n(r),o=n(30),i=n.n(o),s=n(23),c=n.n(s),u=n(44);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e){return f.apply(this,arguments)}function f(){return(f=c()(a.a.mark((function e(t){var n,r,o,i,s,c,u,l,p,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.conversationId,o=t.postId,i=t.entities,s=t.contentType,c=t.displayName,u=t.tempMessageId,l=t.starsRating,e.next=3,D("".concat(s,"/").concat(r,"/comment"),{method:"POST",data:{content:i,metadata:d(d({},c?{display_name:c}:{}),{},{reply_to:{}}),temp_id:u,stars:l},postId:o});case 3:return p=e.sent,(f=null==p?void 0:p.message).users=null!==(n=null==f?void 0:f.users)&&void 0!==n?n:[],e.abrupt("return",{body:f});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=c()(a.a.mark((function e(t){var n,r,o,i,s,c,u,l,p,f,m,v,g;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.conversationId,o=t.replyToMessageId,i=t.rootMessageId,s=t.entities,c=t.displayName,u=t.postId,l=t.contentType,p=t.tempMessageId,f=t.starsRating,m=o?{reply_id:o}:{},e.next=4,D("".concat(l,"/").concat(r,"/comment/").concat(i,"/reply"),{method:"POST",data:{content:s,metadata:d(d({},c?{display_name:c}:{}),{},{reply_to:m}),temp_id:p,stars:f},postId:u});case 4:return v=e.sent,(g=null==v?void 0:v.message).users=null!==(n=null==g?void 0:g.users)&&void 0!==n?n:[],e.abrupt("return",{body:g});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return(h=c()(a.a.mark((function e(t){var n,r,o,i,s,c,u,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.messageId,o=t.entities,i=t.displayName,s=t.postId,c=t.starsRating,e.next=3,D("message/".concat(r),{method:"PATCH",data:{content:o,metadata:d(d({},i?{display_name:i}:{}),{},{reply_to:{}}),stars:c},postId:s});case 3:return u=e.sent,(l=null==u?void 0:u.message).users=null!==(n=null==l?void 0:l.users)&&void 0!==n?n:[],e.abrupt("return",{body:l});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,t){return b.apply(this,arguments)}function b(){return(b=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D("message/".concat(t),{method:"DELETE",data:{},postId:n});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:return e.abrupt("return",{body:{etag:0,messages_count:0,comments_count:0}});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function O(e,t){return w.apply(this,arguments)}function w(){return(w=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D("message/report",{method:"POST",data:{message_id:t},postId:n});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:return e.abrupt("return",{});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function I(e,t,n){return k.apply(this,arguments)}function k(){return(k=c()(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("block-user",{method:"POST",data:{user:t,source:"conversation",apply_to_history:r},postId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t){return _.apply(this,arguments)}function _(){return(_=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("block-user",{method:"DELETE",data:{user:t,source:"conversation"},postId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){return j.apply(this,arguments)}function j(){return(j=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("allow-user",{method:"POST",data:{user:t,source:"conversation"},postId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,t){return x.apply(this,arguments)}function x(){return(x=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("allow-user",{method:"DELETE",data:{user:t,source:"conversation"},postId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t){return P.apply(this,arguments)}function P(){return(P=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("messages/approve",{method:"POST",data:t,postId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t){return R.apply(this,arguments)}function R(){return(R=c()(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D("messages/block",{method:"POST",data:t,postId:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t){return Object(u.a)("v1.0.0/moderation/".concat(e),t)}},68:function(e,t,n){"use strict";var r=n(55),a=n.n(r),o=n(24),i=n.n(o),s=n(25),c=n.n(s),u=n(27),l=n.n(u),d=n(28),p=n.n(d),f=n(29),m=n.n(f),v=n(22),g=n.n(v),h=n(23),y=n.n(h),b=n(30),O=n.n(b),w=n(40),I=n.n(w),k=n(247),E=n.n(k),_=n(0),C=n.n(_),j=n(32),T=n.n(j),x=n(11),S=n.n(x),P=n(12),M=n(35),R=n.n(M),D=n(398),U=n(699),N=n.n(U),L=n(700),B=n.n(L),A=n(31),V=n(2),q=n.n(V),H=n(136),W=n(65);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function K(e){return Q.apply(this,arguments)}function Q(){return(Q=y()(g.a.mark((function e(t){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(W.a)("tracker/track",{method:"POST",data:G({},t)});case 2:return n=e.sent,r=n.body,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var J=n(3),z=n(43);function X(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Z(e){!function(e){$.apply(this,arguments)}({url:e.url,newTab:e.newTab,referTraffic:e.referTraffic,href:e.href})}function $(){return($=y()(g.a.mark((function e(t){var n,r,a,o,i,s,c,u,l,d,p;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.url,r=t.disableNavigation,a=t.referTraffic,o=t.href,i=t.redirectUrl,s=t.newTab,c=void 0!==s&&s,a){e.next=26;break}if(0!==n.indexOf(i)){e.next=26;break}n=n.substr(n.indexOf("#")+1),n=decodeURIComponent(n),u=n.split("&"),l=X(u),e.prev=7,l.s();case 9:if((d=l.n()).done){e.next=18;break}if("to_url"!==(p=d.value).split("=")[0]){e.next=16;break}return n=decodeURIComponent(p.split("=")[1]),e.next=15,te(u,o);case 15:return e.abrupt("break",18);case 16:e.next=9;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(7),l.e(e.t0);case 23:return e.prev=23,l.f(),e.finish(23);case 26:Object(J.dispatchSpotimEvent)(z.o,{detail:{url:n}}),r||ee(n,c);case 28:case"end":return e.stop()}}),e,null,[[7,20,23,26]])})))).apply(this,arguments)}function ee(e,t){var n=document.createElement("a");n.setAttribute("href",e),"http:"!==n.protocol&&"https:"!==n.protocol||e.length&&(t?window.open(e,"_blank"):window.location.href=e)}function te(e,t){return ne.apply(this,arguments)}function ne(){return(ne=y()(g.a.mark((function e(t,n){var r,a,o,i,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={},a=X(t);try{for(a.s();!(o=a.n()).done;)i=o.value,r[i.split("=")[0]]=i.split("=")[1]}catch(e){a.e(e)}finally{a.f()}return s={events:[{type:"generated-page-view",version:1,value:{from:{spot_id:r.from_spot,source:r.source,url:n},to:{spot_id:r.to_spot,url:r.to_url}}}]},e.next=6,K(s);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re=n(50),ae=n.n(re),oe=n(26),ie=n(404),se=n(405),ce=n(44),ue=n(148),le=n(104);function de(e,t,n){return pe.apply(this,arguments)}function pe(){return(pe=y()(g.a.mark((function e(t,n,r){var a,o,i,s,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ce.a)("v1.0.0/conversation/read",{method:"POST",data:{count:20,offset:0,sort_by:"newest",depth:n,message_id:t},postId:r});case 2:return a=e.sent,o=a.conversation.comments[0],i=o.replies,(s=ae()(o,["replies"])).replies=[],i.unshift(s),c={comments:Object(ue.a)(i),users:a.conversation.users},e.abrupt("return",Object(le.b)(a.conversation.conversation_id,c));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fe=n(39),me=n(397),ve=n(105),ge=n(701),he=n.n(ge),ye=n(86),be=n(66),Oe=n(702),we=n.n(Oe);function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var a=m()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var ke=function(e){l()(n,e);var t=Ie(n);function n(){var e;i()(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).userImageRef=C.a.createRef(),e}return c()(n,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.disableUserProfileModal,r=S()(we.a.faceItem,{[we.a.notClickable]:n});return C.a.createElement("div",{className:we.a.faceItem,key:t.id},C.a.createElement(ye.a,{disableUserImageUpload:!0,className:r,size:30,disableOnlineIndicator:!0,user:t}))}}]),n}(_.Component);ke.defaultProps={openUserProfileModal:function(){},userNickName:null,spotId:null};var Ee=I()(Object(P.connect)((function(e){return{spotId:e.moduleOptions.spotId,token:e.authentication.token,enableSSO:e.moduleOptions.enableSSO,disableUserProfileModal:e.moduleOptions.disableUserProfileModal,disableProfileHover:e.moduleOptions.disableProfileHover}}),{onLogin:be.a}),R()({}))(ke);function _e(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var a=m()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var Ce=function(e){l()(n,e);var t=_e(n);function n(){return i()(this,n),t.apply(this,arguments)}return c()(n,[{key:"shouldComponentUpdate",value:function(e){var t=this.props.avatars,n=e.avatars;if(this.props.width!==e.width)return!0;if(t.length!==n.length)return!0;var r=t.map((function(e){return e.id})),a=n.map((function(e){return e.id}));return r.filter((function(e){return!a.includes(e)})).length>0}},{key:"render",value:function(){var e=this.props,t=e.avatars,n=e.currentUserId,r=e.isLoggedIn,a=e.openUserProfileModal,o=e.reporterBadgeText,i=e.moderatorBadgeText,s=e.style,c=e.spotName;return C.a.createElement("div",{className:he.a.container},C.a.createElement("section",{style:s,className:he.a.facesList,"data-spot-im-class":"faces-list"},t.slice(0,20).map((function(e){var t=e.id===n;return C.a.createElement("div",{className:he.a.faceItemWrapper,key:e.id},C.a.createElement(Ee,{user:e,imageId:e.imageId,isMe:t,isLoggedIn:r,spotName:c,openUserProfileModal:a,reporterBadgeText:o,moderatorBadgeText:i}))}))),C.a.createElement("svg",{className:he.a.faceSvgMask},C.a.createElement("defs",null,C.a.createElement("clipPath",{id:"faceItemMask"},C.a.createElement("path",{d:"M15,0 C19.9070141,0 24.2636994,2.35623795 27.0003635,5.99902151 C25.1161248,8.50617072 24,11.6227429 24,15 C24,18.3772571 25.1161248,21.4938293 26.9996365,24.0009785 C24.2636994,27.6437621 19.9070141,30 15,30 C6.71572875,30 0,23.2842712 0,15 C0,6.71572875 6.71572875,0 15,0 Z",id:"Combined-Shape"})))))}}]),n}(_.Component);Ce.defaultProps={avatars:[]};var je=Object(P.connect)((function(e){return{spotId:e.moduleOptions.spotId}}))(Ce),Te=n(94),xe=n(37),Se=n(49),Pe=n(161),Me=n(38),Re=n(703),De=n.n(Re),Ue=function(e){var t=e.onClose,n=e.onImportClicked,r=Object(Pe.a)().t;return C.a.createElement("div",{className:De.a.disqusWelcomeContainer,"data-spotim-class":"disqus-welcome-container"},C.a.createElement("span",{className:De.a.icon},C.a.createElement(A.Icon,{name:"spotim-bubbles",type:"custom"})),C.a.createElement("div",{className:De.a.textPlaceholder},C.a.createElement(A.Typography,{type:"h3",weight:"bold"},r("disqusWelcome.meetYourCommunity","Meet your new conversation!")),C.a.createElement(A.Typography,{type:"modalBody",className:De.a.margin},r("disqusWelcome.importDisqusProfile","Create your new profile by importing your Disqus information")),C.a.createElement(A.Button,{mode:"primary",onClick:function(){return n({connectType:Me.connectTypes.DISQUS})}},r("disqusWelcome.importProfile","Import Profile"))),C.a.createElement(A.CloseButton,{onClick:t,className:De.a.closeButton}))},Ne=n(704),Le=n.n(Ne),Be=n(34),Ae=n(249),Ve=n(216),qe=n(706),He=n.n(qe),We=n(51),Fe=n(106),Ge=n(707),Ke=n.n(Ge),Qe=function(e){var t=e.children;return C.a.createElement("span",{className:Ke.a.wrapper},C.a.createElement("span",{className:Ke.a.normal},t),C.a.createElement("span",{className:Ke.a.strong},t))},Je=n(450),ze=q.a.get("tenant_config.communityView.reverseTabsOrder",!1),Xe=function(e){var t=e.selectedCommunityView,n=e.handleTabClick;return C.a.createElement(C.a.Fragment,null,C.a.createElement(A.Button,{className:S()(He.a.tabButton,{[He.a.selected]:t===We.a.Explore}),onClick:function(){return n(We.a.Explore)}},C.a.createElement(A.Typography,{type:"product-heading",className:He.a.headerText},C.a.createElement(Qe,null,C.a.createElement(Be.a,{i18nKey:"inpage.header.explore"},"Explore")))),C.a.createElement("div",{className:He.a.marginVMd}))},Ye=Object(P.connect)((function(e){var t=e.moduleOptions,n=e.conversation,r=t.isStarsRatingEnabled,a=t.textsOverrides,o=t.spotId,i=t.isConversationPage;return{isStarsRatingEnabled:r,conversationHeaderText:a.conversationHeaderText,starsRatingHeaderText:a.starsRatingHeaderText,isLiveBlog:xe.j(e),messagesCount:n.messagesCount,spotId:o,selectedCommunityView:xe.b(e),isConversationPage:i}}),(function(e){return{setCommunityView(t){e(Object(Fe.a)(t))},preloadConversation(){e({type:oe.S})}}}))((function(e){var t,n=e.isStarsRatingEnabled,r=e.isLiveBlog,a=e.conversationHeaderText,o=e.starsRatingHeaderText,i=e.messagesCount,s=void 0===i?0:i,c=e.selectedCommunityView,u=e.isConversationPage,l=e.setCommunityView,d=e.preloadConversation,p=Object(M.useTracking)();function f(e){l(e),p.trackEvent({type:"change-tab-clicked",item_type:e.toLowerCase()})}if(r)return null;var m=Ae.a&&!r&&!u;return n?t=o||C.a.createElement(Be.a,{i18nKey:"inpage.header.starsRating"}):a&&(t=a),C.a.createElement("div",{className:S()(He.a.headers,(Ve.b===We.a.Conversation||ze)&&He.a.reversed,!m&&He.a.singleTab),onMouseEnter:Le()(d)},m&&C.a.createElement(Xe,{selectedCommunityView:c,handleTabClick:function(){return f(We.a.Explore)}}),C.a.createElement(Je.a,{enableCommunityViewOptions:m,selectedCommunityView:c,handleTabClick:function(){return f(We.a.Conversation)},handleConversationHeaderGotFocus:function(){var e;null===(e=document.querySelector('[tabindex="2"]'))||void 0===e||e.focus()},headerText:t,messagesCount:s}))})),Ze=n(407),$e=n.n(Ze),et=n(36),tt=n.n(et),nt=n(4),rt=/\{\{linkValue\}\}/g,at=/\{\{modalValue\}\}/g,ot=function(e){var t=e.onModalLinkClick,n=e.title,r=n.value,a=n.linkValue,o=n.modalValue,i=n.linkUrl,s=null;function c(e,t){var n=(e||"").replace(rt,"<a class=".concat("spcv_modal-link-text",' target="_blank" rel="noopener noreferrer" href="').concat(i,'">').concat(a,"</a>"));if(n.length)return C.a.createElement("span",{key:t,dangerouslySetInnerHTML:{__html:n}})}if(!r)return nt.a.error("CustomCommunityGuidelinesTitle","missing title"),null;var u=r.split(at),l=tt()(u,2),d=l[0],p=l[1],f=c(d,"1"),m=c(p,"3");return o&&(s=function(e,n){return C.a.createElement("a",{key:n,onClick:t,className:$e.a.modalLinkText},e)}(o,"2")),C.a.createElement(C.a.Fragment,null,[f,s,m].filter((function(e){return e})))},it=function(e){var t,n,r=e.onModalLinkClick,a=e.title,o=Object(Pe.a)("community-guidelines").t,i=a.value,s=a.key,c=a.modalValue,u=a.linkUrl,l=a.linkValue,d=o("".concat(s,".value"),i,{modalValue:"{{modalValue}}",linkUrl:"{{linkUrl}}",linkValue:"{{linkValue}}"});return c&&(t=o("".concat(s,".modalValue"),c)),l&&(n=o("".concat(s,".linkValue"),l)),C.a.createElement(ot,{title:{value:d,modalValue:t,linkValue:n,linkUrl:u},onModalLinkClick:r})},st=n(69),ct=q.a.get("tenant_config.conversation.communityGuidelinesEnabled",!1),ut=q.a.get("tenant_config.conversation.communityGuidelinesTitle",{key:"defaultTitle.0",value:"Your voice matters. Discussions are moderated for civility."}),lt=Object(P.connect)((function(e){return{postId:e.conversation.postId,isLiveBlog:xe.j(e)}}))((function(e){var t=e.isLiveBlog,n=e.postId,r=Object(M.useTracking)();function a(){r.trackEvent({type:"community-guidelines-clicked",item_type:"community-guidelines-page",target_type:"main"}),Object(st.g)(n)}var o="CUSTOM"===(ct&&ut&&ut.key?"DEFAULT":"CUSTOM")?C.a.createElement(ot,{title:ut,onModalLinkClick:a}):C.a.createElement(it,{title:ut,onModalLinkClick:a});return ct&&C.a.createElement(_.Fragment,null,!t&&C.a.createElement(A.Typography,{type:"product-sub-heading",className:$e.a.subheaderContainer},o))})),dt=n(126);var pt=n(710),ft=n.n(pt);function mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var a=m()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var vt=q.a.get("tenant_config.conversation.communityGuidelinesEnabled"),gt=q.a.get("tenant_config.conversation.disable_header_facelist",!1),ht=function(e){l()(n,e);var t=mt(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).headerRef=C.a.createRef(),r.openDiscusForumAccount=function(){Object(J.dispatchSpotimEvent)(dt.d)},r.state={showDisqusHeader:q.a.get("tenant_config.conversation.show_disqus_header",!1)},r}return c()(n,[{key:"componentDidUpdate",value:function(){var e,t;this.props.scrollToHeader&&(!this.headerRef.current||(e=this.headerRef.current,(t=e.getBoundingClientRect()).top>=0&&t.top<window.innerHeight||t.top<0&&t.bottom>0)||(this.headerRef.current.scrollIntoView(),this.props.finishScrollToHeader()))}},{key:"render",value:function(){var e,t,n=this,r=this.state.showDisqusHeader,a=this.props,o=a.spotName,i=a.isLoggedIn,s=a.currentUserId,c=a.followers,u=a.useDisqusLogin,l=a.enableConversationHeaderFacesList,d=a.reporters,p=a.handleDisqusLogin,f=a.openUserProfileModal,m=a.reporterBadgeText,v=a.moderatorBadgeText,g=a.isLiveBlog,h=a.postId,y=a.isPostPage,b=a.isReadOnly;!i&&u&&(C.a.createElement(me.a,{onClick:p,postId:h}),t=!g&&r&&C.a.createElement(Ue,{onImportClicked:p,onClose:function(){return n.setState({showDisqusHeader:!1})}})),!gt&&l&&(e=!fe.a&&C.a.createElement(je,{avatars:c,reporters:d,openUserProfileModal:f,spotName:o,reporterBadgeText:m,moderatorBadgeText:v,isLoggedIn:i,currentUserId:s}));var O=S()(ft.a.conversationHeader,{[ft.a.noFaces]:!l});return g||y?null:C.a.createElement("div",{ref:this.headerRef,className:O,"data-spot-im-class":"conversation-header"},t,C.a.createElement("div",{className:ft.a.info},C.a.createElement("div",{className:ft.a.leftArea},C.a.createElement("div",{className:ft.a.titleFacesWrapper},C.a.createElement(Ye,null),e),!b&&vt&&C.a.createElement(lt,null)),void 0))}}]),n}(C.a.Component);ht.defaultProps={isMobileDevice:!1};var yt=Object(P.connect)((function(e){var t=e.currentUser,n=e.conversation,r=e.followers,a=e.isReadOnly,o=e.moduleOptions,i=o.textsOverrides,s=o.useDisqusLogin,c=o.enableConversationHeaderFacesList,u=o.reporters,l=o.spotName,d=o.direction,p=o.isMobile,f=o.enableSSO,m=o.postId,v=xe.j(e),g=i.moderatorBadgeText,h=i.reporterBadgeText;return{spotName:l,enableConversationHeaderFacesList:c,direction:d,isLoggedIn:Object(Se.d)(t),currentUserId:t.id,messagesCount:n.messagesCount,isPostPage:n.contentType===We.b.Post,useDisqusLogin:s,followers:r,moderatorBadgeText:g,reporterBadgeText:h,reporters:u,isMobileDevice:fe.a||p,isLiveBlog:v,currentUser:t,enableSSO:f,postId:m,scrollToHeader:xe.i(e),isReadOnly:a}}),(function(e){return{openUserProfileModal:function(t){return e(Object(Te.a)(t))},handleDisqusLogin:ve.a,finishScrollToHeader(){e(Object(Fe.c)(!1))}}}))(ht),bt=n(408),Ot=n(711),wt=n.n(Ot);function It(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var a=m()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var kt=function(e){l()(n,e);var t=It(n);function n(){return i()(this,n),t.apply(this,arguments)}return c()(n,[{key:"render",value:function(){var e=this.props,t=e.isModerator,n=e.onToggleHide,r=null;return t&&(r=C.a.createElement("div",null,C.a.createElement("span",null,C.a.createElement(Be.a,{i18nKey:"inpage.hidden.text"}))," ",C.a.createElement("span",{className:wt.a.link,onClick:n},C.a.createElement(Be.a,{i18nKey:"inpage.hidden.button"}))," ")),r}}]),n}(_.Component);kt.displayName="HiddenConversationAlert",kt.propTypes={isModerator:T.a.bool.isRequired,onToggleHide:T.a.func};var Et=Object(P.connect)((function(e){return{isModerator:e.currentUser.isModerator}}),(function(e){return{onToggleHide:function(){return e(Object(bt.a)())}}}))(kt);var _t=n(712),Ct=n(713),jt=n.n(Ct),Tt=function(e){return"string"==typeof e?jt()(e):function e(t,n){var r;return Array.isArray(n)?n.map((function(n){return"string"==typeof n?n:e(t,n)})):"object"==typeof n&&null!==n?(r=Object.keys(n)).map((function(e){return t(e)})).reduce((function(a,o,i){var s,c;return s=n[r[i]],c=e(t,s),a[o]=c,a}),{}):n}(jt.a,e)},xt=n(410),St=n(121),Pt=n(156),Mt=n(157),Rt=n(100),Dt=function(){function e(){i()(this,e)}return c()(e,[{key:"filter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t.filterMine,t.filterConversationId),r=void 0===n?void 0:n;if(r){var a=e.conversation_id,o=e.conversationId,i=!(o=o||a)||r!==o;if(i)return!1}return!0}},{key:"execute",value:function(e,t,n){this.filter(e,t)&&n()}},{key:"isSentByMe",value:function(e){throw new Error("BaseRealtimeHandlers.isSentByMe should be implemented")}}]),e}(),Ut=n(300),Nt=n(353);function Lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var a=m()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var Bt={};var At,Vt=function(e){l()(n,e);var t=Lt(n);function n(e,r,a,o){var s;return i()(this,n),(s=t.call(this)).conversationId=e,s.realTime=r,s.dispatch=a,s.getState=o,s.subscribeOpts=void 0,s.execute=void 0,s.unsubscribeCallbacks=void 0,s.wrapWithTryCatch=function(e,t){return function(n){try{t(n)}catch(t){nt.a.error("wrapWithTryCatch",t,{handler:e})}}},s.picker=function(e){return e[s.conversationId]},s.subscribeOpts=[],s.unsubscribeCallbacks=[],s.registerEvents(),s}return c()(n,[{key:"isSentByMe",value:function(e){return function(e){return!!Bt[e]}(e)}},{key:"getFilterOptions",value:function(){return{filterMine:!0,filterConversationId:this.conversationId}}},{key:"internalDispatch",value:function(e){this.dispatch(e)}},{key:"registerEvents",value:function(){var e=this;this.subscribeOpts.push({topic:"conversation/new-messages",params:function(){return{conversation_id:e.conversationId}},pick:this.picker,callback:this.wrapWithTryCatch("conversation/new-messages",(function(t){var n=e.getState();t.forEach((function(t){var r;t.user_id!==(null===(r=n.currentUser)||void 0===r?void 0:r.id)&&e.internalDispatch(Object(xt.a)(t))}))}))}),this.subscribeOpts.push({topic:"conversation/count-messages",params:function(){return{conversation_id:e.conversationId}},pick:this.picker,callback:this.wrapWithTryCatch("conversation/count-messages",(function(t){var n=tt()(t,1)[0];e.internalDispatch({type:oe.Ab,payload:Tt(n)})}))}),this.subscribeOpts.push({topic:"online/users",params:function(){return{conversation_id:e.conversationId}},pick:this.picker,callback:this.wrapWithTryCatch("online/users",(function(t){e.internalDispatch(Object(Ut.a)(t)),nt.a.send("fetch_online_users_faces_list")}))}),this.subscribeOpts.push({topic:"conversation/updated-messages",params:function(){return{conversation_id:e.conversationId}},pick:this.picker,callback:this.wrapWithTryCatch("conversation/updated-messages",(function(t){if(t&&t.length>0){var n=e.getState().reportedComments,r=t.filter((function(e){return(null==e?void 0:e.id)&&!n[null==e?void 0:e.id]}));e.internalDispatch(Object(St.b)(r))}}))}),this.subscribeOpts.push({topic:"conversation/deleted-messages",params:function(){return{conversation_id:e.conversationId,message_ids:[]}},pick:this.picker,callback:this.wrapWithTryCatch("conversation/deleted-messages",(function(t){if(t.length>0){var n=e.getState(),r=n.currentUser,a=n.reportedComments,o=t.filter((function(e){return e.status===Me.statuses.BLOCKED})),i=t.filter((function(e){return(null==e?void 0:e.id)&&e.user_id!==(null==r?void 0:r.id)&&!a[null==e?void 0:e.id]&&"deleted"===e.status}));o.length>0&&e.internalDispatch(Object(Mt.b)(o)),i.length>0&&e.internalDispatch(Object(Pt.b)(i))}}))}),this.subscribeOpts.push({topic:"conversation/typing-v2-users",params:function(){return{conversation_id:e.conversationId,message_ids:[]}},pick:this.picker,callback:this.wrapWithTryCatch("conversation/typing-v2-users",(function(t){var n=e.getState().currentUser;e.internalDispatch(Object(Rt.f)(e.conversationId,t.map((function(e){return{messageId:null==e?void 0:e.key,count:null==e?void 0:e.count,users:null==e?void 0:e.users}})),n.id)),nt.a.send("typing_v2_users",{tags:{typingsCount:String(t.length)}})}))}),this.subscribeOpts.push({topic:"conversation/notifications-count",params:function(){return{conversation_id:e.conversationId}},pick:this.picker,callback:this.wrapWithTryCatch("conversation/notifications-count",(function(t){var n=tt()(t,1)[0];e.internalDispatch(Object(Nt.a)(null==n?void 0:n.unseen))}))}),this.subscribeOpts.forEach((function(t){var n=e.realTime.subscribe(t);e.unsubscribeCallbacks.push(n)}))}},{key:"unsubscribeEvents",value:function(){this.unsubscribeCallbacks.forEach((function(e){e()}))}}]),n}(Dt),qt=n(33);function Ht(e,t,n){var r=n().conversation,a={"x-spot-id":qt.x,"x-post-id":r.postId};try{var o=new _t.a({url:"v1.0.0/conversation/realtime/read",timeout:parseInt(q.a.get("tenant_config.realtime.start_timeout_milliseconds",3e4),10),requestParams:{headers:a}});e&&(At=new Vt(e,o,t,n))}catch(e){nt.a.error("subscribeRealtime",e)}}function Wt(e){try{e&&At.unsubscribeEvents()}catch(e){nt.a.error("unsubscribeRealtime",e)}}var Ft=n(93),Gt=n(447);var Kt={show:function(){},values:{RANK:5,NEW_MESSAGE:20}},Qt=n(448),Jt=function(){function e(){i()(this,e)}return c()(e,[{key:"subscribe",value:function(e,t){document.addEventListener(e,t)}},{key:"publish",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new CustomEvent(e,{detail:t});document.dispatchEvent(n)}},{key:"unsubscribe",value:function(e,t){document.removeEventListener(e,t)}}]),e}();var zt=n(176),Xt=n(14),Yt=n(411);function Zt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var a=m()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var $t=function(e){l()(n,e);var t=Zt(n);function n(){return i()(this,n),t.apply(this,arguments)}return c()(n,[{key:"render",value:function(){var e=this.props,t=e.isModerator,n=e.postId,r=e.isLiveBlog,a=e.allowLogin,o=e.onLogin;return C.a.createElement(Yt.a,{isModerator:t,postId:n,isLiveBlog:r,allowLogin:a,onLogin:o,hasFeedback:!0})}}]),n}(_.Component);$t.displayName="ConversationFooter";var en=Object(P.connect)((function(e){return{postId:e.moduleOptions.postId,isLiveBlog:xe.j(e),allowLogin:!Object(Xt.isLoggedIn)(e.currentUser)&&(e.moduleOptions.isConnectEnabled&&!e.moduleOptions.enableSSO||qt.p)}}),(function(e){return{onLogin(){e(Object(be.a)())}}}))($t),tn=n(173),nn=n(45),rn=n(732),an=n.n(rn),on=function(e){var t=e.text,n=e.iconSelector,r=e.buttonText,a=e.onClose,o=e.onBannerButtonClick;return C.a.createElement("div",{className:an.a.Banner},C.a.createElement(A.CloseButton,{className:an.a.BannerCloseButton,onClick:a}),C.a.createElement("div",{className:an.a.BannerContentWrapper},C.a.createElement(nn.a,{className:an.a.BannerIcon,selector:n}),C.a.createElement(A.Typography,{className:an.a.BannerText,type:"body"},t," ",C.a.createElement(A.Button,{mode:"link",className:an.a.BannerButton,onClick:o},r))))},sn=function(e){return e.startsWith("conversation")},cn=function(e){if(e.hasOwnProperty("entities")&&Array.isArray(e.entities)&&Object(Me.hasText)(e)){var t=(new Date).getTime();return!(e.expiresIn&&t-(null==e?void 0:e.expiresIn)>=0)}return!1},un=n(413),ln=n(171),dn={backgroundColor:"#f2f2f2",foregroundColor:"#e3e3e3"},pn={backgroundColor:"#7b7f83",foregroundColor:"#b3b3b3"},fn=function(e){var t=e.isDarkMode,n=e.isLTR;return C.a.createElement("div",{id:qt.b,style:{width:"100%",maxHeight:370}},C.a.createElement(ln.a,a()({rtl:!n,speed:2,width:"100%"},t?pn:dn),C.a.createElement("rect",{x:"88",y:"33",rx:"6",ry:"6",width:"60%",height:"54"}),C.a.createElement("rect",{x:"88",y:"113",rx:"6",ry:"6",width:"60%",height:"13"}),C.a.createElement("rect",{x:"88",y:"135",rx:"6",ry:"6",width:"45%",height:"13"}),C.a.createElement("circle",{cx:"51",cy:"59",r:"21"}),C.a.createElement("circle",{cx:"51",cy:"128",r:"21"}),C.a.createElement("rect",{x:"30",y:"172",rx:"6",ry:"6",width:"80%",height:"15"}),C.a.createElement("rect",{x:"30",y:"203",rx:"6",ry:"6",width:"80%",height:"15"})))},mn=n(255);function vn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gn(e){var t=e.url,n=e.highlightedMessageId,r=void 0===n?null:n,a=e.highlightedMessageDepth,o=void 0===a?0:a,i=e.highlightImmediate,s=void 0===i?null:i,c=e.scrollToComments,u=void 0===c?null:c,l=e.typingUsersCount,d=void 0===l?0:l,p=e.redirect,f=void 0===p?void 0:p,m=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vn(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},ae()(e,["url","highlightedMessageId","highlightedMessageDepth","highlightImmediate","scrollToComments","typingUsersCount","redirect"]));return r&&(0===o?m.spot_im_comment_id=r:m.spot_im_reply_id=r,null!==s&&(m.spot_im_highlight_immediate=s)),d>0&&(m.spot_im_state="typing"),null!==u&&(m.spot_im_scroll_to_comments=u),t=mn.a.buildUrl(t,m),f&&(t=function(e){var t=e.url,n=e.redirectParams,r=void 0===n?{}:n,a={to_url:t,from_spot:r.fromSpotId,to_spot:r.toSpotId,source:r.source||null},o=Object.keys(a).map((function(e){return"".concat(e,"=").concat(encodeURIComponent(a[e]))})).join("&");return"".concat(r.redirectEndpoint,"#").concat(window.encodeURIComponent(o))}({url:t,redirectParams:f})),t}var hn=n(414),yn=n(259),bn=n(248),On=n(358),wn=n(354),In=n(218),kn=n(415),En=n(734),_n=n.n(En),Cn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.value;return t&&C.a.createElement("span",{"data-spot-im-class":"community-question",className:_n.a.communityQuestion},t)},jn=n(735),Tn=n.n(jn);n(736),n(737);function xn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var a=m()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}function Sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sn(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n.d(t,"c",(function(){return Rn})),n.d(t,"b",(function(){return Dn}));var Mn,Rn=q.a.get("tenant_config.conversation.isUseShadowDomOnOverlays",!0),Dn=q.a.get("tenant_config.conversation.isUseShadowDomOnMain",!0),Un=q.a.get("tenant_config.conversation.enable_explore_onboarding",!0);!function(e){e.START="start",e.CENTER="center"}(Mn||(Mn={}));var Nn=q.a.get("tenant_config.conversation.explore_mode_alignment",Mn.START),Ln=n(416),Bn=N()((function(){return Promise.all([n.e(0),n.e(3),n.e(4),n.e(5),n.e(10),n.e(11),n.e(12),n.e(16),n.e(17),n.e(80),n.e(2),n.e(1),n.e(6),n.e(7),n.e(8),n.e(9),n.e(14),n.e(15),n.e(13),n.e(21),n.e(49)]).then(n.bind(null,893))}));var An=function(e){l()(n,e);var t=xn(n);function n(){var e;i()(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).isInitialLoadComplete=!1,e.el=void 0,e.tabModeEvent=void 0,e.DocumentEventPubSub=new Jt,e.viewedOnce=!1,e.state={hasError:!1,errorDetails:{stack:"",message:""},remountHideAll:!1,isBannerVisible:Ae.a},e.conversationRef=C.a.createRef(),e.handleViewportEnter=function(){if(!e.viewedOnce){e.viewedOnce=!0;var t={type:"viewed"};e.isCommunityViewEnabled()&&Object.assign(t,{item_type:e.props.selectedCommunityView.toLowerCase()});var n=e.getCommunityQuestion();n&&Object.assign(t,{taxonomy_subject:n}),nt.a.send("viewed"),e.props.tracking.trackEvent(t),e.props.container.style.minHeight="auto"}},e.resizeHandler=function(){var t=e.props.calculateIsMobile;t(e.el),window.addEventListener("resize",E()((function(){return t(e.el)}),200),!1)},e.handleTabModeActivation=function(t){9===t.keyCode&&(document.body.classList.add(Ln.tabMode),e.tabModeEvent.activated||(e.tabModeEvent.activated=!0,document.dispatchEvent(e.tabModeEvent)))},e.handleTabModeDeactivation=function(){document.body.classList.remove(Ln.tabMode),e.tabModeEvent.activated&&(e.tabModeEvent.activated=!1,document.dispatchEvent(e.tabModeEvent))},e.unmuteUser=function(t){var n=t.detail;(0,e.props.unmuteUser)(n&&n.userId)},e.handleErrorBoxReload=function(){e.setState({hasError:!1})},e.handleRemount=function(){e.setState({remountHideAll:!0},(function(){setTimeout((function(){e.setState({remountHideAll:!1})}),500)}))},e.deleteExploreBanner=function(){window.localStorage&&window.localStorage.setItem("SPOTIM_IS_EXPLORE_ONBOARDING_VIEWED","true"),e.setState({isBannerVisible:!1})},e.onBannerClose=function(){e.setState({isBannerVisible:!1}),e.deleteExploreBanner()},e.openExploreOnboarding=function(){var t,n,r;null===(t=window)||void 0===t||null===(n=t.__OPEN_WEB__)||void 0===n||null===(r=n.renderExploreOnboardingModal)||void 0===r||r.call(n),e.deleteExploreBanner()},e.getConversationBody=function(t,n,r,o,i,s,c){if(t===We.c.ERROR){var u=e.props.retryConversationRead;return C.a.createElement(hn.a,{onClick:u})}return t===We.c.FETCHING?C.a.createElement(fn,{isDarkMode:Object(un.a)(),isLTR:qt.t}):C.a.createElement(C.a.Suspense,{fallback:C.a.createElement(fn,{isDarkMode:Object(un.a)(),isLTR:qt.t})},C.a.createElement(Bn,a()({ref:e.conversationRef,onNotificationClick:n,conversation:r,summaryWidget:o,pagination:i,comments:s,tracking:c},{onRemount:e.handleRemount})))},e}return c()(n,[{key:"getChildContext",value:function(){return{toastMessage:Kt,getMessageShareUrl:Qt.a}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.conversation,r=t.onConversationChange,a=e.conversation;this.isInitialLoadComplete||(this.isInitialLoadComplete=!0),a.id!==n.id&&r({prevConversationId:n.id,nextConversationId:a.id})}},{key:"componentDidMount",value:function(){var e=this.props,t=e.enableAccessibilityColorContrast,n=e.conversation,r=e.scrollToComments,a=e.onConversationLoad,o=e.onScrollToConversation,i=n.id;!function(){var e=localStorage.getItem("SPOTIM_DRAFT_MESSAGE_V2");if(e)try{for(var t=JSON.parse(e),n=0,r=Object.entries(t);n<r.length;n++){var a=tt()(r[n],2),o=a[0],i=a[1];sn(o)&&!cn(i)&&delete t[o]}localStorage.setItem("SPOTIM_DRAFT_MESSAGE_V2",JSON.stringify(t))}catch(e){nt.a.error("clearExpiredDraftMessages",e)}}();var s=window.localStorage&&"true"!==window.localStorage.getItem("SPOTIM_IS_EXPLORE_ONBOARDING_VIEWED");this.setState({isBannerVisible:Ae.a&&s}),a(i),r&&o({conversationId:i}),this.resizeHandler(),!0===t&&document.body.classList.add(Ln.accessibilityMode),this.DocumentEventPubSub.subscribe("keydown",this.handleTabModeActivation),this.DocumentEventPubSub.subscribe("mousedown",this.handleTabModeDeactivation),this.tabModeEvent=document.createEvent("Event"),this.tabModeEvent.initEvent("tabModeChanged",!0,!0),this.tabModeEvent.activated=!1,this.el&&this.el.classList.add("spot-im-conversation-module"),q.a.get("tenant_config.conversation.enableUsersMuting",!1)&&this.DocumentEventPubSub.subscribe("data-spot-im-unmute-user",this.unmuteUser),this.setMethodsOnWindow()}},{key:"getCommunityQuestion",value:function(){var e=this.props,t=e.conversation;return e.communityQuestion||t.communityQuestion}},{key:"setMethodsOnWindow",value:function(){var e,t=this;this.props.isConversationPage||(window.__SPOTIM__=Pn(Pn({},window.__SPOTIM__),{},{createMessage:(e=y()(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preloadConversation(),e.next=3,t.props.createMessage(n);case 3:t.props.setCommunityView(We.a.Conversation);case 4:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)}),switchTab:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.props.setCommunityView(We.a.Conversation),t.props.scrollToHeader(),e.focusSayControl&&t.props.focusSayControlOnSwitchTab()},preloadConversation:function(){t.preloadConversation()}}))}},{key:"componentDidCatch",value:function(e){throw new Error(e)}},{key:"componentDidUpdate",value:function(e){e.conversation.id!==this.props.conversation.id&&this.notifyConversationLoaded(),this.props.preloadConversation&&this.preloadConversation()}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.conversation;(0,e.onConversationUnload)(t.id),this.DocumentEventPubSub.unsubscribe("keydown",this.handleTabModeActivation),this.DocumentEventPubSub.unsubscribe("mousedown",this.handleTabModeDeactivation),q.a.get("tenant_config.conversation.enableUsersMuting",!1)&&this.DocumentEventPubSub.unsubscribe("data-spot-im-unmute-user",this.unmuteUser)}},{key:"preloadConversation",value:function(){Bn.preload()}},{key:"notifyConversationLoaded",value:function(){var e=this.props,t=e.conversation,n=e.isStarsRatingEnabled,r=e.currentUser,a=(e.postId,e.isLiveBlog),o=t.spotId,i=t.id;Object(J.dispatchSpotimEvent)(z.j,{spotId:o,conversationId:i});var s=document.querySelectorAll("".concat(qt.d,",\n      ").concat(qt.e)),c=s.length>0?s[0].offsetWidth:0,u={total_comments:t.messagesCount,in_view:Object(zt.a)().toString(),is_rating:n,avg_rate:t.averageStarsRating,is_registered:r.isRegistered,row:c};nt.a.send("".concat(a?"live_blog_":"","loaded")),this.props.tracking.trackEvent(Pn(Pn({},u),{},{type:"loaded"}))}},{key:"isCommunityViewEnabled",value:function(){var e=this.props,t=e.isConversationPage,n=e.isLiveBlog;return Ae.a&&!n&&!t}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.conversation,a=n.summaryWidget,o=n.pagination,i=n.comments,s=n.onNotificationClick,c=n.currentUser,u=n.direction,l=n.selectedCommunityView,d=this.state.isBannerVisible,p=this.props.communityQuestion||r.communityQuestion;if(this.state.hasError,this.state.remountHideAll,r.isHidden)e=C.a.createElement(Et,{conversation:r});else{var f=this.props,m=f.hideNonReadOnlyElements,v=f.isMobile,g=f.isLiveBlog,h=f.tracking,y=f.conversationStatus,b=this.isCommunityViewEnabled(),O=b&&Nn===Mn.CENTER,w=!!window.MSInputMethodContext&&!!document.documentMode,I=S()(Tn.a.conversationView,{[Tn.a.liveBlog]:g,[Tn.a.rtl]:"rtl"===u,"read-only":m,[Tn.a.hiddenConversation]:r.isHidden,[Tn.a.mqMobile]:v,[Tn.a.ie11]:w,[Tn.a.alignToCenter]:O,[Tn.a.communityView]:b},Ln.conversationModule);e=C.a.createElement("div",{"data-spmark":"conversation conversation-id:".concat(r.id),className:I,"data-spot-im-class":"conversation-root","data-tooltips-boundaries":!0,ref:function(e){t.el=e},"data-is-logged-in":!!Object(Se.d)(c)},Un&&b&&d&&C.a.createElement(on,{text:C.a.createElement(Be.a,{i18nKey:"onboarding.description"},"Welcome to your new community feed! Check out your upgraded and improved experience."),iconSelector:"onboardingNew",buttonText:C.a.createElement(Be.a,{i18nKey:"onboarding.buttonText"},"Tell me more"),onClose:this.onBannerClose,onBannerButtonClick:this.openExploreOnboarding}),!qt.w&&C.a.createElement(yt,null),(!b||l===We.a.Conversation)&&C.a.createElement(C.a.Fragment,null,p&&C.a.createElement(Cn,{value:p}),this.getConversationBody(y,s,r,a,o,i,h)),b&&C.a.createElement("div",{"data-post-id":this.props.postId,"data-spot-im-module":"feed","data-spotim-module":"feed","data-spot-im-active":l===We.a.Explore}),C.a.createElement(en,{isModerator:c.isModerator}),C.a.createElement("div",{id:"tooltip-section"}))}return C.a.createElement(A.StylingWrapper,{isLtr:"ltr"===u},C.a.createElement(B.a,{onEnter:this.handleViewportEnter},C.a.createElement(kn.ToastProvider,null,C.a.createElement("div",{id:"spotim-specific-conversation",className:Tn.a.mainContainer,"data-spotim-app":"conversation",style:{display:"none"}},e))))}}]),n}(_.Component);An.childContextTypes={toastMessage:T.a.object.isRequired,getMessageShareUrl:T.a.func.isRequired},An.defaultProps={isLiveBlog:!1};t.a=I()(Object(P.connect)((function(e){var t,n=e.currentUser,r=e.moduleOptions,a=e.comments,o=e.conversation,i=e.summaryWidget,s=e.appState.conversationStatus,c=r.enableAccessibilityColorContrast,u=r.testGroup,l=r.isConversationPage,d=r.contentType,p=xe.j(e);return{enableAccessibilityColorContrast:c,testGroup:u,hideNonReadOnlyElements:(t={isLiveBlog:p},t.isLiveBlog?q.a.get("tenant_config.live-blog.is_read_only_mode",!1):q.a.get("tenant_config.conversation.is_read_only_mode",!1)),isMobile:xe.l(e),brandColor:r.brandColor,conversationSkin:r.conversationSkin,referTraffic:r.referTraffic,spotId:r.spotId,postId:r.postId,isLiveBlog:p,direction:r.direction,conversation:o,pagination:a.pagination,comments:a.list,scrollToComments:r.scrollToComments,communityQuestion:r.communityQuestion,isStarsRatingEnabled:r.isStarsRatingEnabled,summaryWidget:i,currentUser:n,selectedCommunityView:xe.b(e),preloadConversation:xe.g(e),isConversationPage:l,contentType:d,conversationStatus:s}}),(function(e){return{calculateIsMobile:function(t){return e(Gt.b(t))},onScrollToConversation:function(t){var n=t.conversationId;return e({type:"SCROLL_TO_CONVERSATION",payload:{conversationId:{conversationId:n}.conversationId}})},onConversationLoad:function(t){return e(function(e){return function(t,n){Ht(e,t,n)}}(t))},onConversationUnload:function(t){return e(function(e){return function(){Wt(e)}}(t))},onConversationChange:function(t){var n=t.prevConversationId,r=t.nextConversationId;return e(function(e){var t=e.prevConversationId,n=e.nextConversationId;return function(e,r){Wt(t),Ht(n,e,r)}}({prevConversationId:n,nextConversationId:r}))},openLink:function(e,t,n){return Z({url:e,newTab:t,referTraffic:n,href:void 0})},highlightConversationMessage:function(t,n){return e(function(e,t){return function(){var n=y()(g.a.mark((function n(r,a){var o,i,s,c,u,l,d;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=a(),i=o.moduleOptions,s=i.elementId,c=i.postId,Object(se.a)(e,s)){n.next=9;break}return n.next=5,de(e,t,c);case 5:u=n.sent,l=u.comments,d=u.usersList,r({type:oe.b,payload:{comments:l,usersList:d}});case 9:Object(se.b)(e,s),r(Object(ie.a)({id:e}));case 11:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}(t,n))},unmuteUser:function(t){return e(function(e){return function(t){t({type:oe.zb,payload:{userId:e}})}}(t))},createMessage:function(t){return e(Object(tn.a)(t))},setCommunityView(t){e(Object(Fe.a)(t))},focusSayControlOnSwitchTab(){e(Object(Fe.b)(!0))},scrollToHeader(){e(Object(Fe.c)(!0))},retryConversationRead(){e(function(){var e=y()(g.a.mark((function e(t,n){var r,a,o,i,s,c,u,l,d,p,f,m;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n(),a=Object(xe.j)(r),o=r.moduleOptions,i=r.conversation,s=o.postId,c=o.elementId,u=o.isConversationPage,l=i.contentType,d=Object(bn.b)(c)){e.next=8;break}return e.abrupt("return");case 8:t(Object(In.a)({conversationStatus:We.c.FETCHING})),f="true"===(null==d?void 0:d.getAttribute(qt.f)),m=new Promise((function(e){p=setTimeout((function(){e(!1)}),qt.c)})),Promise.race([m,Object(yn.a)({postId:s,element:d,isPreview:f,isLiveBlog:a})]).then((function(e){if(!e||!e.data)return nt.a.error("conversation failed to load",new Error("read failed")),void t(Object(In.a)({conversationStatus:We.c.ERROR}));clearTimeout(p);var n=e.data;t(Object(wn.a)({data:n,postId:s,contentType:l})),Object(On.a)(u)&&t(Object(Fe.a)(We.a.Conversation,!1))})).catch((function(e){nt.a.error("conversation failed to load",e),t(Object(In.a)({conversationStatus:We.c.ERROR}))}));case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}}}),(function(e,t,n){var r,a=e.referTraffic,o=e.spotId,i=e.conversation,s=t.openLink,c=t.highlightConversationMessage;return Pn(Pn(Pn(Pn({},e),t),n),{},{onNotificationClick:(r=y()(g.a.mark((function e(t){var n,r,u,l,d,p;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.conversationUrl,r=t.conversationId,u=t.message,Object(J.dispatchSpotimEvent)(z.x),i.id===r?c(u.id,u.depth):q.a.get("tenant_config.conversation.use_traffic_redirect_api",!1)?(l=gn({url:n,highlightedMessageId:u.id,highlightedMessageDepth:u.depth,highlightImmediate:!0,redirect:{source:"notification",toSpotId:o,fromSpotId:o,redirectEndpoint:H.a.urls.redirect}}),s(l,!1,a)):(d=-1!==n.indexOf("?")?"&":"?",p="".concat(n).concat(d,"utm_source=spotim&utm_medium=spotim_conversation&spot_im_redirect_source=notifications&spot_im_comment_id=").concat(u.id,"&spot_im_highlight_immediate=true"),window.location.href=p);case 4:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})})})),R()((function(e){var t="conversation";return e.isConversationPage&&(t=e.contentType===We.b.Post?"post-page":"conversation-page"),{source:t,total_comments:e.conversation.messagesCount,is_rating:e.isStarsRatingEnabled,avg_rate:e.conversation.starRatingSummary&&e.conversation.starRatingSummary.average,is_registered:e.currentUser.isRegistered,post_id:e.postId,spot_id:e.spotId,user_id:e.currentUser.id}}),{dispatch:Ft.analyticsTrack}),Object(D.a)())(An)},80:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(55),a=n.n(r),o=n(50),i=n.n(o),s=n(31),c=n(0),u=n.n(c),l=n(11),d=n.n(l),p=n(674),f=n.n(p),m=function(e){var t=e.disableHover,n=e.weight,r=e.isIcon,o=e.className,c=e.children,l=i()(e,["disableHover","weight","isIcon","className","children"]);return u.a.createElement(s.Typography,a()({},l,{type:"action",className:d()(f.a.actionWrapper,{[f.a.hoverBackground]:!t,[f.a.icon]:r},o),weight:n}),c)}},86:function(e,t,n){"use strict";var r=n(30),a=n.n(r),o=n(0),i=n.n(o),s=n(11),c=n.n(s),u=n(678),l=n.n(u),d=n(81),p=n(2),f=n.n(p),m=n(12),v=n(69),g=n(33);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=function(){},O=f.a.get("init_data.config.avatars.scheme"),w=f.a.get("tenant_config.shared.disable_user_image_upload",!1);t.a=Object(m.connect)((function(e){var t=e.moduleOptions;return{enableSSO:t.enableSSO,editableSSO:t.editableSSO,currentUser:e.currentUser}}))((function(e){var t,n=e.isOnline,r=e.size,a=e.disableUserImageUpload,o=e.disableTooltip,s=e.onImageUpload,u=e.className,p=e.overrideImageId,f=e.onClick,m=void 0===f?b:f,h=e.disableOnlineIndicator,I=e.isBranding,k=void 0!==I&&I,E=e.enableSSO,_=e.editableSSO,C=e.currentUser,j=e.user,T=e.isDisabled,x=a||!Object(v.d)(C)&&w||!!E&&!_,S=void 0;return p?S=p:(null==j?void 0:j.imageId)||(S="#Grey-Default"),g.l?null:j?i.a.createElement(d.UserImage,{size:r,isOnline:n,className:c()(l.a.userImageAvatar,{[l.a.disabled]:T},u),avatarsScheme:O,disableUserImageUpload:x,user:y(y({},j),{},{imageId:null!==(t=S)&&void 0!==t?t:j.imageId}),onClick:k?b:m,onImageUpload:s,disableOnlineIndicator:h,disableTooltip:o}):null}))},94:function(e,t,n){"use strict";var r=n(22),a=n.n(r),o=n(23),i=n.n(o),s=n(36),c=n.n(s),u=n(18),l=n.n(u),d=n(2),p=n.n(d),f=n(4),m=n(406),v=!1;var g=function(e){f.a.apm.start("user_profile_mount"),new Promise((function(e){if(v)e();else{var t=(p.a.get("assets_config")||[]).find((function(e){if(e.variant){var t,n=e.variant.split(":"),r=c()(n,2),a=r[0],o=r[1],i=null!==(t=l.a.getVariant(a))&&void 0!==t?t:"A";return"modals"===e.module&&"user profile bundle"===e.name&&i===o}return"modals"===e.module&&"user profile bundle"===e.name}));t?(document.addEventListener("spot-im-user-profile-initialized",(function(){v=!0,e()})),Object(m.a)(document.body,"".concat(t.url)).catch((function(e){return f.a.error("fetchUserProfile",e)}))):console.warn('Error: cannot find "user profile bundle" in `assets_config`')}})).then((function(){window.mountUserProfile(e),f.a.apm.end("user_profile_mount")})).catch((function(e){f.a.error("fetchAndMountUserProfile",e)}))},h=n(65),y=n(70);function b(e){return O.apply(this,arguments)}function O(){return(O=i()(a.a.mark((function e(t){var n,r,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.userId,e.next=3,Object(h.a)("public-user/external-user/".concat(n),{data:{}});case 3:return r=e.sent,o=r.body,e.abrupt("return",y.a.map(o,{display_name:"displayName",image_url:"imageUrl",encrypted_pkey:"encryptedPKey",user_name:"username"}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=n(43),I=n(3);function k(e){return function(){var t=i()(a.a.mark((function t(n,r){var o,i,s,c,u,l;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,o=r().moduleOptions.useExternalUserId,i=e.displayName,s=e.id,c=e.username,u=e.userId,l={id:s,displayName:i,username:c,userId:u},!o){t.next=8;break}return t.next=7,b({userId:s});case 7:l=t.sent;case 8:Object(I.dispatchSpotimEvent)(w.p,l),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),f.a.error("notifyOpenUserProfile",t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e,n){return t.apply(this,arguments)}}()}function E(e){var t=function(e){return e instanceof Array?(console.warn("OpenUserProfileModal: should pass new object arguments"),{user:e[0],overrideDisplayName:e[1],overrideImageId:e[2],mode:e[3]}):e}(e),n=t.user,r=t.overrideDisplayName,o=t.mode;return n&&n.id||f.a.error("openUserProfileModal","no user provided"),function(){var e=i()(a.a.mark((function e(t,i){var s,c,u,l,d,p,f,m,v,h,y,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=i(),c=s.authentication.token,u=s.moduleOptions,l=u.disableUserProfileModal,d=u.mainLanguage,p=u.postId,f=u.spotId,m=u.brandColor,v=u.direction,h=u.enableSSO,y=u.editableSSO,b=s.currentUser,"main"===o&&t(k(n)),l&&"privacy"!==o||g({user:n,isDisableNavigation:"privacy"===o&&l,currentUser:b,mode:o,locale:d,postId:p,spotId:f,brandColor:m,direction:v,token:c,enableSSO:h,canEditProfile:!h,canEditUserImage:!h||y,overrideDisplayName:r});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}n.d(t,"a",(function(){return E}))}}]);
//# sourceMappingURL=conversation-component~feedback-modal~preRender-bundle.js.map