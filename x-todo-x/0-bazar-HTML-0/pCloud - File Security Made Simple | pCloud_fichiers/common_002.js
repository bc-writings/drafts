var logoutCookies=["pcauth","plans_period","order_specific","ref","locationid"];var pageCallbackInited=false;var userInited=false;var swipeEnabled=true;var registerDlApp=false;var skipUserCheck=false;var pCloudUserIP=false;var pCloudNewsletter=false;var downgrade=false;var getCurrencyTries=0;var transitionEnd=transitionEndEvent();var animationEnd=animationEndEvent();var animationSpeeds={100:"anim-dur-01",150:"anim-dur-015",200:"anim-dur-02",250:"anim-dur-025",300:"anim-dur-03",350:"anim-dur-035",400:"anim-dur-04",450:"anim-dur-045",500:"anim-dur-05",550:"anim-dur-055",600:"anim-dur-06",650:"anim-dur-065"};var modalData={obj:$(".modal:visible"),animate:false,onOpen:false,onClose:false,func:false,transitionEnd:transitionEnd};var call={downloadDrive:downloadPcloudDrive,apiCall:apiCall,apiCallPost:apiCallPost};var originalOnEvent=$.fn.on;var onResizeFunctions={};var apiCallQueue=[];var pCloud={};var initCallback;var login_callback;var logout_callback;var register_callback;var tooltipTimeout;var checkPclObjInterval;var formLoginInserted;var formRegisterInserted;var formRegisterBusinessInserted;var modal;var productNameMap={0:{short:__("Free"),long:__("Free"),currentPlanText:__("your_current_plan_storage_traffic"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("design_your_plan_btn")}},1:{short:__("HOME_PREMIUM_PLAN"),long:__("HOME_PREMIUM_PLAN"),currentPlanText:__("your_current_plan_storage_traffic"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("design_your_plan_btn")}},3:{short:__("HOME_PREMIUM_PLUS_PLAN"),long:__("HOME_PREMIUM_PLUS_PLAN"),currentPlanText:__("your_current_plan_storage_traffic"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("design_your_plan_btn")}},4:{short:__("HOME_PREMIUM_PLAN"),long:__("HOME_PREMIUM_PLAN")+" 100 "+__("GB"),currentPlanText:__("your_current_plan_storage_traffic"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("design_your_plan_btn")}},7:{short:__("VIVA pCloud"),long:__("VIVA pCloud")+" 500 "+__("GB"),currentPlanText:__("plans_vivapcloud_current_message"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("design_your_plan_btn")}},8:{short:__("VIVA pCloud"),long:__("VIVA pCloud")+" 1 "+__("TB"),currentPlanText:__("plans_vivapcloud_current_message"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("design_your_plan_btn")}},9:{short:__("HOME_PREMIUM_PLUS_PLAN"),long:__("HOME_PREMIUM_PLUS_PLAN")+" 3 "+__("TB"),currentPlanText:__("your_current_plan_storage_traffic"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("design_your_plan_btn")}},10:{short:__("HOME_PREMIUM_PLUS_PLAN"),long:__("HOME_PREMIUM_PLUS_PLAN")+" 10 "+__("TB"),currentPlanText:__("your_current_plan_storage_traffic"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("design_your_plan_btn")}},12:{short:__("VIVA pCloud"),long:__("VIVA pCloud")+" 128 "+__("GB"),currentPlanText:__("plans_vivapcloud_current_message"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("design_your_plan_btn")}},13:{short:__("Custom Plan"),long:__("Custom Plan"),currentPlanText:__("your_current_plan_storage_traffic"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("add_storage_traffic_btn")}},14:{short:__("lifetime_premium"),long:__("lifetime_premium"),currentPlanText:__("your_current_plan_storage_traffic"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("design_your_plan_btn")}},15:{short:__("lifetime_premium"),long:__("lifetime_premium"),currentPlanText:__("your_current_plan_storage_traffic"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("design_your_plan_btn")}},16:{short:__("lifetime_premium"),long:__("lifetime_premium"),currentPlanText:__("your_current_plan_storage_traffic"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("design_your_plan_btn")}},17:{short:__("lifetime_premium"),long:__("lifetime_premium"),currentPlanText:__("your_current_plan_storage_traffic"),buttonText:{0:__("SIGN_UP_NEW"),1:upgradeText,3:upgradeText,13:__("design_your_plan_btn")}},101:{short:__("Crypto"),long:__("Crypto"),currentPlanText:false,buttonText:{0:__("SIGN_UP_NEW"),1:__("get_premium"),3:__("get_premium_plus"),13:__("design_your_plan_btn")}},102:{short:__("Lifetime Crypto"),long:__("Lifetime Crypto"),currentPlanText:false,buttonText:{0:__("SIGN_UP_NEW"),1:__("get_premium"),3:__("get_premium_plus"),13:__("design_your_plan_btn")}},103:{short:__("Lifetime Crypto"),long:__("Lifetime Crypto"),currentPlanText:false,buttonText:{0:__("SIGN_UP_NEW"),1:__("get_premium"),3:__("get_premium_plus"),13:__("design_your_plan_btn")}},111:{short:__("Extended File History"),long:__("Extended File History"),currentPlanText:false,buttonText:{0:__("SIGN_UP_NEW"),1:__("get_premium"),3:__("get_premium_plus"),13:__("design_your_plan_btn")}},1001:{short:__("Business"),long:__("Business"),currentPlanText:currentBAtext,buttonText:{0:__("SIGN_UP_NEW"),1:__("get_premium"),3:__("get_premium_plus"),13:__("design_your_plan_btn")}}};var providers={1:{name:"iTunes",short_name:"itunes",type:"mobile"},2:{name:"PayPal",short_name:"paypal",type:"paypal"},3:{name:"Bitcoin",short_name:"bitcoin",type:"bitcoin"},4:{name:"Authorize",short_name:"authorize",type:"authorize"},5:{name:"Vivacom",short_name:"vivacom",type:"vivacom"},6:{name:"Bank",short_name:"bank",type:"bank"},7:{name:"PaymentWall",short_name:"paymentwall",type:"paymentwall"},8:{name:"SEP",short_name:"sep",type:"sep"},9:{name:"Stripe",short_name:"stripe",type:"ccard"},11:{name:"PayPal",short_name:"paypal",type:"paypal"},12:{name:"Google Play",short_name:"googleplay",type:"mobile"},13:{name:"SafeCharge",short_name:"safecharge",type:"ccard"},15:{name:"Vivacom",short_name:"vivacom",type:"vivacom"},16:{name:"Adyen",short_name:"adyen",type:"ccard"}};var productMap={0:"free",1:"premium",3:"premium-plus",4:"premium-100gb",7:"vivacom",8:"vivacom",9:"premium-3TB",10:"premium-10TB",12:"vivacom",13:"custom-plan",14:"family1",15:"family2",16:"premium-plus-forever",17:"premium-plus-forever",101:"crypto",102:"crypto-forever",103:"crypto-forever",111:"extended-history"};var productInfo={premium:{name:__("HOME_PREMIUM_PLAN"),short_name:"premium",plan_id:1,month:4.99,year:3.99,year_total:3.99*12,lifetime:175,lifetime_discount:480,type:"plan",quota:"500 "+__("GB"),action_text:__("product_change"),description:" <span>-</span> "+"500 "+__("GB")+" "+__("space"),upsale_text:__("upsale_text_for_premium"),upsale_title:__("Premium"),upsale_button:__("get_premium")},"premium-plus":{name:__("HOME_PREMIUM_PLUS_PLAN"),short_name:"premium-plus",plan_id:3,month:9.99,year:7.99,year_total:7.99*12,lifetime:350,lifetime_discount:980,type:"plan",quota:"2 "+__("TB"),action_text:__("product_change"),description:" <span>-</span> "+"2 "+__("TB")+" "+__("space"),upsale_text:__("upsale_text_for_premium"),upsale_title:__("Premium"),upsale_button:__("get_premium")},"custom-plan":{name:__("Custom Plan"),short_name:"custom-plan",plan_id:13,month:9.99,year:7.99,year_total:7.99*12,lifetime:false,lifetime_discount:1,type:"plan",quota:false,action_text:__("product_change"),description:" <span>-</span> "+__("custom_plan_description"),upsale_text:__("upsale_text_for_premium"),upsale_title:__("Premium"),upsale_button:__("get_premium")},"premium-forever":{name:__("lifetime_premium"),short_name:"premium-forever",plan_id:14,month:0,year:59.9,lifetime:175,lifetime_discount:false,type:"plan",quota:"500 "+__("GB"),action_text:__("product_change"),description:" <span>-</span> "+"500 "+__("GB")+" "+__("space"),upsale_text:__("upsale_text_for_premium"),upsale_title:__("Premium"),upsale_button:__("get_premium")},"premium-plus-forever":{name:__("lifetime_premium"),short_name:"premium-forever",plan_id:17,month:0,year:59.9,lifetime:350,lifetime_discount:false,type:"plan",quota:"2 "+__("TB"),action_text:__("product_change"),description:" <span>-</span> "+"2 "+__("TB")+" "+__("space"),upsale_text:__("upsale_text_for_premium"),upsale_title:__("Premium"),upsale_button:__("get_premium")},crypto:{name:"pCloud Crypto",short_name:"crypto",plan_id:101,month:4.99,year:3.99,year_total:3.99*12,lifetime:125,lifetime_discount:480,type:"feature",quota:false,action_text:"",description:"",upsale_text:__("upsale_text_for_crypto"),upsale_title:__("Crypto"),upsale_button:__("get_crypto")},"extended-history":{name:"Extended File History",short_name:"extended-history",plan_id:111,month:3.99,year:3.25,year_total:3.25*12,lifetime:0,lifetime_discount:0,type:"feature",quota:false,action_text:"",description:"",upsale_text:__("Upsale text for Extended file history"),upsale_title:__("Extended File History"),upsale_button:__("Get extended file history")},vivacom:{name:"Viva pCloud",short_name:"vivacom",plan_id:12,month:2.99,year:2.99,year_total:2.99*12,lifetime:false,lifetime_discount:false,type:"plan",quota:"128 "+__("GB"),action_text:"",description:"",upsale_text:"",upsale_title:"",upsale_button:""},family1:{name:"Family 2 TB",short_name:"family",plan_id:14,month:false,year:false,year_total:false,lifetime:500,lifetime_discount:1400,type:"plan",quota:"2 "+__("TB"),action_text:"",description:"",upsale_text:"",upsale_title:"",upsale_button:""},family2:{name:"Family 4 TB",short_name:"family",plan_id:15,month:false,year:false,year_total:false,lifetime:1e3,lifetime_discount:2800,type:"plan",quota:"4 "+__("TB"),action_text:"",description:"",upsale_text:"",upsale_title:"",upsale_button:""},storage:{name:"storage",month:9.99,year:7.99,size:2,lifetime:350},traffic:{name:"traffic",month:9.99,year:7.99,size:2,lifetime:350}};var pclCurrency=sessionStorage.pclCurrency||"$";var currencyMap={USD:"$",EUR:"€",GBP:"₤"};var signToCurrency={$:"USD","€":"EUR","₤":"GBP"};var currencyPrices={1:{$:{month:4.99,"month-total":59.88,year:3.99,"year-total":47.88,lifetime:175,lifetime_discount:480},"€":{month:4.99,"month-total":59.88,year:3.99,"year-total":47.88,lifetime:175,lifetime_discount:480},"₤":{month:4.99,"month-total":59.88,year:3.99,"year-total":47.88,lifetime:175,lifetime_discount:480}},3:{$:{month:9.99,"month-total":119.88,year:7.99,"year-total":95.88,lifetime:350,lifetime_discount:980},"€":{month:9.99,"month-total":119.88,year:7.99,"year-total":95.88,lifetime:350,lifetime_discount:980},"₤":{month:9.99,"month-total":119.88,year:7.99,"year-total":95.88,lifetime:350,lifetime_discount:980}},14:{$:{lifetime:500,lifetime_discount:1400},"€":{lifetime:500,lifetime_discount:1400},"₤":{lifetime:500,lifetime_discount:1400}},15:{$:{lifetime:1e3,lifetime_discount:2800},"€":{lifetime:1e3,lifetime_discount:2800},"₤":{lifetime:1e3,lifetime_discount:2800}},101:{$:{month:4.99,"month-total":59.88,year:3.99,"year-total":47.88,lifetime:125,lifetime_discount:480},"€":{month:4.99,"month-total":59.88,year:3.99,"year-total":47.88,lifetime:125,lifetime_discount:480},"₤":{month:4.99,"month-total":59.88,year:3.99,"year-total":47.88,lifetime:125,lifetime_discount:480}},111:{$:{month:3.99,"month-total":47.88,year:3.25,"year-total":39,lifetime:0,lifetime_discount:0},"€":{month:3.99,"month-total":47.88,year:3.25,"year-total":39,lifetime:0,lifetime_discount:0},"₤":{month:3.99,"month-total":47.88,year:3.25,"year-total":39,lifetime:0,lifetime_discount:0}}};var countryCurrencyPrices={};function addMonthAndYearTotals(countryCurrencyPrices){var countries=Object.keys(countryCurrencyPrices);var country;var products;var product;var i;var j;console.log(countryCurrencyPrices);for(i in countries){country=countries[i];console.log(i,country);products=Object.keys(countryCurrencyPrices[country]);for(j in products){product=countryCurrencyPrices[country][products[j]];product["$"]["month-total"]=product["$"]["month"]*12;product["$"]["year-total"]=product["$"]["year"]*12}}}addMonthAndYearTotals(countryCurrencyPrices);var noYearlyDiscount={};var periodTxt={year:__("billed_annually"),month:__("billed_monthly")};function setSessionObject(type){if(typeof Storage!=="undefined"){if(type!="partial-update"){sessionStorage.setItem("pCloudUpdated",(new Date).getTime())}sessionStorage.setItem("pCloud",JSON.stringify(pCloud))}}function storePurchaseDataLocally(purchaseData){if(typeof Storage==="undefined"||typeof localStorage==="undefined"||localStorage===null){return}var purchases=getPurchaseData();purchases.push(purchaseData);localStorage.setItem("purchases",JSON.stringify(purchases))}function getPurchaseData(){if(typeof Storage==="undefined"||typeof localStorage==="undefined"||localStorage===null){return[]}var purchases=localStorage.getItem("purchases");if(purchases){return JSON.parse(purchases)}else{return[]}}function clearPurchaseData(){localStorage.removeItem("purchases")}function apiCall(method,params,onSuccess,onError,opts){var dfd=jQuery.Deferred();var opts=$.extend({errorCallback:function(data){dfd.reject(data);if(typeof onError==="function"){onError(data)}}},opts);pCloudGlobals.apiMethod(method,params,function(data){if(typeof onSuccess==="function"){onSuccess(data)}dfd.resolve(data)},opts);return dfd.promise()}function apiCallPost(method,params,onSuccess,onError,opts){var dfd=jQuery.Deferred();var opts=$.extend({type:"POST",errorCallback:function(data){dfd.reject(data);if(typeof onError==="function"){onError(data)}}},opts);pCloudGlobals.apiMethod(method,params,function(data){dfd.resolve(data);if(typeof onSuccess==="function"){onSuccess(data)}},opts);return dfd.promise()}function createPcloudObj(){pCloud={api:api.split(".")[0],user:false,subscription:false,paymentSource:false,quota:false,quotaUsed:false,quotaLeft:false,pubLinkQuota:false,isLifetime:false,rtl:isRtl,subscriptionCanceled:false,dlDriveCount:0,isRetina:detectedRetina,isMobile:detectedMobile,isTablet:detectedTablet,planName:false,subDomain:domain(),browser:detectBrowser(),os:detectOS(),osVersion:detectOS(true),osShort:detectOS(false,true),ccardType:"stripe",ref:hrefSearch("ref")||$.cookie("ref")||0,lang:currentLang||$.cookie("set_lang")||$.cookie("lang")||"en",windowWidth:domBody.clientWidth,windowHeight:window.innerHeight,host:host()}}function initPcloudObject(callback){initCallback=callback||initCallback;apiCallQueue=[];createPcloudObj();checkIfUserLogged();$.when.apply($,apiCallQueue).then(function(data){userInited=true;setSessionObject();renderCommonHTML();initUserDropdown();initDevAddon();$.removeCookie("initPcloudObjectUpdate");handleCallback(initCallback)})}function checkIfUserLogged(callback){var token=hrefSearch("authtoken");if(token){$.cookie("pcauth",token,{domain:pCloud.host,path:"/",expires:365});window.location.replace(window.location.href.replace(new RegExp("authtoken="+token+"\\&?"),""))}if(!pCloud.user){if($.cookie("pcauth")){domBody.classList.add("logged_in");domBody.classList.remove("logged_out");if(!detectedMobile&&!detectedTablet&&siteLogo){siteLogo.setAttribute("href",myPcloudURL)}if(skipUserCheck){var data=skipUserCheck;pCloud.user=data;pCloud.user.auth=data.auth;pCloud.planName=getPlanName(data.plan,data);pCloud.quota=renderQuota(data.quota);pCloud.quotaUsed=renderQuota(data.usedquota);pCloud.quotaLeft=renderQuota(data.quota-data.usedquota);pCloud.pubLinkQuota=renderQuota(data.publiclinkquota);pCloud.isLifetime=data.premiumlifetime;skipUserCheck=false;apiCallQueue.push(getCurrency())}else{apiCallQueue.push(getUserInfo())}apiCallQueue.push(getSubscription());apiCallQueue.push(getPaymentSources())}else{domBody.classList.remove("logged_in");domBody.classList.add("logged_out");if(siteLogo){siteLogo.setAttribute("href","/")}handleCallback(callback)}}else if(pCloud.user){domBody.classList.add("logged_in");domBody.classList.remove("logged_out");if(!detectedMobile&&!detectedTablet&&siteLogo){siteLogo.setAttribute("href",myPcloudURL)}}}function loginUser(callback){var obj=$(".modal.login");var email=obj.find('input[type="email"]');var password=obj.find('input[type="password"]');var authexpires=$("#login_remember").prop("checked")?15552e3:null;var button=obj.find(".bottom .btn");$(".modal .error").hide();if(!email.val().length){modalError(false,__("email_required"),email)}else if(!isValidEmailAddress(email.val())){modalError(false,__("email_not_valid"),email)}else if(!password.val().length){modalError(false,__("pass_required"),password)}else{modalLoading(true);call.apiCall("userinfo",{getauth:1,username:email.val(),password:password.val(),authexpire:authexpires,getlastsubscription:1,promoinfo:1},function success(data){skipUserCheck=data;domBody.classList.add("logged_in");domBody.classList.remove("logged_out");$.cookie("pcauth",data.auth,{domain:pCloud.host,path:"/",expires:365});email.val("");password.val("");modalLoading(false);closeModal();checkNewsletter();initPcloudObject();handleCallback(login_callback);if(typeof _learnq!=="undefined"){_learnq.push(["identify",{$email:data.email,$id:data.userid}])}},function error(data){modalLoading(false);if(data.result==2205){call.apiCall("account_getmanager",{username:email.val(),password:password.val()},function(data){var manager="<br><b>"+data.firstname+" "+data.lastname+' <a href="mailto:'+data.email+'">'+data.email+"</a></b>";var message=__("ba_expired_owner_error").replace(/%manager%/,manager);modalError(false,message,button)},function(data){if(data.result==2231){var message=__("ba_expired_owner_no_acc_error").replace(/%sales_email%/,'<a href="mailto:sales@pcloud.com">sales@pcloud.com</a>');modalError(false,message,button)}})}else if(data.result==2229){call.apiCall("account_getowner",{username:email.val(),password:password.val()},function(data){var baOwner="<br><b>"+data.firstname+" "+data.lastname+' <a href="mailto:'+data.email+'">'+data.email+"</a></b>";var message=__("ba_expired_user_error").replace(/%ba_owner%/,baOwner);modalError(false,message,button)})}else{var loginError="_error_"+data.result in jstranslations?__("_error_"+data.result):data.error;modalError(false,loginError,button)}})}}function registerUser(callback){var obj=$(".modal.register");var email=obj.find('input[type="email"]');var password=obj.find("input#check_complex");var terms=obj.find('[name="trms"]');var button=obj.find(".bottom .btn");$(".modal .error").hide();if(!email.val().length){modalError(false,__("email_required"),email)}else if(!isValidEmailAddress(email.val())){modalError(false,__("email_not_valid"),email)}else if(!password.val().length){modalError(false,__("pass_required"),password)}else if(password.val().length<=5){modalError(false,__("Minimum length is 6 characters."),password)}else if(!terms.prop("checked")){modalError(false,__("must_accept_terms"),terms)}else{var registerData={termsaccepted:"yes",mail:email.val(),password:password.val(),os:"4",device:navigator.userAgent,language:pCloud.lang,ref:pCloud.ref};modalLoading(true);call.apiCallPost("register",registerData,function success_callback(data){if(location.hostname=="www.pcloud.com"&&$.cookie("shareasale")){$('<img src="https://shareasale.com/sale.cfm?amount=0.00&tracking='+data.userid+'&transtype=lead&merchantID=66775&xtype=registration" width="1" height="1">');$.removeCookie("shareasale",{path:"/"})}fbq("track","CompleteRegistration");call.apiCall("userinfo",{getauth:1,username:email.val(),password:password.val(),authexpire:null,getlastsubscription:1,promoinfo:1},function success(data){domBody.classList.add("logged_in");domBody.classList.remove("logged_out");pCloud.user=data;pCloud.user.auth=data.auth;pCloud.subscription=false;pCloud.paymentSource=false;pCloud.planName=getPlanName(data.plan,data);pCloud.quota=renderQuota(data.quota);pCloud.quotaUsed=renderQuota(data.usedquota);pCloud.quotaLeft=renderQuota(data.quota-data.usedquota);pCloud.pubLinkQuota=renderQuota(data.publiclinkquota);pCloud.isLifetime=data.premiumlifetime;$.cookie("pcauth",data.auth,{domain:pCloud.host,path:"/",expires:365});email.val("");password.val("");setSessionObject();modalLoading(false);closeModal();handleCallback(register_callback,callback);fbq("track","CompleteRegistration");if(registerDlApp){openModal("download_app",false,function(){$(".modal.download_app .close").off("click").on("click.closedlapp",function(){if(pCloud.isMobile){closeModal()}else{if(inFBnxfo){window.parent.location.href=myPcloudURL}else{window.location=myPcloudURL}}})})}handleCallback(initCallback)},function error(data){modalError(data,false,button);modalLoading(false)})},function error(data){modalError(data,false,button);modalLoading(false)})}}function logoutUser(callback,removeCookie){function onApiLogout(){pCloudNewsletter=false;if(typeof Storage!=="undefined"){sessionStorage.setItem("pCloudNewsletter",JSON.stringify(pCloudNewsletter))}if(removeCookie){if(typeof removeCookie=="string"){logoutCookies.push(removeCookie)}else if(typeof removeCookie=="object"){for(var i in removeCookie){logoutCookies.push(removeCookie[i])}}}domBody.classList.remove("logged_in","is_premium");domBody.classList.add("logged_out");if(siteLogo){siteLogo.setAttribute("href","/")}for(var i in logoutCookies){$.removeCookie(logoutCookies[i],{domain:pCloud.host,path:"/"})}if(pCloud.isMobile&&$("body").hasClass("menu-visible")){$(".mobile-menu-btn").trigger("click")}else{closeModal()}pCloudGlobals.state.actions.user.logout();updateUserLogo();getCurrency();initPcloudObject();handleCallback(logout_callback,callback);closeUnverifiedUsersAlert()}if($.cookie("pcauth")){call.apiCall("logout",{auth:$.cookie("pcauth")},function success(data){onApiLogout()},function error(ret){onApiLogout()})}else{onApiLogout()}}function updateUserLogo(){if($.cookie("pcauth")&&$.cookie("locationid")=="2"){$("#img-logo").attr("src",globalFilesPath+"/img/header/eu-logo.png")}else{$("#img-logo").attr("src",globalFilesPath+"/img/header/logo.png")}}var subscribeForPcloudInit=function(){var callbacks=[];var watcherStarted=false;function startUserinitedWatcher(){var interval=setInterval(function(){if(userInited){clearInterval(interval);callbacks.forEach(function(callback){handleCallback(callback)})}},5)}return function(callback){callbacks.push(callback);if(userInited){callbacks.forEach(function(callback){handleCallback(callback)});return}if(!watcherStarted){watcherStarted=true;startUserinitedWatcher()}}}();var onPcloudInit=subscribeForPcloudInit;function checkPcloudInited(callback){subscribeForPcloudInit(function(){handleCallback(callback)});setTimeout(function(){userInited=true},45e3)}function getUserInfo(token,callback){var pcauth=token||$.cookie("pcauth");var userInfoParams={auth:pcauth,getlastsubscription:1,promoinfo:1};if($.cookie("account_token")){userInfoParams["accounttoken"]=$.cookie("account_token")}return call.apiCall("userinfo",userInfoParams,function(data){pCloud.user=data;pCloud.user.auth=pcauth;pCloud.planName=getPlanName(data.plan,data);pCloud.quota=renderQuota(data.quota);pCloud.quotaUsed=renderQuota(data.usedquota);pCloud.quotaLeft=renderQuota(data.quota-data.usedquota);pCloud.pubLinkQuota=renderQuota(data.publiclinkquota);pCloud.isLifetime=data.premiumlifetime;apiCallQueue.push(getCurrency());domBody.classList.add("logged_in");domBody.classList.remove("logged_out");closeModal();checkNewsletter();handleCallback(callback)},function error_callback(){$.removeCookie("pcauth",{domain:pCloud.host,path:"/"});$.removeCookie("locationid",{domain:domain});handleCallback(callback)})}function getCurrency(){var params={};getCurrencyTries++;if(getCurrencyTries>=5){updateCurrency();return}if($.cookie("pcauth")){params["auth"]=$.cookie("pcauth")}if($.cookie("forcecurrency")){params["currency"]=$.cookie("forcecurrency")}if($.cookie("forcecountry")){params["country"]=$.cookie("forcecountry")}function onError(){setTimeout(function(){getCurrency()},300)}setTimeout(function(){updateCurrency()},2e3);return call.apiCall("getcurrency",params,function(data){if(data.currency){pclCurrency=currencyMap[data.currency];updateCurrency()}else{onError()}},function error_callback(error){onError()})}function getSubscription(success_callback,error_callback){return call.apiCall("listpaymentsubscriptions",{auth:$.cookie("pcauth")},function success(data){if(data.subscriptions.length){pCloud.subscription=data.subscriptions}else if(pCloud.user.premium){pCloud.subscriptionCanceled=true}handleCallback(success_callback)},function error(data){handleCallback(error_callback)})}function getPaymentSources(success_callback,error_callback){return call.apiCall("listpaymentsources",{auth:$.cookie("pcauth")},function success(data){if(Object.keys(data).length>1){pCloud.paymentSource=data}handleCallback(success_callback)},function error(data){handleCallback(error_callback)})}function getIP(success_callback,error_callback){return call.apiCall("getip",{},function success(data){if(data.ip){pCloudUserIP=data}handleCallback(success_callback)},function error(data){handleCallback(error_callback)})}function listAvailablePaymentMethods(additionalParams){var params={auth:$.cookie("pcauth")};if($.cookie("forcecard")){params.card=$.cookie("forcecard")}if($.cookie("forcecountry")){params.country=$.cookie("forcecountry")}params=$.extend(additionalParams,params);return call.apiCall("listpaymentmethods",params,function success(data){if(data.paymentmethods){data.paymentmethods.map(function(res){if(res.type=="card"){pCloud.ccardType=res.method}});setSessionObject("partial-update")}},function error(data){pCloud.ccardType=pCloud.ccardType||"stripe"})}function handleCallback(call1,call2){if(typeof call1=="function"){call1()}if(typeof call2=="function"){call2()}}function verifyEmail(code){return call.apiCall("verifyemail",{code:code},function success(data){if(pCloud.user){pCloud.user.emailverified=true;setSessionObject()}window.location=location.origin+location.pathname},function error(data){})}function checkNewsletter(){if($.cookie("pcauth")){return call.apiCall("newsletter_check",{auth:$.cookie("pcauth")},function success(data){pCloudNewsletter=data.subscribed;if(typeof Storage!=="undefined"){sessionStorage.setItem("pCloudNewsletter",JSON.stringify(pCloudNewsletter))}},function error(data){})}else{pCloudNewsletter=false;if(typeof Storage!=="undefined"){sessionStorage.setItem("pCloudNewsletter",JSON.stringify(pCloudNewsletter))}return false}}function resetPassword(){var obj=$(".modal.reset_password");var email=obj.find('input[type="email"]');var button=obj.find(".bottom .btn");if(!email.val().length){modalError(false,__("email_required"),email)}else if(!isValidEmailAddress(email.val())){modalError(false,__("email_not_valid"),email)}else{modalLoading(true);call.apiCall("lostpassword",{mail:email.val()},function success(data){modalLoading(false);obj.addClass("success");obj.find(".close").on("click.closepass",function(){closeModal();email.val("");obj.removeClass("success")})},function error(data){modalError(data,false,button);modalLoading(false)})}}function newsletterSubscribe(){var input=$('input[name="subscribe-email"]');function showError(error){input.data("tooltip",error);showTooltip(input,-10);setTimeout(function(){$(".tooltip_box").fadeOut(200,function(){hideError()})},2e3)}function hideError(){input.data("tooltip","");$(".tooltip_box").remove()}input.on("click.removetooltip",function(){hideError()}).on("keydown.removetooltip",function(){hideError()}).on("mouseenter",function(){input.data("tootltip","")});if(!input.val().length){showError(__("email_required"))}else if(pCloud.user&&pCloudNewsletter&&input.val()==pCloud.user.email){showError(__("This email is already subscribed."))}else if(!isValidEmailAddress(input.val())){showError(__("email_not_valid"))}else{call.apiCallPost("newsletter_subscribe","mail="+input.val(),function(data){if(data.error){alert(data.error)}else{pCloudNewsletter=true;if(typeof Storage!=="undefined"){sessionStorage.setItem("pCloudNewsletter",JSON.stringify(pCloudNewsletter))}openModal("newsletter_welcome");input.val("")}})}}function checkPcloudChanges(){if(pCloud.user&&pCloud.user.auth!=$.cookie("pcauth")||!pCloud.user&&$.cookie("pcauth")){sessionStorage.removeItem("pCloud");initPcloudObject()}else{pCloud.api=api;pCloud.rtl=isRtl;pCloud.isRetina=detectedRetina;pCloud.isMobile=detectedMobile;pCloud.isTablet=detectedTablet;pCloud.windowWidth=domBody.clientWidth;pCloud.windowHeight=window.innerHeight;pCloud.os=detectOS();pCloud.osVersion=detectOS(true);pCloud.osShort=detectOS(false,true);pCloud.lang=currentLang||$.cookie("set_lang")||$.cookie("lang");if(!$.cookie(pCloud.ref)){pCloud.ref=$.cookie("ref")?$.cookie("ref"):0}setSessionObject("partial-update");renderCommonHTML()}}function fadeIn(node,callback,speed,forceBlock){var fadeInClass="animate-fade-in";if(speed&&speed in animationSpeeds){fadeInClass+=" "+animationSpeeds[speed]}node.on(animationEnd,function(){node.off(animationEnd).show().removeClass("animate-fade-in");if(typeof callback=="function"){callback()}}).removeClass("animate-fade-in animate-fade-out").addClass(fadeInClass);if(forceBlock){node.css({display:"block"})}else{node.show()}}function fadeOut(node,callback,speed){var fadeOutClass="animate-fade-out";if(speed&&speed in animationSpeeds){fadeOutClass+=" "+animationSpeeds[speed]}node.on(animationEnd,function(){node.off(animationEnd).hide().removeClass("animate-fade-out");if(typeof callback=="function"){callback()}}).removeClass("animate-fade-in animate-fade-out").addClass(fadeOutClass)}function getPlanName(planID,user){var result="Unknown";if(user&&user.business){result=__("Business")}else if(productNameMap[planID]){result=productNameMap[planID].short}return result}function checkLanguage(){if(pCloud.user&&pCloud.user.language!=pCloud.lang){call.apiCallPost("setlanguage",{language:pCloud.lang,auth:pCloud.user.auth},function success(){pCloud.user.language=pCloud.lang;setSessionObject("partial-update")},function error(){})}}function setLanguage(lang,URL,callback){$.cookie("lang",lang,{domain:pCloud.host,path:"/"});pCloud.lang=lang;if(pCloud.user&&URL){pCloud.user.language=lang}setSessionObject("partial-update");handleCallback(callback)}function domain(){var d="www";if(location.hostname.indexOf("tmp")!=-1)d=location.hostname.split(".")[0];if(location.protocol=="http:")d="local";return d}function host(){return location.protocol=="http:"&&!~location.hostname.indexOf(".com")?location.hostname:".pcloud.com"}function detectBrowser(){var a;if(!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0)a="opera";if(typeof InstallTrigger!=="undefined")a="firefox";if(Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0||function(p){return p.toString()==="[object SafariRemoteNotification]"}(!window["safari"]||safari.pushNotification))a="safari";if(false||!!document.documentMode)a="ie";if(a!="ie"&&!!window.StyleMedia)a="ie";if(!!window.chrome&&!!window.chrome.webstore)a="chrome";return a}function renderQuota(value){var thresh=1024;var bytes=value;var units=["","KB","MB","GB","TB","PB","EB","ZB","YB"];var u=0;if(bytes<thresh)return bytes+" B";do{bytes/=thresh;++u}while(bytes>=thresh);return cleanFloat(bytes)+" "+units[u]}function downloadPcloudDrive(os,callback){var code;if(os){code=driveDLcode[os]}else{var unify={"windows-10":"Windows 10","Windows 10":"Windows 10","Windows 8":"Windows 8","Windows 7":"Windows 7","Windows Server 2003":"Windows Vista","Windows Vista":"Windows Vista","Windows ME":"Windows XP","Windows 98":"Windows XP","Windows NT 4.0":"Windows XP",Linux:"Electron","Linux 64bit":"Electron","Linux 32bit":"Electron 32bit",UNIX:"Electron","Mac OS X":"Mac","Mac OS":"Mac","Electron 32bit":"Electron 32bit"};code=driveDLcode[unify[pCloud.os]]}pCloud.dlDriveCount++;if(pCloud.isMobile){if(!os||os!="Android apk"){openModal("dl_drive_mobile");handleCallback(callback);return}}if(pCloud.dlDriveCount>=50){return}call.apiCall("getpublinkdownload",{code:code},function success(data){window.location="//"+data.hosts[0]+""+data.path;pCloud.dlDriveCount++;if(typeof callback=="function"){callback()}else{if(os&&(os=="Android apk"||os=="Lightroom")){return}setTimeout(function(){if(inFBnxfo){window.parent.location.href=dlDriveSuccess[pCloud.osShort]}else{window.location=dlDriveSuccess[pCloud.osShort]}},3200)}},function error(data){})}function scrollTo(toElement,callback,animationTime){var scrollValue=typeof toElement=="number"?toElement:toElement.offset().top||0;var duration=animationTime||400;$("html, body").animate({scrollTop:scrollValue},duration,function(){handleCallback(callback)})}function loadResources(images,subFolder,callback){var done=0;var count=images.length;var checkRetina=window.devicePixelRatio>1?"@2x":"";var path=subFolder?CDN+"images/"+subFolder:CDN+"images/";var callbackCalled=false;$(images).each(function(){var fileName=this.split(".");fileName=fileName[0]+checkRetina+"."+fileName[1];$("<img>").attr("src",path+fileName).on("load.resources",function(){done++;if(done===count){handleCallback(callback)}}).error(function(error){var notFound=/[^/]*$/.exec($(this)[0].src)[0];if(notFound.indexOf("@2x")!=-1){var fileName=notFound.split("@2x.");fileName=fileName[0]+"."+fileName[1];$("<img>").attr("src",path+fileName)}if(!callbackCalled){callbackCalled=true;handleCallback(callback)}})})}function animatePrice(element,currentPrice,priceToReach,priceSpeed){var price1=isRtl?currentPrice*6e4:currentPrice;var price2=isRtl?priceToReach*6e4:priceToReach;var delimiter=isRtl?0:2;var animatePriceSpeed=priceSpeed||50;if(price2%1==0){delimiter=0}if(isNaN(currentPrice)){price1=0}var jump=Math.abs(((price2-price1)/animatePriceSpeed).toFixed(delimiter));function animate(){setTimeout(function(){if(price1<price2){if(price1+jump>price2){price1=price2}else{price1+=jump}animate()}else if(price1>price2){if(price1-jump<price2){price1=price2}else{price1-=jump}animate()}},10);element.html(parseFloat(Math.round(price1*100)/100).toFixed(delimiter))}animate()}function animationEndEvent(){var i;var el=document.createElement("el");var animations={transition:"animationend",OTransition:"oAnimationEnd",MozTransition:"animationend",WebkitTransition:"webkitAnimationEnd"};for(i in animations){if(el.style[i]!==undefined){return animations[i]}else{return false}}}function transitionEndEvent(){var i;var el=document.createElement("el");var animations={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(i in animations){if(el.style[i]!==undefined){return animations[i]}else{return false}}}function windowResize(){$(window).on("resize.getsize",function(){$(window).off("resize.getsize");setTimeout(function(){pCloud.windowWidth=domBody.clientWidth;pCloud.windowHeight=window.innerHeight;if(onResizeFunctions){for(var i in onResizeFunctions){onResizeFunctions[i]()}}windowResize()},30)})}function modalError(data,forceMessage,input){var error_box=$(".modal:visible").find(".error");var error=forceMessage||data.error;var topMargin=input.data("tooltip-margin")||-10;function removeTooltip(){input.data("tootltip","");$(".tooltip_box").remove()}input.data("tooltip",error).on("click.removetooltip",function(){removeTooltip()}).on("keydown.removetooltip",function(){removeTooltip()}).on("mouseenter",function(){input.data("tootltip","")});showTooltip(input,topMargin);if(input&&!pCloud.isMobile){input.focus()}setTimeout(function(){$(".tooltip_box").fadeOut(200,function(){removeTooltip()})},2e3)}function modalLoading(enable){var obj=$(".modal:visible");if(enable){obj.find(".mask").show();obj.find("input").attr("disable");obj.find(".bottom .btn:visible").css({"text-indent":"-100000px"}).find(".spinner").addClass("animate")}else{obj.find(".mask").hide();obj.find("input").removeAttr("disable");obj.find(".bottom .btn:visible").css({"text-indent":0}).find(".spinner").removeClass("animate")}}function stringFit(string,length){length=length||50;if(string.length<=length)return string;length-=3;var head=Math.floor(length*.85),tail=length-head;return string.substring(0,head)+"<span>...</span>"+string.substring(string.length-tail)}function fitEmail(string,length){var n=string.indexOf("@"),left=Math.max(18,length-(string.length-n));length=length||18;return stringFit(string.substring(0,n),left)+string.substring(n)}function openModalAdjustments(){swipeEnabled=false;domBody.classList.add("overlayed");if(!pCloud.isMobile&&!pCloud.rtl){function resizeElements(){var containTargets=document.getElementsByClassName("modal_contain");for(var i in containTargets){var el=containTargets[i];if(typeof el=="object"){el.style.width=window.innerWidth-scrollWidth+"px"}}}if(scrollWidth>0){resizeElements();onResizeFunctions["on_modal_open_resize"]=function(){resizeElements()}}}}function openModal(modal_class,animate,onOpen,onClose,func){modal=modalData;modal.obj=$(".modal."+modal_class);modal.animate=animate!=undefined?animate:modalData.animate;modal.onOpen=onOpen;modal.onClose=onClose;modal.func=func;$(".modal").removeClass("fade_in fade_out fading").hide().off(modal.transitionEnd).find(".error").hide();$(".tooltip_box").remove();if(modal.obj.length){modal.obj.on("click.overlayclose",function(e){if(e.target.className.indexOf("modal_wrap")!=-1&&e.target.className.indexOf("no_overlay_close")==-1){closeModal()}}).find(".close").off("click").on("click",function(){closeModal()});if(modal.animate&&modal.transitionEnd){modal.obj.removeClass("fade_out").addClass("fading").show(0,function(){modal.obj.addClass("fade_in").off(modal.transitionEnd).on(modal.transitionEnd,function(){openModalAdjustments();if(onOpen&&typeof onOpen=="function"){modal.onOpen()}})})}else{modal.obj.show();openModalAdjustments();if(modal.onOpen&&typeof modal.onOpen=="function"){modal.onOpen()}}if(modal.func&&typeof modal.func=="function"){modal.func()}}}function closeModalAdjustments(){swipeEnabled=true;domBody.classList.remove("overlayed");if(!pCloud.isMobile){var containTargets=document.getElementsByClassName("modal_contain");for(var i in containTargets){var el=containTargets[i];if(typeof el=="object"){el.style.width=""}}}}function closeModal(modal_class,func){if(modal_class){modal.obj=$(".modal."+modal_class)}if(modal&&modal.obj.length){if(modal.animate&&modal.transitionEnd){modal.obj.removeClass("fade_in").addClass("fade_out").off(modal.transitionEnd).on(modal.transitionEnd,function(){modal.obj.hide();closeModalAdjustments();if(modal.onClose&&typeof modal.onClose=="function"){modal.onClose()}})}else{modal.obj.hide();closeModalAdjustments();if(modal.onClose&&!modal.animate&&typeof modal.onClose=="function"){modal.onClose()}}}else{$(".modal").hide().removeClass("fade_in")}if(modal&&modal.func&&typeof modal.func=="function"){modal.func()}delete onResizeFunctions["on_modal_open_resize"]}function onAuthAction(data){domBody.classList.add("logged_in");domBody.classList.remove("logged_out");if(!detectedMobile&&!detectedTablet&&siteLogo){siteLogo.setAttribute("href",myPcloudURL)}$.cookie("pcauth",data.userinfo.auth,{domain:pCloud.host,path:"/",expires:365});$.cookie("locationid",data.locationid,{domain:pCloud.host,path:"/",expires:365});updateUserLogo();if(data.action=="login"||data.action=="facebook-login"||data.action=="google-login"||data.action=="apple-login"){skipUserCheck=data.userinfo;pCloudGlobals.state.actions.user.login(data.userinfo,data.userinfo.auth);if(typeof gaAll=="function"){gaAll("event","Page "+currentPageClass.toUpperCase()+" login","click",data.action)}closeModalAdjustments();checkNewsletter();initPcloudObject();handleCallback(login_callback);initUnverifiedUsersAlert();if(typeof _learnq!=="undefined"){_learnq.push(["identify",{$email:data.email,$id:data.userid}])}}if(data.action=="register"||data.action=="facebook-register"||data.action=="google-register"||data.action=="apple-register"){if($.cookie("shareasale")){$('<img src="https://shareasale.com/sale.cfm?amount=0.00&tracking='+data.userinfo.userid+'&transtype=lead&merchantID=66775&xtype=registration" width="1" height="1">');$.removeCookie("shareasale",{path:"/"})}if(typeof gaAll=="function"){gaAll("event","Page "+currentPageClass.toUpperCase()+" register","click",data.action)}fbq("track","CompleteRegistration");var retUser=data.userinfo;pCloud.user=retUser;pCloud.user.auth=retUser.auth;pCloud.subscription=false;pCloud.paymentSource=false;pCloud.planName=getPlanName(retUser.plan,retUser);pCloud.quota=renderQuota(retUser.quota);pCloud.quotaUsed=renderQuota(retUser.usedquota);pCloud.quotaLeft=renderQuota(retUser.quota-retUser.usedquota);pCloud.pubLinkQuota=renderQuota(retUser.publiclinkquota);pCloud.isLifetime=retUser.premiumlifetime;pCloudGlobals.state.actions.user.login(data.userinfo,data.userinfo.auth);setSessionObject();checkPcloudChanges();initUserDropdown();handleCallback(register_callback);initDevAddon();if(registerDlApp){openModal("download_app",false,function(){$(".modal.download_app .close").off("click").on("click.closedlapp",function(){if(pCloud.isMobile){closeModal()}else{if(inFBnxfo){window.parent.location.href=e.target.href}else{window.location=myPcloudURL}}})})}handleCallback(initCallback)}}function openGlobalModal(type,onOpenFunction,opts){$(".modal:visible").removeClass("fade_in fade_out fading").hide().off(modalData.transitionEnd).find(".error").hide();var params=$.extend({onForgotPassword:function(){pCloudGlobals.Popup.close();openModal("reset_password")},language:pCloud.lang},opts);pCloudGlobals.authModal(type,function onGetUserData(data){onAuthAction(data)},params,{onReady:function(){openModalAdjustments();handleCallback(onOpenFunction)},onClose:function(){closeModalAdjustments()}})}function resizeTop(){$("header").css("height","auto");$(".p_download").css("paddingTop",$("header").outerHeight()-60);$(".plans_wrap").css("paddingTop",$("header").outerHeight());$("#p_crypto").css("paddingTop",$("header").outerHeight()-60);$("#p_affiliate, #p_reseller").css("paddingTop",$("header").outerHeight()-60);$(".monials_top_inner").css("marginTop",$("header").outerHeight());$(".monials_top_inner").css("backgroundPosition",0);$(".home .section.top").css("paddingTop",$("header").outerHeight());$(".home-eu .section.top").css("paddingTop",$("header").outerHeight());$(".family_wrap").css("paddingTop",$("header").outerHeight());$(".thanks_box").css("paddingTop",$("header").outerHeight());$(".p_download .tabs_mega_wrap").css("top",$("header").outerHeight());$(".microheader-wrap.faq").css("marginTop",$("header").outerHeight());if(pCloud.isMobile){$(".top_nav_links_holder").css("top",$("header").outerHeight());$(".downloads.modal_contain").css("paddingTop",$("header").outerHeight());$(".micro-content-wrap .menu").css("top",$("header").outerHeight()+40);$(".microheader-wrap.faq").attr("style","margin-top: "+$("header").outerHeight()+"px !important")}}function initUnverifiedUsersAlert(){function verifyEmail(){openModal("email_verify",true,false,false,function(){var node=$(".email_verify .user_message");node.html(node.html().replace("%email%",pCloud.user.email))});call.apiCall("sendverificationemail",{auth:pCloud.user.auth},function success(data){},function error(data){})}var cont=$(".unverified-users-alert");var isPremium=pCloud.user.subscription||pCloud.user.premiumlifetime||pCloud.user.cryptolifetime||pCloud.user.business||pCloud.user.vivapcloud;var verifiedEmail=pCloud.user&&pCloud.user.emailverified;if(pCloud.user&&pCloud.user.auth&&!isPremium&&!verifiedEmail&&!cont.children().get(0)){var auth=pCloud.user.auth;call.apiCall("checkverifyrestriction",{auth:auth},function success(data){if(data.showwarning){pCloudGlobals.components.UnverifiedUsersAlert(cont[0],{showVerifyMail:verifyEmail});$("header").prepend(cont);resizeTop()}},function error(data){})}}function closeUnverifiedUsersAlert(){if($(".unverified-users-alert").children().length){$(".unverified-users-alert").children().get(0).remove();resizeTop()}}function insertForm(type,toElement,success,opts){console.log("insertForm common",arguments);var node=toElement[0]||false;opts=opts||{};var successCallback=function(){handleCallback(success)};var props=$.extend({onSuccess:function(data){onAuthAction(data);successCallback(data)},onForgotPassword:function(){openModal("reset_password")},language:pCloud.lang},opts);if(!node){console.error("Invalid DOM node")}else{if(type=="login"&&pCloudGlobals.components){formLoginInserted=pCloudGlobals.components.Signin(node,props)}else if(type=="register"&&pCloudGlobals.components){formRegisterInserted=pCloudGlobals.components.Signup(node,props)}else if(type=="business"&&pCloudGlobals.components){var businessProps=$.extend(props,{shouldRednerNames:false,noDefaultFiles:true,formWidth:"450px",initLoginRegModal:openGlobalModal,tooltip:{key:"data_region_tooltip_register_business",text:"A data region is where your data will be stored and it applies for all users who join your Business account."}});if(formRegisterBusinessInserted){formRegisterBusinessInserted()}formRegisterBusinessInserted=pCloudGlobals.components.RegistrationForm(node,businessProps)}}}function initTopNotificationBar(){var cont=$(".topbar-notification");cont.find(".close-button").off("click").on("click",function(){$.cookie("showedTopbarNotification",1);gaAll("event","letter_bar","click");cont.animate({maxHeight:0,opacity:.8},{duration:200,progress:function(){resizeTop()},end:function(){$(this).hide()}})});if(!$.cookie("showedTopbarNotification")){cont.css("display","flex");cont.animate({maxHeight:60,opacity:1},{duration:200,progress:function(){resizeTop()}});gaAll("event","letter_bar","show")}}function initUserDropdown(toElement){var nodeHolder=toElement?toElement[0]:userDropdownWrap;if(!nodeHolder){return}if(pCloudGlobals&&pCloudGlobals.components){pCloudGlobals.components.UserHeader(nodeHolder,{language:pCloud.lang,onChangeLanguage:function(langCode){$('.other-langs .set-lang[data-lang="'+langCode+'"]').trigger("click")},onLogoutRequest:function(){logoutUser()},onUnverifiedStatusClick:function(){openModal("email_verify",true,false,false,function(){var node=$(".email_verify .user_message");node.html(node.html().replace("%email%",pCloud.user.email))});call.apiCall("sendverificationemail",{auth:pCloud.user.auth},function success(data){},function error(data){})},onLoginRequest:function(){openGlobalModal("login")}})}if(pCloud.user&&pCloudGlobals&&pCloudGlobals.state){pCloudGlobals.state.actions.user.login(pCloud.user,pCloud.user.auth)}}function showTooltip(element,margin,effect){if(!element.data("tooltip")){return}var transitionEnd=animationEndEvent();var tooltipType="";var showEffect="";var hideEffect="";var arrowBorder="";var effectsMap={1:{show:"movedown-fadein",hide:"moveup-fadeout"}};clearTimeout(tooltipTimeout);if(element.data("tooltip-type")){tooltipType=" "+element.data("tooltip-type");if(element.data("tooltip-type")=="white"){arrowBorder='<div class="arrow_border"></div>'}}if(element.data("tooltip-effect")){showEffect=" "+effectsMap[element.data("tooltip-effect")]["show"];hideEffect=" "+effectsMap[element.data("tooltip-effect")]["hide"]}if(element.data("tooltip-show-type")){showEffect=" "+element.data("tooltip-show-type")}if(element.data("tooltip-hide-type")){hideEffect=" "+element.data("tooltip-hide-type")}$(".tooltip_box").remove();$("body").append('<div class="tooltip_box'+tooltipType+showEffect+'" style="display: none;">'+element.data("tooltip")+arrowBorder+'<div class="arrow"></div></div>');var tooltipBox=$("body").find(".tooltip_box");var topMargin=element.offset().top-tooltipBox.outerHeight()-element.outerHeight()/2;var leftMargin=element.offset().left-tooltipBox.outerWidth()/2+element.outerWidth()/2;var extraMargin=margin||element.data("tooltip-margin")||0;if(extraMargin<0){topMargin-=Math.abs(extraMargin)}else{topMargin+=extraMargin}if(topMargin<0){tooltipBox.addClass("bottomed")}if(pCloud.isMobile){tooltipBox.css({left:leftMargin,top:Math.abs(topMargin)}).show()}else{tooltipTimeout=setTimeout(function(){if(element.is(":hover")){tooltipBox.css({left:leftMargin,top:Math.abs(topMargin)}).show()}},50)}if(pCloud.isMobile){if(pCloud.windowWidth<=419){var arrowPosition=element.offset().left+(element.outerWidth()/2-14);tooltipBox.css({"max-width":pCloud.windowWidth-60,left:15});topMargin=element.offset().top-tooltipBox.outerHeight()-element.outerHeight()/2;if(extraMargin<0){topMargin-=Math.abs(extraMargin)}else{topMargin+=extraMargin}if(topMargin<0){tooltipBox.addClass("bottomed")}tooltipBox.css({top:Math.abs(topMargin)}).find(".arrow").css({left:arrowPosition+"px"})}setTimeout(function(){$(document).on("tap.removetooltip",function(){if(tooltipBox.length){if(hideEffect.length){tooltipBox.on(transitionEnd,function(){tooltipBox.remove()}).addClass(hideEffect.replace(" ",""))}else{tooltipBox.remove()}$(document).off("tap.removetooltip")}})},100)}else{element.on("mouseleave.removetooltip",function(){if(hideEffect.length){tooltipBox.on(transitionEnd,function(){tooltipBox.remove()}).addClass(hideEffect.replace(" ",""))}else{tooltipBox.remove()}})}}function openYoutube(src,title,startAt){var modal=$(".modal.youtube");var source=$(src.target).data("youtube")||$(src.target).parent().data("youtube")||src;var title=$(src.target).data("youtube-title")||$(src.target).parent().data("youtube-title")||title||__("pCloud Video");var startAt="&start="+($(src.target).data("start-at")||$(src.target).parent().data("start-at")||startAt||0);var subtitles="&cc_load_policy="+($(src.target).data("youtube-subtitles")||$(src.target).parent().data("youtube-subtitles")||0);var subtitlesLanguage="&cc_lang_pref="+(pCloud.lang||"en");var youtubeInterfaceLanguage="&hl="+(pCloud.lang||"en");var modalAnimated=$(src.target).data("modal-animate")||$(src.target).parent().data("modal-animate")||false;var modalSpinner=modal.find(".spinner");var iframe=false;var width;var height;var iframeParams={src:source.replace("watch?v=","embed/")+"?autoplay=1&showinfo=0&modestbranding=0&border=0&wmode=opaque&controls=1&rel=0"+startAt+subtitles+subtitlesLanguage+youtubeInterfaceLanguage,frameborder:0,allowfullscreen:""};modalSpinner.removeClass("fade_out").show();openModal("youtube",modalAnimated,false,function(){setTimeout(function(){if(iframe){iframe.remove()}},500);$(window).off("resize.youtube")},function(){function resizeVideo(){if(pCloud.isMobile){width=domBody.clientWidth;height=Math.round(width/(16/9))}else{height=Math.round((window.innerHeight<800?window.innerHeight:800)-200);width=Math.round(height*(16/9))}iframe.css({height:height,width:width})}modal.find(".h1").html(__(title));modal.find(".inner").html($("<iframe>",iframeParams));iframe=modal.find("iframe");setTimeout(function(){modalSpinner.on(transitionEnd,function(){modalSpinner.hide()}).addClass("fade_out");iframe.css({opacity:1})},1300);resizeVideo();(function(){$(window).on("resize.youtube",function(){resizeVideo()})})()})}function updateCurrency(node){var latestCurrency;if(typeof Storage!=="undefined"){if(sessionStorage.pclCurrency){if(pclCurrency!=sessionStorage.pclCurrency){sessionStorage.setItem("pclCurrency",pclCurrency)}latestCurrency=sessionStorage.pclCurrency}else{sessionStorage.setItem("pclCurrency",pclCurrency)}}if(!latestCurrency){return}if(node){node.text(latestCurrency)}$(".sign, .curreny_sign, .currency, .ld_sign").text(latestCurrency);if(typeof plansPage=="function"){plansPage()}}function isValidEmailAddress(email){var pattern=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);return pattern.test(email)}function htmlentities(str){return $("<div>").text(str).html()}function unique(array){return array.filter(function(item,pos){return array.indexOf(item)==pos})}function isTextSelected(e){var input=$(e.target)[0];if(typeof input.selectionStart=="number"){return input.selectionStart==0&&input.selectionEnd==input.value.length}else if(typeof document.selection!="undefined"){input.focus();return document.selection.createRange().text==input.value}}function characterLimit(e,max){var allowTextSelection=pCloud.isMobile?false:isTextSelected(e);if($(e.target).val().length>=max&&!allowTextSelection){return true}else{return false}}function isPrimitive(value){return value==null||typeof value!=="function"&&typeof value!=="object"}function isEqual(a,b){if(!a&&!b)return true;if(!a&&b||a&&!b)return false;var numKeysA=0;var numKeysB=0;var key;for(key in b){numKeysB++;if(!isPrimitive(b[key])||!a.hasOwnProperty(key)||a[key]!==b[key]){return false}}for(key in a){numKeysA++}return numKeysA===numKeysB}function discountValuePercent(discountedValue,originalValue){var result=100-discountedValue/originalValue*100;var decimal=result%1==0?0:1;result=Number(result.toFixed(decimal));if(result%1==0){decimal=0}return Number(result.toFixed(decimal))}function priceAfterDiscount(price,discountPercent){var result=price-price*(discountPercent/100);var decimal=result%1==0?0:2;return Number(result.toFixed(decimal))}function cleanFloat(number){var value=Number(number);var decimal=value%1==0?0:2;var result=Number(value.toFixed(decimal));if(result%1==0){decimal=0}return Number(value.toFixed(decimal))}function joinLastWith(type,array){var lastJoiner=type=="or"?__("or"):__("and");if(array.length>1){return array.slice(0,-1).join(", ")+" "+lastJoiner+" "+array.slice(-1)}else{return array.join("")}}function msToTime(duration,showHours){var seconds=parseInt(duration/1e3%60);var minutes=parseInt(duration/6e4%60);var hours=parseInt(duration/36e5%24);var showHours=showHours!=undefined?showHours:true;hours=hours<10?"0"+hours:hours;minutes=minutes<10?"0"+minutes:minutes;seconds=seconds<10?"0"+seconds:seconds;return(showHours?hours+":":"")+minutes+":"+seconds}function formatMS(milliseconds,type){var typeMap={day:{divider:864e5,modulo:milliseconds+1},hour:{divider:36e5,modulo:24},minute:{divider:6e4,modulo:60},second:{divider:1e3,modulo:60}};if(!(type in typeMap)){console.error("Invalid duration type: "+type);return 0}return parseInt(milliseconds/typeMap[type].divider%typeMap[type].modulo)}function isElementVisible(node){var docViewTop=$(window).scrollTop();var docViewBottom=docViewTop+$(window).height()*2;var elemTop=node.offset().top;var elemBottom=elemTop+node.height();return elemBottom<=docViewBottom&&elemTop>=docViewTop}function screenTopPosition(node,trueCallback,falseCallback,forceViewPercent){var docViewTop=$(window).scrollTop();var docHeight=$(window).height();var docViewBottom=docViewTop+docHeight;var elemTop=node.offset().top;var viewPercent=forceViewPercent||10;if(elemTop<=docViewBottom&&(docViewBottom-elemTop)/docHeight*100>=viewPercent){if(typeof trueCallback=="function"){trueCallback(node)}else{return true}}else{if(typeof falseCallback=="function"){falseCallback(node)}else{return false}}}if(typeof Object.assign!="function"){Object.defineProperty(Object,"assign",{value:function assign(target,varArgs){"use strict";if(target==null){throw new TypeError("Cannot convert undefined or null to object")}var to=Object(target);for(var index=1;index<arguments.length;index++){var nextSource=arguments[index];if(nextSource!=null){for(var nextKey in nextSource){if(Object.prototype.hasOwnProperty.call(nextSource,nextKey)){to[nextKey]=nextSource[nextKey]}}}}return to},writable:true,configurable:true})}function addHrefSearch(params,forceRefresh){if(params){var finalURL;if(typeof params=="string"){params=[params]}if(location.search.length){var oldQueriesArr=location.search.substring(1).split("&");var oldQueriesMap={};var givenQueriesMap={};var finalQueriesMap={};var finalQueriesArr=[];for(var i in oldQueriesArr){oldQueriesMap[oldQueriesArr[i].split("=").shift()]=oldQueriesArr[i].split("=").pop()}for(var i in params){givenQueriesMap[params[i].split("=").shift()]=params[i].split("=").pop();if(params[i].split("=").shift()in oldQueriesMap){delete oldQueriesMap[params[i].split("=").shift()]}}finalQueriesMap=Object.assign(oldQueriesMap,givenQueriesMap);for(var i in finalQueriesMap){finalQueriesArr.push(i+"="+finalQueriesMap[i])}finalURL=location.origin+location.pathname+"?"+finalQueriesArr.join("&")}else{finalURL=location.href+"?"+params.join("&")}if(forceRefresh){location=finalURL}else{window.history.pushState({},null,finalURL)}}}function removeHrefSearch(params,forceRefresh){if(params&&typeof params=="string"){params=[params]}if(params&&params.length&&location.search.length){var currentQueriesArr=location.search.substring(1).split("&");var currentQueriesMap={};var finalQueriesArr=[];var finalURL;for(var i in currentQueriesArr){currentQueriesMap[currentQueriesArr[i].split("=").shift()]=currentQueriesArr[i].split("=").pop()}for(var i in params){if(params[i].split("=").shift()in currentQueriesMap){delete currentQueriesMap[params[i].split("=").shift()]}}if(Object.keys(currentQueriesMap).length){for(var i in currentQueriesMap){finalQueriesArr.push(i+"="+currentQueriesMap[i])}finalURL=location.origin+location.pathname+"?"+finalQueriesArr.join("&")}else{finalURL=location.origin+location.pathname}if(forceRefresh){location=finalURL}else{window.history.pushState({},null,finalURL)}}}function hrefSearch(key){var parsed=false;var params={};function _parse(){var p_arr=location.search.substring(1).split("&");var arr;for(var n in p_arr){arr=p_arr[n].split("=");params[decodeURIComponent(arr[0])]=decodeURIComponent(arr[1])}parsed=true}if(!parsed){_parse()}return key in params?params[key]:false}jQuery.fn.extend({on:function(e){this.off(e);var ret=originalOnEvent.apply(this,arguments);return ret}});if(!Array.prototype.find){Object.defineProperty(Array.prototype,"find",{value:function(predicate){if(this==null){throw TypeError('"this" is null or not defined')}var o=Object(this);var len=o.length>>>0;if(typeof predicate!=="function"){throw TypeError("predicate must be a function")}var thisArg=arguments[1];var k=0;while(k<len){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o)){return kValue}k++}return undefined},configurable:true,writable:true})}if(!Array.prototype.last){Object.defineProperty(Array.prototype,"last",{value:function(predicate){if(this==null){throw new TypeError('"this" is null or not defined')}var o=Object(this);var len=o.length>>>0;if(typeof predicate!=="function"){throw new TypeError("predicate must be a function")}var thisArg=arguments[1];var k=len-1;while(k>=0){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o)){return kValue}k--}return undefined}})}function renderCommonHTML(){if(pCloud.user){if(pCloud.subscription&&!pCloud.rtl){domBody.classList.add("is_premium")}else{domBody.classList.remove("is_premium")}$(".mob_user_info ._name").html(fitEmail(pCloud.user.email,5))}}function top_content_resize(){var aspectRatio=domBody.clientWidth/window.innerHeight;$(".top-box").css({width:domBody.clientWidth,height:window.innerHeight});if(aspectRatio<.836||window.innerHeight>1180||domBody.clientWidth>window.innerHeight&&domBody.clientWidth<700||window.innerHeight>1010||window.innerHeight<700&&domBody.clientWidth<1e3){$(".top-box").addClass("ratio-on")}else{$(".top-box").removeClass("ratio-on")}}function top_image_resize(){var elmOne=$(".top-box .elm-1").outerHeight();var elmTwo=$(".top-box .elm-2:visible").outerHeight();var elmThree=$(".top-box .elm-3").outerHeight();var allElms=window.innerHeight-elmOne-elmTwo-elmThree;$(".top-box img").css({maxHeight:allElms+"px"});$(".top-box .img-wrap").css({width:domBody.clientWidth-30+"px",bottom:elmTwo+"px"})}function toggleMobileMenu(){var body=$("body");var menu=$(".top_nav_links_holder");var menuBtn=$(".mobile-menu-btn");var ovrLay=$(".mob_menu_overlay");var ovrLay_mask=$(".mob_menu_overlay_mask");var toggleMenu=function(swipe){if(swipe&&(swipe=="left"&&menu.hasClass("is_visible")||swipe=="right"&&!menu.hasClass("is_visible"))){return}$(ovrLay,ovrLay_mask).toggleClass("show");body.toggleClass("overflow");menuBtn.toggleClass("mob_btn_on");if(menu.hasClass("is_visible")){menu.removeClass("is_visible");$(".help .search-area").css({"z-index":"11"});$(".help .sticky .menu").css({"z-index":"10"})}else{menu.addClass("is_visible");$(".help .search-area").css({"z-index":"6"});$(".help .sticky .menu").css({"z-index":"5"})}menu.on(transitionEnd,function(){menu.off(transitionEnd)})};$(".mobile-menu-btn, .mob_menu_overlay").on("click.togglemenu",toggleMenu);if(pCloud.isMobile){$(document).on("swipeleft",function(){if(swipeEnabled){toggleMenu("left")}});$(document).on("swiperight",function(){if(swipeEnabled){toggleMenu("right")}})}}function shareasale(){if($.cookie("shareasale")){$('<img src="https://shareasale.com/sale.cfm?amount=0.00&tracking='+$.cookie("shareasale")+'&transtype=lead&merchantID=66775&xtype=registration" width="1" height="1">');$.removeCookie("shareasale",{path:"/"})}}$.cookie=function(name,value,options){if(typeof value==="undefined"){return pCloudGlobals.rcookie(name)}pCloudGlobals.setcookie(name,value,options?options.expires:null)};$.removeCookie=function(name){pCloudGlobals.setcookie(name,"",-1)};$(function(){(function saveREF(){if(hrefSearch("ref")){$.cookie("ref",hrefSearch("ref"),{domain:host(),path:"/"})}else if(!$.cookie("ref")){$.cookie("ref",0,{domain:host(),path:"/"})}})();shareasale();if(hrefSearch("authtoken")){initPcloudObject();return}var currencyValues=["$","€","₤"];if(sessionStorage.pclCurrency&&currencyValues.indexOf(sessionStorage.pclCurrency)!==-1){updateCurrency()}else{getCurrency()}if(false&&sessionStorage.pCloud){if(sessionStorage.pCloudUpdated&&(new Date).getTime()-Number(sessionStorage.pCloudUpdated)>=36e5){pageCallbackInited=true;initPcloudObject()}else{createPcloudObj();pCloud=JSON.parse(sessionStorage.pCloud);var stack2018code=pCloud.user.promocodes&&pCloud.user.promocodes.filter(function(code){return code.code=="STACK2018"});if(stack2018code&&stack2018code.length){var discountCoef=.7;var params={discountcode:"stack_2018_upsell_crypto",auth:pCloud.user.auth};call.apiCall("getdiscountcodeinfo",params,function(data){if(data.discountcode){var code=data.discountcode;var lifetimeDiscountPercent=code.lifetimediscount;var discountCoef=(100-lifetimeDiscountPercent)/100;$("[data-price-lifetime]").each(function(){$(this).text(currencyPrices[$(this).data("price-lifetime")][pclCurrency]["lifetime"]*discountCoef)});$("[data-price-lifetime-discount]").each(function(){$(this).text(currencyPrices[$(this).data("price-lifetime-discount")][pclCurrency]["lifetime"])})}},function(error){})}userInited=true;checkPcloudChanges();initUserDropdown();initDevAddon()}}else{pageCallbackInited=true;initPcloudObject()}console.log("Getting IP");if(sessionStorage.pCloudUserIP){pCloudUserIP=JSON.parse(sessionStorage.pCloudUserIP);console.log("From sessionStorage",pCloudUserIP)}else{getIP().then(function(data){if(typeof Storage!=="undefined"){if(pCloud.user){sessionStorage.setItem("pCloudUserIP",JSON.stringify(data))}}})}if(sessionStorage.pCloudNewsletter){pCloudNewsletter=JSON.parse(sessionStorage.pCloudNewsletter)}else{checkNewsletter()}if(typeof Storage!=="undefined"){checkPclObjInterval=setInterval(function(){checkPcloudChanges()},5e3)}checkPcloudInited();checkLanguage();if(hrefSearch("downgrade")){downgrade=true;upgradeText=__("DOWNGRADE")}if(hrefSearch("ref")){var refData={affid:hrefSearch("ref"),referer:document.referrer,mobile:pCloud.isMobile?1:0};call.apiCallPost("recordclick",refData)}if(hrefSearch("verifymailcode")){verifyEmail(hrefSearch("verifymailcode"))}if(hrefSearch("getpremium")){$.cookie("getpremium",1,{domain:pCloud.host})}if(hrefSearch("do")=="login"&&!pCloud.user){openGlobalModal("login")}if(hrefSearch("do")=="register"&&!pCloud.user){openGlobalModal("register")}if(hrefSearch("do")=="reset-pass"){openModal("reset_password")}if(hrefSearch("do")=="subscribe"&&hrefSearch("code")){call.apiCall("newsletter_verifymail",{code:htmlentities(hrefSearch("code"))},function success(){pCloudNewsletter=true;if(typeof Storage!=="undefined"){sessionStorage.setItem("pCloudNewsletter",JSON.stringify(pCloudNewsletter))}openModal("newsletter_welcome")})}if(hrefSearch("do")=="unsubscribe"&&hrefSearch("code")){call.apiCall("newsletter_unsubscribe",{code:htmlentities(hrefSearch("code"))},function success(){pCloudNewsletter=false;if(typeof Storage!=="undefined"){sessionStorage.setItem("pCloudNewsletter",JSON.stringify(pCloudNewsletter))}openModal("newsletter_goodbye")})}if(hrefSearch("newsletter")&&hrefSearch("email")){call.apiCallPost("newsletter_subscribe","mail="+htmlentities(hrefSearch("email")),function(data){if(data.error){alert(data.error)}else{pCloudNewsletter=true;if(typeof Storage!=="undefined"){sessionStorage.setItem("pCloudNewsletter",JSON.stringify(pCloudNewsletter))}openModal("newsletter_welcome")}})}if(pCloud.isMobile&&!pCloud.isTablet&&showMobileMenu){$("body").addClass("mob_menu");toggleMobileMenu()}$("[data-gevent]").each(function(){$(this).on("click.datagevent",function(){if(typeof gaAll=="function"){gaAll("event",$(this).data("gevent"),"click")}})});$("[data-download]").each(function(){$(this).on("click.datadownload",function(){if($(this).data("download")=="drive"){call.downloadDrive()}else{call.downloadDrive($(this).data("download"))}})});$("[data-open]").each(function(){$(this).on("click.dataopen",function(){var node=$(this);if(node.data("open")=="login"||node.data("open")=="register"){openGlobalModal(node.data("open"))}else{if(node.data("hide")){var elClass=node.data("hide");var thisModal=$("."+node.data("open"));openModal(node.data("open"),false,function(){thisModal.find("."+elClass).hide()},function(){thisModal.find("."+elClass).show()})}else{openModal(node.data("open"))}}})});$("[data-youtube]").each(function(){$(this).on("click.datayoutube",function(e){openYoutube(e)})});$("[data-tooltip]").each(function(){var openOn=pCloud.isMobile?"click":$(this).data("on")||"mouseenter";$(this).on(openOn+".opentooltip",function(){showTooltip($(this))})});$("[data-hover]").each(function(){var _this=$(this);var elClass=_this.data("hover");if(pCloud.isMobile){_this.on("click.datahover",function(){_this.toggleClass(elClass)})}else{_this.on("mouseenter.datamouseenter",function(){_this.addClass(elClass)}).on("mouseleave.datamouseleave",function(){_this.removeClass(elClass)})}});$("[data-lang]").each(function(){$(this).on("click.datalang",function(e){e.preventDefault();var node=$(this);setLanguage(node.data("lang"),node.attr("href"),function(){window.location=node.attr("href")})})});$(document).on("keyup.trackkeyup",function(e){var key=e.which||e.keyCode||e.charCode;if(key==27){$(".modal:visible").find(".close").trigger("click")}if(key==13){$(".modal:visible").find(".bottom .btn").trigger("click")}});setTimeout(function(){windowResize()},1);$(".footer-inputs .other-langs a").each(function(){$(this).attr("href",$(this).attr("href")+window.location.search+window.location.hash)});$("footer").on("click.footerclick",".footer-menu h4",function(){var _this=$(this);var langWrap=_this.parent();if(_this.find("img").is(":visible")){if(langWrap.hasClass("open")){langWrap.removeClass("open")}else{$(".footer-menu.open").removeClass("open");langWrap.addClass("open")}}});updateUserLogo();setPromoParam("channelid");setPromoParam("label");if(typeof sendAnalyticsEventFromStorage==="function"){sendAnalyticsEventFromStorage()}onPcloudInit(function(){if(typeof _learnq!=="undefined"&&pCloud&&pCloud.user){_learnq.push(["identify",{$email:pCloud.user.email,$id:pCloud.user.userid}])}})});function addDebugParams(method,params){var newParams;var methods;var i;var param;var forcedValue;newParams=$.extend({},params);methods={getip:["country"],getcurrency:["country","currency"],paystripe:["country","currency","card"],paysafecharge:["country","currency","use3dsecure"],account_register:["country"],createstripesource:["country"]};if(methods[method]){for(i=0;i<=methods[method].length;i++){param=methods[method][i];forcedValue=$.cookie("force"+param)||sessionStorage.getItem("force"+param);if(forcedValue){newParams[param]=forcedValue}}}return newParams}function addCookieSettings(toElement){var nodeHolder=toElement[0];var successCallback=function(){pCloudGlobals.initTracking([{type:pCloudGlobals.GA_FLAG,onStart:initAnalytics},{type:pCloudGlobals.FBQ_FLAG,onStart:function(){initFacebookTracking();initTwitterTracking()}}])};if(pCloudGlobals&&pCloudGlobals.components){pCloudGlobals.components.CookieConsentModal(nodeHolder,{onApiSuccessCallback:successCallback})}}function addCookieConsent(toElement){var nodeHolder=toElement[0];if(pCloudGlobals&&pCloudGlobals.components){pCloudGlobals.components.CookieConsent(nodeHolder,{initAnalyticsTracking:initAnalytics,initFacebookTracking:initFacebookTracking,initTwitterTracking:initTwitterTracking})}}var showedPromoOffer=false;function initShowPromoOffer(){if(showedPromoOffer){return}showedPromoOffer=true;var params={os:4};if(pCloud.user){params.auth=pCloud.user.auth;params.language=pCloud.user.language}else{params.logout=1;params.language=pCloud.lang}call.apiCall("getpromoofferforweb",params,function success(data){var modal=data.modal;var ribbon=data.ribbon;var stickybar=data.stickybar;if(modal&&($.cookie("promo-modal-id")!=modal.channelid||pCloud.user)){showModal(modal)}if(ribbon){if($(".header_ribbon")[0]){$(".header_ribbon")[0].remove()}showRibbon(ribbon)}if(stickybar){if($(".promo-sticky-bar")[0]){$(".promo-sticky-bar")[0].remove()}if(!detectedMobile){showPromoStickyBar(stickybar)}}},function error(){});function showModal(data){$('<div class="promo-modal"></div>').appendTo(document.body);var newLayout=false;if(data.lefttitletext&&data.lefttitletextcolor&&data.leftpartbackgroundcolor){newLayout=true}pCloudGlobals.components.PromoModal($(".promo-modal")[0],{title:data.title,label:data.label,channelid:data.channelid,titlecolor:data.titlecolor,description:data.description,descriptioncolor:data.descriptioncolor,btntext:data.btntext,btntextcolor:data.btntextcolor,btnlink:data.btnlink,btnbackground:data.btnbackground,disclaimer:data.disclaimer,disclaimercolor:data.disclaimercolor,leftpartbackgroundcolor:data.leftpartbackgroundcolor,lefttitletext:data.lefttitletext,lefttitletextcolor:data.lefttitletextcolor,img:data.img,img2x:data.img2x,imgSize:data.img_size,img2xSize:data.img2x_size,backgroundcolor:data.backgroundcolor,timerStartTime:data.timerstime,timerEndTime:data.timeretime,timerbackgroundcolor:data.timerbackgroundcolor,useLocalTime:data.uselocaltime,newLayout:newLayout,sendAnalyticsEvent:sendAnalyticsEvent});$.cookie("promo-modal-id",data.channelid,{domain:pCloud.host,path:"/",expires:365})}function showRibbon(ribbon){var url=ribbon.url;var ribbon_image_size=ribbon.ribbon_image_size;var label=ribbon.label;var ribbon_image=ribbon.ribbon_image;var ribbon_image2x=ribbon.ribbon_image2x;var channelid=ribbon.channelid;var src=window.devicePixelRatio>1?ribbon_image2x:ribbon_image;var imgSize=ribbon_image_size.split("x");var width=imgSize[0]+"px";var os=hrefSearch("os")||4;$(".header_wrap").append("<div class='header_ribbon ribbon-wrapper'><a href="+url+" target='_blank' ><img src="+src+" width="+width+" alt='pCloud promotion'></a></div>");sendAnalyticsEvent({category:"ribbon",action:"show",label:label,os:os},{channelid:channelid});setTimeout(function(){$(".header_ribbon").show()},500);$("div.header_ribbon").on("click",function(){sendAnalyticsEvent({category:"ribbon",action:"click",label:label,os:os},{channelid:channelid});if(typeof gaAll=="function"){gaAll("event","promo-offer-ribbon-"+channelid,"click")}})}function showPromoStickyBar(data){var cont=$("<div />").addClass("promo-sticky-bar");var props={bgcolor:data.bgcolor,title:data.title,titlecolor:data.titlecolor,btnlink:data.url,btncolor:data.linktextcolor,btntext:data.linktext,leftimg:data.stickybarleft_image,leftimg2x:data.stickybarleft_image2x,rightimg:data.stickybarright_image,rightimg2x:data.stickybarright_image2x,imgSize:data.stickybarleft_image_size,label:data.label,channelid:data.channelid,sendAnalyticsEvent:sendAnalyticsEvent};PromoStickyBar(cont[0],props);$("header").prepend(cont);resizeTop()}}function initShowBottombanner(){var timeNow=(new Date).getTime();var timeEnds=new Date(Date.UTC(2020,3,12,20,0,0)).getTime();var timeStarts=new Date(Date.UTC(2020,3,9,6,0,0)).getTime();var isUserEligible=pCloud.user&&!pCloud.user.premiumlifetime&&!pCloud.user.business&&!pCloud.user.cryptolifetime;var hasCookieConsent=$.cookie("cookieconsent");if(hasCookieConsent&&BottomBanner&&$(window).width()>374&&timeNow<timeEnds&&(!pCloud.user||isUserEligible)&&timeStarts<=timeNow){BottomBanner($(".bottom-wrapper")[0],{discountPercent:78,leftText:2+__("TB")+" "+__("footer_family")+" "+__("and")+" "+__("Encryption"),buttonText:__("bf2018_cta"),campaignEnds:timeEnds,buttonAction:function(){gaAll("event","Bottom Banner","click");location.href="https://www.pcloud.com/easter-promo"}});gaAll("event","Bottom Banner","show");$(".footer-wrapper").css("padding-bottom",130)}}function setFBTrackingForReferral(referrer){var referrersEvents=[{baseurl:"cloudwards.net",event:"Cloudwards-User"},{baseurl:"techradar.com",event:"Techradar-User"},{baseurl:"clubic.com",event:"Clubic-User"}];for(var i=0;i<referrersEvents.length;i++){var r=referrersEvents[i];var refFound=new RegExp("//[^.]*.?"+r.baseurl+"/?");if(refFound.test(referrer)){fbq("trackCustom",r.event)}}}function setGoogleExperiment(id,variations){if(!document.getElementById("google_experiment_code")){var chosenVariation=0;var script=document.createElement("script");script.src="//www.google-analytics.com/cx/api.js?experiment="+id;script.setAttribute("id","google_experiment_code");document.getElementsByTagName("body")[0].appendChild(script);script.onload=function(){chosenVariation=cxApi.chooseVariation();console.log("chosenVariation",chosenVariation);variations[chosenVariation]();if(googleExperimentVariant!=undefined){googleExperimentVariant=chosenVariation}};script.onerror=function(){console.log("setGoogleExperiment ERROR");variations[0]()}}}function setHotjarTracking(){$('input[type="text"], input[type="password"], input[type="email"], input[type="number"]').attr("data-hj-masked","");(function(h,o,t,j,a,r){h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};h._hjSettings={hjid:1321779,hjsv:6};a=o.getElementsByTagName("head")[0];r=o.createElement("script");r.async=1;r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;a.appendChild(r)})(window,document,"https://static.hotjar.com/c/hotjar-",".js?sv=")}function initYandexMetrika(){(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date;k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym");ym(53686483,"init",{clickmap:true,trackLinks:true,accurateTrackBounce:true,webvisor:true});$("body").append('<div><img src="https://mc.yandex.ru/watch/53686483" style="position:absolute; left:-9999px;" alt="" /></div>')}function checkIncomingDiscount(discountCode){var dfd=jQuery.Deferred();var params={discountcode:discountCode};if(pCloud.user){params["auth"]=pCloud.user.auth}call.apiCall("getdiscountcodeinfo",params,function(data){if(data.discountcode&&(typeof data.remaining==="undefined"||data.remaining>0)){var code=data.discountcode;var isUsed=data.isused;if(code.productdiscount){var discountProductsArr=code.productdiscount;var discountProductsObj={};for(var i=0;i<discountProductsArr.length;i++){discountProductsObj[discountProductsArr[i].productid]=discountProductsArr[i];discountProductsObj[discountProductsArr[i].productid].monthdiscount}code.productdiscount=discountProductsObj}data.discountcode=code;dfd.resolve(data)}else{dfd.reject(data)}},function(error){dfd.reject(error)});return dfd.promise()}function setFooterLangPath(){var origin=window.location.origin||document.location.origin;var pathname=window.location.pathname||document.location.pathname;var search=window.location.search||document.location.search;var pathnameLang=pathname.split("/")[1];var langs=["bg","en","tr","es","ru","zh","de","it","fr","pt"];if(langs.indexOf(pathnameLang)!==-1){pathname=pathname.substr(3)}$(".set-lang").each(function(){var lang=$(this).data("lang");var path=origin+"/"+lang+pathname+search;if(lang==="en"){path=origin+pathname+search}$(this).attr("href",path).on("click",function(){$.cookie("lang",lang,{domain:pCloud.host,path:"/"})})})}