var visibilityStats=function(){var i=new Array();var b=false;var g={};var h=0;var k=this;var l={};var c={};this.findVideos=function(){e(true);var p=document.querySelectorAll("iframe");for(var n=0;n<p.length;n++){if(p[n].hasAttribute("src")){if(p[n].getAttribute("src").match(/(ultimedia|digiteka)\.(com|net)/)&&i.indexOf(p[n])==-1){b=i.length;i.push(p[n]);g[b]=false;p[n].contentWindow.postMessage("your_id_visi="+i.indexOf(p[n]),"*");var o=p[n].getAttribute("src").match(/mdtk=(.{8})&/);c[b]=o&&o[1]?o[1]:"0"}else{if(i.indexOf(p[n])!=-1){var q=i.indexOf(p[n]);p[n].contentWindow.postMessage("your_id_visi="+q,"*")}}}}e(true);window.addEventListener("scroll",function(m){clearTimeout(h);h=setTimeout(function(){e()},15)},false)};function e(n){n=typeof n=="undefined"?false:n==true;for(var m=0;m<i.length;m++){l[m]=d(m);if(l[m]&&(!g[m]||n)){a(m,true);g[m]=l[m]}else{if(!l[m]&&(g[m]||n)){a(m,false);g[m]=l[m]}}}}function d(m){var n=i[m];var q=c[m]=="01579005"?0.5:0.45;var p=1-q;if(typeof jQuery==="function"&&n instanceof jQuery){n=n[0]}var o=n.getBoundingClientRect();return(0<n.offsetHeight&&0<n.offsetWidth&&o.top>=(-1*p*o.height)&&o.bottom<=(window.innerHeight||document.documentElement.clientHeight)+(p*o.height))}function f(n){if(typeof n.data.message!="undefined"&&n.data.message=="newVideo"){k.findVideos()}var m=typeof n.data=="string"?n.data.match(/is_visi_(\d)/):false;if(m){j(parseInt(m[1]))}}function j(m){a(m,d(m),true)}function a(p,o,m){var n=o?"visibilityStat_false":"visibilityStat_true";n=m?n+"-np":n;if(null!=i[p].contentWindow&&"undefined"!=typeof i[p].contentWindow){i[p].contentWindow.postMessage(n,"*")}}if(window.addEventListener){window.addEventListener("message",f,false)}else{window.attachEvent("onmessage",f)}this.findVideos()};visibilityStats=new visibilityStats();