function getLoc(t){var e=DynamicContent.get("localization"),n=t+"_"+FORMAT_ID;return n in e?e[n]:e[t]}function reformatWrapAndScale(t,e){if(!this.isLoading()&&!this.__formatted){t=t||new createjs.Rectangle(0,0,this.maxWidth,this.lineHeight),e=e||function(t,e,n){return t/e};var n=this.text;this._getMeasuredWidth(n)>t.width&&1==n.split(/(?:\r\n|\r|\n)/).length&&(n=autoWrap(this,t,n,e)),adaptTextToBounds(this,t,n,parseFloat(this.fontSize)),this.__formatted=!0}}function autoWrap(t,e,n,a){for(var i=t._getMeasuredWidth(n),o=accurateMeasureHeight(t),s=o.bottom-o.top,r=e.width/e.height,l=1;i/(l+1)/(s*(l+1))>r;)++l;for(var u=n.split(/\s/).filter(function(t){return t.length>0}),h=[],c=0,d=0;u.length>0;++d){var f=a(n.length,l,h.filter(function(t){return t.length>0}).length);for(h[d]="";u.length>0&&h[d].length+u[0].length-f-c<=0&&(h[d].length>0&&(h[d]+=" "),h[d]+=u.shift(),!(h[d].length>=f)););c+=f-h[d].length}return h.filter(function(t){return t.length>0}).join("\n")}function adaptTextToBounds(t,e,n,a){function i(t,e,n,a,i){function o(n){return t.fontSize=n+"px",{width:t._getMeasuredWidth(e),height:n}}for(var s=i,r=1,l=o(s),u=o(r);(u.width<n||l.width>n||l.height>a||u.height<a)&&Math.abs(r-s)>.5;){var h=Math.floor(10*(r+s)/2)/10,c=o(h);c.width<n&&c.height<a?(u=c,r=h):(l=c,s=h)}return s==i?i:r}if(!t.isLoading()){var o=n.split(/(?:\r\n|\r|\n)/);t.fontSize=o.reduce(function(n,s){return Math.min(n,i(t,s,e.width,e.height/o.length,a||500))},Number.POSITIVE_INFINITY)+"px";var s=accurateMeasureHeight(t),r=1.1*(s.bottom-s.top),l=r*o.length/(e.height-r);t.lineHeight=Math.max(1,Math.sqrt(1/l))*r,t.multilineOffsetY=(e.height-o.length*t.lineHeight)/2-(t.lineHeight-r)/2,t.text=o.join("\n")}}function accurateMeasureHeight(t){function e(t,e){return pixOffset=4*(e*s.width+t),s.data[pixOffset+3]>0}if(t.isLoading())throw"You should wait for the font to load before measuring";if(createjs.Text.measures=createjs.Text.measures||{},createjs.Text.measures[t.font])return createjs.Text.measures[t.font];canvas=document.createElement("canvas"),canvas.height=10,canvas.width=30;for(var n,a,i=canvas.getContext("2d"),o=!0;o;){i.fillStyle="black",t._prepContext(i),i.textAlign="left",i.fillText("!@#$&",0,0,65535);var s=i.getImageData(0,0,canvas.width,canvas.height);n=canvas.height,a=0;for(var r=0;r<canvas.width;++r){for(var l=n;l>=0;--l)e(r,l)&&(n=l);for(l=a;l<canvas.height;++l)e(r,l)&&(a=l)}o=a==canvas.height-1||a<n,o&&(canvas.height*=2,canvas.width*=2)}return i=canvas=void 0,createjs.Text.measures[t.font]={top:n,bottom:a},createjs.Text.measures[t.font]}function hexToRGB(t){var e=/#(\w\w)(\w\w)(\w\w)/i.exec(t);return{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}}function manageRTLContent(){if(rtlLanguage){var t,e,n,a,i;for(t=0;t<arguments.length;++t)arguments[t].fontFamily+=", "+rtlLanguage.font,e=arguments[t].name,"_text"==e&&arguments[t].parent&&(e=arguments[t].parent.__finalClass),e in rtlLanguage.offsets&&(a=Array.isArray(rtlLanguage.offsets[e])?rtlLanguage.offsets[e][0]:rtlLanguage.offsets[e],i=Array.isArray(rtlLanguage.offsets[e])?rtlLanguage.offsets[e][1]:0,n=parseFloat(arguments[t].fontSize)+a,arguments[t].fontSize=n+"px",arguments[t].y+=i,n>=arguments[t].lineHeight&&(arguments[t].lineHeight+=a+1,arguments[t].y-=(a+1)/2))}}const FORMAT_ID="160x600",RTL_LANGUAGES={he:{font:"Arial, sans-serif",offsets:{offerLine1:3,offerLine3:[3,2],cta:[3,-2]}}};var rtlLanguage="";DynamicContent.init({isDefault:{default:"false",accept:"bool"},offerKey:{default:"happy-first"},productKey:{default:"ski"},languageCode:{default:"fr-FR"},offerId:{default:"EBE"},config:{default:JSON.stringify({promoLogoPath:"https://s0.2mdn.net/creatives/assets/2404049/",signaturePath:"https://s0.2mdn.net/creatives/assets/2404073/",assetsOneTimePath:"https://s0.2mdn.net/creatives/assets/2397739/"}),accept:"json"},data:{default:JSON.stringify({offerColor:"#235578",signature:"26",logoPromo:"LMO",topImage:"topImage_golf",bottomImage:"bottomImage_canoe"}),accept:"json"},localization:{default:JSON.stringify({valuePrefix:"jusqu'à",valueCurrency:"-300€*",valueRate:"par personne",firstSentence:"Départ imminent",firstSentenceIsBold:"true",secondSentence:"Réservez maintenant",secondSentenceIsBold:"false",endshotDate:"jusqu'au 30 juin",cta:"Voir l'offre",conditions:"*voir conditions sur clubmed.com",redirectionUrl:"http://www.google.com/?search=Club+Med+EBH"}),accept:"json"},img_signature:function(){return DynamicContent.get("config").signaturePath+DynamicContent.get("data").signature+"_"+DynamicContent.get("languageCode")+"_"+FORMAT_ID+".png"},img_logo_promo:function(){return DynamicContent.get("config").promoLogoPath+DynamicContent.get("data").logoPromo+"_"+DynamicContent.get("languageCode")+"_"+FORMAT_ID+".png"},img_img_1:function(){return DynamicContent.get("config").assetsOneTimePath+DynamicContent.get("data").topImage+"_"+FORMAT_ID+".jpg"},img_img_2:function(){return DynamicContent.get("config").assetsOneTimePath+DynamicContent.get("data").topImage+"_"+FORMAT_ID+".jpg"},img_img_3:function(){return DynamicContent.get("config").assetsOneTimePath+DynamicContent.get("data").bottomImage+"_"+FORMAT_ID+".jpg"},text_offer_color:{default:"#FFFFFF",accept:"color"},text_offerLine1_color:function(){return DynamicContent.get("text_offer_color")},text_offerLine2_color:function(){return DynamicContent.get("text_offer_color")},text_offerLine3_color:function(){return DynamicContent.get("text_offer_color")},text_offerLine1_text:function(){return getLoc("valuePrefix")},text_offerLine2_text:function(){return getLoc("valueCurrency")},text_offerLine3_text:function(){return getLoc("valueRate")},text_cta_color:"#FFFFFF",text_cta_text:function(){return getLoc("cta")}}),document.addEventListener("DOMContentLoaded",function(){var t=DynamicContent.get("data");document.querySelector(".preload").style.backgroundColor=t&&t.offerColor||"#235578"}),AnimateLinkedClasses.registerClass("basecontroller",[],{init:function(){var t=DynamicContent.get("languageCode");Array.isArray(t)&&(t=t[0]),t.split("-")[0]in RTL_LANGUAGES&&(document.dir="rtl",rtlLanguage=RTL_LANGUAGES[t.split("-")[0]]);var e=DynamicContent.get("data");if(null==e)return platform.fallback();var n=""!=e.signature,a=""===e.bottomImage?1:2;this.modules=[],n?(this.modules.push("ModuleIntroSignature"),2==a?this.modules.push(["ModuleBackground2","ModulePromoSignature2"]):this.modules.push(["ModuleBackground1","ModulePromoSignature1"])):(this.modules.push("ModuleIntro"),2==a?this.modules.push(["ModuleBackground2","ModulePromo2"]):this.modules.push(["ModuleBackground1","ModulePromo1"])),this.modules.push("ModuleEndshot")},_override_start:function(t){function e(t){t.__called||(t.__called=!0,t())}t();var n=this.getLib(),a=DynamicContent.get("data");return this.clears=[],this.modules.map(function(t){return Array.isArray(t)?t.map(function(t){return n[t]}):n[t]}).reverse().reduce(function(t,i,o,s){var r=function(s){i=Array.isArray(i)?i:[i];var r=new n.empty,l=e.bind(null,function(){0!==o&&r.parent&&r.parent.removeChild(r)});this.clears.push(l),i.map(function(n){var i=new n;i.setup(a,e.bind(null,t),l),r.addChild(i)}.bind(this)),s?this.moduleContainer.addChild(r):this.moduleContainer.addChildAt(r,0)}.bind(this);return 0==o&&(r=e.bind(this,r),this.gotoEndModule=r.bind(this,!0)),r}.bind(this),function(){}.bind(this))()},_override_doFreeze:function(t){this.clears.forEach(function(t){t()}),this.gotoEndModule(),t()}}),AnimateLinkedClasses.registerClass("Module",[],{}),AnimateLinkedClasses.registerClass("ModuleIntro",["Module"],{setup:function(t,e,n){var a=hexToRGB(t.offerColor);console.log("##col"),console.log(a),this.background.filters=[new createjs.ColorFilter(0,0,0,1,a.r,a.g,a.b,0)],this.background.cache(this.background.nominalBounds.x,this.background.nominalBounds.y,this.background.nominalBounds.width,this.background.nominalBounds.height),this.atFrame(this.getLabelPosition("out"),e),this.atFrame(this.totalFrames,n)}}),AnimateLinkedClasses.registerClass("ModuleIntroSignature",["Module"],{setup:function(t,e,n){var a=hexToRGB(t.offerColor);console.log("##col"),console.log(a),this.background.filters=[new createjs.ColorFilter(0,0,0,1,a.r,a.g,a.b,0)],this.background.cache(this.background.nominalBounds.x,this.background.nominalBounds.y,this.background.nominalBounds.width,this.background.nominalBounds.height),this.atFrame(this.getLabelPosition("out"),e),this.atFrame(this.totalFrames,n)}}),AnimateLinkedClasses.registerClass("ModuleBackground1",["Module"],{setup:function(t,e,n){this.atFrame(this.totalFrames,e),this.atFrame(this.totalFrames,n)}}),AnimateLinkedClasses.registerClass("ModuleBackground2",["Module"],{setup:function(t,e,n){this.atFrame(this.totalFrames,e),this.atFrame(this.totalFrames,n)}}),AnimateLinkedClasses.registerClass("ModulePromo1",["Module"],{setup:function(t,e,n){this.atFrame(this.totalFrames,e),this.atFrame(this.totalFrames,n)}}),AnimateLinkedClasses.registerClass("ModulePromo2",["Module"],{setup:function(t,e,n){this.atFrame(this.totalFrames,e),this.atFrame(this.totalFrames,n)}}),AnimateLinkedClasses.registerClass("ModulePromoSignature1",["Module"],{setup:function(t,e,n){this.atFrame(this.totalFrames,e),this.atFrame(this.totalFrames,n)}}),AnimateLinkedClasses.registerClass("ModulePromoSignature2",["Module"],{setup:function(t,e,n){this.atFrame(this.totalFrames,e),this.atFrame(this.totalFrames,n)}}),AnimateLinkedClasses.registerClass("ModuleEndshot",["Module"],{setup:function(t,e,n){this.atFrame(this.totalFrames,e),this.atFrame(this.totalFrames,n);var a=hexToRGB(t.offerColor),i=this.promo.losange;i.filters=[new createjs.ColorFilter(0,0,0,1,a.r,a.g,a.b,0)],i.cache(i.nominalBounds.x,i.nominalBounds.y,i.nominalBounds.width,i.nominalBounds.height)}}),AnimateLinkedClasses.registerClass("text_tagline1",[],{init:function(){manageRTLContent(this._text),"true"===DynamicContent.get("localization").firstSentenceIsBold?this._text.fontWeight="bold":this._text.fontWeight="normal",this._text.text=getLoc("firstSentence"),this._text.reformatText=reformatWrapAndScale.bind(this._text)}}),AnimateLinkedClasses.registerClass("text_tagline2",[],{init:function(){manageRTLContent(this._text),"true"===DynamicContent.get("localization").secondSentenceIsbold?this._text.fontWeight="bold":this._text.fontWeight="normal",this._text.text=getLoc("secondSentence"),this._text.reformatText=reformatWrapAndScale.bind(this._text)}}),AnimateLinkedClasses.registerClass("text_taglineEndshot",[],{init:function(){manageRTLContent(this._text),this._text.fontWeight="bold",this._text.text=getLoc("endshotDate"),this._text.reformatText=reformatWrapAndScale.bind(this._text,this.nominalBounds)}}),AnimateLinkedClasses.registerClass("text_PromoEndshot",[],{init:function(){manageRTLContent(this.offerLine1,this.offerLine2,this.offerLine3),this.offerLine1.reformatText=reformatWrapAndScale.bind(this.offerLine1),this.offerLine2.reformatText=reformatWrapAndScale.bind(this.offerLine2),this.offerLine3.reformatText=reformatWrapAndScale.bind(this.offerLine3)}}),AnimateLinkedClasses.registerClass("text_cta",[],{init:function(){manageRTLContent(this.cta),this.cta.reformatText=reformatWrapAndScale.bind(this.cta)}}),AnimateLinkedClasses.registerClass("text_conditions",[],{init:function(){manageRTLContent(this._text),this._text.text=getLoc("conditions"),this._text.reformatText=reformatWrapAndScale.bind(this._text,this.nominalBounds)}}),AnimateLinkedClasses.registerClass("Bounds",[],{_override_getBounds:function(){return new createjs.Rectangle(this.x-this.nominalBounds.x*this.scaleX,this.y-this.nominalBounds.y*this.scaleY,this.nominalBounds.width*this.scaleX,this.nominalBounds.height*this.scaleY)}});