!function(window,top,document){var invibes=window.invibes=window.invibes||{};window.location.href.match(/\bbvci|\bbvid/i)&&(invibes.testMode=!0),invibes.isTablet=!1,invibes.deviceType=invibes.isTablet?4:1;var vsConfig={videoAdDomain:"//content.videostep.com",bidAdDomain:"//bid.videostep.com",videoAdCss:"//static.r66net.com/Content/dvad3.css",uwebDomain:"//u.videostep.com/User",ewebUrl:"//paid.invibes.com",sewebUrl:"//invibes.b26net.com",statwebUrl:"https://s.videostep.com",kwebstatUrl:"https://kwebstat.videostep.com",getlink:"//static.r66net.com/d_eu/gl19.4.5.js",krpanojs:"//static.r66net.com/Scripts/krpano/krpano.js",gyrojs:"//static.r66net.com/Scripts/krpano/gyro2.js",videoplayerjs:"//static.r66net.com/Scripts/krpano/videoplayer.js",followmousejs:"//static.r66net.com/Scripts/krpano/followmouse.js",brokerframe:"//static.r66net.com/Content/broker.html",mapboxJs:"https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js",mapboxCss:"https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css",leafletJs:"//static.r66net.com/leaflet/leaflet.js",leafletCss:"//static.r66net.com/leaflet/leaflet.css"},beacons={0:"https://bk.madamebuzz.fr/beacon.html",1:"https://bk.futura-sciences.com/beacon.html",2:"https://inv.psychologies.com/beacon.html",3:"https://inv.sabervivirtv.com/beacon.html",4:"https://inv.nationalgeographic.com.es/beacon.html",5:"https://inv.clara.es/beacon.html",6:"https://inv.elmueble.com/beacon.html",7:"https://inv.lecturas.com/beacon.html",8:"https://inv.arquitecturaydiseno.es/beacon.html",9:"https://inv.cuerpomente.com/beacon.html",10:"https://inv.instyle.es/beacon.html",11:"https://inv.eljueves.es/beacon.html",12:"https://inv.lequotidiendumedecin.fr/beacon.html",13:"https://inv.lequotidiendupharmacien.fr/beacon.html",14:"https://inv.legeneraliste.fr/beacon.html"};function escapeFrom(e){var t=function(t){e.parentElement.insertBefore(t,e)},i=function(e){var i=document.querySelectorAll(e);Array.prototype.forEach.call(i,function(e){e.parentElement.removeChild(e),t(e)})};i("[id^=divVideoStep]"),i("[id^=_videoStep]"),i("[id^=ivbs]");var n=document.createElement("script");if(n.type="text/javascript",n.async=!0,null!=invibes.getlinkUrl&&""!==invibes.getlinkUrl?n.src=invibes.getlinkUrl:n.src=vsConfig.getlink,t(n),invibes){var o=window.parent.invibes=window.parent.invibes||{};Object.keys(invibes).forEach(function(e){invibes.hasOwnProperty(e)&&(o[e]=invibes[e])})}}if(frameElement)escapeFrom(frameElement);else if(invibes.alreadyRun)console.warn("IVBS Script run twice!");else{invibes.alreadyRun=!0,function(e){function t(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],a(e,this)}function n(e,t){for(;3===e._state;)e=e._value;return 0===e._state?void e._deferreds.push(t):(e._handled=!0,void i._immediateFn(function(){var i=1===e._state?t.onFulfilled:t.onRejected;if(null!==i){var n;try{n=i(e._value)}catch(e){return void r(t.promise,e)}o(t.promise,n)}else(1===e._state?o:r)(t.promise,e._value)}))}function o(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void s(e);if("function"==typeof n)return void a(function(e,t){return function(){e.apply(t,arguments)}}(n,t),e)}e._state=1,e._value=t,s(e)}catch(t){r(e,t)}}function r(e,t){e._state=2,e._value=t,s(e)}function s(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,o=e._deferreds.length;t<o;t++)n(e,e._deferreds[t]);e._deferreds=null}function a(e,t){var i=!1;try{e(function(e){i||(i=!0,o(t,e))},function(e){i||(i=!0,r(t,e))})}catch(e){if(i)return;i=!0,r(t,e)}}var d=setTimeout;i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,i){var o=new this.constructor(t);return n(this,new function(e,t,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=i}(e,i,o)),o},i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,i){function n(r,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var a=s.then;if("function"==typeof a)return void a.call(s,function(e){n(r,e)},i)}t[r]=s,0==--o&&e(t)}catch(e){i(e)}}if(0===t.length)return e([]);for(var o=t.length,r=0;r<t.length;r++)n(r,t[r])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,i){i(e)})},i.race=function(e){return new i(function(t,i){for(var n=0,o=e.length;n<o;n++)e[n].then(t,i)})},i._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){d(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},"undefined"!=typeof module&&module.exports?module.exports=i:e.Promise||(e.Promise=i)}(this);var getDocumentLocation=function(){return top.window.location.href.substring(0,300).split(/[?#]/)[0]},addQueryStringParam=function(e,t,i){return e+(e.indexOf("?")<0?"?":"&")+t+"="+i},addParamsToUrl=function(e,t){var i=e;if(t)for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];null==o&&(o=""),i=addQueryStringParam(i,encodeURIComponent(n),encodeURIComponent(o))}return i},generateRandomId=function(){return Math.round(1e12*Math.random()).toString(36).substring(0,10)};invibes.jsonp=function(e,t){var i="cb_"+generateRandomId(),n=document.createElement("script");n.src=addQueryStringParam(e,"callback","invibes."+i),invibes[i]=t||noop,document.head.appendChild(n)},invibes.jsonpWithParams=function(e,t,i){invibes.jsonp(addParamsToUrl(e,t),i)},invibes.pixel=function(e,t){var i=new Image;return new Promise(function(n,o){i.addEventListener("load",n),i.addEventListener("error",o),i.src=addParamsToUrl(e,t)})};var createQueryString=function(e){return Object.keys(e).map(function(t){var i=e[t];return[t,i=null!=i?i.toString():""].map(encodeURIComponent).join("=")}).join("&")},crossDomainMessageIsFromExpectedOrigin=function(e,t){var i=function(e){var t=(e=e||"").match(/\/\/[^\/]+/);return t?t[0]:""};return i(e.origin||e.originalEvent.origin||"").toLowerCase()===i(t).toLowerCase()};invibes.Uid={generate:function(){var e=parseInt("zzzzzz",36),t=function(){return Math.floor(Math.random()*e).toString(36)};return t()+t()}};var noop=function(){},ivDebug=!1;try{ivDebug=localStorage&&localStorage.InvibesDEBUG}catch(e){}var ivLogger=ivDebug?window.console:{info:noop,error:noop,log:noop,warn:noop,debug:noop},cookieDomain;ivDebug&&ivLogger.info("IV DEBUG ON."),invibes.getCookie=function(e){var t,i,n,o=document.cookie.split(";");for(t=0;t<o.length;t++)if(i=o[t].substr(0,o[t].indexOf("=")),n=o[t].substr(o[t].indexOf("=")+1),(i=i.replace(/^\s+|\s+$/g,""))===e)return unescape(n)},invibes.setCookie=function(e,t,i,n){var o="ivNoCookie"==e||"IvbsCampIdsLocal"==e;if(!(invibes.noCookies&&!o&&(i||0)>=0)){i>365&&(i=365),n=n||cookieDomain;var r=new Date,s=24*i*60*60*1e3;r.setTime(r.getTime()+s);var a=t+(i?"; expires="+r.toUTCString():"");a+=";domain="+n+";path=/",document.cookie=e+"="+a}},invibes.deleteLocalCookies=function(){"IvbsCampIdsLocal|VSVASuspended|ivNotCD|VsLLocal|ivbss|ivbsdid|ivBlk|ivOptIn|ivvbks|ivdtbrk".split("|").forEach(function(e){invibes.setCookie(e,"",-1)})},invibes.forgetFunction=function(e){invibes.dom.id&&invibes.sendStatwebStats(11003,invibes.dom.id),userManager.clear(e||noop),invibes.noCookies=1,invibes.optIn=0,invibes.setCookie("ivNoCookie",1,365),invibes.deleteLocalCookies()};var detectTopmostCookieDomain=function(){var e=invibes.Uid.generate(),t=location.hostname.split(".");if(1===t.length)return location.hostname;for(var i=t.length-1;i>=0;i--){var n="."+t.slice(i).join(".");if(invibes.setCookie(e,e,1,n),invibes.getCookie(e)===e)return invibes.setCookie(e,e,-1,n),n}},initDomainId=function(e){if(!invibes.dom){var t,i={cname:"ivbsdid",load:function(){var e=invibes.getCookie(this.cname)||"";try{return JSON.parse(e)}catch(e){}},save:function(e){invibes.setCookie(this.cname,JSON.stringify(e),365)}},n=(e=e||{}).persistence||i;(t=n.load()||{id:invibes.Uid.generate(),cr:(new Date).getTime(),hc:1}).id.match(/\./)&&(t.id=invibes.Uid.generate());var o=function(){t.cr&&(delete t.cr,delete t.hc,n.save(t),s())},r=function(){t.id=invibes.Uid.generate(),n.save(t)},s=function(){invibes.dom={get id(){return!t.cr&&invibes.optIn>0?t.id:void 0},get tempId(){return invibes.optIn>0?t.id:void 0},graduate:o,regen:r}};t.cr&&!e.noVisit&&(t.hc<2&&t.hc++,(t.hc>=2&&function(e){if(!e.cr)return!1;if(e.cr<151e10)return!1;return(new Date).getTime()-e.cr>864e5}(t)||e.skipGraduation)&&o()),n.save(t),s(),ivLogger.info("Did="+invibes.dom.id)}},runIabConsent=function(){if(null!=window.__cmp)try{window.__cmp("getVendorConsents",[436],function(e){var t,i,n=function(e){if(null==e)return 0;if(!e.gdprApplies||e.hasGlobalConsent)return 2;if(e.purposeConsents instanceof Array){if(e.purposeConsents.length<5)return 0;for(var t=0;t<5&&t<e.purposeConsents.length;t++)if(!1===e.purposeConsents[t]||"false"===e.purposeConsents[t]||null==e.purposeConsents[t])return 0}else{if("object"!=typeof e.purposeConsents||null===e.purposeConsents)return 0;for(var i in t=0,e.purposeConsents){if(5===t)break;if(e.purposeConsents.hasOwnProperty(i)&&(t++,!1===e.purposeConsents[i]||"false"===e.purposeConsents[i]||null==e.purposeConsents[i]))return 0}if(t<5)return 0}return null==e.vendorConsents||1!=e.vendorConsents[436]?4:2}(e);if(n>0){var o=10*n;invibes.noCookies=0,invibes.setCookie("ivNoCookie",0,-1),invibes.optIn=(t=invibes.optIn,i=n,t<=0?i:i<=0?t:t<i?t:i),1!==invibes.optIn&&invibes.setCookie("ivOptIn",o,.007)}})}catch(e){ivLogger.error(e)}},adBlockerDetected;cookieDomain=detectTopmostCookieDomain(),ivLogger.info("cd:"+cookieDomain),invibes.noCookies=invibes.getCookie("ivNoCookie"),invibes.optIn=parseInt(invibes.getCookie("ivOptIn"))||0,runIabConsent();var minBlockedUrls=3,currentBlockedUrls=0,detectAdBlock=function(e){if(!e.length)return ivLogger.log("Blocker NOT detected."),void invibes.setCookie("ivBlk","n",1);var t=invibes.getCookie("ivBlk");if(t)return ivLogger.log("Blocker test: "+t),void(adBlockerDetected="y"===t);var i=e.shift();ivLogger.log("Testing... "+i),invibes.pixel(i,{xyzNoCache:Math.floor(1e12*Math.random()).toString(36)}).then(function(){window.setTimeout(function(){detectAdBlock(e)},1e3)},function(){ivLogger.log("Blocker detected! "+i),++currentBlockedUrls>=minBlockedUrls?(adBlockerDetected=!0,invibes.setCookie("ivBlk","y",1)):window.setTimeout(function(){detectAdBlock(e)},2e3)})};detectAdBlock(["https://stats.g.doubleclick.net/r/collect","https://www.google-analytics.com/collect","https://pixel.adsafeprotected.com/","https://cisco.sc.omtrdc.net/b/ss/cisco-complete/1/JS-2.6.0/s22097838216706","https://bvt.r66net.com/1x1.gif","https://box.r66net.com/1x1.gif","https://video.r66net.com/1x1.gif","https://kwebstat.videostep.com/stat/pixel","https://paid.invibes.com/Redir/Pixel"]);var DataBrokerClient=function(){var visitedBrokers,today=Math.floor((new Date).getTime()/864e5),maxAgeMatched=30,maxAgeUnmatched=10,maxApisToCall=2,delayBetweenRequests=1e3,brokerTimeout=3e3,persistence={cname:"ivdtbrk",load:function(){var e={};return(invibes.getCookie(this.cname)||"").split("|").forEach(function(t){var i=t.split("."),n=parseInt(i[0],10);!isNaN(n)&&n>today&&(i[1]||"").split(",").forEach(function(t){e[t]=n})}),e},save:function(e){var t={};Object.keys(e).forEach(function(i){if(e.hasOwnProperty(i)){var n=e[i];t[n]=t[n]||[],t[n].push(i)}});var i=Object.keys(t).filter(function(e){return t.hasOwnProperty(e)}).map(function(e){return e+"."+t[e].join(",")}).join("|");invibes.setCookie(this.cname,i,maxAgeMatched)}},hashLid=function(e){var t,i=0;if(0===e.length)return i;for(t=0;t<e.length;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return i},chooseRandom=function(e){return e[Math.floor(Math.random()*e.length)]},insertIframe=function(e){var t=addParamsToUrl(vsConfig.brokerframe,{type:e.Type,url:e.Url}),i=document.createElement("iframe");return i.src=t,i.style.width=0,i.style.height=0,i.frameBorder=0,document.body.appendChild(i),i},constructRedirectUrl=function(e){var t=vsConfig.statwebUrl+"/sync.png";return t=addQueryStringParam(t,"lid",invibes.dom.id),t=addQueryStringParam(t,"pid",e),t=addQueryStringParam(t,"ts",(new Date).getTime()+generateRandomId()),t+="&puid=",encodeURIComponent(t)},runApis=function(apis){if(!(invibes.noCookies||invibes.optIn<=0)){var callBroker=function(e){var t,i,n;ivLogger.log("Broker start: "+e.Url);var o=function(){n&&(window.removeEventListener("message",i),n.parentElement.removeChild(n),n=null)},r=new Promise(function(i){window.setTimeout(function(){t||ivLogger.warn("Broker timeout: "+e.Url),o(),i()},brokerTimeout)}),s=new Promise(function(r){i=function(e){var i;e.data.ivbroker&&(e.data.error?(ivLogger.error(e.data.error),i=null):i=e.data.content,t=!0,o(),r(i))},window.addEventListener("message",i),n=insertIframe(e)});return Promise.race([r,s])},callBrokers=function(callsRemaining){var brokerApi=chooseRandom(apis);brokerApi&&callBroker(brokerApi).then(function(response){var puid=null,useAge;try{null!=response&&(eval("var brokerResponseParser = "+brokerApi.Script),puid=brokerResponseParser(response))}catch(e){ivLogger.error(e)}puid?(invibes.dom.graduate(),invibes.sendStatwebStats(11007,puid+"|"+brokerApi.PId),useAge=maxAgeMatched,ivLogger.info('%cGot id "'+puid+'" from broker %c'+brokerApi.Url,"color:#ee1111;","color:#494")):useAge=maxAgeUnmatched,apis.splice(apis.indexOf(brokerApi),1),visitedBrokers[brokerApi.BId]=today+useAge,persistence.save(visitedBrokers),callsRemaining>1&&window.setTimeout(function(){callBrokers(callsRemaining-1)},delayBetweenRequests)})};apis=apis.filter(function(e){if(e.Url.indexOf("[lid]")>-1){if(null==invibes.dom.id)return ivLogger.warn("Broker "+e.Url+" is of type "+e.Type+" and requires valid lid to be sent but it doesnt exist yet"),!1;e.Url=e.Url.replace("[lid]",invibes.dom.id),e.Url=addQueryStringParam(e.Url,"ts",(new Date).getTime()+generateRandomId())}if(e.Url.indexOf("[lidhash]")>-1){if(null==invibes.dom.id)return ivLogger.warn("Broker "+e.Url+" is of type "+e.Type+" and requires valid lid to be sent but it doesnt exist yet"),!1;e.Url=e.Url.replace("[lidhash]",hashLid(invibes.dom.id)),e.Url=addQueryStringParam(e.Url,"ts",(new Date).getTime()+generateRandomId())}if(e.Url.indexOf("[ivbsUrl]")>-1){if(null==invibes.dom.id)return ivLogger.warn("Broker "+e.Url+" is of type "+e.Type+" and requires valid lid to be sent on redirect url but it doesnt exist yet"),!1;e.Url=e.Url.replace("[ivbsUrl]",constructRedirectUrl(e.PId))}return null==visitedBrokers[e.BId]}),apis&&apis.length>0&&callBrokers(maxApisToCall)}};return visitedBrokers=persistence.load(),{runApis:runApis,get getVisited(){return Object.keys(visitedBrokers).join(",")}}},brokerClient=new DataBrokerClient,EventClass=Event;navigator.userAgent.match(/MSIE |Trident/i)&&(EventClass=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i},EventClass.prototype=window.Event.prototype),invibes.setAttr=function(e,t){if(e)if(e instanceof Array)e.forEach(function(e){e instanceof Array&&invibes.setAttr.apply(invibes,e)});else{if(ivLogger.info("%cOPT: "+e+" = %c"+t,"color:#44f;","color:#494"),"noCookies"===e)return invibes.setCookie("ivNoCookie",1,365),void(invibes.noCookies=1);if("forget"===e)return void invibes.forgetFunction();if("opt-in"===e)return invibes.noCookies=0,invibes.setCookie("ivNoCookie",0,-1),invibes.optIn=1,void invibes.setCookie("ivOptIn",1,365);if("opt-out"===e)return invibes.setCookie("ivOptIn",-1,365),void(invibes.optIn=-1);if("login"===e||"puid"===e){if(invibes.optIn<=0)return;if(null==t)return;return invibes.dom.graduate(),void invibes.sendStatwebStats(11002,t)}}},window.dispatchEvent(new EventClass("ivbsinit"));var testConfiguration=invibes.testConfiguration||{};Object.keys(vsConfig).forEach(function(e){vsConfig.hasOwnProperty(e)&&testConfiguration[e]&&(vsConfig[e]=testConfiguration[e])}),invibes.uwebDomain=vsConfig.uwebDomain;var suspendedCookieName="VSVASuspended";invibes.headerHeight=invibes.headerHeight||0,invibes.footerHeight=invibes.footerHeight||0,Array.prototype.findIndex||(Array.prototype.findIndex=function(e){for(var t=0;t<this.length;t++)if(e(this[t]))return t}),enableEventFunctionality(invibes),initDomainId(),invibes.visitId=invibes.visitId||generateRandomId();var sessionIdCookieName="ivbss";invibes.setCookie(sessionIdCookieName,invibes.getCookie(sessionIdCookieName)||generateRandomId());var keywords=function(){var e=document.getElementsByTagName("head")[0],t=e?e.getElementsByTagName("meta"):[];function i(e,t){var i=e.replace(/[<>~|\\"`!@#$%^&*()=+?]/g,"");var n=i.split(/[\s,;.:]+/).filter(function(e,t,i){return""!==e&&i.indexOf(e)===t});i="";for(var o=0;o<n.length;o++){if((i+=n[o]).length>=t)return i;o<n.length-1&&(i+=",")}return i}function n(e,n,o){e=e||"keywords",n=n||100;for(var r=o=o||"",s=0;s<t.length;s++){if(t[s].name&&t[s].name.toLowerCase()===e.toLowerCase())return i(o+","+t[s].content||"",n);t[s].name&&t[s].name.toLowerCase().indexOf(e.toLowerCase())>-1&&(r=o+","+t[s].content||"")}return i(r,n)}var o=n("keywords",300);return(!o||o.length<292)&&(!(o=n("description",300,o))||o.length<292)&&(o=function(t,n){return t=t||300,i((n=n||"")+","+((document.title||e)&&e.getElementsByTagName("title")[0]?e.getElementsByTagName("title")[0].innerHTML:""),t)}(300,o)),o}(),clickDelay={thresholdReachedAt:Number.MAX_SAFE_INTEGER+1,EvaluateVisibilityThreshold:function(e){e=e||0,clickDelay&&clickDelay.thresholdReachedAt==Number.MAX_SAFE_INTEGER+1&&e>=50&&(clickDelay.thresholdReachedAt=(new Date).getTime())},GetElipsedTime:function(){return clickDelay.thresholdReachedAt!=Number.MAX_SAFE_INTEGER+1?"["+((new Date).getTime()-clickDelay.thresholdReachedAt)+"]":""},IsClickDelayed:function(){return!!(clickDelay.thresholdReachedAt&&invibes.currentAd&&invibes.currentAd.ClickDelay&&invibes.currentAd.ClickDelay>0&&(new Date).getTime()-clickDelay.thresholdReachedAt<invibes.currentAd.ClickDelay)}},isScrolledIntoView=function(e,t){var i=e.getBoundingClientRect(),n=i.top,o=i.bottom;return t?n>0&&o<=window.innerHeight:n<window.innerHeight&&o>0},BeaconClient=function(){var e=Math.floor((new Date).getTime()/864e5),t=function(){var t,i,n=(t=invibes.getCookie("ivvbks")||"",i={},t.split("|").forEach(function(t){var n=t.split("."),o=parseInt(n[0],10);!isNaN(o)&&o+3>e&&(n[1]||"").split(",").forEach(function(e){i[e]=o})}),i),o=[];if(Object.keys(beacons).forEach(function(e){!beacons.hasOwnProperty(e)||n[e]||beacons[e].indexOf(cookieDomain)>=0||o.push({idx:e,url:beacons[e]})}),o.length){var r,s=(r=o)[Math.floor(Math.random()*r.length)];return n[s.idx]=e,function(e){var t={};Object.keys(e).forEach(function(i){if(e.hasOwnProperty(i)){var n=e[i];t[n]=t[n]||[],t[n].push(i)}});var i=Object.keys(t).filter(function(e){return t.hasOwnProperty(e)}).map(function(e){return e+"."+t[e].join(",")}).join("|");invibes.setCookie("ivvbks",i,3)}(n),s.url}ivLogger.warn("No BK available")},i=function(e){var t,i;ivLogger.log("BK start:"+e);var n=function(e){var t=document.createElement("iframe");return t.src=e,t.style.width=0,t.style.height=0,t.frameBorder=0,document.body.appendChild(t),t}(e),o=function(){n&&(window.removeEventListener("message",i),n.parentElement.removeChild(n),n=null)},r=new Promise(function(i){window.setTimeout(function(){t||ivLogger.warn("BK timeout: "+e),o(),i()},3e3)}),s=new Promise(function(n){i=function(i){i.data.ivbxx&&(t=1,o(),n(i.data.id),ivLogger.info("BK OK: "+e))},window.addEventListener("message",i)});return Promise.race([r,s])},n=function(e,o){if(cookieDomain&&!invibes.noCookies&&!(invibes.optIn<=0)){var r=t();r&&i(r).then(function(t){t&&(invibes.dom.graduate(),invibes.sendStatwebStats(11001,invibes.dom.id+"."+t)),e>1&&window.setTimeout(function(){n(e-1,o)},o)})}};this.run=n},hidden,visibilityChange;invibes.visibilityAPI=(visibilityChange="",void 0!==document.hidden?(hidden="hidden",visibilityChange="visibilitychange"):void 0!==document.mozHidden?(hidden="mozHidden",visibilityChange="mozvisibilitychange"):void 0!==document.msHidden?(hidden="msHidden",visibilityChange="msvisibilitychange"):void 0!==document.webkitHidden&&(hidden="webkitHidden",visibilityChange="webkitvisibilitychange"),{eventName:visibilityChange,isVisible:function(){return!!invibes.FullscreenApi().recentlyChanged||!document[hidden]}}),function(){invibes.handlers=invibes.handlers||[],invibes.trySetStatus=function(e){var t=!0;if(this.statusCode!==e.code){switch(e.code){case 0:1===this.statusCode&&(t=!1);break;case-1:void 0!==this.statusCode&&(t=!1);break;case 1:0!==this.statusCode&&1!==this.statusCode||(t=!1)}t?(ivLogger.info("IvStatus changed from ["+this.statusCode+"] to ["+e.code+"]."),this.statusCode=e.code,this.handlers.forEach(function(t){"function"==typeof t&&t.call(e)})):ivLogger.log("Warning: Trying to change status from ["+this.statusCode+"] to ["+e.code+"].")}};var e=invibes.localize=function(e){return this.localize.currentDict[e]||e};e.dictionaries={en:{close:"Close",loading:"Loading... Please wait",suspend:"Hide this Ad",about:"About Invibes advertising",aboutCookies:"About cookies",cookieDescription:"We may transmit one or more cookies, small text files containing alphanumeric characters that uniquely identify the web browser. This is used to track your usage patterns on our affiliate websites in a non-personally identifiable manner.",clearCookies:"Click here to delete all your cookie history",cookiesDeleted:"Your cookie history will be deleted.",cookiePolicy:"Read more about our Terms"},fr:{close:"Fermer",loading:"Chargement en cours, merci de patienter...",suspend:"Masquer cette publicité",about:"À propos de Invibes advertising",aboutCookies:"À propos des cookies",cookieDescription:"Nous pouvons transmettre un ou plusieurs cookies sous forme de petits fichiers texte contenant des caractères alphanumériques qui identifient votre navigateur Internet.  Ils sont utilisés pour suivre des habitudes d’utilisation sur nos sites partenaires, de manière non personnellement identifiable.",clearCookies:"Cliquer ici pour supprimer vos cookies",cookiesDeleted:"Votre historique de cookies sera supprimé.",cookiePolicy:"Lire notre politique sur les cookies"},de:{close:"Schliessen",loading:"Laden... Bitte warten",suspend:"Diese Werbung ausblenden",about:"Über Invibes advertising",aboutCookies:"Über Cookies",cookieDescription:"Wir können ein oder mehrere Cookies, kleine Textdateien mit alphanumerischen Zeichen übertragen, die einmalig den Web-Browser identifizieren. Dies wird verwendet, um Ihr Internetnutzungsverhalten auf unserer Partner-Websites in einer nicht-personenbezogene Weise zu verfolgen.",clearCookies:"Hier klicken, um alle Cookies zu löschen",cookiesDeleted:"Die Cookies werden gelöscht werden.",cookiePolicy:"Mehr lesen über die AGB"},es:{close:"Cerrar",loading:"Cargando... por favor, espere",suspend:"Oculta este anuncio",about:"Sobre Invibes advertising",aboutCookies:"Sobre las cookies",cookieDescription:"Podemos transmitir una o más cookies, pequeños archivos de texto que contienen caracteres alfanuméricos que identifican el navegador web. Esto se utiliza para realizar un seguimiento de los patrones de uso de los sitios de afiliados de forma no personal.",clearCookies:"Haga click aquí para borrar todo su historial de cookies",cookiesDeleted:"Su historial de cookies se va a borrar.",cookiePolicy:"Más información sobre nuestros términos"},ru:{close:"Закрыть",loading:"Загрузка... Пожалуйста, ожидайте",suspend:"Скрыть это объявление",about:"Об Invibes",aboutCookies:"О Cookies",cookieDescription:"Мы можем передавать один и более cookies, небольшие текстовые файлы, содержащие наборы символов для уникальной идентификации веб браузером. Это используется для того, чтобы отслеживать посещение сайтов наших партнеров, без использования персональных данных.",clearCookies:"Нажмите здесь, чтобы очистить историю cookie",cookiesDeleted:"Ваша история cookie очищена.",cookiePolicy:"Узнать больше о нашей Политике Безопасности"},it:{close:"Chiudi",loading:"Attendere... Caricamento in corso",suspend:"Nascondi questo annuncio",about:"A proposito di Invibes advertising",aboutCookies:"A proposito di cookies",cookieDescription:"Questo sito utilizza i cookie per migliorare servizi ed esperienza dei lettori ed inviare pubblicità. Se decidi di continuare la navigazione consideriamo che accetti il loro uso.",clearCookies:"Clicca qui per cancellare tutta la cronologia dei cookie",cookiesDeleted:"La vostra storia cookie viene cancellata.",cookiePolicy:"Leggere di più sui nostri Termini"},nl:{close:"Sluiten",loading:"Laden... Ogenblik aub",suspend:"Verberg deze reklame",about:"Over Invibes advertising",aboutCookies:"Cookies beleid",cookieDescription:"We kunnen mogelijks één of meerdere cookies doorsturen. Dit zijn kleine text files met alpha numerieke waarden die uw browser uniek identificeren. Deze worden gebruikt om de gewoonten van gebruikers op te volgen op onze partner websites, op een niet-identificeerbare en onpersoonlijke wijze.",clearCookies:"Verwijder mijn cookie geschiedenis",cookiesDeleted:"Uw cookie geschiedenis zal worden verwijderd.",cookiePolicy:"Lees onze gebruikersvoorwaarden"},pt:{close:"Fechar",loading:"Carregando... Favor aguardar",suspend:"Esconder este anuncio",about:"Sobre Invibes Advertising",aboutCookies:"Sobre cookies",cookieDescription:"Poderemos transferir um ou mais cookies, pequenos arquivos de texto contendo caracteres alfa-numéricos que identificam o web browser de forma única. Isto é usado para registrar seu padrão de uso em websites afiliados, de maneira anônima e não identificável.",clearCookies:"Clique aqui para apagar todo seu histórico de cookies",cookiesDeleted:"Seu histórico de cookies será apagado.",cookiePolicy:"Leia mais sobre nossos Termos"}},e.defaultDict=e.dictionaries.en,e.usingLanguage=function(e){e&&(this.currentLanguage=e.toLowerCase(),this.currentDict=this.dictionaries[this.currentLanguage]||this.defaultDict)},e.usingLanguage("en"),invibes.localizeDom=function(e){"string"==typeof e&&(e=document.getElementById(e)),e=e||document.body;var t=e.querySelectorAll("[data-res-id]");Array.prototype.forEach.call(t,function(e){var t=e.getAttribute("data-res-id");e.textContent=invibes.localize(t)})}}(),window.addEventListener("scroll",function(){invibes.dispatchEvent("scroll"),invibes.dispatchEvent("scrollresize")}),window.addEventListener("resize",function(){invibes.dispatchEvent("scrollresize")}),invibes.getClientVerticalVisibilityPercent=function(e){if(e.forcedVisibilityPercent)return e.forcedVisibilityPercent;var t=e.getBoundingClientRect(),i=Math.max(invibes.headerHeight,t.top),n=Math.min(window.innerHeight-invibes.footerHeight,t.bottom);return t.height<1?0:Math.max(0,Math.round(100*(n-i)/t.height))};var userManager=(serviceUrls=[invibes.uwebDomain],supportsCrossDomain=!invibes.getCookie("ivNotCD"),clients=serviceUrls.map(function(e){var t,i={};return i.get=function(i,n){if(!supportsCrossDomain)return ivLogger.info("Not CD..."),void i({});var o=e+"/GetIvId";invibes.dom.id&&(o=addQueryStringParam(o,"k",1)),n&&(o=addQueryStringParam(o,"idToSet",n)),invibes.jsonp(o,function(e){e.mustRetry?(ivLogger.log("retrying..."),o=addQueryStringParam(o,"retry",1),invibes.jsonp(o,function(n){n.optIn=n.optIn||e.optIn,n.notCD&&(ivLogger.warn("Set as not CD!"),supportsCrossDomain=!1,invibes.setCookie("ivNotCD","y",365)),t=n.id,i(n)})):(t=e.id,i(e))})},i.set=function(e,n){n&&t===n?e({}):i.get(e,n)},i.clear=function(t){var i={location:encodeURIComponent(getDocumentLocation()),ts:(new Date).getTime()};document.referrer&&(i.referrer=encodeURIComponent(document.referrer.substring(0,300).split(/[?#]/)[0])),invibes.dom.id&&(i.lid+=invibes.dom.id),invibes.jsonpWithParams(e+"/NoIvId",i,t)},i.getOptIn=function(t){if(!supportsCrossDomain)return ivLogger.info("Not CD..."),void t({});invibes.jsonpWithParams(e+"/GetOptIn",null,t)},i}),crossDomainCookieProvider={getId:function(e){var t=0,i=function(){var n=clients[t];n?n.get(function(n){n.id?(e(n),clients.forEach(function(e){e.set(noop,n.id)})):(t++,i())}):e({})};i()},clear:function(e){delete invibes.id;var t=clients.length,i=function(){0==--t&&e()};clients.forEach(function(e){e.clear(i)})},getOptIn:function(e){var t=clients.length,i=function(i){0==--t&&e(i)};clients.forEach(function(e){e.getOptIn(i)})}},{detectUserId:function(e){if(invibes.noCookies||invibes.optIn<0||window.ivbsIdLess)e&&e();else{var t=!1;window.setTimeout(function(){t||(ivLogger.warn("Cookie mechanism timeout/error."),e())},1e3),0!=invibes.optIn?crossDomainCookieProvider.getId(function(i){t=!0,i.optIn<0&&invibes.dom.regen&&invibes.dom.regen(),invibes.id=i.id,i.k&&invibes.dom.graduate(),ivLogger.info("CDid="+invibes.id),e()}):crossDomainCookieProvider.getOptIn(function(i){t=!0,null!=i&&null!=i.Data&&i.Data.OptIn<0&&(invibes.noCookies=1,invibes.optIn=0,invibes.setCookie("ivNoCookie",1,365),invibes.deleteLocalCookies()),e&&e()})}},clear:crossDomainCookieProvider.clear}),serviceUrls,supportsCrossDomain,clients,crossDomainCookieProvider,ViewCapping=function(e){(e=e||{}).getTime=e.getTime||function(){return(new Date).getTime()};var t=function(){try{return JSON.parse(localStorage.getItem("ivvcap"))||{}}catch(e){return{}}},i=function(e){try{localStorage.setItem("ivvcap",JSON.stringify(e))}catch(e){}};this.registerView=function(n,o){var r,s=t(),a=s[n]||[0,e.getTime()+(r=o,3600*r*1e3)];s[n]=[a[0]+1,a[1]],i(s)},this.getCappedCampaigns=function(){!function(){var n=e.getTime(),o=t(),r=!1;Object.keys(o).forEach(function(e){o[e][1]<=n&&(delete o[e],r=!0)}),r&&i(o)}();var n=t();return Object.keys(n).filter(function(e){return n.hasOwnProperty(e)}).sort().map(function(e){return[e,n[e][0]]})},this.getCappedCampaignsAsString=function(){return this.getCappedCampaigns().map(function(e){return e.join("=")}).join(",")}},viewCapping=new ViewCapping,registerViewCapping=function(e){var t=e.ViewCapping;t&&viewCapping.registerView(t.C,t.T)},addScriptsSequentially=function(e,t){var i=e.shift();i?(i.parent.appendChild(i.script),i.script.src?i.script.onload=function(){addScriptsSequentially(e,t)}:addScriptsSequentially(e,t)):t&&t()},setInnerHtmlWithScripts=function(e,t,i){e.innerHTML=t;var n=e.querySelectorAll("script"),o=[];Array.prototype.forEach.call(n,function(e){var t=e.parentElement;t.removeChild(e);var i=document.createElement("script");"id|type|src|textContent".split("|").forEach(function(t){e[t]&&(i[t]=e[t])}),o.push({script:i,parent:t})}),addScriptsSequentially(o,i)},hasClass=function(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},addClass=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},removeClass=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")},toggleClass=function(e,t){e.classList?e.classList.toggle(t):hasClass(e,t)?removeClass(e,t):addClass(e,t)},showElement=function(e){e.style.display="block"},beforeWindowCloseExecuted=!1,createPopup=function(e,t,i){var n,o='<div id="ivPopupContainer"> <div id="ivPopup">  <div class="fermer"> <div id="resize-btn"> <img class="max-btn" src="//static.r66net.com/Content/Images/maximizev8.png" /> <img class="min-btn" src="//static.r66net.com/Content/Images/minimizev8.png" /> </div> <div id="fermer-btn"> <img src="//static.r66net.com/Content/Images/closev8.png" /> </div> <div id="fermer-msg"> <p>'+invibes.localize("loading")+'</p> </div> </div> <div id="sewebContainer" class="nonInbound"> <iframe id="ivFrame" frameborder="0"></iframe> </div> </div> </div>',r='<div id="ivPopupContainer"> <div id="ivPopup"> <div class="fermer"> <div id="fermer-btn"> <img src="//static.r66net.com/Content/Images/closev8.png" /> </div> <div id="fermer-msg"> <p>'+invibes.localize("loading")+'</p> </div> </div> <div id="sewebContainer" class="nonInbound"> <iframe id="ivFrame" frameborder="0"></iframe> </div> </div> </div>',s=function(e){crossDomainMessageIsFromExpectedOrigin(e,vsConfig.sewebUrl)&&("close"===e.data.command&&invibes.popup.close(),"toggleMax"===e.data.command&&invibes.popup.toggleMaximized())};n=t?'<div id="ivPopupContainer"> <div id="ivPopup"> <div id="sewebContainer"> <iframe id="ivFrame" frameborder="0"></iframe> </div> </div> </div>':e?o:r;var a=document.createElement("div");a.innerHTML=n,a.style.display="none",document.querySelector("body").appendChild(a);var d=document.getElementById("ivPopup");e&&!t&&document.getElementById("resize-btn").addEventListener("click",function(e){e.preventDefault(),invibes.popup.toggleMaximized()});t&&window.addEventListener("message",s,!1);var l={};return l.show=function(){var e=invibes.currentAd;if(document.querySelector("html").setAttribute("style","overflow: hidden !important"),document.querySelector("body").setAttribute("style","overflow: hidden !important"),invibes.vsSewebStartTime=(new Date).toISOString(),window.onbeforeunload=window.onpagehide=function(){return""},window.addEventListener("beforeunload",beforeWindowCloseHandler),window.addEventListener("pagehide",beforeWindowCloseHandler),showElement(a),!t){var i=document.getElementById("fermer-btn");i&&i.addEventListener("click",function(){invibes.popup.close()}),showElement(document.getElementById("fermer-msg")),top.window.setTimeout(function(){var e=document.getElementById("fermer-msg");e&&(e.style.display="none")},5e3)}var n=vsConfig.sewebUrl+"/V8/Overlay/?bvExposedId="+e.VideoExposedId+"&t="+e.Token+"&et="+e.EwebToken+"&lid="+invibes.dom.id+"&lang="+invibes.localize.currentLanguage;e.CustomInfo&&(n+="&addinf="+e.CustomInfo),e.InvoiceOnBoxOpen&&(n+="&ib=1"),void 0!==invibes.slideIndex&&(n+="&si="+invibes.slideIndex),invibes.extraSewebParams&&(n+="&"+createQueryString(invibes.extraSewebParams));var o=function(){if(invibes.currentAd.CampaignGeoTag&&invibes.currentAd.CampaignGeoTag.TagReplacements){var e={},t=invibes.currentAd.CampaignGeoTag.TagsNotSentToSeweb||[],i=invibes.currentAd.CampaignGeoTag.TagReplacements;for(var n in i)i.hasOwnProperty(n)&&-1===t.indexOf(n)&&(e[n]=i[n]);return JSON.stringify(e)}}();o&&(n+="&GeoTagContent="+encodeURIComponent(o)),document.getElementById("ivFrame").setAttribute("src",n)},l.close=function(){t&&window.removeEventListener("message",s);var e=document.getElementById("ivPopupContainer").parentElement;document.getElementById("ivFrame").src="about:blank",setTimeout(function(){e.parentElement.removeChild(e)},0),setTimeout(function(){beforeWindowCloseHandler(!0)},0),document.querySelector("html").setAttribute("style",""),document.querySelector("body").setAttribute("style",""),invibes.dispatchEvent("afterEngagement",invibes.videoAdContentResult)},l.toggleMaximized=e?function(){toggleClass(d,"maximize")}:function(){},e&&i&&l.toggleMaximized(),l},sendStatwebStats=invibes.sendStatwebStats=function(e,t,i){var n=vsConfig.statwebUrl+"/statPixel?location="+encodeURIComponent(getDocumentLocation());document.referrer&&(n+="&referrer="+encodeURIComponent(document.referrer.substring(0,300).split(/[?#]/)[0])),invibes.dom.id&&(n+="&lId="+invibes.dom.id),n+="&optIn="+invibes.optIn,n+="&actionType="+e,t=t||invibes.visitId+"|"+invibes.optIn,n+="&additionalInfo="+encodeURIComponent(t),invibes.id&&(n+="&cookie="+encodeURIComponent(invibes.id)),i&&(n+="&rfc="+i),n+="&ts="+(new Date).getTime()+generateRandomId(),invibes.pixel(n)},videoAdContentResult=null,fbScriptDisplayed=!1,resolveClickSentPromise;invibes.clickSentPromise=new Promise(function(e){resolveClickSentPromise=e});var hardCutIfConfigured=(iter=0,function(){if(!0&invibes.currentAd.COptions){window.stop&&window.stop();for(var e=window.setTimeout(null,0);e--;)window.clearTimeout(e);++iter<50&&setTimeout(hardCutIfConfigured,100)}}),iter,sendVideoAdClickStats=invibes.sendClickStats=function(e,t){if(!invibes.adClickSent){invibes.adClickSent=1;var i=invibes.currentAd,n=i.CampaignGeoTag?i.CampaignGeoTag.ApiKeyInfo:null;t&&(n+="|"+t),clickDelay&&clickDelay.GetElipsedTime&&(n+=clickDelay.GetElipsedTime());var o=createQueryString({bvToken:i.Token,ivbsCampIdsLocal:invibes.getCookie("IvbsCampIdsLocal"),exposedId:"VideoExposedId="+i.VideoExposedId,location:getDocumentLocation(),additionalInfo:n,optIn:invibes.optIn,l:invibes.latency||-1}),r=vsConfig.kwebstatUrl+"/Stat/RegisterAdClickStat?"+o;invibes.jsonp(r,function(t){t.campIds&&invibes.setCookie("IvbsCampIdsLocal",t.campIds,365),resolveClickSentPromise(),e&&e(),hardCutIfConfigured()})}},pendingUserVideoEvents=[],sendUserVideoEvent=invibes.sendUserVideoEventId=function(e,t,i){var n;if(invibes.videoAdContentResult){var o=i||invibes.currentAd;(n=o&&o.Token?{bvToken:o.Token,additionalInfo:t}:{pageId:invibes.videoAdContentResult.PageId,publisherUrlId:invibes.videoAdContentResult.PublisherUrlId,userCookieId:invibes.id,zone:invibes.videoAdContentResult.Zone,vId:invibes.visitId,additionalInfo:t}).eventType=e,1050!==e&&1052!==e||(n.location=getDocumentLocation()),invibes.pixel(vsConfig.kwebstatUrl+"/Stat/PixelUve",n)}else pendingUserVideoEvents.push([e,t])},isCurrentlyInView=(hasDisplayNone=!0,isDisplayNoneRec=function(e){return null!=e&&("none"==function(e){return e.currentStyle?e.currentStyle.display:getComputedStyle(e,null).display}(e)||isDisplayNoneRec(e.parentElement))},function(e){if(invibes.testMode&&invibes.doNotWaitForScroll)return!0;var t=e.getBoundingClientRect().top;return top.window.innerHeight>t&&t>=0&&(hasDisplayNone&&(hasDisplayNone=isDisplayNoneRec(e)),!hasDisplayNone)}),hasDisplayNone,isDisplayNoneRec,unbindWindowScrollAndResizeEvents,addMenuFunctionality=function(e){var t=!1,i=e.querySelector(".ivTrigger"),n=e.querySelector(".ivDropDown"),o=e.querySelector(".ivCookies"),r=e.querySelector(".ivCookieInfo"),s=e.querySelector(".ivClearCookiesLink"),a=e.querySelector(".ivClearCookiesConfirmation");i&&n&&(i.addEventListener("click",function(){toggleClass(i,"active"),r&&removeClass(r,"active"),t=!t,n.style.display=t?"block":"none"}),o&&(o.addEventListener("click",function(){toggleClass(r,"active")}),s.addEventListener("click",function(e){e.cancelBubble=!0,s.parentNode.removeChild(s),invibes.forgetFunction(function(){a.style.display=""})})))},addFooter=function(e){var t=document.createElement("div");t.innerHTML='<div id="ivbsFooter" class="ivbsIdentity" style="margin: 0 auto!important;text-align: right!important;color: #555!important;font-size: 10px!important;letter-spacing: -0.2px!important;line-height: 16px!important;padding: 5px 0!important;font-family: \'Roboto\',sans-serif!important;font-weight: 400!important;" >Inspired by<a title="Invibes advertising" target="_blank" href="http://www.invibes.com"><img style="height: 16px!important;margin-right: 0!important;margin-top: 0!important;float:right!important;margin-left: 3px!important;" src="//bvt.r66net.com/Images/logo-invibes-grey.svg"></a></div>',e.appendChild(t)},startVisiIfNeeded=function(e){if(e.VisiDuration&&e.VisiPercent){var t={target:{percentage:e.VisiPercent,duration:e.VisiDuration}};e.VisiElementId&&(t.target.element=document.getElementById(e.VisiElementId)),ivLogger.info(["Starting Visi: ",t]),new invibes.Visi(t).start()}},clickTrackers=[];invibes.addClickTrackers=function(e){if(e&&e.length>0)for(var t=0;t<e.length;t++)clickTrackers.push(e[t])},invibes.createOutgoingLink=function(e){var t=invibes.currentAd,i=(t.Token,e.replace(/\[[^\]]*(timestamp|cache)[^\]]*\]/gi,(new Date).getTime()));return invibes.utm&&(i+=invibes.utm),vsConfig.ewebUrl+"/redir/?t="+t.EwebToken+"&to="+encodeURIComponent(i)};var outgoingLinkClickHandler=function(e){if(clickDelay&&clickDelay.IsClickDelayed&&clickDelay.IsClickDelayed())return e.preventDefault(),e.stopPropagation(),!1;invibes.outgoingClicked=1,invibes.handleAdClick&&invibes.handleAdClick(),invibes.sendClickStats&&invibes.sendClickStats();for(var t=0;t<clickTrackers.length;t++)invibes.pixel(clickTrackers[t]);1===invibes.vpaidClickedThrough&&e.preventDefault()},initializeOutgoingLink=function(e,t){if(e){var i=t||e.getAttribute("outgoing-href");if(i){var n=invibes.createOutgoingLink(i);e.setAttribute("href",i),e.setAttribute("onmousedown",'this.href="'+n+'"'),e.setAttribute("ontouchstart",'this.href="'+n+'"'),e.removeEventListener("click",outgoingLinkClickHandler),e.addEventListener("click",outgoingLinkClickHandler)}}};invibes.initializeAllOutgoingLinks=function(){var e=invibes.adDiv.querySelectorAll("a[outgoing-href]");(e=Array.prototype.slice.call(e)).forEach(function(e){initializeOutgoingLink(e)})};var initializeClickTargets=function(){var e=invibes.adDiv.querySelectorAll('[data-role="clickTarget"]');(e=Array.prototype.slice.call(e)).forEach(function(e){e.addEventListener("click",invibes.handleAdClick)})},listenToInvoiceMessageFromPopup=function(e){crossDomainMessageIsFromExpectedOrigin(e,vsConfig.sewebUrl)&&invibes.dispatchEvent("messageFromPopup",e)};window.addEventListener("message",listenToInvoiceMessageFromPopup,!1);var createVisibilityMonitor=function(e){var t,i={},n=[],o=function(e){Object.keys(i).filter(function(t){return t<=e}).forEach(function(e){i[e].disable(),delete i[e]})},r=function(){if(n.length){var t=n[n.length-1];e.onCheckpointReached.call(null,t),n=[]}},s=function(){var s,a=invibes.getClientVerticalVisibilityPercent(e.target);if(clickDelay&&clickDelay.EvaluateVisibilityThreshold&&clickDelay.EvaluateVisibilityThreshold(a),Object.keys(i).forEach(function(e){var t=i[e];t.update(a),t.done&&(s=e)}),s>-1){var d=parseInt(s,10);t&&window.clearTimeout(t),o(s),e.debounceRate>0&&Object.keys(i).length>0?(n.push(d),t=window.setTimeout(r,e.debounceRate)):e.onCheckpointReached.call(null,d)}};return e.checkpoints.sort().forEach(function(t){i[t]=new function(e,t,i){var n,o=0,r=0,s=(new Date).getTime(),a=function(){n&&window.clearTimeout(n)};return{update:function(d){if(a(),!this.done){var l=(new Date).getTime();if(r>=e){if((o+=l-s)>=t.duration)return void(this.done=1)}else t.continuous&&(o=0);if(d>=e){var c=t.duration-o;n=window.setTimeout(i,c)}s=l,r=d}},disable:function(){a()}}}(t,e,s)}),invibes.addEventListener("scrollresize",s),s(),{stop:function(){invibes.removeEventListener("scrollresize",s),o(101)}}},handleAdViewStats=function(e){var t=function(){if(ivLogger.info("view"),invibes.viewed=!0,invibes.dispatchEvent("view"),sendVideoAdViewStats(e),invibes.currentAd.DmpScript&&invibes.optIn>0){var t=new Function(invibes.currentAd.DmpScript);try{t.call()}catch(e){ivLogger.error("Dmp script error",e)}}},i=videoAdContentResult.MinPercentageForAdview||0,n=invibes.currentAd.MinPercentageForAdview||0,o=i>n?i:n;if(o){var r=function(){invibes.getClientVerticalVisibilityPercent(e)>=o&&(t(),invibes.removeEventListener("scrollresize",r))};invibes.addEventListener("scrollresize",r),r()}else t()},renderAd=function(){invibes.hasScrolled=!0;var e=invibes.adDiv=invibes.adDiv||getDivToFill();if(!e)return unbindWindowScrollAndResizeEvents(),sendStatwebStats(-40,"NoVideoAdDivFound"),void tryInsertVideoAdFallbackScript();if(canDisplayAdIn(e))if(0!==invibes.statusCode){var t;unbindWindowScrollAndResizeEvents(),invibes.adDisplayed=!0;var i,n=invibes.currentAd;e.getAttribute("id");n.HtmlString?(i=n.HtmlString,t=i=makeGeoTagReplacements(i=invibes.currentAd.HasInspiredBy?function(e){var t='<link href="https://fonts.googleapis.com/css?family=Roboto:400,100,300,500|Open+Sans|Oswald:100,300,400,500" rel="stylesheet" type="text/css"><div style="font-size:10px;color:black; margin: 0 auto; line-height: normal; position: relative;"><div class="ivTrigger">'+invibes.videoAdContentResult.LocalizedAdvertiserTitle+'</div><span class="ivDropDown"><span onclick="invibes.hideAndSuspend();">'+invibes.localize("suspend")+'</span><span class="ivCookies">'+invibes.localize("aboutCookies")+'<div class="ivCookieInfo"><div><img src="//bvt.r66net.com/vi/options-arrow.png" /><p>'+invibes.localize("cookieDescription")+'</p><p class="ivClearCookiesConfirmation" style="display: none;">'+invibes.localize("cookiesDeleted")+'</p><a href="javascript:void(0);" class="ivClearCookiesLink">'+invibes.localize("clearCookies")+'</a><a target="_blank" href="http://www.invibes.com/terms.html">'+invibes.localize("cookiePolicy")+'</a></div></div></span><a target="_blank" href="http://www.invibes.com/">'+invibes.localize("about")+"</a></span></div>",i=e.indexOf(">",e.indexOf("<div"))+1;return e=[e.slice(0,i),t,e.slice(i)].join("")}(i):function(e){var t={videoAdSuspend:"suspend",videoAdAbout:"about",aboutCookies:"aboutCookies",cookieDescription:"cookieDescription",clearCookies:"clearCookies",cookiePolicy:"cookiePolicy",cookiesDeleted:"cookiesDeleted"};return Object.keys(t).forEach(function(i){if(t.hasOwnProperty(i)){var n=new RegExp("\\["+i+"\\]","g"),o=invibes.localize(t[i]);e=e.replace(n,o)}}),e}(i)),setInnerHtmlWithScripts(e,t)):sendStatwebStats(-40,"NoHtmlString|VideoExposedId="+n.VideoExposedId);var o=e.querySelector("div[id^='divMosaic+']");o&&(createVisibilityMonitor({target:invibes.adDiv,duration:1e3,debounceRate:700,checkpoints:[35,50,75],onCheckpointReached:function(e){invibes.maxv1s=e,invibes.dispatchEvent("visiCheckpoint",e),sendVisibilityStat({cookieId:invibes.id,pageId:invibes.vsPageId,bvToken:n.Token,userDeviceType:videoAdContentResult.UserDeviceType,visibilityPercentCheckpoint:e})}}),addMenuFunctionality(o),invibes.currentAd.HasInspiredBy&&addFooter(o)),invibes.trySetStatus({code:1}),invibes.initializeAllOutgoingLinks(),initializeClickTargets(),addTrackingScript(),!invibes.vsSentVideoAdStats&&e.innerHTML.length&&(invibes.vsSentVideoAdStats=!0,handleAdViewStats(e)),startVisiIfNeeded(n),invibes.dispatchEvent("adRendered",invibes.videoAdContentResult)}else invibes.scrollTimeoutStatSent||(invibes.scrollTimeoutStatSent=!0,sendStatwebStats(-45,Date.now()-invibes.videoAdResponseReceived))};unbindWindowScrollAndResizeEvents=function(){invibes.removeEventListener("scrollresize",renderAd)};var appendPopupToDOM=function(){var e=(invibes.currentAd.OverlayType||"").split("_"),t=e.indexOf("fixed")<0,i=e.indexOf("inbound")>=0,n=e.indexOf("maximized")>=0;return createPopup(t,i,n)},BidAdapter=function(e,t){var i=this;i.bidModel=e,i.ad=t,BidAdapter.adDisplayed=!1,i.handleAdDisplay=function(e){switch(i.bidModel.BidVersion){case 0:invibes.continueAdDisplay=function(t){if(!BidAdapter.adDisplayed){if(BidAdapter.adDisplayed=!0,null!=t)for(var n=t.ownerDocument.defaultView.frameElement;null!==n;)n.parentNode.insertBefore(t,n.nextSibling),n=n.ownerDocument.defaultView.frameElement;invibes.dispatchEvent("afterBidWin"),invibes.sendUserVideoEventId(4002,i.ad.BidPrice,i.ad),e(t)}},top.dispatchEvent(new EventClass("ivbsReadyToDisplay"));break;case 1:if(BidAdapter.adDisplayed)return;BidAdapter.adDisplayed=!0,invibes.dispatchEvent("afterBidWin"),invibes.sendUserVideoEventId(4002,i.ad.BidPrice,i.ad),e();break;default:ivLogger.logError("Bid Version "+i.bidModel.BidVersion+" is not known. Cannot display.")}}},AdChooser=function(e,t,i){var n=window.location.href.match(/testcotargeting/i),o=function(r){r=r||0;var s=e.Ads[r];if(!s)return invibes.trySetStatus({code:0}),void i();var a=s.VideoExposedId,d=function(){null!=e.BidModel?new BidAdapter(e.BidModel,s).handleAdDisplay(function(i){s.displayed=!0,ivLogger.log("Displaying: "+a),t(e,s,i)}):(s.displayed=!0,ivLogger.log("Displaying: "+a),t(e,s))},l=function(){return!!e.Ads[r+1]},c=function(){o(r+1)};if(s.CotargetingScript){if(invibes.testMode&&!n)return ivLogger.info("COT skipped (considered true): "+a+" (add &testCotargeting parameter in url to test cotargeting)"),void d();var u=function(e){try{return new Function(e)()}catch(e){}}(s.CotargetingScript);if(!u)return ivLogger.error("INVALID COT: "+a),invibes.sendUserVideoEventId(1112),void c();if(invibes.scrolledToAd&&l())return ivLogger.warn("Scrolled! No time for COT: "+a),invibes.sendUserVideoEventId(1113),void c();ivLogger.log("COT request: "+a),window.setTimeout(function(){s.displayed||s.refused||(ivLogger.warn("COT timeout "+a),s.refused="timeout",invibes.sendUserVideoEventId(1111),c())},25e3),invibes.addEventListener("scrollToAd",function e(){s.displayed||s.refused||l&&(s.refused="scroll",invibes.sendUserVideoEventId(1110),c(),ivLogger.warn("COT cancelled because of early scroll: "+a),invibes.removeEventListener("scrollToAd",e()))}),s.cotargetingStarted=(new Date).getTime(),u(function(e,t){var i=(new Date).getTime();s.elapsed=i-s.cotargetingStarted;var n={elapsed:s.elapsed,response:t,refuseReason:s.refused};if((s.elapsed<0||s.elapsed>6e5)&&(n.started=s.cotargetingStarted,n.ended=i),n=JSON.stringify(n),s.refused){var o=e?1102:1103;invibes.sendUserVideoEventId(o,n)}else ivLogger.info("COT response for "+a+": "+!!e),e?(invibes.sendUserVideoEventId(1100,n),d()):(invibes.sendUserVideoEventId(1101,n),s.refused="cot.no",c())})}else d()};this.displayAnAd=function(){e.Ads=e.Ads||[],o(0)}},monitorScrollToAd=function(){var e,t,i=function(){return e=function(){if(null==invibes.bidContainerId)return null;var e=null,t=!1;return t||(e=document.getElementById(invibes.bidContainerId)||document.getElementsByClassName(invibes.bidContainerId)[0],t=!0),e}()||e||getDivToFill()},n=invibes.isTablet?1052:1050;t=function(){var e=i();e&&isCurrentlyInView(e)&&(invibes.removeEventListener("scrollresize",t),ivLogger.info("scrolled!"),invibes.scrolledToAd=!0,invibes.dispatchEvent("scrollToAd"),invibes.scrollToAdStatSent||(invibes.scrollToAdStatSent=!0,sendUserVideoEvent(n)))},invibes.addEventListener("scrollresize",t),t()},cmpProvider=function(){var e=function(e){if(null!=e){if(e.AutoOI)return invibes.noCookies=0,invibes.setCookie("ivNoCookie",0,-1),invibes.optIn=10,void invibes.setCookie("ivOptIn",10,365);if(e.ConsentPop&&0===invibes.optIn&&!invibes.noCookies){var t=function(e){return function(){!0===e?(invibes.noCookies=0,invibes.setCookie("ivNoCookie",0,-1),invibes.optIn=1,invibes.setCookie("ivOptIn",1,365)):!1===e&&(invibes.setCookie("ivOptIn",-1,365),invibes.optIn=-1),l&&(l.style.display="none",document.body.classList.remove("ivbsCmpBlur")),n.style.display="none"}},i=function(e,i){for(var o=n.getElementsByClassName(e),r=0;r<o.length;r++)o[r].addEventListener("click",t(i))},n=document.createElement("div");n.id="ivbsCmpContainer",document.body.appendChild(n);try{setInnerHtmlWithScripts(n,e.ConsentPop)}catch(e){ivLogger.error(e)}var o,r,s,a,d,l=(o="ivbsCmpOverlay",overlayElm=n.getElementsByClassName(o),document.body.classList.add("ivbsCmpBlur"),overlayElm[0]);i("ivbsCmpAccept",!0),i("ivbsCmpReject",!1),i("ivbsCmpClose",void 0),function(e,i){for(var o=n.getElementsByClassName(e),r=n.getElementsByClassName(i),s=0;s<o.length;s++)o[s].addEventListener("click",function(){for(var e=0;e<r.length;e++)if(!0!==r[e].checked)return void t(!1)();t(!0)()})}("ivbsCmpSave","ivbsSliderCheckbox"),r="ivbsForgetButton",s="ivbsConfText",a=n.getElementsByClassName(r),(d=n.getElementsByClassName(s))[0]&&(d[0].style.display="none"),a[0]&&a[0].addEventListener("click",function(){return invibes.forgetFunction(function(){d[0]&&(d[0].style.display="")}),!1})}}};return{makeCmpRequest:function(){0===invibes.optIn&&invibes.jsonpWithParams(vsConfig.cmpUrl,{location:getDocumentLocation()},function(t){e(t)})},handleCmpResponse:e}},triedPerformLoadVideoAdAfterDocumentReady=!1,loaded=!1,hide=invibes.hide=function(){document.getElementById("divMosaic+"+invibes.videoAdContentResult.HtmlId).style.display="none"},suspendVideoAdForADay=function(){invibes.jsonp(invibes.uwebDomain+"/SuspendVideoAdForADay"),invibes.setCookie(suspendedCookieName,"1",1),sendStatwebStats(49)};invibes.hideAndSuspend=function(){hide(),suspendVideoAdForADay()},invibes.getGAParams=function(){var e=this.currentAd.GA;return void 0!==this.slideIndex&&(e+="_"+this.slideIndex),e};var startEngagement=function(){invibes.dispatchEvent("beforeEngagement",invibes.videoAdContentResult),invibes.customEngagement||invibes.outgoingClicked||invibes.popup.show(),hide()};invibes.handleAdClick=function(){clickDelay&&clickDelay.IsClickDelayed&&clickDelay.IsClickDelayed()||(ivLogger.info("click"),invibes.clicked=!0,invibes.dispatchEvent("click"),sendVideoAdClickStats(),startEngagement())};var firstSwipeEventId=invibes.isTablet?901:900,swipeEventId=invibes.isTablet?904:903,hasSwipedBefore=!1,ret,add,krpanoReference,supportedVpaidVersion,viewMode,fullscreenMode,adUnitStates,state,Cts_MaxEventsToSendPerPoll,Cts_MinVotesToShow,statsInc,sendStats;invibes.handleAdSwipe=function(){sendUserVideoEvent(hasSwipedBefore?swipeEventId:firstSwipeEventId),invibes.dispatchEvent(hasSwipedBefore?"firstSwipe":"swipe"),hasSwipedBefore=!0},(window.invibes=window.invibes||{}).InlinePlayer=function(){function e(e,t,i,n){function o(t){Boolean(e[i])===Boolean(n)&&t.stopImmediatePropagation(),delete e[i]}return e.addEventListener(t,o,!1),o}function t(e,t,i,n){function o(e){i[t]=e}n&&o(e[t]),Object.defineProperty(e,t,{get:function(){return i[t]},set:o})}var i="undefined"==typeof Symbol?function(e){return"@"+(e||"@")+Math.random()}:Symbol,n=/iPhone|iPod|iPad/i.test(navigator.userAgent),o=i(),r=i(),s=i("nativeplay"),a=i("nativepause"),d=[];function l(e,t,i){(d.tue||0)+200<Date.now()&&(e[r]=!0,d.tue=Date.now()),i||(e.currentTime=t),d[++d.i%3]=100*t|0}function c(e){return e.driver.currentTime>=e.video.duration}function u(){var e=this[o];this.webkitDisplayingFullscreen?this[s]():("data:"!==e.driver.src&&e.driver.src!==this.src&&(l(this,0,!0),e.driver.src=this.src),this.paused&&(e.paused=!1,this.buffered.length||this.load(),e.driver.play(),e.updater.start(),this.dispatchEvent(new Event("play")),this.dispatchEvent(new Event("playing"))))}function v(e){var t=this[o];t.driver.pause(),t.updater.stop(),this.webkitDisplayingFullscreen&&this[a](),t.paused&&!e||(t.paused=!0,this.dispatchEvent(new Event("pause")),this.ended&&(this[r]=!0,this.dispatchEvent(new Event("ended"))))}function p(e,t){var i=e[o]={};i.paused=!0,i.hasAudio=!0,i.video=e,i.updater=new function(e){var t=void 0,i=void 0;function n(o){t=requestAnimationFrame(n),e(o-(i||o)),i=o}this.start=function(){t||n(0)},this.stop=function(){cancelAnimationFrame(t),t=null,i=0}}(function(e){this.video.readyState>=this.video.HAVE_FUTURE_DATA?(this.hasAudio||(this.driver.currentTime=this.video.currentTime+e*this.video.playbackRate/1e3,this.video.loop&&c(this)&&(this.driver.currentTime=0)),l(this.video,this.driver.currentTime)):this.video.networkState===this.video.NETWORK_IDLE&&this.video.load(),this.video.ended&&this.video.pause(!0)}.bind(i)),i.driver=function(e){var t=new Audio;return t.crossOrigin=e.crossOrigin,t.src=e.src||e.currentSrc||"data:",t}(e),e.addEventListener("emptied",function(){var t=!i.driver.src||"data:"===i.driver.src;i.driver.src&&i.driver.src!==e.src&&(l(e,0,!0),i.driver.src=e.src,t?i.driver.play():i.updater.stop())},!1),e.addEventListener("webkitbeginfullscreen",function(){e.paused?i.driver.buffered.length||i.driver.load():(e.pause(),e[s]())}),e.addEventListener("webkitendfullscreen",function(){i.driver.currentTime=e.currentTime}),e.addEventListener("seeking",function(){d.indexOf(100*e.currentTime|0)<0&&(i.driver.currentTime=e.currentTime)})}function f(i,d,l){d=void 0===d||d,(l=void 0===l||l)&&!n||i[o]||(p(i),function(i){var n=i[o];i[s]=i.play,i[a]=i.pause,i.play=u,i.pause=v,t(i,"paused",n.driver),t(i,"muted",n.driver,!0),t(i,"playbackRate",n.driver,!0),t(i,"ended",n.driver),t(i,"loop",n.driver,!0),e(i,"seeking"),e(i,"seeked"),e(i,"timeupdate",r,!1),e(i,"ended",r,!1)}(i),i.classList.add("IIV"),!d&&i.autoplay&&i.play())}return d.i=0,f.isWhitelisted=n,function(e,t){t&&e.setAttribute("src",t);var i=null===e.getAttribute("muted");return n&&f(e,i),{videoElement:e,play:function(){return this.videoElement.play()},pause:function(){return this.videoElement.pause()},isPaused:function(){return this.videoElement.paused},isMuted:function(){return this.videoElement.muted},mute:function(){this.videoElement.muted=!0,this.videoElement.volume=0},unmute:function(){this.videoElement.muted=!1,this.videoElement.volume=1},toggleSound:function(){this.isMuted()?this.unmute():this.mute()}}}}(),(invibes.VideoQuartileReporter=function(e){(e=e||{}).tolerance=e.tolerance||3;var t=this,i=0;this.videoElement=e.videoElement,this.checkpoints=e.checkpoints||[0,25,50,75,99],e.report=e.report||function(t){invibes.sendUserVideoEventId(1300+t,e.videoElement.src)},this.handleTimerEvents=function(){var n=t.videoElement.currentTime,o=e.duration||parseInt(t.videoElement.getAttribute("data-qduration"))||t.videoElement.duration;if(!isNaN(o)){for(var r=Math.floor(100*n/o),s=-1,a=0;a<t.checkpoints.length;a++){var d=t.checkpoints[a];if(!(d<i)){if(d>=r+e.tolerance)break;s=a}}if(s>=0){var l=t.checkpoints[s];t.checkpoints.splice(s,1),e.report(l)}i=r}},this.videoElement.addEventListener("timeupdate",this.handleTimerEvents)}).prototype.destroy=function(){this.videoElement.removeEventListener("timeupdate",this.handleTimerEvents)},function(){var e=invibes.VastParser=function(e,t){this.url=e,this.config=t=t||{},t.mediaType=t.mediaType||"video/mp4",this.quartiles={},this.configErrors=[],this.vpaidConfig=vpaidConfig={},Object.keys(t).forEach(function(e){t.hasOwnProperty(e)&&(vpaidConfig[e]=t[e])}),this.vpaidConfig.mediaType="application/javascript"};e.prototype.initialize=function(e){var t=this,i=new XMLHttpRequest;i.addEventListener("load",function(i){t.__parseXmlConfig(i),e&&e()}),i.open("GET",this.url),i.send()};var t=function(e,t){var i={};["bitrate","width","height","type","apiFramework"].forEach(function(t){i[t]=e.getAttribute(t)}),i.src=e.textContent;var n=i.type===t.mediaType&&(!t.minBitrate||i.bitrate>=t.minBitrate)&&(!t.maxBitrate||i.bitrate<=t.maxBitrate);if("application/javascript"!==i.type||i.apiFramework&&"VPAID"===i.apiFramework.toUpperCase()||(n=!1),n)return i};e.prototype.__parseXmlConfig=function(e){var i=this,n=e.target.responseXML,o=n.querySelectorAll("Impression");if(o.length>0){this.impressionUrls=[];for(var r=0;r<o.length;r++)this.impressionUrls.push(o[r].textContent)}var s=n.querySelector("ClickThrough");s&&(this.clickThroughUrl=s.textContent);var a=n.querySelectorAll("Creative Linear");if(0!==a.length){a.length>1&&invibes.logger.warn("VAST url="+this.url+": More than one creative found. Will only play the first!");var d=a[0],l=d.querySelectorAll("MediaFile");if(this.mediaFile=Array.prototype.reduce.call(l,function(e,n){return e||t(n,i.config)},null),this.vpaidFile=Array.prototype.reduce.call(l,function(e,n){return e||t(n,i.vpaidConfig)},null),this.mediaFile||this.vpaidFile||this.errors.push("No suitable Media Files or VPAID files found!"),this.vpaidFile){var c=d.querySelectorAll("AdParameters");c[0]&&(this.adParams=c[0].textContent)}var u={start:0,firstQuartile:25,midpoint:50,thirdQuartile:75,complete:99},v=d.querySelectorAll("Tracking");Array.prototype.forEach.call(v,function(e){var t=e.getAttribute("event"),n=u[t];void 0!==n&&(i.quartiles[n]=i.quartiles[n]||[],i.quartiles[n].push(e.textContent))});var p=d.querySelectorAll("ClickTracking");if(p.length>0){this.clickTrackingUrls=[];for(r=0;r<p.length;r++)this.clickTrackingUrls.push(p[r].textContent)}if(this.configErrors.length){var f="Error(s) parsing VAST url: "+this.url+"\n";f+=this.configErrors.join("\n"),invibes.logger.error(f)}}else this.configErrors.push("No Linear Creatives found!")}}(),invibes.FullscreenApi=(ret=null,function(){var t,i,n,o,r=null,s=function(){null!==ret&&(ret.recentlyChanged=!0,clearTimeout(r),r=setTimeout(function(){ret.recentlyChanged=!1},100))};return null===ret&&(t=void 0!==document.documentElement.requestFullscreen?"requestFullscreen":void 0!==document.documentElement.mozRequestFullScreen?"mozRequestFullScreen":void 0!==document.documentElement.webkitRequestFullscreen?"webkitRequestFullscreen":void 0!==document.documentElement.webkitRequestFullScreen?"webkitRequestFullScreen":void 0!==document.documentElement.msRequestFullscreen?"msRequestFullscreen":void 0,i=void 0!==document.exitFullscreen?"exitFullscreen":void 0!==document.mozCancelFullScreen?"mozCancelFullScreen":void 0!==document.webkitExitFullscreen?"webkitExitFullscreen":void 0!==document.webkitExitFullScreen?"webkitExitFullScreen":void 0!==document.msExitFullscreen?"msExitFullscreen":void 0,n=void 0!==document.onfullscreenchange?"fullscreenchange":void 0!==document.onmozfullscreenchange?"mozfullscreenchange":void 0!==document.onwebkitfullscreenchange?"webkitfullscreenchange":void 0!==document.onmsfullscreenchange?"MSFullscreenChange":void 0,void 0!==t&&void 0!==i&&void 0!==n?(enableEventFunctionality(o={requestFullscreen:function(i){s(),i[t](),n||o.dispatchEvent("fullscreenchange",e)},exitFullscreen:function(){s(),document[i](),n||o.dispatchEvent("fullscreenchange",e)},isFullscreen:function(){return null!=document.fullscreenElement||null!=document.webkitFullscreenElement||null!=document.webkitFullScreenElement||null!=document.mozFullScreenElement||null!=document.msFullscreenElement},onfullscreenchange:void 0}),document.addEventListener(n,function(e){o.dispatchEvent("fullscreenchange",e),o.onfullscreenchange&&o.onfullscreenchange(e)}),ret=o):ret=function(){var t,i=null,n=function(e){e.preventDefault()},o=function(e){e?document.addEventListener("touchmove",n,{passive:!1}):document.removeEventListener("touchmove",n,{passive:!1})},r={requestFullscreen:function(n){s(),i=n,t=function(){var e=document.createElement("div");e.style.display="none",e.classList.add("ivbsFullscreenPlaceholder");var t=function(){var n=i.getBoundingClientRect();n.height<1?window.setTimeout(t,50):(e.style.width=n.width+"px",e.style.height=n.height+"px",e.style.left=n.left,e.style.right=n.right,e.style.position=i.style.position?i.style.position:"relative",e.style.zIndex=i.style.zIndex)};return t(),i.parentElement.insertBefore(e,i),{hide:function(){e.style.display="none"},show:function(){e.style.display="block"},el:e}}(),function(){i.parentElement.removeChild(i);var e=document.createElement("div");e.style.zIndex="2147483647",e.style.position="fixed",e.style.width="100%",e.style.height="100%",e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.appendChild(i),document.body.appendChild(e),document.body.classList.add("ivbsNoScroll"),o(!0)}(),i.style.height="100%",i.style.width="auto",i.style.left="0",i.style.right="0",r.dispatchEvent("fullscreenchange",null),r.onfullscreenchange&&r.onfullscreenchange(e)},exitFullscreen:function(){var n;s(),(n=i.parentElement).removeChild(i),t.el.parentElement.insertBefore(i,t.el),document.body.removeChild(n),document.body.classList.remove("ivbsNoScroll"),o(!1),i.style.height=t.el.height,i.style.width=t.el.width,i.style.left=t.el.left,i.style.right=t.el.right,i.style.position=t.el.position,i.style.zIndex=t.el.zIndex,i=null,t=null,r.dispatchEvent("fullscreenchange",null),r.onfullscreenchange&&r.onfullscreenchange(e)},isFullscreen:function(){return null!==i},onfullscreenchange:void 0};return enableEventFunctionality(r),r}()),ret}),invibes.Fullscreen=function(e,t){var i=t.toggle instanceof Element?t.toggle:document.getElementById(t.toggle),n=t.target instanceof Element?t.target:document.getElementById(t.target),o=t.fullscreenClass||"ivbsFullscreen",r=t.normalscreenClass||"ivbsNormalscreen",s=invibes.FullscreenApi(),a=!1,d=function(){i.classList.add(r),i.classList.remove(o),n.classList.add(r),n.classList.remove(o)},l=function(){s.isFullscreen()?(i.classList.add(o),i.classList.remove(r),n.classList.add(o),n.classList.remove(r)):d(),"function"==typeof e.getPlayer.resize&&e.getPlayer.resize(isFullscreen)},c=function(t){t.stopPropagation(),t.preventDefault(),e.getPlayer&&(s.isFullscreen()?s.exitFullscreen():s.requestFullscreen(n),a?invibes.sendUserVideoEventId(971):(invibes.sendUserVideoEventId(970),a=!0))};return{init:function(){null!=s?(d(),i.addEventListener("click",c),s.addEventListener("fullscreenchange",l)):ivLogger.warn("Fullscreen not supported. Check bv templace config.")}}},invibes.Draggable=function(e,t){var i,n,o=t.target instanceof Element?t.target:document.getElementById(t.target),r=t.outOfViewTransition||"ivbsOutOfViewTransition",s=0,a=0,d=!1,l=function(){var e=o.getBoundingClientRect(),t=o.parentElement.getBoundingClientRect();return{left:e.left-t.left,right:e.right-t.right}},c=function(){var e=l();e.left>0?(o.classList.add(r),o.style.left=parseInt(o.style.left)-e.left+"px"):e.right<0&&(o.classList.add(r),o.style.left=parseInt(o.style.left)-e.right+"px")},u=function(e){e.preventDefault(),v(e)},v=function(e){i=0,null!=e.clientX?a=e.clientX:e.touches&&e.touches.length>0&&(a=e.touches[0].clientX),o.classList.remove(r),document.addEventListener("mouseup",g),document.addEventListener("touchend",g),document.addEventListener("mousemove",p),document.addEventListener("touchmove",p)},p=function(e){var t;null!=e.clientX?t=e.clientX:e.changedTouches&&e.changedTouches.length>0&&(t=e.changedTouches[0].clientX),i+=Math.abs(a-t),s=a-t,a=t;var n=l();n.left>screen.width/5&&s<0||n.right<0&&Math.abs(n.right)>screen.width/5&&s>0||(o.style.left=o.offsetLeft-s+"px")},f=function(e){i>5&&(e.stopPropagation(),e.preventDefault())},g=function(){c(),d?invibes.sendUserVideoEventId(973):(invibes.sendUserVideoEventId(972),d=!0),document.removeEventListener("mouseup",g),document.removeEventListener("touchend",g),document.removeEventListener("mousemove",p),document.removeEventListener("touchmove",p)};return{init:function(){invibes.FullscreenApi().addEventListener("fullscreenchange",c);var e=document.getElementById(o.id+"header");(n=e||o).addEventListener("mousedown",u),n.addEventListener("touchstart",v),n.addEventListener("click",f)}}},invibes.Play=invibes.FullPlay=function(e){var t=this,i=e.video,n=i,o=invibes.currentAd.VideoCompletionTime,r=invibes.currentAd.PlayVAfterC,s=null;e.topMargin=e.topMargin||0,e.bottomMargin=e.bottomMargin||0,e.visiPercent=invibes.currentAd.MinVideoVisiPercentToPlay||0;var a=i.parentElement,d=!0,l=!1;i.volume=0;var c=[],u=function(e,t,i){e.addEventListener(t,i),c.push(function(){e.removeEventListener(t,i)})},v=function(){t.createVastQuartileReporter&&t.createVastQuartileReporter()};t.startRecordingQuartiles=function(){t.quartileReporter=new invibes.VideoQuartileReporter({videoElement:n,report:function(t){var i=e.id||n.getAttribute("data-ivVidId")||n.getAttribute("src");ivLogger.log(["QUARTILE",i,t]),invibes.sendUserVideoEventId(1300+t,"bv_"+i)}}),v(),t.quartilesStarted=!0};var p,f=function(e){e&&(new Image(1,1).src=e)};if(e.toggleMuteBtn){enableEventFunctionality(this);var g,m=e.toggleMuteBtn;this.unmute=function(){invibes.videoZoomed=!0,invibes.sendUserVideoEventId(g?3501:3500),g=!0,p.unmute(),m.classList.remove("ivbsToggleMute"),m.classList.add("ivbsToggleUnmute"),a.classList.add("ivFlashyMaxi"),"function"==typeof p.resize&&p.resize(),this.dispatchEvent("unmute")},this.mute=function(){delete invibes.videoZoomed,p.mute(),m.classList.add("ivbsToggleMute"),m.classList.remove("ivbsToggleUnmute"),a.classList.remove("ivFlashyMaxi"),"function"==typeof p.resize&&p.resize(),this.dispatchEvent("mute")},m.classList.add("ivbsToggleMute"),u(m,"click",function(e){e.stopPropagation(),e.preventDefault(),p&&(invibes.videoZoomed?t.mute():t.unmute())}),invibes.visibilityAPI&&u(document,invibes.visibilityAPI.eventName,function(){invibes.visibilityAPI.isVisible()||t.mute()})}var b={get getPlayer(){return p}};e.fullscreen&&new invibes.Fullscreen(b,e.fullscreen).init(),e.draggable&&new invibes.Draggable(b,e.draggable).init();var h=e.vastUrl||e.vpaidUrl,y=!1,w=function(i){u(i,"timeupdate",function(){if(d&&(d=!1,ivLogger.debug("IPlay heated"),t.scrollResizeHandler()),i.currentTime>o&&!y&&(y=!0,invibes.sendUserVideoEventId(1e3),r&&(e.forever=!0,E())),s){var n=Object.keys(s)[0];if(n){var a=parseInt(n);i.currentTime>=a&&(s[n](),invibes.sendUserVideoEventId(1400,a),delete s[n])}}})};if(h){var C=this.vast=new invibes.VastParser(h);t.pending=!0,C.initialize(function(){if(t.pending=!1,e.vpaidUrl){i.volume=0,i.muted=!0,i.setAttribute("playsinline",""),d=!1;var o={video:i,fileSettings:C.vpaidFile,params:C.adParams,eventHandler:invibes.sendUserVideoEventId,vpaidHasRedirect:void 0!==e.vpaidHasRedirect&&e.vpaidHasRedirect,noLoop:e.noLoop,indexVideoOnFinish:e.indexVideoOnFinish};e.vpaidConfig&&"object"==typeof e.vpaidConfig&&Object.keys(e.vpaidConfig).forEach(function(t){e.vpaidConfig.hasOwnProperty(t)&&(o[t]=e.vpaidConfig[t])}),p=invibes.VPAIDPlayer(o),n=p.timedVideo,w(n),n.addEventListener("play",function e(){t.scrollResizeHandler(),n.removeEventListener("play",e)})}else i.setAttribute("src",C.mediaFile.src),p=new invibes.InlinePlayer(i),e.noLoop||u(i,"ended",function(){i.currentTime=0,i.play()}),w(i);if(C.clickThroughUrl){if(e.vastRedirectLinkId){var r=document.getElementById(e.vastRedirectLinkId);r&&"A"===r.nodeName&&initializeOutgoingLink(r,C.clickThroughUrl)}if(e.vastRedirectLinkClass){var s=document.getElementsByClassName(e.vastRedirectLinkClass);if(null!=s&&s.length>0)for(var a=0;a<s.length;a++)s[a]&&"A"===s[a].nodeName&&initializeOutgoingLink(s[a],C.clickThroughUrl)}}invibes.addClickTrackers(C.clickTrackingUrls);var l=C.quartiles,c=Object.getOwnPropertyNames(l);t.createVastQuartileReporter=function(){t.vastQuartileReporter=new invibes.VideoQuartileReporter({videoElement:n,report:function(e){var t=l[e];if(t)for(var i=0;i<t.length;i++)f(t[i])},checkpoints:c})},t.quartilesStarted&&(t.sendVastImpressionIfNecessary(),v()),k(),t.scrollResizeHandler()})}else p=new invibes.InlinePlayer(i),e.noLoop||u(i,"ended",function(){i.currentTime=0,i.play()}),w(i);this.sendVastImpressionIfNecessary=function(){if(this.vast&&this.vast.impressionUrls&&!this.vast.impressionSent){for(var e=0;e<this.vast.impressionUrls.length;e++)f(this.vast.impressionUrls[e]);this.vast.impressionSent=!0}};var k=function(){var n=function(){var e=p.play();e&&e.then(function(){t.scrollResizeHandler()}).catch(function(e){ivLogger.error(e)})},o=e.vpaidUrl||i.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA;/iPhone|iPod|iPad/i.test(navigator.userAgent)&&(o=!0),o?n():i.addEventListener("loadeddata",function e(){o=!0,t.scrollResizeHandler(),i.removeEventListener("loadeddata",e),n()})};t.pending||k();var E=function(){null!=p&&(t.quartilesStarted||t.startRecordingQuartiles(),t.sendVastImpressionIfNecessary(),p.isPaused()&&(ivLogger.debug("IPlay started"),p.play()))},A=function(){if(!t.pending&&!d){var n=function(){var t=(e.inViewTarget||i).getBoundingClientRect();if(t.height<1||t.width<1)return!1;if(i.forcedVisibilityPercent>=e.visiPercent)return!0;var n=Math.ceil((100-e.visiPercent)*t.height/100),o=invibes.headerHeight+e.topMargin-n,r=window.innerHeight-invibes.footerHeight-e.bottomMargin+n;return t.top>=o&&t.bottom<=r}();if(n&&(l=!0,E()),!p.isPaused()&&!n){if((e.forever||e.playOnView)&&l)return;p.isPaused()||(ivLogger.debug("IPlay paused"),p.pause())}}};if(this.scrollResizeHandler=function(){setTimeout(function(){A()},150),A()},invibes.addEventListener("scrollresize",this.scrollResizeHandler),window.addEventListener("touchend",this.scrollResizeHandler),this.scrollResizeHandler(),e.playOnView){var S=function(){l=!0,E()};invibes.viewed?S():invibes.addEventListener("view",S)}var I=function(){t.quartileReporter&&t.quartileReporter.destroy(),t.vastQuartileReporter&&t.vastQuartileReporter.destroy(),p.isPaused()||p.pause(),s=null,c.forEach(function(e){e()}),invibes.playinstance=null};this.destroy=I,invibes.addEventListener("beforeEngagement",I),t.addVideoTracking=function(e){null==s&&(s={}),s[e.time]=e.tracking},invibes.dispatchEvent("ivplayinit",t),invibes.playinstance=t},invibes.addVideoTracking=(add=function(e,t){if(t&&t.length)for(var i=0;i<t.length;i++)e.addVideoTracking(t[i])},function(e){invibes.playinstance?add(invibes.playinstance,e):invibes.addEventListener("ivplayinit",function(){console.log("ivplayinit eventlistener exists"),add(this,e)})}),invibes.PlayC=function(e){this.options=e;var t,i=e.buttonContainer.querySelectorAll("[data-ivvid-src]");i=Array.prototype.slice.call(i);var n=function(i,n){var o=i.getAttribute("data-ivvid-src"),r=i.getAttribute("data-ivvid-type"),s=i.getAttribute("data-ivvid-id");t&&t.destroy();var a,d,l=(a=e.playOptions,d={},Object.keys(a).filter(function(e){return a.hasOwnProperty(e)}).forEach(function(e){d[e]=a[e]}),d);l.video=e.videoEl,l.id=s,"vast"===r?l.vastUrl=o:e.videoEl.src=o,t=new invibes.Play(l),n&&"vast"!==r&&t.unmute()};this.start=function(){i.forEach(function(t){t.addEventListener("click",function(i){i.preventDefault(),i.stopPropagation(),n(t,e.unmuteOnClick)})}),n(i[0])}},invibes.Visi=function(e){(e=e||{}).target=e.target||{},e.target.percentage=e.target.percentage||50,e.forcePercentage=e.forcePercentage||e.target.percentage,e.target.duration=e.target.duration||1e3,e.safetyMargin=e.safetyMargin||0;var t,i=0,n=!1,o=0,r=(new Date).getTime(),s=invibes.adDiv,a=e.target.element||s;s.style.transition="transform 0.01s ease-in-out";var d=function(){if(t=null,!e.target.met){var s=2===i||invibes.getClientVerticalVisibilityPercent(a)>=e.target.percentage,l=(new Date).getTime(),c=n&&s;if(c?o+=l-r:e.target.continuous&&(o=0),e.debug&&ivLogger.info({name:"Visi info",now:l,rollingDuration:o,wasVisible:n,isCurrentlyVisible:s}),c&&o>=e.target.duration)return ivLogger.info("Visibility target reached!"),e.target.met=!0,void g();s&&(t=setTimeout(d,e.target.duration)),n=s,r=l}},l=document.createElement("div");s.parentElement.insertBefore(l,s),l.style.display="none";var c=function(){var e=s.getBoundingClientRect();e.height<1?window.setTimeout(c,30):(l.style.width=e.width+"px",l.style.height=e.height+"px")};c();var u,v={},p=function(){if(!e.target.met&&(isScrolledIntoView(l,!0)&&(g(),invibes.addEventListener("scrollresize",p),i=0),t||(t=setTimeout(d,100)),0===i)){var n=invibes.headerHeight,o=window.innerHeight-invibes.footerHeight,r=a.getBoundingClientRect(),c=r.height*e.forcePercentage/100+1,v=r.height-c,m=r.top+v,b=r.bottom-v,h=n-m>0,y=o-b<0;self.topWasVisible=self.topWasVisible||m>=n&&m<=o,self.bottomWasVisible=self.bottomWasVisible||b>=n&&b<=o,h&&self.topWasVisible?(u=!0,f()):y&&self.bottomWasVisible?(u=!1,f()):(i=0,s.style.transform="translateY(0px)")}},f=function(){i=2,l.style.display="block",s.classList.remove("ivVisiInTransition"),s.classList.add("ivVisiActive");var t,n=a.getBoundingClientRect(),o=n.height*(e.forcePercentage/100)+1,r=n.height-o,d=s.getBoundingClientRect(),c=n.top-d.top,p=d.bottom-n.bottom,f=c+r-invibes.headerHeight,g=p+r-invibes.footerHeight;v.transition=s.style.transition,v.position=s.style.position,v.width=s.style.width,v.height=s.style.height,v.left=s.style.left,v.top=s.style.top,v.bottom=s.style.bottom,s.style.transition="none",s.style.transform="translateY(0)",s.style.position="fixed",s.style.setProperty("width",d.width+"px","important"),s.style.height=d.height+"px",s.style.left=d.left+"px",u?(t=o+p,s.style.top=-f+"px"):(t=o+c,s.style.bottom=-g+"px"),s.forcedVisibilityPercent=100*t/d.height,s.forcedVisibilityPixels=t,a.forcedVisibilityPercent=e.forcePercentage,a.forcedVisibilityPixels=o,invibes.dispatchEvent("scrollresize")};s.addEventListener("transitionend",function(){e.target.met&&g()});var g=function(){if(2===i){delete s.forcedVisibilityPercent,delete s.forcedVisibilityPixels,delete a.forcedVisibilityPercent,delete a.forcedVisibilityPixels,i=3,s.classList.remove("ivVisiActive"),s.classList.add("ivVisiInTransition");var e=l.getBoundingClientRect().top,t=s.getBoundingClientRect().top-e;s.style.transition=v.transition,s.style.position=v.position,s.style.width=v.width,s.style.height=v.height,s.style.left=v.left,s.style.top=v.top,s.style.bottom=v.bottom,l.style.display="none",s.style.transition="none",s.style.transform="translateY("+t+"px)",window.setTimeout(function(){s.style.transition="transform 0.5s ease-in-out",s.style.transform="translateY(0px)",invibes.removeEventListener("scrollresize",p),s.addEventListener("transitionend",function e(t){i=0,s.classList.remove("ivVisiInTransition"),t.currentTarget.removeEventListener(t.type,e)})},30)}};return{start:function(){navigator.userAgent.match(/CriOS/i)?ivLogger.warn("Disabling Visi (Chrome on iOS)"):(invibes.addEventListener("scrollresize",p),d())}}},invibes.PanoramicPlay=function(e){var t,i=!0;null!=e.isAutoPlay&&(i=e.isAutoPlay);var n=invibes.currentAd.VideoCompletionTime,o=document.getElementById(e.video),r=new invibes.PanoramicPlayer(e,function(s){var a=this;s.volume=0,/iPhone|iPod|iPad/i.test(navigator.userAgent)||(t=new invibes.VideoQuartileReporter({videoElement:s,report:function(t){var i=e.id||s.getAttribute("data-ivVidId")||s.getAttribute("src");i="bv_"+i,invibes.sendUserVideoEventId(1300+t,i)}}));if(i){e.marginPercentage=e.marginPercentage||20;var d=s.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA;/iPhone|iPod|iPad/i.test(navigator.userAgent)&&(d=!0),d||s.addEventListener("loadeddata",function e(){d=!0,a.scrollResizeHandler(),s.removeEventListener("loadeddata",e)});this.scrollResizeHandler=function(){if(!a.pending){var t,i,n,s,d,l,c=(t=window.innerHeight-invibes.headerHeight-invibes.footerHeight,i=t*e.marginPercentage/100,n=i,s=t-i,d=o.getBoundingClientRect(),l=(d.top+d.bottom)/2,n<=l&&s>=l);r.isPaused()&&c&&r.play(),r.isPaused()||c||r.pause()}},invibes.addEventListener("scrollresize",this.scrollResizeHandler),window.addEventListener("touchend",this.scrollResizeHandler),this.scrollResizeHandler()}else r.addEventListener("panoclick",function(){invibes.sendUserVideoEventId(943),r.isPaused()?r.play():r.pause()});var l=!1;s.addEventListener("timeupdate",function(){s.currentTime>n&&!l&&(l=!0,invibes.sendUserVideoEventId(1e3))}),invibes.addEventListener("beforeEngagement",function(){t&&t.destroy(),r.isPaused()||r.pause()})});r.addEventListener("panodrag",function(){a(),invibes.sendUserVideoEventId(941)}),r.addEventListener("panozoom",function(){invibes.sendUserVideoEventId(942)});var s=!1,a=function(){s||(invibes.sendUserVideoEventId(940),s=!0)};return{player:r}},invibes.PanoramicPlayer=function(e,t){e.krpanojs=e.krpanojs||vsConfig.krpanojs,e.gyrojs=e.gyrojs||vsConfig.gyrojs,e.videoplayerjs=e.videoplayerjs||vsConfig.videoplayerjs,e.followmousejs=e.followmousejs||vsConfig.followmousejs,e.viewH=e.viewH||0,e.viewV=e.viewV||0,e.zoom=e.zoom||130;var i,n,o=function(){var i,n,o='loadxml(\'<krpano> <action name="startup" autorun="onstart"> if(device.panovideosupport == true, loadscene(videopano);); </action> <scene name="videopano"> <control mouse="drag" touch="drag" zoomtocursor="false" zoomoutcursor="false" draginertia="0.1" dragfriction="0.9" movetoaccelerate="1.0" movetospeed="10.0" movetofriction="0.8" keybaccelerate="0.09" keybfriction="0.94" keybfovchange="0.25" mousefovchange="1.0" fovspeed="3.0" fovfriction="0.9" bouncinglimits="true" /> <cursors standard="default" dragging="move" moving="move" /> <krpano stagescale="calc:stagescale * 2" if="stagescale LT 1.0" devices="mobile" /><plugin name="followmouse" url="'+e.followmousejs+'" enabled="false" devices="desktop" videoelement="'+e.video+'" /> <plugin name="gyro" keep="true" url="'+e.gyrojs+'" devices="html5.and.touch" enabled="true" />',r='<view hlookat="'+e.viewH+'" vlookat="'+e.viewV+'" fovtype="DFOV" fov="'+e.zoom+'" fovmin="75" fovmax="150" distortion="0.0" />  </scene> </krpano>\')',s='<image> <sphere url="'+e.posterUrl+'" /> </image>',a='<plugin name="video" url.html5="'+e.videoplayerjs+'" pausedonstart="true" loop="true" volume="0" /> <image> <sphere url="plugin:video" /> </image>';(krpanoReference=document.getElementById("krpanoSWFObject")).style.display="none",e.audioUrl||e.videoUrl||e.webmUrl||!e.posterUrl?(i=o+a+r,n=function(){krpanoReference.set("events.onxmlcomplete",null);var i=krpanoReference.get("plugin[video]");i.onloaded=function(){var t=function(){var t="";return/iPhone|iPod|iPad/i.test(navigator.userAgent)?t=e.audioUrl:(e.videoUrl&&(t+=e.videoUrl),e.webmUrl&&(t.length>0&&(t+="|"),t+=e.webmUrl),t.length>0&&e.audioUrl&&(t+="|"+e.audioUrl)),t}();i.playvideo(t,e.posterUrl,!0,0)},i.onvideoready=function(){t(i.videoDOM),krpanoReference.style.display="block"},i.onvideoplay=function(){null!=e.playHandler&&e.playHandler()},i.onvideopaused=function(){null!=e.pausedHandler&&e.pausedHandler()}}):(i=o+s+r,n=function(){krpanoReference.set("events.onxmlcomplete",null),krpanoReference.style.display="block"}),krpanoReference.set("events.onxmlcomplete",n),krpanoReference.call(i)},r={play:function(){krpanoReference&&krpanoReference.call("plugin[video].play()")},pause:function(){krpanoReference&&krpanoReference.call("plugin[video].pause()")},isPaused:function(){var e=null;return krpanoReference&&(e=krpanoReference.get("plugin[video]").ispaused),e},setViewPos:function(e,t,i){krpanoReference&&(krpanoReference.call("lookat("+e+", "+t+")"),krpanoReference.call("zoomto("+i+")"))},getViewPos:function(){return krpanoReference?{viewH:krpanoReference.get("view.hlookat"),viewV:krpanoReference.get("view.vlookat"),zoom:krpanoReference.get("view.fov")}:null}};return enableEventFunctionality(r),function(e,t){var i,n=[],o=[],r=!1,s=function(e){null!=e.pageX?o=[e.pageX,e.pageY]:e.touches&&e.touches.length>0&&(o=[e.touches[0].pageX,e.touches[0].pageY]),e.touches&&e.touches.length>1&&(r=!0),t.removeEventListener("mousemove",s),t.removeEventListener("touchmove",s)},a=function(i){null!=i.pageX?o=[i.pageX,i.pageY]:i.changedTouches&&i.changedTouches.length>0&&(o=[i.changedTouches[0].pageX,i.changedTouches[0].pageY]),0===o.length||n[0]===o[0]&&n[1]===o[1]?1==i.which&&e.dispatchEvent("panoclick"):r?e.dispatchEvent("panozoom"):e.dispatchEvent("panodrag"),t.removeEventListener("mouseup",a),t.removeEventListener("touchend",a)},d=function(e){n=[],o=[],r=!1,null!=e.pageX?n=[e.pageX,e.pageY]:e.touches&&e.touches.length>0&&(n=[e.touches[0].pageX,e.touches[0].pageY]),t.addEventListener("mousemove",s,!1),t.addEventListener("touchmove",s,!1),t.addEventListener("mouseup",a,!1),t.addEventListener("touchend",a,!1)};t.addEventListener("mousedown",d,!1),t.addEventListener("touchstart",d,!1);var l=function(){i&&clearTimeout(i),i=setTimeout(function(){e.dispatchEvent("panozoom")},500)};t.addEventListener("mousewheel",l,!1),t.addEventListener("DOMMouseScroll",l,!1)}(r,(i=document.getElementById(e.video),(n=document.createElement("script")).src=e.krpanojs,n.onload=function(){embedpano({xml:null,target:e.video,html5:"only",mobilescale:1,passQueryParameters:!0,onready:o})},i.parentNode.insertBefore(n,i),i)),r},invibes.Reveal=function(e){var t="string"==typeof e.container?document.getElementById(e.container):e.container,i=!1,n=!1;l();var o=function(){n||(n=!0,window.requestAnimationFrame?requestAnimationFrame(function(){l()}):setTimeout(function(){l()},100))};window.addEventListener("scroll",o),window.addEventListener("resize",o);var r=t.querySelector(".cd-handle"),s=t.querySelector(".cd-resize-img"),a=t.querySelector('.cd-image-label[data-type="original"]'),d=t.querySelector('.cd-image-label[data-type="modified"]');function l(){t.getBoundingClientRect().top>0&&t.classList.add("is-visible"),n=!1}function c(e,t,n,o,r,s,a,d,l,c,u){var v=(e.pageX||e.touches[0].pageX)+n-o;v<r?v=r:v>s&&(v=s);var g=100*(v+o/2-a)/d;p();var m=g+"%";if(t&&t.classList.contains("draggable")){t.style.left=m;var b=function(){t.classList.remove("draggable"),l.classList.remove("resizable")};t.addEventListener("mouseup",b),t.addEventListener("touchend",b)}l&&l.classList.contains("resizable")&&(l.style.width=m),f(u,l,"left"),f(c,l,"right"),i=!1}!function(e,t,n,o,r){var s,a=function(){e.classList.remove("draggable"),t.classList.remove("resizable"),n.removeEventListener("mousemove",s),n.removeEventListener("touchmove",s)},d=function(d){e.classList.add("draggable"),t.classList.add("resizable");var l=e.getBoundingClientRect(),u=n.getBoundingClientRect(),v=d.pageX||d.touches[0].pageX,p=l.width,f=l.left+p-v,g=u.left,m=u.width,b=g-22,h=g+m-p+22;s=function(n){i||(i=!0,invibes.dispatchEvent("ivSliderDrag",this),window.requestAnimationFrame?requestAnimationFrame(function(){c(n,e,f,p,b,h,g,m,t,o,r)}):setTimeout(function(){c(n,e,f,p,b,h,g,m,t,o,r)},100))},n.addEventListener("mousemove",s),n.addEventListener("touchmove",s),n.addEventListener("mouseup",a),n.addEventListener("touchend",a),d.preventDefault()};e.addEventListener("mousedown",d),e.addEventListener("touchstart",d),e.addEventListener("mouseover",d),e.addEventListener("mouseup",a),e.addEventListener("touchend",a)}(r,s,t,a,d);var u,v=function(){invibes.dispatchEvent("ivSliderDragGesture",this)},p=function(){u&&window.clearTimeout(u),u=window.setTimeout(v,400)};function f(e,t,i){var n=e.getBoundingClientRect(),o=t.getBoundingClientRect();("left"===i?n.right>=o.right:n.left<=o.right)?e.classList.add("is-hidden"):e.classList.remove("is-hidden")}},invibes.SwipeNSurf=function(e){var t=function(e){var t=invibes.createOutgoingLink(e);invibes.sendClickStats(noop,"swipe");var i=invibes.clickSentPromise,n=new Promise(function(e){window.setTimeout(e,1e3)});Promise.race([i,n]).then(function(){window.location.assign(t)})};e.outgoingSlides&&e.swiper.on("slideChangeEnd",function(){invibes.handleAdSwipe();var i=e.outgoingSlides[e.swiper.realIndex];i&&(invibes.doNotHideAdOnClick=1,t(i),invibes.hide())}),e.lastSlideRedirect&&e.swiper.on("reachEnd",function(){e.swiper.on("touchMove",function(i){i.isEnd&&"next"==i.swipeDirection&&(invibes.doNotHideAdOnClick=1,t(e.lastSlideRedirect),invibes.hide())})})},invibes.videoCompletion=function(e){var t="string"==typeof e.el?document.getElementById(e.el):e.el;return new Promise(function(i){var n=function(){isNaN(t.duration)||(t.currentTime>=e.time||100*t.currentTime/t.duration>=e.percent)&&(ivLogger.log("Video target completed."),i(),t.removeEventListener("timeupdate",n))};t.addEventListener("timeupdate",n),t.addEventListener("videotargetchanged",function e(i){t.removeEventListener("timeupdate",n),t.removeEventListener("videotargetchanged",e),(t=i.newVideoTarget).addEventListener("timeupdate",n)})})},invibes.Sticky=function(e){var t=this,i=e.el;e.bottomMargin=e.bottomMargin||0,e.topMargin=e.topMargin||0;var n,o,r,s,a,d=invibes.FullscreenApi(),l=function(){var e=document.createElement("div");e.style.display="none",e.classList.add("ivStickyPlaceholder");var t=function(){var n=i.getBoundingClientRect();n.height<1?window.setTimeout(t,50):(e.style.width=n.width+"px",e.style.height=n.height+"px")};return t(),i.parentElement.insertBefore(e,i),{hide:function(){e.style.display="none"},show:function(){e.style.display="block"},el:e}}(),c=new Promise(function(i){e.closeBtn&&e.closeBtn.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.dispatchEvent("clickClose"),i()})}),u=new Promise(function(e){t.close=e}),v=new Promise(function(){}),p=new Promise(function(e){invibes.addEventListener("beforeEngagement",e)}),f=Promise.race([e.endStickyPromise||v,c,p,u]),g=0,m={},b=i.querySelector("#ivbsVid"),h=function(){i.style.width=m.width,i.style.height=m.height,i.style.top=m.topheight,i.style.bottom=m.bottom,i.style.left=m.left,i.classList.remove("ivStuckTop"),i.classList.remove("ivStuckBottom"),e.noParentDetach||(i.parentElement.removeChild(i),l.el.parentElement.insertBefore(i,l.el)),b&&(delete b.forcedVisibilityPercent,delete b.forcedVisibilityPixels),delete i.forcedVisibilityPercent,delete i.forcedVisibilityPixels,o=r=!1},y=function(){i.classList.remove("ivStuckTop"),i.classList.remove("ivStuckBottom"),o=r=!1,m.width=i.style.width,m.height=i.style.height,m.top=i.style.top,m.bottom=i.style.bottom,m.left=i.style.left;var t=i.getBoundingClientRect();if(i.style.width=t.width+"px",i.style.height=t.height+"px",i.style.left=t.left+"px",b){var n=b.getBoundingClientRect();b.forcedVisibilityPercent=100,b.forcedVisibilityPixels=n.height}i.forcedVisibilityPercent=100,i.forcedVisibilityPixels=t.height,e.noParentDetach||(i.parentElement.removeChild(i),document.body.appendChild(i)),l.show()},w=function(){if(!(invibes.adDiv.getBoundingClientRect().height<1||d.isFullscreen())){var a=(o||r?l.el:i).getBoundingClientRect(),c=a.top<=(e.topMargin||0)+invibes.headerHeight,u=a.top+a.height>=window.innerHeight-(e.bottomMargin||0)-invibes.footerHeight;n||c||u||(n=!0),(!c&&o||!u&&r)&&(l.hide(),h(),t.dispatchEvent("unstuck")),!n||!c||o||invibes.Sticky.noTop||invibes.videoZoomed&&e.noStickyOnZoom||(y(),i.style.top=e.topMargin+invibes.headerHeight+"px",i.classList.add("ivStuckTop"),o=!0,t.dispatchEvent("stuck",t,["top"])),!n||!u||r||invibes.Sticky.noBottom||invibes.videoZoomed&&e.noStickyOnZoom||(y(),i.style.bottom=e.bottomMargin+invibes.footerHeight+"px",i.style.top="",i.classList.add("ivStuckBottom"),r=!0,t.dispatchEvent("stuck",t,["bottom"])),!o&&!r||s||(s=!0,window.setTimeout(function(){i.classList.add("ivCanClose")},e.closeDelay))}};f.then(function(){invibes.removeEventListener("scrollresize",w),t.dispatchEvent("complete"),function(){if(o||r){t.dispatchEvent("unstuck"),l.hide();var e=i.getBoundingClientRect();h();var n=i.getBoundingClientRect(),s=e.left-n.left,a=e.top-n.top;i.style.transform="translateX("+s+"px)translateY("+a+"px)",window.setTimeout(function(){i.classList.add("ivAnimTrans"),window.setTimeout(function(){i.style.transform="",i.addEventListener("transitionend",function e(){invibes.dispatchEvent("scrollresize"),i.classList.remove("ivAnimTrans"),i.removeEventListener("transitionend",e)})},10)},10)}}()});this.start=function(){var i,n,o,r,s;invibes.currentAd.Sticky?(ivLogger.info("Sticky!"),invibes.addEventListener("scrollresize",w),w(),n=invibes.videoAdContentResult.StickyCFIDelay||e.cfiDuration||4e3,o=function(){t.removeEventListener("stuck",r),t.removeEventListener("unstuck",s),invibes.removeEventListener("click",s),invibes.jsonpWithParams(vsConfig.kwebstatUrl+"/bvr/cfi",{token:invibes.currentAd.Token,isBid:null!=invibes.bidResponse}),t.dispatchEvent("cfi")},r=function(){if(!invibes.clicked){a=(new Date).getTime();var t=n-(e.cfiContinuous?0:g);i=window.setTimeout(o,t)}},s=function(){var e=(new Date).getTime();g+=e-a,i&&window.clearTimeout(i)},t.addEventListener("stuck",r),t.addEventListener("unstuck",s),invibes.addEventListener("click",s)):ivLogger.warn("No Sticky")},enableEventFunctionality(this)},invibes.VPAIDPlayer=(supportedVpaidVersion="2.0.0",viewMode="normal",fullscreenMode="fullscreen",adUnitStates={INIT:1,LOADED:2,PLAYING:3,PAUSED:4,STOPPED:5,FAILED:6},function(e,t){var i,n=e.fileSettings,o=e.params,r=e.video,s=e.eventHandler,a=e.vpaidHasRedirect,d=!e.noLoop,l=e.indexVideoOnFinish,c=null;if(!n)throw"Invalid VPAID file";s=s||invibes.sendUserVideoEventId;var u,v,p=adUnitStates.INIT,f=n.id||r.getAttribute("data-ivVidId")||r.getAttribute("src");f="bv_"+f,u=function(u){var v=(i=u).handshakeVersion(supportedVpaidVersion);if(v===supportedVpaidVersion||0==supportedVpaidVersion.indexOf(v)){i.subscribe(function(e){b("VPAID failure: "+e)},"AdError",this),i.subscribe(function(){ivLogger.log("VPAID AdLoaded"),p=adUnitStates.LOADED,null!=t&&t(),e.vpaidSlotElement&&e.sticky&&function(){if(null!=e.vpaidSlotElement.querySelector('iframe[src*="ima"]')){var t=e.vpaidSlotElement,i={visi:t.style.visibility,pos:t.style.position};e.sticky.addEventListener("stuck",function(){t.style.position="fixed",m(!1,function(){var e=r.parentElement.getBoundingClientRect();t.style.left=e.left+"px",t.style.top=e.top+"px"})}),e.sticky.addEventListener("unstuck",function(){t.style.position=i.pos,m(!1,function(){t.style.left=0,t.style.top=0})})}else ivLogger.error("Invibes Play configured with VPAID and sticky ima iframe but the iframe cannot be found")}()},"AdLoaded",this),i.subscribe(function(){ivLogger.log("VPAID AdStarted"),p=adUnitStates.PLAYING,function(){if("function"==typeof i.getAdRemainingTime&&"function"==typeof i.getAdDuration){var e=new EventClass("videotargetchanged");e.newVideoTarget=g,r.dispatchEvent(e);var t=function(e){setTimeout(function(){i.getAdRemainingTime;var n=i.getAdDuration(),o=i.getAdRemainingTime();if(null!==e||o>0!=0){var r=n-o;r=r>=0?r:0,g.currentTime=r,g.duration=n,e!==r&&g.dispatchEvent("timeupdate"),p!==adUnitStates.STOPPED&&p!==adUnitStates.FAILED&&t(r)}else t(null)},500)};t(null)}}(),g.dispatchEvent("play"),c=r.src},"AdStarted",this),i.subscribe(function(){ivLogger.log("VPAID AdStopped"),p=adUnitStates.STOPPED,null!=l&&""!=l&&(r.style.zIndex=l,r.style.position="relative"),d&&function(){r.currentTime=0;try{r.src||(r.src=c);var e=r.play();e&&e.then(function(){}).catch(function(e){r.src=c,r.play()})}catch(e){r.src=c,r.play()}r.addEventListener("ended",function(){r.currentTime=0,r.play()})}()},"AdStopped",this),i.subscribe(function(){ivLogger.log("VPAID AdPaused"),p=adUnitStates.PAUSED},"AdPaused",this),i.subscribe(function(){ivLogger.log("VPAID AdPlaying"),p=adUnitStates.PLAYING},"AdPlaying",this),i.subscribe(function(){ivLogger.log("VPAID AdImpression"),s(3100,f)},"AdImpression",this),i.subscribe(function(){ivLogger.log("VPAID AdClickThru"),s(3101,f),a&&(invibes.vpaidClickedThrough=1)},"AdClickThru",this),i.subscribe(function(){ivLogger.log("VPAID AdQ0"),s(3e3,f)},"AdVideoStart",this),i.subscribe(function(){ivLogger.log("VPAID AdQ25"),s(3025,f)},"AdVideoFirstQuartile",this),i.subscribe(function(){ivLogger.log("VPAID AdQ50"),s(3050,f)},"AdVideoMidpoint",this),i.subscribe(function(){ivLogger.log("VPAID AdQ75"),s(3075,f)},"AdVideoThirdQuartile",this),i.subscribe(function(){ivLogger.log("VPAID AdQ100"),s(3099,f)},"AdVideoComplete",this);var h={AdParameters:o},y={slot:e.vpaidSlotElement||r.parentElement,videoSlot:r};i.initAd(r.parentElement.offsetWidth,r.parentElement.offsetHeight,viewMode,n.bitrate,h,y)}else b("VPAID version not supported: "+v)},(v=document.createElement("iframe")).name="ivbs-loading-frame",v.style.display="none",v.onload=function(){var e=v.contentDocument;!e&&v.contentWindow&&(e=v.contentWindow.document);var t=e.createElement("script");t.type="text/javascript",t.src=n.src,t.onload=function(){var t=e.createElement("script");t.type="text/javascript",t.text="var vpaid = getVPAIDAd();",e.body.appendChild(t),u(v.contentWindow.vpaid)},e.body.appendChild(t)},document.body.appendChild(v);var g={src:r.src,currentTime:r.currentTime,duration:r.duration,getAttribute:function(e){return r.getAttribute(e)}};return enableEventFunctionality(g),{play:function(){switch(p){case adUnitStates.INIT:var e=new Promise(function(e){!function e(t){setTimeout(function(){p===adUnitStates.INIT?e(t):t()},100)}(e)});return e;case adUnitStates.LOADED:return void i.startAd();case adUnitStates.PLAYING:return void i.resumeAd();case adUnitStates.PAUSED:return i.pauseAd(),void i.resumeAd();case adUnitStates.STOPPED:return void r.play();case adUnitStates.FAILED:return}},pause:function(){p===adUnitStates.STOPPED&&r.pause(),p===adUnitStates.PLAYING&&i.pauseAd()},stop:function(){p>=adUnitStates.LOADED&&i.stopAd()},isPaused:function(){return p===adUnitStates.STOPPED?r.paused:!(!r.paused&&p===adUnitStates.PLAYING)},mute:function(){r.muted=!0,p===adUnitStates.STOPPED?r.volume=0:(r.volume=0,i.setAdVolume(0))},unmute:function(){r.muted=!1,p===adUnitStates.STOPPED?r.volume=1:(r.volume=1,i.setAdVolume(1))},resize:m,timedVideo:g};function m(e,t){if(p===adUnitStates.STOPPED)r.style.width="100%",r.style.height="100%";else{var n=r.parentElement;i.resizeAd;var o=2,s=function(r,a){setTimeout(function(){var d=n.offsetWidth,l=n.offsetHeight;if(r!==d||a!==l){o=2;var c=e?fullscreenMode:viewMode;i.resizeAd(d,l,c),s(d,l)}else--o>=0&&s(d,l);t&&t()},25)};s(n.offsetWidth,n.offsetHeight)}}function b(e){p=adUnitStates.FAILED,s(3999,JSON.stringify({videoId:f,error:e}))}}),invibes.Configurator=function(e){e.useDefaultSelections=null==e.useDefaultSelections||e.useDefaultSelections;var t=document.getElementsByClassName(e.parseFrom)[0]||document.getElementsByClassName("ivbsGeneral")[0]||document,i=document.getElementById(e.img),n=[],o=[],r=function(e){for(var t=0;t<5;){if("a"==e.nodeName.toLowerCase()&&e.getAttribute("outgoing-href"))return e;e=e.parentNode,t++}},s=function(t,s,d){var l,c=function(t,i){for(var n=[],r=0;r<e.dependencies.length;r++){for(var s=e.dependencies[r].depArray,a=!0,d=0;d<t-1;d++)if(e.dependencies[r].depArray[d]!=o[d]){a=!1;break}a&&s[t-1]==i&&null!=s[t]&&n.push(s[t].toString())}return n}(t,s),u=o[t],v=null!=d?d[t]:null,p=!1;if(0!==c.length&&null!=n[t])for(var f=0;f<n[t].length;f++){var g=n[t][f];null!=v&&v==g.ivcfgIndexValue?(g.style.display="inline-block",l=g,v!=u&&(p=!0)):c.indexOf(g.ivcfgIndexValue)>-1?(g.style.display="inline-block",l=l||g):(g.style.display="none",null!=u&&g.ivcfgIndexValue!=u||(p=!0))}p?a(l,d,!1):function(){for(var t=0;t<e.dependencies.length;t++){for(var n=e.dependencies[t].depArray,s=!0,a=0;a<n.length;a++)if(n[a]!=o[a]&&void 0!==o[a]){s=!1;break}if(s){if(i.src=e.dependencies[t].img,e.dependencies[t].link){var d=r(i);initializeOutgoingLink(d,e.dependencies[t].link)}break}}}()},a=function(t,i,r){var a=t.ivcfgIndex,d=t.ivcfgIndexValue;o[a-1]!=d&&(o[a-1]=d,function(t,i){for(var o=0;o<n[t-1].length;o++){var r=n[t-1][o];r.ivcfgIndexValue==i?r.classList.add(e.activeClass):r.classList.remove(e.activeClass)}}(a,d),r&&invibes.sendUserVideoEventId(7e3,d),s(a,d,i))},d=function(t){for(var i=0;i<e.dependencies.length;i++)if(e.dependencies[i].depArray[0]==t.ivcfgIndexValue)return e.dependencies[i].depArray;return null};return{init:function(){for(var i=!0,o=0,r=!1;i;){o++;var s="data-ivcfg-"+(e.mapping[o]||o),l=t.querySelectorAll("["+s+"]");if(0===l.length)i=!1;else{n.push(l);for(var c=0;c<l.length;c++){var u=l[c];u.ivcfgIndex=o,u.ivcfgIndexValue=u.getAttribute(s),u.onclick=function(t){var i=null;1==this.ivcfgIndex&&e.useDefaultSelections&&(i=d(this)),r||(invibes.sendUserVideoEventId(930,e.mapping[this.ivcfgIndex]||this.ivcfgIndex),r=!0),a(this,i,!0)}}}}var v=function(){for(var t=0;t<n[0].length;t++)if(n[0][t].ivcfgIndexValue==e.dependencies[0].depArray[0])return n[0][t];return null}();a(v,d(v),!1)}}},invibes.LoopWriter=function(e){var t=new Array(e.text),n=e.speed||100,o=e.maxRows||2,r=0,s=0,a=t[s].length,d=document.getElementById(e.textContainer),l=d.cloneNode(!0);d.parentNode.insertBefore(l,d),d.style.marginTop=0,d.style.paddingTop=0,l.style.marginBottom=0,l.style.paddingBottom=0,l.style.opacity=1,l.style.maxHeight="1500px",l.style.transition="opacity 0.5s, max-height 1s";var c=function(){var e,u=null;(e=d).offsetHeight/parseInt(e.style.lineHeight||document.defaultView.getComputedStyle(e,null).getPropertyValue("lineHeight")||document.defaultView.getComputedStyle(e,null).getPropertyValue("line-height"))>o&&(u=function(e){var t;for(i=e.innerHTML.length-1;i>=0;i--)if(" "==e.innerHTML[i]){t=i;break}return t}(d)),u>0&&(l.innerHTML=d.innerHTML.substring(0,u-1),d.innerHTML=d.innerHTML.substring(u,d.innerHTML.length),l.style.opacity=0,l.style.maxHeight=0,setTimeout(function(){l.innerHTML="",l.style.opacity=1,l.style.maxHeight="1500px"},1500)),d.innerHTML=d.innerHTML+t[s][r],r++==a?(r=0,d.innerHTML="",++s!=t.length?(a=t[s].length,setTimeout(c,500)):(s=0,a=t[0].length,setTimeout(c,500))):setTimeout(c,n)};return{start:function(){c()}}},invibes.initVideoSwiper=function(e){for(var t={},i={},n=1,o=function(e,o){var r=new invibes.InlinePlayer(e),s=e.getAttribute("data-ivvidid")||e.src;new invibes.VideoQuartileReporter({videoElement:e,report:function(e){!function(e,i){var n=e+i;t[n]||(invibes.sendUserVideoEventId(1300+i,e),t[n]=1)}(s,e)}}),e.addEventListener("ended",function(t){e.currentTime=0,e.play()});var a={play:function(){e.paused&&(e.readyState>0?(e.currentTime=i[s]||0,r.play()):window.setTimeout(function(){a.play()},50))},pause:function(){e.paused||(i[s]=e.currentTime,r.pause())},isMuted:function(){return e.muted},mute:function(){this.isMuted()||(e.volume=0,e.muted=!0,o&&(o.classList.add("ivMute"),o.classList.remove("ivUnmute")))},unmute:function(){this.isMuted()&&(e.volume=1,e.muted=!1,o&&(o.classList.remove("ivMute"),o.classList.add("ivUnmute")))},toggleMute:function(){this.isMuted()?(this.unmute(),invibes.sendUserVideoEventId(n?3500:3501),n=!1):this.mute()}};return function(e,t){t&&t.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),e.toggleMute()})}(a,o),a},r=[],s=0;s<e.slides.length;s++){var a=e.slides[s],d=a.querySelector("[data-ivvidid]"),l=a.querySelector('[data-role="unmute"]');d&&(video=o(d,l),video.mute(),r[s]=video)}var c=!1,u=function(){return r[e.activeIndex]},v=u();e.on("onSlideChangeEnd",function(){invibes.handleAdSwipe(),v=u(),c&&v&&v.play()}),e.on("onSlideChangeStart",function(){c&&v&&(v.pause(),v.mute())});var p=function(){c=!0,v&&v.play()};invibes.viewed?p():invibes.addEventListener("view",function e(){p(),invibes.removeEventListener("view",e)}),invibes.addEventListener("scrollresize",function(){invibes.getClientVerticalVisibilityPercent(invibes.adDiv)<80&&v&&v.mute()}),invibes.addEventListener("click",function(){v&&(v.pause(),v.mute())})},invibes.Locator=function(e){var t="2",i="3",n="5",o=["mousedown","mouseup","mousemove","pointerdown","pointerup","pointermove","MSPointerDown","MSPointerUp","MSPointerMove","touchstart","touchend","touchmove"],r=function(){var t=[];if(null!=e.id)t.push(document.getElementById(e.id));else for(var i=document.getElementsByClassName(e.class),n=0;n<i.length;n++)t.push(i[n]);return t},s=function(){var o="<style>body {margin: 0px;} .scrolloff { pointer-events: none; } </style><div style='height:100%' id='map'></div><script async defer src='https://maps.googleapis.com/maps/api/js?key="+e.apiKey+"&callback=initMap'><\/script>",r="<style>body {margin: 0px;} .scrolloff { pointer-events: none; } </style><div style='height:100%' id='map'></div><script onload='initMap()' src='"+vsConfig.mapboxJs+"'><\/script><link href='"+vsConfig.mapboxCss+"' rel='stylesheet'>",s="<style>body { margin: 0px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; } .scrolloff { pointer-events: none; } </style><div style='height:100%' id='map'></div><link href='"+vsConfig.leafletCss+"' rel='stylesheet'><script onload='initMap()' src='"+vsConfig.leafletJs+"'><\/script>";switch(e.mapType){case t:return{frameContent:o,initFunction:"var initMap = "+function(){var e=this.document.getElementById("map"),t={lat:this.config.latitude,lng:this.config.longitude},i=new google.maps.Map(e,{zoom:this.config.zoom,center:t,disableDefaultUI:!0,zoomControl:!0,gestureHandling:this.config.gesture});new google.maps.Marker({position:t,map:i})}.toString()};case i:return{frameContent:r,initFunction:"var hasInit = false; var initMap = "+function(){if(window.mapboxgl&&!hasInit){hasInit=!0,mapboxgl.accessToken=this.config.apiKey;var e,t=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v9",center:[this.config.longitude,this.config.latitude],zoom:this.config.zoom,attributionControl:!1});t.addControl(new mapboxgl.NavigationControl({showCompass:!1}),"bottom-right"),this.config.color&&(e=parseInt(this.config.color,16)?"#"+this.config.color:this.config.color);var i=new mapboxgl.Marker({color:e||"red"});i.setLngLat([this.config.longitude,this.config.latitude]),i.addTo(t)}}.toString()+";initMap()"};case n:return{frameContent:s,initFunction:"var hasInit = false; var initMap = "+function(){if(window.L&&!hasInit){hasInit=!0;var e=L.map("map",{center:[this.config.latitude,this.config.longitude],zoom:this.config.zoom,zoomControl:!1});L.marker([this.config.latitude,this.config.longitude],{}).addTo(e),L.control.zoom({position:"bottomright"}).addTo(e),e.attributionControl.setPrefix('<span style="font-size: 9px">&copy; <a target="_blank" href="http://leafletjs.com">Leaflet</a> & <a target="_blank" href="https://www.mapbox.com/">Mapbox</a><span>'),L.tileLayer("//api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",{attribution:"",maxZoom:18,id:"mapbox.streets",accessToken:this.config.apiKey}).addTo(e)}}.toString()+";initMap()"};default:return ivLogger.error("Unknown locator maptype: "+e.mapType),{frameContent:null,initFunction:null}}},a=function(t,i){t.name="ivbs-locator-frame",t.style.width="100%",t.style.height="100%",t.style.margin="0 !important",t.style.border="none",t.border=0,t.frameBorder=0;var n=t.contentDocument;!n&&t.contentWindow&&(n=t.contentWindow.document),n.open("text/html"),n.write(i.frameContent),n.close(),"cooperative"==e.gesture&&function(e){for(var t=null,i=0,n=1,r=0;r<o.length;r++)e.addEventListener(o[r],function(o){if("touchend"!=o.type&&"mouseup"!=o.type||(n=1,i=0,t=null),"touchmove"==o.type||"mousemove"==o.type){if(null==o.changedTouches||0==o.changedTouches.length)return;var r=o.changedTouches[0].clientX;if(null==t)t=r;else if(r>=t){if(1==i)return n=1,void(i=0);if(0==i){if(n<3)return n++,void(t=r);i=-1,n=0,t=r}else n=0,t=r}else if(r<t){if(-1==i)return n=1,void(i=0);if(0==i){if(n<3)return n++,void(t=r);i=1,n=0,t=r}else n=0,t=r}}var s=1===invibes.deviceType?new MouseEvent(o.type,o):new TouchEvent(o.type,o);e.frameElement.parentNode.dispatchEvent(s)})}(t.contentWindow),t.contentWindow.config=e,t.contentWindow.eval(i.initFunction),t.style.display="inline-block"};return{initAllMaps:function(){if(function(e){if(!invibes.currentAd.CampaignGeoTag||!invibes.currentAd.CampaignGeoTag.Locator){if(!e.apiKey)return ivLogger.error("Locator configs not found in BV. Will not generate a Locator"),!1;ivLogger.warn("Geo Tag and/or Javascript_V2 locator is not configured for this campaign. Will try to only use configs from BV")}return e.apiKey=e.apiKey||invibes.currentAd.CampaignGeoTag.Locator.ApiKey,e.mapType=e.mapType||invibes.currentAd.CampaignGeoTag.Locator.MapType,e.latitude=e.latitude||parseFloat(invibes.currentAd.CampaignGeoTag.Locator.Latitude),e.longitude=e.longitude||parseFloat(invibes.currentAd.CampaignGeoTag.Locator.Longitude),e.zoom=e.zoom||parseInt(invibes.currentAd.CampaignGeoTag.Locator.Zoom),e.color=e.color||invibes.currentAd.CampaignGeoTag.Locator.Color,e.gesture=e.gesture||"greedy",!0}(e))for(var t=r(),i=s(),n=0;n<t.length;n++)a(t[n],i)}}},invibes.PhotoChannel=function(e){var t=new IvSwiper(e.swiperConfig.container,e.swiperConfig.params);new invibes.Slider(t,{clickHandler:function(e){}}).start(),setTimeout(function(){t.update(),t.slideReset(),invibes.initializeAllOutgoingLinks()},500);for(var i=null!=e.channelConfig.img?document.getElementById(e.channelConfig.img):null,n=null!=e.channelConfig.title?document.getElementById(e.channelConfig.title):null,o=null!=e.channelConfig.desc?document.getElementById(e.channelConfig.desc):null,r=document.getElementsByClassName(e.channelConfig.slide),s=e.channelConfig.activeTarget?document.getElementsByClassName(e.channelConfig.activeTarget):r,a=function(e){for(var t=0;t<s.length;t++)s[t]!=e?s[t].classList.remove("activeSlider"):s[t].classList.add("activeSlider")},d=0;d<s.length;d++)s[d].addEventListener("click",function(){a(this)});for(d=0;d<r.length;d++)r[d].addEventListener("click",function(){i&&(i.src=this.getAttribute("data-img")),n&&(n.innerHTML=this.getAttribute("data-title")),n&&this.getAttribute("data-titleBg")&&(n.style.backgroundColor=this.getAttribute("data-titleBg")),o&&(o.innerHTML=this.getAttribute("data-desc")),invibes.sendStatwebStats(950,this.getAttribute("data-id"))})},invibes.Reveal2=function(e){var t,i,n,o,r=document.getElementById(e.container),s=document.getElementById("ivbsMasker"),a=document.getElementById("ivbsRing"),d=document.getElementById("ivbsDot"),l=document.getElementById("ivbsProgressRing"),c=document.getElementById("ivbsProgressCounter"),u=e.minRadius||50,v=e.maxRadius||300,p=e.maxFirstPassRadius||150,f=e.zoomSpeed||10,g=function(){return(100*(i-u)/(v-u)).toFixed()},m=function(e){null!=l&&(e<=0?(e=0,l.setAttribute("stroke-dashoffset","252.363"),l.setAttribute("stroke-dasharray","none")):e>=100?(e=100,l.setAttribute("stroke-dashoffset","0"),l.setAttribute("stroke-dasharray","0px, 999999px")):(l.setAttribute("stroke-dashoffset",252*e/100),l.setAttribute("stroke-dasharray","252.363px, 262.363px"))),null!=c&&(c.textContent=e)},b=function(e,t){s.setAttribute("cx",e),s.setAttribute("cy",t),a.setAttribute("cx",e),a.setAttribute("cy",t),d.setAttribute("cx",e),d.setAttribute("cy",t)},h=function(){a.style.opacity=0,d.style.opacity=0},y=function(){a.style.opacity=1,d.style.opacity=1},w=function(){0!=t&&(-1==t&&i<=u?i=u:1==t&&i>=v?i=v:(i+=f*t,s.setAttribute("r",i),m(g()),setTimeout(w,50)))},C=function(e){if(0==t){if(-1==e&&i<=u)return i=u,void(o=!1);1==e&&i>=p&&(e=-1),i+=.8*f*e,s.setAttribute("r",i),m(g()),setTimeout(function(){C(e)},50)}else o=!1},k=function(e){if(!o&&null!=e.changedTouches&&e.changedTouches.length>0){var t=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY,n=r.getBoundingClientRect(),s=n.x||n.left,a=n.y||n.top;t>s&&t<s+n.width&&i>a&&i<a+n.height?y():h()}},E=function(e){var t,i;null!=e.clientX?(t=e.clientX,i=e.clientY):null!=e.changedTouches&&e.changedTouches.length>0&&(t=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY);var n=r.getBoundingClientRect(),o=t-n.left,s=i-n.top;b(o,s)},A=function(){document.removeEventListener("mouseup",A),document.removeEventListener("touchend",A),t=-1,invibes.sendStatwebStats(915,(Date.now()-n)/1e3),w()},S=function(){document.addEventListener("mouseup",A),document.addEventListener("touchend",A),n=Date.now(),t=1,w()},I=function(){invibes.getClientVerticalVisibilityPercent(invibes.adDiv)>75&&(invibes.removeEventListener("scrollresize",I),o=!0,b(r.offsetWidth/2,r.offsetHeight/2),y(),C(1),r.addEventListener("mousemove",E),r.addEventListener("touchmove",E),e.zoom&&(r.addEventListener("mousedown",S),r.addEventListener("touchstart",S)),r.addEventListener("mouseleave",h),r.addEventListener("mouseenter",y),document.addEventListener("touchmove",k))};return{init:function(){h(),i=u,s.setAttribute("r",i),t=0,invibes.addEventListener("scrollresize",I),I()}}},invibes.scrollSwipe=(state={vt:0,vb:0,prv:0,prvs:0},function(e){enableEventFunctionality(this),e||(e={eventVsb:75,step:100});var t=this,i=function(){var i=invibes.adDiv.getBoundingClientRect();state.vt=i.bottom/i.height*100,state.vb=(window.innerHeight-i.top)/i.height*100;var n=Math.abs(state.prvs-i.top);state.prv>i.top&&state.vb>e.eventVsb&&state.vt>e.eventVsb&&n>e.step?(t&&t.dispatchEvent&&t.dispatchEvent("next"),e.onNext&&e.onNext(),state.prvs=i.top):state.prv<i.top&&state.vt>e.eventVsb&&state.vb>e.eventVsb&&n>e.step?(t&&t.dispatchEvent&&t.dispatchEvent("prev"),e.onPrev&&e.onPrev(),state.prvs=i.top):state.prv>i.top&&state.vb<e.eventVsb?state.prvs=0:state.prv<i.top&&state.vt<e.eventVsb&&(state.prvs=window.innerHeight),state.prv=i.top};e&&e.triggerFunction&&e.triggerFunction(i),i()}),invibes.Parallax=function(){var e,t,i,n,o=0,r=0,s=[],a=[],d=["containerVisibility","pageScroll","containerScroll"],l={},c={basePercentageOn:"containerScroll",decimalPrecision:2},u=function(){var e={},t=!1,i=0,n=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(t=arguments[0],i++);for(var o=function(i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t&&"[object Object]"===Object.prototype.toString.call(i[n])?e[n]=u(!0,e[n],i[n]):e[n]=i[n])};i<n;i++)o(arguments[i]);return e},v=function(){var e=document.documentElement||document.body;return t=e.scrollHeight,(r=window.pageYOffset||e.scrollTop)/(t-e.clientHeight)},p=function(e){if("containerScroll"==n.basePercentageOn){var s=e.container.getBoundingClientRect();s.height,o=1-s.top/(i-s.height)}else"containerVisibility"==n.basePercentageOn?(t=e.container.scrollHeight,r=i-e.container.getBoundingClientRect().top,o=r/t):"pageScroll"==n.basePercentageOn&&(o=v());o<0?o=0:o>1&&(o=1)},f=function(){!function(){for(var e=0;e<s.length;e++){var t,i,r=a[e];if("elementSize"==r.baseSizeOn?(t=s[e].scrollWidth||parseFloat(window.getComputedStyle(s[e]).width),i=s[e].scrollHeight||parseFloat(window.getComputedStyle(s[e]).height)):"containerSize"==r.baseSizeOn&&(t=r.container.offsetWidth-(s[e].offsetWidth||parseFloat(window.getComputedStyle(s[e]).width)),i=r.container.offsetHeight-(s[e].offsetHeight||parseFloat(window.getComputedStyle(s[e]).height))),p(r),o<=r.start.percent?(r.target.x=r.start.x*t,r.target.y=r.start.y*i):o>=r.end.percent?(r.target.x=r.end.x*t,r.target.y=r.end.y*i):(r.target.x=r.start.x*t+r.diff.x*(o-r.start.percent)/r.diff.percent*t,r.target.y=r.start.y*i+r.diff.y*(o-r.start.percent)/r.diff.percent*i),r.containerBound){var d=r.container.getBoundingClientRect(),l=r.element.getBoundingClientRect(),c=r.current.x-r.target.x;if(c>0){if(l.right-d.right<c)return}else if(l.left-d.left>c)return}r.current.x&&r.current.y?(r.current.x=r.current.x+.1*(r.target.x-r.current.x),r.current.y=r.current.y+.1*(r.target.y-r.current.y)):(r.current.x=r.target.x,r.current.y=r.target.y),r.current.x=parseFloat(r.current.x.toFixed(n.decimalPrecision)),r.current.y=parseFloat(r.current.y.toFixed(n.decimalPrecision)),s[e].style.transform="translate3d("+r.current.x+"px, "+r.current.y+"px, 0)"}}(),requestAnimationFrame(f)};return l.init=function(t){var o;i=window.innerHeight,(n=u(c,t||{})).decimalPrecision=parseInt(n.decimalPrecision)||c.decimalPrecision,o=!0,-1==d.indexOf(n.basePercentageOn)&&(o=!1,console.error("Value not supported for setting basePercentageOn: "+n.basePercentageOn)),o&&(function(){var t,i,n,o,r,d,l,c,u,v,p=["elementSize","containerSize"];s=(invibes.adDiv||document).querySelectorAll("[smooth-parallax]");for(var f=0;f<s.length;f++){t=parseFloat(s[f].getAttribute("start-movement"))||0,i=parseFloat(s[f].getAttribute("start-position-x"))||0,n=parseFloat(s[f].getAttribute("start-position-y"))||0,o=parseFloat(s[f].getAttribute("end-movement"))||1,r=parseFloat(s[f].getAttribute("end-position-x"))||0,d=parseFloat(s[f].getAttribute("end-position-y"))||0,c=s[f].getAttribute("base-size"),l=s[f].getAttribute("container-bound"),-1==p.indexOf(c)&&(c="elementSize");var g={element:s[f],container:(u=s[f],v=u.getAttribute("container"),e=u.parentNode,""!=v&&document.querySelector(v)&&(e=document.querySelector(v)),e),baseSizeOn:c,start:{percent:t,x:i,y:n},end:{percent:o,x:r,y:d},diff:{percent:o-t,x:r-i,y:d-n},target:{},current:{},containerBound:null!=l};a.push(g)}}(),f())},l.getScrollPercent=function(e){if(null==e)return v();var t=document.querySelector(e);if(null==t)return!1;var i=function(e){for(var t=0;t<a.length;t++)if(a[t].element==e)return a[t];return!1}(t);return!!i&&(p(i),o)},l},invibes.Poll=(Cts_MaxEventsToSendPerPoll=19,Cts_MinVotesToShow=20,statsInc=0,sendStats=function(e){statsInc<Cts_MaxEventsToSendPerPoll&&(statsInc++,invibes.sendUserVideoEventId(980,statsInc+"|"+e))},function(e){var t,i,n,o=0,r=function(i){if(null==t){var n=this.getAttribute(e.attrChoice);sendStats(n),t=this,d(!0),t.classList.add(e.classChosen),e.pollContainer.classList.add(e.classShowResult),a(n),i.preventDefault(),i.stopPropagation()}},s=function(){if(null!=t){d(!1),t.classList.remove(e.classChosen),e.pollContainer.classList.remove(e.classShowResult),t=null,sendStats(0);for(var i=e.pollContainer.querySelectorAll("["+e.attrChoice+"] svg"),n=0;n<i.length;n++)i[n].style.width=0;event.preventDefault(),event.stopPropagation()}},a=function(t){for(var n=100,r=function(t,i){var n=t.getElementsByTagName("svg")[0];n&&setTimeout(function(){n.style.width=i+"%"},0);var o=t.getElementsByClassName(e.classPercent)[0];o&&(o.innerHTML=i+"%")},s=0;s<i.length-1;s++){var a=i[s].getAttribute(e.attrChoice),d=e.scores[a]||0;a==t&&d++;var l=Math.round(100*d/(o+1));n-=l,r(i[s],l)}r(i[i.length-1],n)},d=function(e){if(null!=n){var t=o+(e?1:0);n.textContent=t<Cts_MinVotesToShow?"<100 ":t.toLocaleString("en")}};!function(){if(e.pollContainer=e.pollContainer?e.pollContainer instanceof Element?e.pollContainer:document.getElementById(e.pollContainer):invibes.adDiv,e.classChosen=e.classChosen||"ivbsChosen",e.classShowResult=e.classShowResult||"ivbsResults",e.classPercent=e.classPercent||"ivbsPercent",e.attrChoice=e.attrChoice||"data-ivpoll-choice",e.scores=invibes.currentAd.BvOptVotes||e.scores||{},0!=(i=(invibes.adDiv||document).querySelectorAll("["+e.attrChoice+"]")).length){Object.keys(e.scores).forEach(function(t){o+=e.scores[t]});for(var t=0;t<i.length;t++)i[t].addEventListener("click",r),void 0===e.scores[i[t].getAttribute(e.attrChoice)]&&ivLogger.info("Choice was configured in html but was not matched to the scores set.");e.idUndo&&document.getElementById(e.idUndo).addEventListener("click",s),e.idVotes&&(n=document.getElementById(e.idVotes),d(!1))}else ivLogger.error("No choice elements configured with ["+e.attrChoice+"] attribute.")}()});var monitorIabVisibility=function(){var e=function(e,t,i,n){e&&createVisibilityMonitor({target:e,duration:i,checkpoints:[n],onCheckpointReached:function(){invibes.sendUserVideoEventId(t)}})};e(invibes.adDiv,3400,2e3,50);var t=invibes.currentAd;t.InfeedIABDuration&&t.InfeedIABPercent&&e(invibes.adDiv,3300,1e3*t.InfeedIABDuration,t.InfeedIABPercent);var i=invibes.adDiv.querySelector("#ivbsVid");i&&t.VideoIABDuration&&t.VideoIABPercent&&e(i,3200,1e3*t.VideoIABDuration,t.VideoIABPercent)};if(invibes.addEventListener("adRendered",monitorIabVisibility),null==invibes.bidResponse){var beaconClient=new BeaconClient;beaconClient.run(3,1e3);var measureLatency=function(){var e=(new Date).getTime(),t=new Image;return t.src="//static.r66net.com/Content/Images/loading-black.gif",new Promise(function(i){t.addEventListener("load",function(){var t=(new Date).getTime();invibes.latency=t-e,ivLogger.log("Latency: "+invibes.latency),i()})})},latencyTimeout=function(e){return new Promise(function(t){window.setTimeout(function(){invibes.latency||(ivLogger.warn("Latency timed out after "+e+" ms."),t())},e)})},latencyPromise=Promise.race([measureLatency(),latencyTimeout(500)]),userIdPromise=new Promise(function(e){userManager.detectUserId(e)});Promise.all([latencyPromise,userIdPromise]).then(function(){start()})}else userManager.detectUserId(noop),startWithoutAdweb(),sendAdRequestToKWebStat(invibes.bidResponse)}function enableEventFunctionality(e){var t={};e.addEventListener=function(e,i){i.constructor===Function&&(t[e]=t[e]||[],t[e].push(i))},e.removeEventListener=function(e,i){var n=t[e]||[],o=n.indexOf(i);o>-1&&n.splice(o,1)},e.dispatchEvent=function(e,i,n){var o=(t[e]||[]).slice(0);for(var r in o)if(o.hasOwnProperty(r))try{o[r].apply(i,n||[])}catch(e){ivLogger.error(e)}}}function getDivToFill(){return document.getElementById("divVideoStepAdTop2")||document.getElementById("divVideoStepAdTop")||document.getElementById("divVideoStepAdBottom")}function parseQueryStringParams(){var e={};try{e=JSON.parse(localStorage.ivbs)}catch(e){}for(var t,i=/[\\?&]([^=]+)=([^\\?&#]+)/g;null!=(t=i.exec(window.location.href));)t.index===i.lastIndex&&i.lastIndex++,e[t[1].toLowerCase()]=t[2];return e}function readMinifiedScriptTag(){var e=document.querySelector('[id^="_videoStepMinifiedScript+"]');if(e)return e.value}function setCommonQueryStringParameters(e){var t={userCookieId:invibes.id,vId:invibes.visitId,width:top.window.innerWidth,height:top.window.innerHeight,minifiedScriptList:invibes.prod||readMinifiedScriptTag()};for(var i in invibes.getCookie(suspendedCookieName)&&(t[suspendedCookieName]=1),t)t.hasOwnProperty(i)&&(e[i]=t[i])}function beforeWindowCloseHandler(e){return!0===e&&(window.onbeforeunload=window.onpagehide=null),beforeWindowCloseExecuted||(beforeWindowCloseExecuted=!0,window.removeEventListener("beforeunload",beforeWindowCloseHandler),window.removeEventListener("pagehide",beforeWindowCloseHandler),sendUserVideoEvent(101),sendSewebDuration()),""}function sendVisibilityStat(e){invibes.pixel(vsConfig.kwebstatUrl+"/Stat/RegisterAdVisibility",e)}function sendAdRequestToKWebStat(e){if(e.SendAdRequest){var t={pageId:e.PageId,publisherUrlId:e.PublisherUrlId,deviceType:e.UserDeviceType,lId:invibes.dom.id,kw:keywords,zone:e.Zone,location:getDocumentLocation()};invibes.jsonp(vsConfig.kwebstatUrl+"/Stat/RegisterPageAdRequest?"+createQueryString(t))}}function getLinkVideoAdContent(){var e=parseQueryStringParams(),t={location:getDocumentLocation(),lId:invibes.dom.id,videoAdHtmlId:generateRandomId(),showFallback:"0"===e.advs,ivbsCampIdsLocal:invibes.getCookie("IvbsCampIdsLocal"),blk:adBlockerDetected,noc:!cookieDomain,oi:invibes.optIn,lnkBrk:brokerClient.getVisited,kw:keywords},i=viewCapping.getCappedCampaignsAsString();i&&(t.capCounts=i),invibes.latency&&(t.l=invibes.latency),invibes.adDiv=getDivToFill(),invibes.adDiv&&(t.aci=invibes.adDiv.getAttribute("id"));var n="videoAdDebug,ADVS,BVCI,BVID,istop,trybvid,trybvci".toLowerCase().split(",");for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];(n.indexOf(o)>-1||/^vs|^invib/i.test(o))&&(t[o]=r)}return cookieDomain||(t.advs=0),setCommonQueryStringParameters(t),vsConfig.videoAdDomain+"/VideoAd/VideoAdContent?"+createQueryString(t)}function getAbsoluteTopSizeInPixelsFor(e){if(e){var t=window.pageYOffset||document.documentElement.scrollTop;return e.getBoundingClientRect().top+t}}function getAdViewAdditionalInfo(){var e="window="+top.window.innerHeight;return["divVideoStepAdTop","divVideoStepAdTop2","divVideoStepAdBottom"].forEach(function(t){var i=document.getElementById(t);i&&(e+="|"+t+"="+getAbsoluteTopSizeInPixelsFor(i))}),e}function tryInsertVideoAdFallbackScript(){if(sendPendingUserVideoEvents(),!fbScriptDisplayed&&null==videoAdContentResult.BidModel){fbScriptDisplayed=!0;var e=videoAdContentResult.FallbackScript;if(e){var t=document.createElement("script");t.type="text/javascript",t.text=e,document.head.appendChild(t),sendStatwebStats(-41)}}}function sendVideoAdViewStats(){if(registerViewCapping(invibes.currentAd),!invibes.adViewSent){invibes.adViewSent=1;var e={bvToken:invibes.currentAd.Token,exposedId:"VideoExposedId="+invibes.currentAd.VideoExposedId,location:getDocumentLocation(),additionalInfo:invibes.currentAd.CampaignGeoTag?invibes.currentAd.CampaignGeoTag.ApiKeyInfo:null,optIn:invibes.optIn,udata:invibes.currentAd.UData,l:invibes.latency||-1,isBid:null!=invibes.bidResponse};invibes.pixel(vsConfig.kwebstatUrl+"/Stat/RegisterAdViewStat",e)}}function sendPendingUserVideoEvents(){pendingUserVideoEvents.forEach(function(e){sendUserVideoEvent.apply(null,e)}),pendingUserVideoEvents=[]}function makeGeoTagReplacements(e){var t=invibes.currentAd.CampaignGeoTag;if(t&&t.TagReplacements){var i=t.TagReplacements;for(var n in i)if(i.hasOwnProperty(n)){var o=new RegExp("\\["+n+"\\]","g"),r=i[n];e=e.replace(o,r)}}return e}function addTrackingScript(){var e=invibes.currentAd.TrackingScript;if(e){e=makeGeoTagReplacements(e);var t=document.createElement("script");t.type="text/javascript",t.text=e,invibes.adDiv.appendChild(t)}}function canDisplayAdIn(e){return!!e&&(!invibes.adDisplayed&&isCurrentlyInView(e))}function waitForVideoAdToBeScrolledIntoView(){invibes.trySetStatus({code:-1}),canDisplayAdIn(getDivToFill())?renderAd():invibes.addEventListener("scrollresize",renderAd)}function doAjaxVsVideoAdContent(e){var t=function(e,t,i){invibes.currentAd=t;try{if(invibes.adBlocked)tryInsertVideoAdFallbackScript();else{if(null==i){var n=document.getElementById("tt-container");"ShowOnlyBottomIfTeadsPresent"===e.VideoAdDisplayOption&&n&&(e.DivIdToFill="#divVideoStepAdBottom")}sendPendingUserVideoEvents(),e.SecondsToWaitForVideoAdScroll&&window.setTimeout(function(){1!==invibes.statusCode&&(invibes.trySetStatus({code:0}),tryInsertVideoAdFallbackScript(),sendStatwebStats(-48,invibes.hasScrolled?"1":"0"))},1e3*e.SecondsToWaitForVideoAdScroll),invibes.localize.usingLanguage(e.Language),null!=e.PageId&&0!==e.PageId&&(invibes.vsPageId=e.PageId),invibes.currentAd.HtmlString?"DoNotShowIfTeadsPresent"===e.VideoAdDisplayOption&&n?(sendStatwebStats(-40,"CompetitionFound=tt-container"),tryInsertVideoAdFallbackScript()):(invibes.popup=appendPopupToDOM(),waitForVideoAdToBeScrolledIntoView()):tryInsertVideoAdFallbackScript()}}catch(e){ivLogger.error(e.stack)}},i=function(e){if(0!==invibes.statusCode&&(invibes.videoAdResponseReceived=Date.now(),null!=e&&e.Data&&e.Data.videoAdContentResult)){invibes.videoAdContentResult=videoAdContentResult=e.Data.videoAdContentResult,ivLogger.info(">>> Got "+invibes.videoAdContentResult.Ads.length+" ad(s)."),cmpProvider().handleCmpResponse(invibes.videoAdContentResult.CmpSettings),brokerClient.runApis(invibes.videoAdContentResult.BrokerApis);var i=new Function(videoAdContentResult.BlockingScript);try{i.call()}catch(e){ivLogger.error("PBS error",e)}videoAdContentResult.AdReason&&ivLogger.info("* AdReason = "+videoAdContentResult.AdReason),invibes.log=videoAdContentResult.Log,monitorScrollToAd(),new AdChooser(videoAdContentResult,t,tryInsertVideoAdFallbackScript).displayAnAd()}};window.setTimeout(function(){invibes.videoAdResponseReceived||invibes.trySetStatus({code:0})},3e4),invibes.bidResponse?i({Data:{videoAdContentResult:invibes.bidResponse}}):testConfiguration.adResponse?i(testConfiguration.adResponse):invibes.jsonp(e,i)}function loadVideoAd(){invibes.vsSentCallToAdWeb||(invibes.vsSentCallToAdWeb=!0,doAjaxVsVideoAdContent(getLinkVideoAdContent()))}function onDocumentReady(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}function tryPerformLoadVideoAd(){var e=document.querySelector("div[id^='divVideoStepAdTop']"),t=document.querySelector("#divVideoStepAdBottom");loadVideoAd(),e||t||triedPerformLoadVideoAdAfterDocumentReady||(triedPerformLoadVideoAdAfterDocumentReady=!0,onDocumentReady(function(){tryPerformLoadVideoAd()}))}function loadElements(){if(!invibes.VsSentLoadPageStat){invibes.VsSentLoadPageStat=!0;var e=null;invibes.rfc1&&(e=encodeURIComponent(document.cookie).substring(0,4e3)),sendStatwebStats(invibes.isTablet?3:1,null,e)}tryPerformLoadVideoAd()}function loadVideoAdCss(){var e=document.createElement("link");e.async=!0,e.rel="stylesheet",e.type="text/css",e.href=vsConfig.videoAdCss,document.head.appendChild(e)}function start(){loaded||(loaded=!0,loadVideoAdCss(),loadElements())}function startWithoutAdweb(){loaded||(loaded=!0,loadVideoAdCss(),doAjaxVsVideoAdContent())}function sendSewebDuration(){if(!window.VsSentOnBeforeUnloadStats){window.VsSentOnBeforeUnloadStats=!0;var e=(new Date).toISOString(),t=vsConfig.kwebstatUrl+"/Stat/RegisterSewebDuration";t+="?pageId="+invibes.videoAdContentResult.PageId,t+="&startDate="+invibes.vsSewebStartTime,t+="&endDate="+e,t+="&lId="+encodeURIComponent(invibes.dom.id),t+="&vId="+encodeURIComponent(invibes.visitId),t+="&videoExposedId="+invibes.currentAd.VideoExposedId,invibes.jsonp(t)}}}(window,top,document);