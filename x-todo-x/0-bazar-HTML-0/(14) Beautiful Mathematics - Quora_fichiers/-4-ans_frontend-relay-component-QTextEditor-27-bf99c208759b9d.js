(window.ansFrontendRelayWebpackJsonpFunction=window.ansFrontendRelayWebpackJsonpFunction||[]).push([["component-QTextEditor"],{"+c4W":function(e,t,n){var i=n("711d"),o=n("4/ic"),r=n("9ggG"),a=n("9Nap");e.exports=function(e){return r(e)?i(a(e)):o(e)}},"4/ic":function(e,t,n){var i=n("ZWtO");e.exports=function(e){return function(t){return i(t,e)}}},"4sDh":function(e,t,n){var i=n("4uTw"),o=n("03A+"),r=n("Z0cm"),a=n("wJg7"),s=n("shjB"),d=n("9Nap");e.exports=function(e,t,n){for(var c=-1,l=(t=i(t,e)).length,u=!1;++c<l;){var h=d(t[c]);if(!(u=null!=e&&n(e,h)))break;e=e[h]}return u||++c!=l?u:!!(l=null==e?0:e.length)&&s(l)&&a(h,l)&&(r(e)||o(e))}},"4uTw":function(e,t,n){var i=n("Z0cm"),o=n("9ggG"),r=n("GNiM"),a=n("dt0z");e.exports=function(e,t){return i(e)?e:o(e,t)?[e]:r(a(e))}},"711d":function(e,t){e.exports=function(e){return function(t){return null==t?undefined:t[e]}}},"9Nap":function(e,t,n){var i=n("/9aa"),o=1/0;e.exports=function(e){if("string"==typeof e||i(e))return e;var t=e+"";return"0"==t&&1/e==-o?"-0":t}},"9ggG":function(e,t,n){var i=n("Z0cm"),o=n("/9aa"),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(i(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||a.test(e)||!r.test(e)||null!=t&&e in Object(t)}},B9Yq:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},CMye:function(e,t,n){var i=n("GoyQ");e.exports=function(e){return e===e&&!i(e)}},GDhZ:function(e,t,n){var i=n("wF/u"),o=n("mwIZ"),r=n("hgQt"),a=n("9ggG"),s=n("CMye"),d=n("IOzZ"),c=n("9Nap"),l=1,u=2;e.exports=function(e,t){return a(e)&&s(t)?d(c(e),t):function(n){var a=o(n,e);return a===undefined&&a===t?r(n,e):i(t,a,l|u)}}},GNiM:function(e,t,n){var i=n("I01J"),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,a=i(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,function(e,n,i,o){t.push(i?o.replace(r,"$1"):n||e)}),t});e.exports=a},I01J:function(e,t,n){var i=n("44Ds"),o=500;e.exports=function(e){var t=i(e,function(e){return n.size===o&&n.clear(),e}),n=t.cache;return t}},IOzZ:function(e,t){e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(t!==undefined||e in Object(n))}}},JC6p:function(e,t,n){var i=n("cq/+"),o=n("7GkX");e.exports=function(e,t){return e&&i(e,t,o)}},Juji:function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},O7RO:function(e,t,n){var i=n("CMye"),o=n("7GkX");e.exports=function(e){for(var t=o(e),n=t.length;n--;){var r=t[n],a=e[r];t[n]=[r,a,i(a)]}return t}},SKAX:function(e,t,n){var i=n("JC6p"),o=n("lQqw")(i);e.exports=o},ZCpW:function(e,t,n){var i=n("lm/5"),o=n("O7RO"),r=n("IOzZ");e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?r(t[0][0],t[0][1]):function(n){return n===e||i(n,e,t)}}},ZWtO:function(e,t,n){var i=n("4uTw"),o=n("9Nap");e.exports=function(e,t){for(var n=0,r=(t=i(t,e)).length;null!=e&&n<r;)e=e[o(t[n++])];return n&&n==r?e:undefined}},"a+Nv":function(e,t,n){"use strict";n.r(t),n.d(t,"createDoc",function(){return Qe}),n.d(t,"default",function(){return Ve});var i={};n.r(i),n.d(i,"default",function(){return H});var o={};n.r(o),n.d(o,"default",function(){return ee});var r=n("iJoy"),a=n.n(r),s=n("8ZkK"),d=n.n(s),c=n("tQZz"),l=n.n(c),u=n("7eVb"),h=n.n(u),f=n("n3k3"),p=n.n(f),m=n("10u2"),g=n.n(m),v=n("g8yt"),b=n.n(v),y=n("q1tI"),S=n("i8i4"),x=n.n(S),_=n("sEfC"),C=n.n(_),E=n("odos"),T=n("nwxp"),k=n("yju1"),w=n("SKAY"),I=n("nqCt"),O=n("mVMq"),M=n("edYY"),R=n("P6tR"),N=n("RA+f"),L=n("VwdU"),A=n("0xW3"),D=n("8lmh"),P=n("jufJ"),U=n("Y+p1"),B=n.n(U),F=n("jQsN"),j=n.n(F),q=n("tcRq"),Q=n.n(q),V=n("vOnD"),z=function(){var e=[{kind:"LocalArgument",name:"query",type:"String!",defaultValue:null}],t=[{kind:"Literal",name:"limit",value:10},{kind:"Variable",name:"query",variableName:"query"},{kind:"Literal",name:"querySource",value:7},{kind:"Literal",name:"queryType",value:31}],n={kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},i={kind:"ScalarField",alias:null,name:"__typename",args:null,storageKey:null},o={kind:"ScalarField",alias:null,name:"uid",args:null,storageKey:null},r={kind:"ScalarField",alias:null,name:"profileUrl",args:null,storageKey:null},a={kind:"ScalarField",alias:null,name:"handle",args:null,storageKey:null},s={kind:"ScalarField",alias:null,name:"url",args:null,storageKey:null},d={kind:"ScalarField",alias:null,name:"tribeId",args:null,storageKey:null},c={kind:"ScalarField",alias:null,name:"tid",args:null,storageKey:null},l=[i,n,{kind:"ScalarField",alias:null,name:"reverseOrder",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"givenName",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"familyName",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"scriptCode",args:null,storageKey:null}],u=[{kind:"Literal",name:"size",value:100}],h={kind:"ScalarField",alias:null,name:"name",args:null,storageKey:null};return{kind:"Request",fragment:{kind:"Fragment",name:"QTextLinkSelectorQuery",type:"QueryRoot",metadata:null,argumentDefinitions:e,selections:[{kind:"LinkedField",alias:null,name:"searchQuery",storageKey:null,args:t,concreteType:null,plural:!0,selections:[n,i,{kind:"FragmentSpread",name:"QTextLinkSelectorResult_searchQuery",args:null},{kind:"InlineFragment",type:"UserSearchResult",selections:[{kind:"LinkedField",alias:null,name:"user",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[n,i,o,r,{kind:"FragmentSpread",name:"UserName_user",args:null}]}]},{kind:"InlineFragment",type:"TribeSearchResult",selections:[{kind:"LinkedField",alias:null,name:"tribe",storageKey:null,args:null,concreteType:"Tribe",plural:!1,selections:[n,i,a,s,d,{kind:"FragmentSpread",name:"TribeName_tribe",args:null}]}]},{kind:"InlineFragment",type:"TopicSearchResult",selections:[{kind:"LinkedField",alias:null,name:"topic",storageKey:null,args:null,concreteType:"Topic",plural:!1,selections:[n,i,s,c,{kind:"FragmentSpread",name:"TopicName_topic",args:null}]}]}]}]},operation:{kind:"Operation",name:"QTextLinkSelectorQuery",argumentDefinitions:e,selections:[{kind:"LinkedField",alias:null,name:"searchQuery",storageKey:null,args:t,concreteType:null,plural:!0,selections:[n,i,{kind:"InlineFragment",type:"UserSearchResult",selections:[{kind:"LinkedField",alias:null,name:"user",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[n,i,o,{kind:"ScalarField",alias:null,name:"isAnon",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"profileImageUrl",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"isVerified",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"businessStatus",args:null,storageKey:null},r,{kind:"ScalarField",alias:null,name:"useTranslatedName",args:null,storageKey:null},{kind:"LinkedField",alias:null,name:"names",storageKey:null,args:null,concreteType:"UserName",plural:!0,selections:l},{kind:"LinkedField",alias:null,name:"adminNames",storageKey:null,args:null,concreteType:"UserName",plural:!0,selections:l},{kind:"Condition",passingValue:!0,isCustom:!0,customValue:{name:"annotate_with_ids",value:"true"},condition:"onGate",selections:[{kind:"ScalarField",alias:null,name:"debugInfo",args:null,storageKey:null}]}]}]},{kind:"InlineFragment",type:"TribeSearchResult",selections:[{kind:"LinkedField",alias:null,name:"tribe",storageKey:null,args:null,concreteType:"Tribe",plural:!1,selections:[n,i,d,s,{kind:"ScalarField",alias:null,name:"iconUrl",args:u,storageKey:"iconUrl(size:100)"},h,a]}]},{kind:"InlineFragment",type:"TopicSearchResult",selections:[{kind:"LinkedField",alias:null,name:"topic",storageKey:null,args:null,concreteType:"Topic",plural:!1,selections:[n,i,c,s,{kind:"ScalarField",alias:null,name:"photoUrl",args:u,storageKey:"photoUrl(size:100)"},h]}]}]}]},params:{operationKind:"query",name:"QTextLinkSelectorQuery",id:"a7e90a891169eb5bd85e71d03c2f5d88d163e3f42286d6241ad872dcd1eee356",text:null,metadata:{}}}}();z.hash="06fa356feee54a8887687365d9382d24";var H=z,K=n("VyO/"),W=n("NldC"),J=n("cztr"),Y=n("R+um"),G=n("cecZ"),X=n("PuWf"),Z=function(){var e={kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},t={kind:"ScalarField",alias:null,name:"__typename",args:null,storageKey:null};return{kind:"Fragment",name:"QTextLinkSelectorResult_searchQuery",type:"SearchResult",metadata:null,argumentDefinitions:[],selections:[e,t,{kind:"InlineFragment",type:"UserSearchResult",selections:[{kind:"LinkedField",alias:null,name:"user",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[e,t,{kind:"FragmentSpread",name:"UserPhoto_user",args:null},{kind:"FragmentSpread",name:"UserName_user",args:null}]}]},{kind:"InlineFragment",type:"TribeSearchResult",selections:[{kind:"LinkedField",alias:null,name:"tribe",storageKey:null,args:null,concreteType:"Tribe",plural:!1,selections:[e,t,{kind:"FragmentSpread",name:"TribeIcon_tribe",args:null},{kind:"FragmentSpread",name:"TribeName_tribe",args:null}]}]},{kind:"InlineFragment",type:"TopicSearchResult",selections:[{kind:"LinkedField",alias:null,name:"topic",storageKey:null,args:null,concreteType:"Topic",plural:!1,selections:[e,t,{kind:"FragmentSpread",name:"TopicPhoto_topic",args:null},{kind:"FragmentSpread",name:"TopicName_topic",args:null}]}]}]}}();Z.hash="69f10dcdf277c153c1fa76ce60b7ec04";var $,ee=Z,te=n("wl2v"),ne=n("r+vq"),ie=n("n2ec"),oe=n("MI6j"),re=function(e){function t(){return d()(this,t),h()(this,p()(t).apply(this,arguments))}return g()(t,e),l()(t,[{key:"render",value:function(){var e=this.props.searchQuery,t=e.user,n=e.topic,i=e.tribe,o={size:"dense",borderBottom:!0,hover:{_:{backgroundColor:"gray_ultralight",color:"blue_dark"}}};return t?y.createElement(oe.b,Object.assign({icon:y.createElement(ne.a,{linked:!1,user:t,includeHovercard:!1}),mainText:y.createElement(Y.a,{user:t}),subText:Object(P.K)("(user)")},o)):n?y.createElement(oe.b,Object.assign({icon:y.createElement(te.a,{link:!1,topic:n}),mainText:y.createElement(G.a,{topic:n}),subText:Object(P.K)("(topic)")},o)):i?y.createElement(oe.b,Object.assign({icon:y.createElement(ie.a,{linked:!1,tribe:i,includeHovercard:!1}),mainText:y.createElement(X.a,{tribe:i}),subText:Object(P.K)("(space)")},o)):null}}]),t}(y.Component);re.displayName="QTextLinkSelectorResult",re.fragments={searchQuery:void 0!==$?$:$=o};var ae,se=Object(K.b)(re),de=void 0!==ae?ae:ae=i,ce=Object(V["default"])(N.a).withConfig({displayName:"QTextLinkSelector___StyledAbsolute",componentId:"sc-1vcxixy-0"})(["input{padding-top:2px;padding-left:2px;margin-bottom:-1px;}"]),le=function(e){function t(e){var n;return d()(this,t),(n=h()(this,p()(t).call(this,e)))._onSubmitCallback=W.h,n.handleInputChange=function(e){n.setState({input:e})},n.handleOnChange=function(e){if(e.data){var t=e.data,i=t.tribe,o=t.topic,r=t.user;i?n._onSubmitCallback({text:Object(P.K)(y.createElement(X.a,{tribe:i})),target:{type:"tribe",tribe_id:i.tribeId,url:i.handle?i.handle:i.url}}):o?n._onSubmitCallback({text:Object(P.K)(y.createElement(G.a,{topic:o})),target:{type:"topic",tid:o.tid,url:o.url}}):r&&n._onSubmitCallback({text:Object(P.K)(y.createElement(Y.a,{user:r})),target:{type:"user",uid:r.uid,url:r.profileUrl||""}})}},n.state={active:!1,toolbar:undefined,x:0,y:0,isRtl:!1,docNode:undefined,doc:undefined,input:""},n}return g()(t,e),l()(t,[{key:"setEditorToolbar",value:function(e){this.setState({toolbar:e})}},{key:"setDocNode",value:function(e,t){this.setState({docNode:e,doc:t})}},{key:"isActive",value:function(){return this.state.active}},{key:"show",value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,o=arguments.length>3&&arguments[3]!==undefined&&arguments[3];if(T.n)this.props.openModal({method:"link_selector_modal",onSubmit:this.handleWebnodeBridgeSubmit.bind(this),onClose:function(){t.props.onClose&&t.props.onClose()}});else{var r=o?n-200:n,a=i-3;this.setState({active:!0,x:r,y:a,isRtl:o})}this.props.onOpen&&this.props.onOpen()}},{key:"hide",value:function(){this.setState({active:!1,key:""}),!T.n&&this.props.onClose&&this.props.onClose()}},{key:"cancel",value:function(){this.setState({active:!1})}},{key:"onSubmit",value:function(e){this._onSubmitCallback=e}},{key:"onCancel",value:function(e){}},{key:"getExternalURL",value:function(e,t,n){this.state.toolbar&&this.state.toolbar.setupLinkInput(e)}},{key:"getLinkPreview",value:function(e,t,n){Object(O.a)("/qtext/get_link_preview_POST",{json:JSON.stringify({args:[],kwargs:{url:e}})}).then(function(e){return t(e.data.value)})["catch"](n)}},{key:"handleWebnodeBridgeSubmit",value:function(e){if(e){var t=e.target,n=e.text,i=e.url;this._onSubmitCallback({text:n,target:Object.assign({},t,{url:i})})}}},{key:"render",value:function(){var e=this;return y.createElement(y.Fragment,null,this.state.active?y.createElement(ce,{top:this.state.y-3,display:"flex",width:"200px",zIndex:"popover",style:{left:this.state.x}},y.createElement(N.s,{mr:"tiny",pt:"tiny",color:"blue_dark"},Object(P.K)("@")),y.createElement(J.a,{async:!0,options:Q()(j.a.mark(function t(){var n,i,o,r,a,s,d;return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.props.client.query({query:de,variables:{query:null!==(n=e.state.input)&&void 0!==n?n:""},fetchPolicy:"store-or-network"});case 2:if(i=t.sent,o=i.data,r=[],o)for(a=0;a<o.searchQuery.length;a++)s="",d=o.searchQuery[a],s=d.user?Object(P.K)(y.createElement(Y.a,{user:d.user})):d.tribe?Object(P.K)(y.createElement(X.a,{tribe:d.tribe})):d.topic?Object(P.K)(y.createElement(G.a,{topic:d.topic})):Object(P.L)(""),r.push({item:y.createElement(se,{searchQuery:d}),title:Object(P.L)(s),data:d});return t.abrupt("return",r);case 7:case"end":return t.stop()}},t)})),inputPlaceholder:Object(P.K)("Search"),limit:9,onChange:this.handleOnChange,onInputChange:this.handleInputChange,emptyInputCallback:function(){e.setState({active:!1}),e.state.docNode.qtextContainer.focus()},autoFocus:!0,inputWrapperProps:{compact:!0},listProps:{bg:"white",borderAll:!0}})):null)}}]),t}(y.Component);le.displayName="QTextLinkSelector",le.queries={selector:de};var ue=Object(K.f)(le),he=n("NvBY"),fe=n("LJFN"),pe=function(e){var t=e.count,n=void 0===t?0:t;return y.createElement(P.A,null,y.createElement(P.y,{value:n},{ONE:"There was an error uploading this file.",OTHER:"There was an error uploading these files."}))};pe.displayName="UploadErrorMessage";var me=function(e){function t(e){var n;return d()(this,t),(n=h()(this,p()(t).call(this,e))).fileInputRef=void 0,n._objectUrlToFileMap={},n._errorObjectUrltoFileMap={},n._onPendingImageUploadSuccess=function(e,t){var i,o;if((null===e||void 0===e?void 0:e.success)&&(null===e||void 0===e?void 0:e.qimg_urls.length)>0){var r={};Object.keys(n._objectUrlToFileMap).forEach(function(t,n){r[t]=e.qimg_urls[n]}),n._objectUrlToFileMap={},t(r)}null===(i=(o=n.props).onImageUploadStatusChange)||void 0===i||i.call(o,fe.b.ready)},n._onPendingImageUploadError=function(e,t){var i,o;null===(i=(o=n.props).onImageUploadStatusChange)||void 0===i||i.call(o,fe.b.ready),n._onError(e),n._errorObjectUrltoFileMap=Object.assign({},n._errorObjectUrltoFileMap,{},n._objectUrlToFileMap),n._objectUrlToFileMap={},t(Object.keys(n._errorObjectUrltoFileMap))},n.uploadImagesFromLocalFileUrls=function(){var e=Q()(j.a.mark(function t(e){var i,o,r;return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.props.useEagerImageUploading){t.next=7;break}return t.next=3,Promise.all(e.map(function(){var e=Q()(j.a.mark(function t(e){return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(fe.c)(e));case 1:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}()));case 3:r=t.sent,e.forEach(function(e,t){n._objectUrlToFileMap[e]=r[t]}),null===(i=(o=n.props).onImageUploadStatusChange)||void 0===i||i.call(o,fe.b.uploading),n.props.onAddImages&&n.props.onAddImages(e,!0);case 7:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),n.state={visible:!1,count:0,error:!1},n.fileInputRef=y.createRef(),n.onInputChange=n.onInputChange.bind(b()(b()(n))),n.onDrop=n.onDrop.bind(b()(b()(n))),n._onUpload=n._onUpload.bind(b()(b()(n))),n._onError=n._onError.bind(b()(b()(n))),n.props.doc.on("paste",function(e){return n._onPaste(e)}),n}return g()(t,e),l()(t,[{key:"showUploading",value:function(e){this.setState({visible:!0,error:!1,count:e})}},{key:"showDropZone",value:function(){this.setState({visible:!0,error:!1,count:0})}},{key:"hideDropZone",value:function(){this.setState({visible:!1,count:0})}},{key:"_onUpload",value:function(e){this.props.onAddImages&&this.props.onAddImages(e.qimg_urls,!1),this.hideDropZone()}},{key:"_onError",value:function(e){(null===e||void 0===e?void 0:e.message)?alert(e.message):alert(Object(P.K)(y.createElement(pe,{count:this.state.count}))),this.hideDropZone()}},{key:"_onPaste",value:function(e){var t=e.clipboardData,n=[];if(t&&t.items){for(var i=0;i<t.items.length;++i){var o=t.items[i].type;(o.match(/image/i)||o.match(/file/i))&&n.push(t.items[i].getAsFile())}this.startUpload(n)}}},{key:"startUpload",value:function(e){var t=this;if(0!==e.length)if(this.props.useEagerImageUploading){var n,i,o=Array.from(e).map(function(e){var n=URL.createObjectURL(e);return t._objectUrlToFileMap[n]=e,n});this.props.onAddImages&&this.props.onAddImages(o,!0),null===(n=(i=this.props).onImageUploadStatusChange)||void 0===n||n.call(i,fe.b.uploading),this.hideDropZone()}else this.showUploading(e.length),Object(he.b)({kind:"qtext"},e,this._onUpload,this._onError);else this.hideDropZone()}},{key:"onInputChange",value:function(){var e=this.fileInputRef.current;this.startUpload(e.files),e.value=null}},{key:"onDrop",value:function(e){if(e.preventDefault(),e.stopPropagation(),e.dataTransfer&&e.dataTransfer.files){for(var t=[],n=0;n<e.dataTransfer.files.length;++n){var i=e.dataTransfer.files[n].type;(i.match(/image/i)||i.match(/file/i))&&t.push(e.dataTransfer.files[n])}this.startUpload(t)}else this.hideDropZone()}},{key:"triggerUpload",value:function(){this.fileInputRef.current.click()}},{key:"uploadImageUrl",value:function(e,t){var n=this;Object(O.a)("/qtext/upload_image_url_POST",{json:JSON.stringify({args:[],kwargs:{url:e}})}).then(function(e){var i=(e||{}).data;i?i.value?t(i.value):i.error&&n._onError(i):n._onError(i)})["catch"](this._onError)}},{key:"uploadPendingImages",value:function(e,t,n){var i=this;if(e.length>0){var o=e.map(function(e){return i._objectUrlToFileMap[e]});Object(he.b)({kind:"qtext"},o,function(e){return i._onPendingImageUploadSuccess(e,t)},function(e){return i._onPendingImageUploadError(e,n)})}}},{key:"retryUpload",value:function(e,t){this._objectUrlToFileMap=Object.assign({},this._errorObjectUrltoFileMap),this._errorObjectUrltoFileMap={};var n=Object.keys(this._objectUrlToFileMap);this.uploadPendingImages(n,e,t)}},{key:"render",value:function(){var e=this,t=this.state,n=t.visible,i=void 0!==n&&n,o=t.count,r=void 0===o?0:o,a=t.error,s=void 0===a?null:a,d={bg:i?"white_transparent_light":null,borderColor:i?"blue":"transparent",borderWidth:"4px",borderStyle:"dashed",display:i?"flex":"none"};return y.createElement(y.Fragment,null,y.createElement("input",{type:"file",accept:".jpg, .png, .jpeg, .gif, .bmp|images/*",multiple:!0,ref:this.fileInputRef,style:{display:"none"},onChange:this.onInputChange}),y.createElement(N.a,Object.assign({full:!0,className:"drop_zone",alignItems:"center",justifyContent:"center"},d,{onDrop:this.onDrop,onDragOver:function(e){return e.preventDefault()},onDragLeave:function(){return e.hideDropZone()},onClick:function(){e.hideDropZone()},zIndex:"inline_overlay"}),i?y.createElement(N.s,{color:"blue",medium:!0,fontSize:"22px"},s?y.createElement(pe,{count:r}):y.createElement(P.A,null,y.createElement(P.y,{value:r},{ZERO:"Drop images here",ONE:y.createElement(y.Fragment,null,"Uploading ",y.createElement(P.h,{value:r})," image..."),OTHER:y.createElement(y.Fragment,null,"Uploading ",y.createElement(P.h,{value:r})," images...")}))):null))}}]),t}(y.Component);me.defaultProps={onAddImages:W.h};var ge=n("YXhY"),ve=n("k4Da"),be=n.n(ve),ye=function(e){function t(e){var n;return d()(this,t),(n=h()(this,p()(t).call(this,e))).state={hyperlinkEmbeds:[]},n}return g()(t,e),l()(t,[{key:"insertHyperlinkEmbedPreview",value:function(e){this.setState(function(t){return{hyperlinkEmbeds:[].concat(a()(t.hyperlinkEmbeds),[e])}})}},{key:"removeHyperlinkEmbedPreview",value:function(e){this.setState(function(t){return{hyperlinkEmbeds:be()(t.hyperlinkEmbeds,function(t){return t.placeholder!==e.placeholder})}})}},{key:"render",value:function(){return y.createElement(y.Fragment,null,this.state.hyperlinkEmbeds.map(function(e){return x.a.createPortal(y.createElement(ge.a,{span:{text:"",modifiers:{embed:e.data}},omitBottomMargin:!0,readOnly:!0}),e.placeholder)}))}}]),t}(y.Component);ye.displayName="QTextHyperlinkEmbedManager";var Se=n("OMLc"),xe=n("/bbo"),_e=n("cbxS"),Ce="\n  user-select: none !important;\n  -webkit-user-select: none !important;\n  -ms-user-select: none !important;\n  line-height: 21px !important;\n",Ee=Object(V["default"])(N.a).withConfig({displayName:"QTextUploadRetryManager___StyledAbsolute",componentId:"sc-16mzks9-0"})(["",""],Ce),Te=Object(V["default"])(N.a).withConfig({displayName:"QTextUploadRetryManager___StyledAbsolute2",componentId:"sc-16mzks9-1"})(["",""],Ce),ke=function(e){function t(){var e,n;d()(this,t);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(n=h()(this,(e=p()(t)).call.apply(e,[this].concat(o)))).state={imgSections:[]},n}return g()(t,e),l()(t,[{key:"insertButtonAndBanner",value:function(e){this.setState(function(t){return{imgSections:[].concat(a()(t.imgSections),[e])}})}},{key:"removeButtonAndBanner",value:function(e){this.setState(function(t){return{imgSections:be()(t.imgSections,function(t){return t.button!==e.button&&t.banner!==e.banner})}})}},{key:"renderButton",value:function(){return y.createElement(Ee,{center:!0,contentEditable:!1},y.createElement(xe.a,{variant:"blue",text:Object(P.K)("Retry"),icon:y.createElement(Se.a,{name:"Sync"})}))}},{key:"renderBanner",value:function(){return y.createElement(Te,{fullX:!0,bottom:"0%",contentEditable:!1},y.createElement(_e.a,{p:"tiny",buttonVariant:"error",variant:"warning_inverted",icon:y.createElement(Se.a,{name:"Error"}),translatedText:Object(P.K)("Image failed to upload.")}))}},{key:"render",value:function(){var e=this;return y.createElement(y.Fragment,null,this.state.imgSections.map(function(t){return y.createElement(y.Fragment,null,x.a.createPortal(e.renderButton(),t.button),x.a.createPortal(e.renderBanner(),t.banner))}))}}]),t}(y.Component);ke.displayName="QTextUploadRetryManager";var we=n("AFGi"),Ie=n("bmMU"),Oe=n.n(Ie),Me=function(e){function t(e){var n;return d()(this,t),(n=h()(this,p()(t).call(this,e))).currentActiveToolbar=void 0,n.editorKey="",n.currentActiveToolbar=-1,n}return g()(t,e),l()(t,[{key:"shouldComponentUpdate",value:function(e,t){return!Oe()(this.currentActiveToolbar,e.activeToolbar)||!Oe()(this.props.buttonStates,e.buttonStates)||!Oe()(this.state,t)}},{key:"handleToolbarAction",value:function(e){var t=e.eventName,n=e.args,i=this.props,o=i.onButtonClick,r=i.onLinkInput,a=i.onImageUpload,s=i.onImageSelected;switch(t){case"click":o(n);break;case"linkInput":r(n);break;case"imageUpload":a(n);break;case"imageSelected":s(n)}}},{key:"getButtonParams",value:function(e,t){if(2!==t){var n=[],i=[],o=this.props.onRulesButtonClick;return e.forEach(function(e){"rules"===e.name?o&&i.push(Object.assign({},e,{text:Object(P.K)("Rules")})):"dismiss"===e.name?i.push(e):n.push(e)}),Object.assign({buttons:n},i.length>0?{stickyButtons:i,stickyButtonsAlign:0===t?"end":"start"}:{})}return{buttons:e}}},{key:"sendToolbarUpdateMessage",value:function(){var e=this.props,t=e.buttonStates,n=e.activeToolbar;e.isLightWeightContentStyle?Object(k.a)("updateToolbar",Object.assign({},this.getButtonParams(t[n],n),{animation:this.currentActiveToolbar<n?"up":this.currentActiveToolbar>n?"down":null,lightweight:!0})):Object(k.a)("updateToolbar",{buttons:t[n],animation:this.currentActiveToolbar<n?"up":this.currentActiveToolbar>n?"down":null}),this.currentActiveToolbar!==n&&(this.currentActiveToolbar=n)}},{key:"componentDidMount",value:function(){var e=this;Object(A.handleEventFromWebnode)("qtextNativeToolbarAction",function(t){e.handleToolbarAction(t)}),this.sendToolbarUpdateMessage()}},{key:"componentWillUnmount",value:function(){Object(k.a)("hideEditorToolbar")}},{key:"componentDidUpdate",value:function(){this.sendToolbarUpdateMessage()}},{key:"render",value:function(){return y.createElement(y.Fragment,null)}}]),t}(y.Component);Me.displayName="NativeQTextEditorToolbar";var Re=n("f5aN"),Ne=n("zLpq"),Le=n("MzdU"),Ae={bold:y.createElement(Se.a,{name:"EditorBold"}),italic:y.createElement(Se.a,{name:"EditorItalicize"}),ordered_list:y.createElement(Se.a,{name:"EditorOrderedListBidi"}),unordered_list:y.createElement(Se.a,{name:"EditorUnorderedListBidi"}),indent:y.createElement(Se.a,{name:"EditorIndentBidi"}),deindent:y.createElement(Se.a,{name:"EditorDeindentBidi"}),image:y.createElement(Se.a,{name:"EditorPhotos"}),link:y.createElement(Se.a,{name:"EditorLink"}),overflow_show:y.createElement(Se.a,{name:"Overflow"}),mention:y.createElement(Se.a,{name:"EditorMention"}),quote:y.createElement(Se.a,{name:"EditorQuote"}),code:y.createElement(Se.a,{name:"EditorCode"}),math:y.createElement(Se.a,{name:"EditorMath"}),undo:y.createElement(Se.a,{name:"EditorUndo"}),redo:y.createElement(Se.a,{name:"EditorRedo"}),overflow_hide:y.createElement(Se.a,{name:"Close"}),text_formatting:y.createElement(Se.a,{name:"EditorTextFormatting"}),h1:y.createElement(Se.a,{name:"H1Font"})},De=function(e){var t=e.name,n=e.icon,i=e.pressed,o=void 0!==i&&i,r=e.disabled,a=void 0!==r&&r,s=e.onClick,d=o?"blue":"gray",c=o?"gray":"transparent",l=a?.5:1;return y.createElement(N.n,{alignItems:"center",justifyContent:"center",size:"30px",mr:"small",borderRadius:"small",borderAll:T.j,borderColor:c,opacity:l,transition:"border-color",cursor:"pointer",hover:{borderColor:"blue"}},y.createElement(N.e,{onClick:function(e){(e.preventDefault(),a)||s&&s(t,!o)}},y.cloneElement(n,{color:d,isFilled:o})))};De.displayName="ToolbarButton";var Pe=Object(V["default"])(N.f).withConfig({displayName:"ReactQTextEditorToolbar___StyledCssComponent",componentId:"sc-1egumr2-0"})(["input::placeholder{direction:",";text-align:",";}"],function(e){return e._css},function(e){return e._css2}),Ue=function(e){function t(e){var n;return d()(this,t),(n=h()(this,p()(t).call(this,e))).linkRef=void 0,n.citationRef=void 0,n.linkRef=y.createRef(),n.citationRef=y.createRef(),n}return g()(t,e),l()(t,[{key:"saveLink",value:function(){var e,t=this.props.onLinkInput,n=this.linkRef.current.value,i=null===(e=this.citationRef.current)||void 0===e?void 0:e.checked;this.citationRef.current&&(this.linkRef.current.value="",this.citationRef.current.checked=!1),t({url:n,isCitation:i})}},{key:"closeLink",value:function(){(0,this.props.onLinkInput)({})}},{key:"componentDidUpdate",value:function(e){var t=this;this.props.isLightWeightContentStyle?2===this.props.activeToolbar&&2!==e.activeToolbar&&setTimeout(function(){t.linkRef.current.focus()},200):0===this.props.activeToolbar&&0!==e.activeToolbar&&this.linkRef.current.focus()}},{key:"renderLinkInput",value:function(){var e=this;return y.createElement(N.h.Consumer,{key:"toolbar-link-input-wrapper"},function(t){return y.createElement(Pe,{_css:t===N.c.RTL?"rtl":"ltr",_css2:t===N.c.RTL?"right":"left"},y.createElement(N.o,{key:"toolbar-link-input",type:"url",innerRef:e.linkRef,placeholder:Object(P.K)("Enter URL"),flex:"auto",px:"tiny",mr:"small",color:"gray_dark",fontSize:"15px",fontFamily:"sans",style:{outline:"none",border:"none"},onKeyUp:function(t){"Escape"==t.key&&e.closeLink(),"Enter"==t.key&&e.saveLink()}}))})}},{key:"renderCitationCheckbox",value:function(){return y.createElement(N.n,{key:"toolbar-citation-checkbox",pr:"small",alignItems:"center"},y.createElement("input",{id:"is_citation",ref:this.citationRef,type:"checkbox"}),y.createElement(N.s,{as:"label",ml:"tiny",htmlFor:"is_citation",color:"gray_light",fontSize:"tiny"},y.createElement(P.A,null,"Footnote")))}},{key:"renderLinkSaveButton",value:function(){var e=this;return y.createElement(N.d,{key:"toolbar-link-save-button",as:"button",type:"button",px:"10px",py:"6px",mr:"small",borderRadius:"small",color:"gray_light",bg:"gray_ultralight",style:{border:"none"},onClick:function(){e.saveLink()}},y.createElement(N.s,{bold:!0,fontSize:"small"},y.createElement(P.A,null,"Add")))}},{key:"renderRulesButton",value:function(){var e=this.props,t=e.isLightWeightContentStyle,n=e.onRulesButtonClick;return t&&n?y.createElement(Ne.a,{key:"rules",onClick:function(e){e.preventDefault(),n()},mr:"small",icon:y.createElement(Se.a,{name:"Info"}),text:Object(P.K)("Rules"),size:T.n?"small":"regular"}):null}},{key:"renderHideOverflowButton",value:function(e){var t=e.pressed,n=e.onClick;return y.createElement(N.n,{key:"toolbar-button-overflow_hidden",alignItems:"center",justifyContent:"center",size:"30px",ml:T.j?"":"tiny",mr:"small",transition:"border-color",cursor:"pointer"},y.createElement(N.e,{onClick:function(e){e.preventDefault(),n&&n(name,!t)}},y.createElement(Le.a,{bg:"blue",borderRadius:"circle",size:24,iconName:"ChevronDown"})))}},{key:"onButtonClick",value:function(e){var t=this.props.onButtonClick;t(e)}},{key:"renderButton",value:function(e){var t=this,n=e.name,i=e.pressed,o=void 0!==i&&i,r=e.disabled,a=void 0!==r&&r;switch(n){case"link_input_icon":return y.createElement(Se.a,{key:"toolbar_link_input_icon",color:"blue",name:"EditorLink"});case"link_input":return this.renderLinkInput();case"cite":return this.renderCitationCheckbox();case"link_save":return this.renderLinkSaveButton();case"rules":return this.renderRulesButton();case"dismiss":return this.renderHideOverflowButton({pressed:o,onClick:function(){return t.onButtonClick(n)}});default:return y.createElement(De,{key:"toolbar-button-".concat(n),name:n,icon:Ae[n],onClick:function(){return t.onButtonClick(n)},pressed:o,disabled:a})}}},{key:"renderLightWeightContentTextFormattingOptions",value:function(){var e=this,t=this.props,n=t.buttonStates,i=t.isLightWeightContentStyle,o=n[1].find(function(e){return"dismiss"===e.name}),r=n[1].filter(function(e){return"dismiss"!==e.name});return y.createElement(N.j,{key:"editor-toolbar-1",alignItems:"center",px:i?"":"tiny",height:"".concat(44,"px")},o&&this.renderButton(o),y.createElement(Re.b,null,r.map(function(t){return e.renderButton(t)})))}},{key:"renderBar",value:function(e){var t=this,n=this.props,i=n.buttonStates,o=n.isLightWeightContentStyle,r=function(e){var t=e.findIndex(function(e){return"space"==e.name});return-1==t?{leftButtons:e,rightButtons:[]}:{leftButtons:e.slice(0,t),rightButtons:e.slice(t+1)}}(i[e]),a=r.leftButtons,s=r.rightButtons;return y.createElement(N.j,{key:"editor-toolbar-".concat(e),alignItems:"center",justifyContent:"space-between",px:o?"":"tiny",height:"".concat(44,"px")},y.createElement(N.n,{flex:1},a.map(function(e){return t.renderButton(e)})),y.createElement(N.n,{mr:"n_small"},s.map(function(e){return t.renderButton(e)})))}},{key:"render",value:function(){var e,t=this,n=this.props,i=n.activeToolbar,o=n.isBottomOfEditor,r=n.isLightWeightContentStyle,a="-".concat(44*i,"px"),s=!T.j&&r;return y.createElement(y.Fragment,null,y.createElement(N.q,{mt:null!==(e=o&&!r?14:null)&&void 0!==e?e:undefined,borderBottom:!o&&!s,borderWidth:"regular",overflow:"hidden",height:"".concat(44,"px")},y.createElement(N.a,{fullX:!0,ml:T.j?"small":"n_tiny",top:a,transition:"top",transitionDuration:"0.25s"},[0,1,2].map(function(e){return r&&1===e?t.renderLightWeightContentTextFormattingOptions():t.renderBar(e)}))),!o&&s&&y.createElement(N.a,{fullX:!0,width:"100%",borderBottom:!0,borderWidth:"regular"}))}}]),t}(y.Component);Ue.displayName="ReactQTextEditorToolbar",Ue.defaultProps={isBottomOfEditor:!1};var Be=function(e){return[0,1,2].map(function(t){return e.getToolbarState(t)})},Fe=function(e){function t(e){var n;return d()(this,t),(n=h()(this,p()(t).call(this,e))).saveLinkCallback=void 0,n._isMounted=!1,n.refreshButtonStates=function(){var e=n.props.doc;e&&n._isMounted&&n.setState({buttonStates:Be(e)})},n.onImageSelected=function(e){n.props.imageUploaderRef.current&&n.props.imageUploaderRef.current.uploadImagesFromLocalFileUrls(e)},n.state={activeToolbar:e.isLightWeightContentStyle?0:1,buttonStates:n.props.doc?Be(n.props.doc):[]},n}return g()(t,e),l()(t,[{key:"componentDidMount",value:function(){var e,t;this._isMounted=!0,null===(e=this.props.doc)||void 0===e||e.on("updateToolbar",C()(this.refreshButtonStates,100,{leading:!1,trailing:!0})),null===(t=this.props.doc)||void 0===t||t.on("meaningfulChange",C()(this.refreshButtonStates,300,{leading:!1,trailing:!0}))}},{key:"shouldComponentUpdate",value:function(e,t){return!Oe()(this.props,e)||!Oe()(this.state,t)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"onButtonClick",value:function(e){var t=this.props,n=t.doc,i=t.imageUploaderRef,o=t.isLightWeightContentStyle,r=t.onRulesButtonClick;if(o)switch(e){case"text_formatting":this.setState({activeToolbar:1});break;case"dismiss":this.setState({activeToolbar:0});break;case"rules":r&&r();break;case"photo":case"image":return void(i.current&&i.current.triggerUpload())}else switch(e){case"overflow_show":this.setState({activeToolbar:2});break;case"overflow_hide":this.setState({activeToolbar:1});break;case"image":return void(i.current&&i.current.triggerUpload())}var a=[e,null,{source:"toolbar",button:e}];null===n||void 0===n||n.handleCommand.apply(n,a),this.refreshButtonStates(),"link"!==e&&(null===n||void 0===n||n.focus())}},{key:"setupLinkInput",value:function(e){this.saveLinkCallback=e,this.props.isLightWeightContentStyle?this.setState({activeToolbar:2}):this.setState({activeToolbar:0})}},{key:"onLinkInput",value:function(e){var t=e.url,n=e.isCitation;t&&this.saveLinkCallback&&this.saveLinkCallback({url:t,isCitation:n}),this.saveLinkCallback=undefined,this.setState({activeToolbar:1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.doc,i=t.onImageUpload,o=t.isBottomOfEditor,r=t.isLightWeightContentStyle,a=t.onRulesButtonClick,s=this.state,d=s.activeToolbar,c=s.buttonStates,l=Object(T.f)()?Me:Ue;return n&&y.createElement(l,{activeToolbar:d,onButtonClick:function(t){return e.onButtonClick(t)},onLinkInput:function(t){var n=t.url,i=void 0===n?"":n,o=t.isCitation,r=void 0!==o&&o;return e.onLinkInput({url:i,isCitation:r})},onImageUpload:function(e){return i(e)},onImageSelected:this.onImageSelected,buttonStates:c,isBottomOfEditor:o,isLightWeightContentStyle:r,onRulesButtonClick:a})}}]),t}(y.Component);Fe.displayName="QTextEditorToolbar",Fe.defaultProps={isBottomOfEditor:!1,isLightWeightContentStyle:!1};var je=n("nW6E"),qe=function(){return null},Qe=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:Object(we.f)(),t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"",i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return new E.Doc(e,function(){var e=n("kI88");return{isMobile:Object(T.d)(),isIPad:T.m,isIOSApp:Object(T.c)(),isAndroidApp:Object(T.a)(),isNativeApp:Object(T.f)(),isIOS:T.l,isAndroid:T.i,isIOSMobileWeb:Object(T.e)()&&T.l,buildNumber:Object(w.getBuildNumber)()||0,debug:Object(w.getDebugToolsEnabled)(),isMSEdge:!!e.msedge,isMSIE:!!e.msie,isGecko:!!e.gecko,isWebkit:!!e.webkit,isFirefox:!!e.firefox,webkitVersion:0,isUIWebView:Object(T.g)(),osVersion:parseFloat(e.osversion)}}(),function(e,t){var n=Object(I.a)("DefaultContentBidiDirectionIsRTL",!1)?"RTL":"LTR",i={enableSmartQuotes:Object(I.a)("SmartQuotesEnabled",!0),defaultDirection:n,tabbedEditorToolbar:Object(T.f)(),imageRemoveButtonEnabled:!1,qtext_hyperlink_embed:!1,qtextReactHyperlinkEmbed:!1,lightWeightContentToolbar:!1,eagerImageUploading:!1,placeholder:e,deleteVideoButton:Object(P.K)("Delete"),deleteVideoMessage:Object(P.K)("Video will be deleted"),deleteVideoTitle:Object(P.K)("Are you sure you want to delete your video?"),doneUploadingTitle:Object(P.K)("Uploaded"),pauseUploadingButton:Object(P.K)("Pause"),pauseUploadingTitle:Object(P.K)("Uploading"),resumeUploadingButton:Object(P.K)("Resume Uploading"),resumeUploadingTitle:Object(P.K)("Upload Paused"),retryUploadingButton:Object(P.K)("Retry"),uploadErrorTitle:Object(P.K)("Something went wrong"),videoNotPresent:Object(P.K)("Your video is on a different device"),videoEnabled:!1,videoEditorSupported:!1,deleteVideoSvg:"",playVideoSvg:"",uploadErrorSvg:"",uploadingSvg:"",videoIndicatorSvg:"",videoNotPresentSvg:""};return Object.assign(i,t)}(t,i),{sendMessage:k.a,logJsError:D.d,makeRpc:O.a,getFormkey:w.getFormkey,sendLog:function(){}})},Ve=function(e){function t(e){var n,i,o;d()(this,t),(o=h()(this,p()(t).call(this,e))).docRef=void 0,o.toolbarRef=void 0,o.uploaderRef=void 0,o.linkSelectorRef=void 0,o.hyperlinkEmbedManagerRef=void 0,o.uploadRetryManagerRef=void 0,o._isMounted=!1,o._initialContent=void 0,o._isToolbarReady=!1,o.debouncedSaveStateToApp=void 0,o.docRef=y.createRef(),o.toolbarRef=y.createRef(),o.uploaderRef=y.createRef(),o.linkSelectorRef=y.createRef(),o.hyperlinkEmbedManagerRef=y.createRef(),o.uploadRetryManagerRef=y.createRef(),o.handleMeaningfulChange=o.handleMeaningfulChange.bind(b()(b()(o))),o.handleKeyDown=o.handleKeyDown.bind(b()(b()(o))),o.handlePaste=o.handlePaste.bind(b()(b()(o))),o.state={doc:Qe(e.content,e.placeholder,e.settingOverrides)},o._initialContent=null===(n=o.state.doc)||void 0===n?void 0:n.toJSON(),delete o._initialContent.caret;var r,s=[].concat(a()(Object(I.c)("DisabledEditorCommands",[])),a()(null!==(i=e.commandsToDisable)&&void 0!==i?i:[]));s.length>0&&(null===(r=o.state.doc)||void 0===r||r.disableCommands(s));return o.debouncedSaveStateToApp=C()(function(){Object(k.a)("saveState",{key:o.props.editorKey,value:o.save()})},750,{maxWait:1e4,trailing:!0}),o}return g()(t,e),l()(t,[{key:"clear",value:function(){this.state.doc&&this.state.doc.clear()}},{key:"handleKeyDown",value:function(e){this.props.onKeyDown&&this._isMounted&&this.props.onKeyDown(e)}},{key:"handlePaste",value:function(e){this.props.onPaste&&this._isMounted&&this.props.onPaste(e)}},{key:"setupEditor",value:function(){var e=this,t=this.docRef.current,n=this.linkSelectorRef.current,i=this.toolbarRef.current,o=this.state.doc;o&&(o.setLinkSelector(n),o.setImageUploader(this.uploaderRef.current),o.setHyperlinkEmbedManager(this.hyperlinkEmbedManagerRef.current),o.setUploadRetryManager(this.uploadRetryManagerRef.current),o.setSendMessageFn(k.a),o.on("meaningfulChange",this.handleMeaningfulChange),o.on("keydown",this.handleKeyDown),o.on("paste_event",this.handlePaste)),i&&(n.setEditorToolbar(i),this._isToolbarReady=!0),o&&o.node&&(n.setDocNode(o.node,o),t.appendChild(o.node),this.props.focusOnLoad&&(o.node.focus(),this.moveCaretToEnd(o.node))),this.state.doc||this.setState({doc:o}),Object(T.f)()&&this.props.editorKey&&(Object(A.handleEventFromWebnode)("qtextNativeRestoreState",function(t){var n=t.state;e.restoreState(n)}),Object(k.a)("restoreState",{key:this.props.editorKey})),this._isMounted=!0}},{key:"componentDidMount",value:function(){this.setupEditor(),this.props.onEditorSetup&&this.state.doc&&this.props.onEditorSetup(this.state.doc),T.k&&Object(je.j)()&&Object(k.a)("setPageAction",{visible:!1})}},{key:"componentDidUpdate",value:function(){var e=this.props.settingOverrides.lightWeightContentToolbar;T.j&&e&&!this._isToolbarReady&&(document.getElementById("modal_footer_portal_container")&&(this.linkSelectorRef.current.setEditorToolbar(this.toolbarRef.current),this._isToolbarReady=!0))}},{key:"componentWillUnmount",value:function(){this.state.doc&&(this.state.doc.destroy(),this.setState({doc:null})),this._isMounted=!1}},{key:"handleMeaningfulChange",value:function(){this.props.onMeaningfulChange&&this._isMounted&&this.state.doc&&this.props.onMeaningfulChange(this.state.doc),Object(T.f)()&&this.props.editorKey&&this.debouncedSaveStateToApp()}},{key:"save",value:function(){var e=!(arguments.length>0&&arguments[0]!==undefined)||arguments[0],t=this.state.doc?this.state.doc.toJSON():{};return e&&delete t.caret,t}},{key:"clearState",value:function(){Object(T.f)()&&this.props.editorKey&&Object(k.a)("saveState",{key:this.props.editorKey,value:{}})}},{key:"handleAddImages",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1];this.state.doc&&this.state.doc.insertImages(e,{source:"upload"},t)}},{key:"restoreState",value:function(e){var t;null===(t=this.state.doc)||void 0===t||t.fromJSON(e);var n=this.toolbarRef.current;n&&n.refreshButtonStates()}},{key:"isDirty",value:function(){if(this.state.doc){var e=this.state.doc.toJSON();return delete e.caret,!B()(e,this._initialContent)}return!1}},{key:"moveCaretToEnd",value:function(e){if(document.createRange&&window.getSelection){var t=document.createRange();t.selectNodeContents(e);var n=window.getSelection();n&&(n.removeAllRanges(),n.addRange(t),n.rangeCount&&n.collapseToEnd())}}},{key:"renderBottomToolbar",value:function(){var e,t=this,n=this.props.settingOverrides.lightWeightContentToolbar,i=y.createElement(Fe,{doc:this.state.doc,ref:this.toolbarRef,imageUploaderRef:this.uploaderRef,onImageUpload:function(e){t.handleAddImages(e,!1)},isBottomOfEditor:!0,isLightWeightContentStyle:n,onRulesButtonClick:this.props.onRulesButtonClick}),o={zIndex:"footer",bottom:"0",bg:"white"};if(T.j){var r=document.getElementById("modal_footer_portal_container");if(n)return r?x.a.createPortal(y.createElement(N.q,Object.assign({fullX:!0},o,{ml:"-20px"}),i),r):null;e=N.r}else e=N.i;return y.createElement(e,Object.assign({fullX:!0},o),i)}},{key:"render",value:function(){var e=this,t=T.j&&this.props.toolbarOnWeb||T.n&&this.props.toolbarOnMobile,n=this.props.isToolbarBottom,i=this.props.editorPaddingReset,o=this.props.settingOverrides.lightWeightContentToolbar,r={};T.o&&o&&(r.pt="medium");var a="editor_inner";return i&&(a+=" editor_padding_reset"),y.createElement(N.h.Consumer,null,function(s){var d,c=s===N.c.RTL?"u-layout-direction--rtl":"u-layout-direction--ltr";return y.createElement(N.d,{className:"editor_wrapper ".concat(c),whiteSpace:"pre-wrap",style:{outline:"none",MozTabSize:4,OTabSize:4,tabSize:4}},t&&!n?y.createElement(L.a,{condition:!T.j,wrapper:function(e){return y.createElement(R.a.Consumer,null,function(t){return y.createElement(N.r,{top:T.j?Object(M.d)({isPrefetched:t}):0,bg:"white",zIndex:"qtext_overlay"},e)})}},y.createElement(Fe,{doc:e.state.doc,ref:e.toolbarRef,imageUploaderRef:e.uploaderRef,onImageUpload:function(t){e.handleAddImages(t,!1)},isLightWeightContentStyle:o,onRulesButtonClick:e.props.onRulesButtonClick})):null,y.createElement(N.d,Object.assign({className:a},r),y.createElement(N.q,{onDragEnter:function(t){var n;e.uploaderRef.current&&(null===t||void 0===t?void 0:null===(n=t.dataTransfer)||void 0===n?void 0:n.items)&&Array.from(t.dataTransfer.items).some(function(e){return e.type.includes("image")})&&e.uploaderRef.current.showDropZone()}},y.createElement(N.d,{innerRef:e.docRef,p:i?undefined:"medium"}),y.createElement(me,{ref:e.uploaderRef,onAddImages:function(t,n){e.handleAddImages(t,n)},doc:null!==(d=e.state.doc)&&void 0!==d?d:undefined,onImageUploadStatusChange:e.props.onImageUploadStatusChange,useEagerImageUploading:e.props.settingOverrides.eagerImageUploading}),y.createElement(A.WebnodeBridgeModal,null,function(t){return y.createElement(ue,{ref:e.linkSelectorRef,openModal:t,onOpen:function(){e.state.doc&&e.state.doc&&T.j&&e.state.doc.node.setAttribute("data-placeholder","")},onClose:function(){e.state.doc&&e.state.doc&&T.j&&e.state.doc.node.setAttribute("data-placeholder",e.props.placeholder)}})})),y.createElement(qe,null),y.createElement(ye,{ref:e.hyperlinkEmbedManagerRef}),y.createElement(ke,{ref:e.uploadRetryManagerRef})),e.props.footerSection,t&&n?e.renderBottomToolbar():null)})}}]),t}(y.Component);Ve.defaultProps={content:undefined,editorKey:"",placeholder:"",toolbarOnWeb:!0,toolbarOnMobile:!0,focusOnLoad:!0,isCommentEditor:!1,isToolbarBottom:!1,editorPaddingReset:!1,commandsToDisable:[],settingOverrides:{}}},dt0z:function(e,t,n){var i=n("zoYe");e.exports=function(e){return null==e?"":i(e)}},eUgh:function(e,t){e.exports=function(e,t){for(var n=-1,i=null==e?0:e.length,o=Array(i);++n<i;)o[n]=t(e[n],n,e);return o}},hgQt:function(e,t,n){var i=n("Juji"),o=n("4sDh");e.exports=function(e,t){return null!=e&&o(e,t,i)}},k4Da:function(e,t,n){var i=n("LXxW"),o=n("n3Sm"),r=n("ut/Y"),a=n("Z0cm");e.exports=function(e,t){return(a(e)?i:o)(e,r(t,3))}},kI88:function(e,t,n){var i;i=function(){var e=!0;function t(t){function n(e){var n=t.match(e);return n&&n.length>1&&n[1]||""}var i,o=n(/(ipod|iphone|ipad)/i).toLowerCase(),r=!/like android/i.test(t)&&/android/i.test(t),a=/nexus\s*[0-6]\s*/i.test(t),s=!a&&/nexus\s*[0-9]+/i.test(t),d=/CrOS/.test(t),c=/silk/i.test(t),l=/sailfish/i.test(t),u=/tizen/i.test(t),h=/(web|hpw)os/i.test(t),f=/windows phone/i.test(t),p=(/SamsungBrowser/i.test(t),!f&&/windows/i.test(t)),m=!o&&!c&&/macintosh/i.test(t),g=!r&&!l&&!u&&!h&&/linux/i.test(t),v=n(/edge\/(\d+(\.\d+)?)/i),b=n(/version\/(\d+(\.\d+)?)/i),y=/tablet/i.test(t),S=!y&&/[^-]mobi/i.test(t),x=/xbox/i.test(t);/opera/i.test(t)?i={name:"Opera",opera:e,version:b||n(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr|opios/i.test(t)?i={name:"Opera",opera:e,version:n(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||b}:/SamsungBrowser/i.test(t)?i={name:"Samsung Internet for Android",samsungBrowser:e,version:b||n(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(t)?i={name:"Opera Coast",coast:e,version:b||n(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(t)?i={name:"Yandex Browser",yandexbrowser:e,version:b||n(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(t)?i={name:"UC Browser",ucbrowser:e,version:n(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(t)?i={name:"Maxthon",maxthon:e,version:n(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(t)?i={name:"Epiphany",epiphany:e,version:n(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(t)?i={name:"Puffin",puffin:e,version:n(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(t)?i={name:"Sleipnir",sleipnir:e,version:n(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(t)?i={name:"K-Meleon",kMeleon:e,version:n(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:f?(i={name:"Windows Phone",windowsphone:e},v?(i.msedge=e,i.version=v):(i.msie=e,i.version=n(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(t)?i={name:"Internet Explorer",msie:e,version:n(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:d?i={name:"Chrome",chromeos:e,chromeBook:e,chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/chrome.+? edge/i.test(t)?i={name:"Microsoft Edge",msedge:e,version:v}:/vivaldi/i.test(t)?i={name:"Vivaldi",vivaldi:e,version:n(/vivaldi\/(\d+(\.\d+)?)/i)||b}:l?i={name:"Sailfish",sailfish:e,version:n(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(t)?i={name:"SeaMonkey",seamonkey:e,version:n(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(t)?(i={name:"Firefox",firefox:e,version:n(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)&&(i.firefoxos=e)):c?i={name:"Amazon Silk",silk:e,version:n(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(t)?i={name:"PhantomJS",phantom:e,version:n(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(t)?i={name:"SlimerJS",slimer:e,version:n(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)?i={name:"BlackBerry",blackberry:e,version:b||n(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:h?(i={name:"WebOS",webos:e,version:b||n(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(t)&&(i.touchpad=e)):/bada/i.test(t)?i={name:"Bada",bada:e,version:n(/dolfin\/(\d+(\.\d+)?)/i)}:u?i={name:"Tizen",tizen:e,version:n(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||b}:/qupzilla/i.test(t)?i={name:"QupZilla",qupzilla:e,version:n(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||b}:/chromium/i.test(t)?i={name:"Chromium",chromium:e,version:n(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||b}:/chrome|crios|crmo/i.test(t)?i={name:"Chrome",chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:r?i={name:"Android",version:b}:/safari|applewebkit/i.test(t)?(i={name:"Safari",safari:e},b&&(i.version=b)):o?(i={name:"iphone"==o?"iPhone":"ipad"==o?"iPad":"iPod"},b&&(i.version=b)):i=/googlebot/i.test(t)?{name:"Googlebot",googlebot:e,version:n(/googlebot\/(\d+(\.\d+))/i)||b}:{name:n(/^(.*)\/(.*) /),version:function(e){var n=t.match(e);return n&&n.length>1&&n[2]||""}(/^(.*)\/(.*) /)},!i.msedge&&/(apple)?webkit/i.test(t)?(/(apple)?webkit\/537\.36/i.test(t)?(i.name=i.name||"Blink",i.blink=e):(i.name=i.name||"Webkit",i.webkit=e),!i.version&&b&&(i.version=b)):!i.opera&&/gecko\//i.test(t)&&(i.name=i.name||"Gecko",i.gecko=e,i.version=i.version||n(/gecko\/(\d+(\.\d+)?)/i)),i.msedge||!r&&!i.silk?o?(i[o]=e,i.ios=e):m?i.mac=e:x?i.xbox=e:p?i.windows=e:g&&(i.linux=e):i.android=e;var _="";i.windowsphone?_=n(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):o?_=(_=n(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g,"."):r?_=n(/android[ \/-](\d+(\.\d+)*)/i):i.webos?_=n(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):i.blackberry?_=n(/rim\stablet\sos\s(\d+(\.\d+)*)/i):i.bada?_=n(/bada\/(\d+(\.\d+)*)/i):i.tizen&&(_=n(/tizen[\/\s](\d+(\.\d+)*)/i)),_&&(i.osversion=_);var C=_.split(".")[0];return y||s||"ipad"==o||r&&(3==C||C>=4&&!S)||i.silk?i.tablet=e:(S||"iphone"==o||"ipod"==o||r||a||i.blackberry||i.webos||i.bada)&&(i.mobile=e),i.msedge||i.msie&&i.version>=10||i.yandexbrowser&&i.version>=15||i.vivaldi&&i.version>=1||i.chrome&&i.version>=20||i.samsungBrowser&&i.version>=4||i.firefox&&i.version>=20||i.safari&&i.version>=6||i.opera&&i.version>=10||i.ios&&i.osversion&&i.osversion.split(".")[0]>=6||i.blackberry&&i.version>=10.1||i.chromium&&i.version>=20?i.a=e:i.msie&&i.version<10||i.chrome&&i.version<20||i.firefox&&i.version<20||i.safari&&i.version<6||i.opera&&i.version<10||i.ios&&i.osversion&&i.osversion.split(".")[0]<6||i.chromium&&i.version<20?i.c=e:i.x=e,i}var n=t("undefined"!==typeof navigator&&navigator.userAgent||"");function i(e){return e.split(".").length}function o(e,t){var n,i=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n++)i.push(t(e[n]));return i}function r(e){for(var t=Math.max(i(e[0]),i(e[1])),n=o(e,function(e){var n=t-i(e);return o((e+=new Array(n+1).join(".0")).split("."),function(e){return new Array(20-e.length).join("0")+e}).reverse()});--t>=0;){if(n[0][t]>n[1][t])return 1;if(n[0][t]!==n[1][t])return-1;if(0===t)return 0}}function a(e,i,o){var a=n;"string"===typeof i&&(o=i,i=void 0),void 0===i&&(i=!1),o&&(a=t(o));var s=""+a.version;for(var d in e)if(e.hasOwnProperty(d)&&a[d])return r([s,e[d]])<0;return i}return n.test=function(e){for(var t=0;t<e.length;++t){var i=e[t];if("string"===typeof i&&i in n)return!0}return!1},n.isUnsupportedBrowser=a,n.compareVersions=r,n.check=function(e,t,n){return!a(e,t,n)},n._detect=t,n},e.exports?e.exports=i():n("B9Yq")("bowser",i)},lQqw:function(e,t,n){var i=n("MMmD");e.exports=function(e,t){return function(n,o){if(null==n)return n;if(!i(n))return e(n,o);for(var r=n.length,a=t?r:-1,s=Object(n);(t?a--:++a<r)&&!1!==o(s[a],a,s););return n}}},"lm/5":function(e,t,n){var i=n("fmRc"),o=n("wF/u"),r=1,a=2;e.exports=function(e,t,n,s){var d=n.length,c=d,l=!s;if(null==e)return!c;for(e=Object(e);d--;){var u=n[d];if(l&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++d<c;){var h=(u=n[d])[0],f=e[h],p=u[1];if(l&&u[2]){if(f===undefined&&!(h in e))return!1}else{var m=new i;if(s)var g=s(f,p,h,e,t,m);if(!(g===undefined?o(p,f,r|a,s,m):g))return!1}}return!0}},mwIZ:function(e,t,n){var i=n("ZWtO");e.exports=function(e,t,n){var o=null==e?undefined:i(e,t);return o===undefined?n:o}},n3Sm:function(e,t,n){var i=n("SKAX");e.exports=function(e,t){var n=[];return i(e,function(e,i,o){t(e,i,o)&&n.push(e)}),n}},odos:function(e,t){var n,i;n=this,i=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=31)}([function(e,t){var n={isIOS:!1,isMobile:!1,isIPad:!1,isMSEdge:!1,isMSIE:!1,isGecko:!1,isWebkit:!1,isFirefox:!1,webkitVersion:0,isIOSApp:!1,isAndroid:!1,isAndroidApp:!1,isNativeApp:!1,isUIWebView:!1,isIOSMobileWeb:!1,buildNumber:0,osVersion:0,debug:!1},i={deleteVideoButton:"Delete",deleteVideoMessage:"Video will be deleted",deleteVideoSvg:"",deleteVideoTitle:"Are you sure you want to delete your video?",doneUploadingTitle:"Uploaded",pauseUploadingButton:"Pause",pauseUploadingTitle:"Uploading",playVideoSvg:"",resumeUploadingButton:"Resume Uploading",resumeUploadingTitle:"Upload Paused",retryUploadingButton:"Retry",uploadErrorSvg:"",uploadErrorTitle:"Something went wrong",uploadingSvg:"",videoIndicatorSvg:"",videoNotPresent:"Your video is on a different device",videoNotPresentSvg:"Paste From Clipboard",videoEnabled:!1,videoEditorSupported:!1,tabbedEditorToolbar:!1,minHeight:null,enableSmartQuotes:!1,defaultDirection:"LTR",qtext_hyperlink_embed:!1,qtextReactHyperlinkEmbed:!1,imageRemoveButtonEnabled:!1,lightWeightContentToolbar:!1,isDarkModeOn:!1,eagerImageUploading:!1,placeholder:""},o=function(){},r={sendMessage:o,sendLog:o,logJsError:o,makeRpc:function(){return new Promise(o,o)},getFormkey:o};window.hasOwnProperty("scrollTo")||(window.scrollTo=function(){}),t.config={clientInfo:Object.assign({},n),options:Object.assign({},i),platform:Object.assign({},r),setClientInfo:function(e){this.clientInfo=Object.assign({},n,e)},setOptions:function(e){this.options=Object.assign({},i,e)},setPlatformFunctions:function(e){this.platform=Object.assign({},r,e)},setSendMessageFn:function(e){e&&"function"===typeof e&&(this.platform.sendMessage=e)},setLogJsErrorFn:function(e){e&&"function"===typeof e&&(this.platform.logJsError=e)},setRpcFn:function(e){e&&"function"===typeof e&&(this.platform.makeRpc=e)},setGetFormkeyFn:function(e){e&&"function"===typeof e&&(this.platform.getFormkey=e)},_docId:1,_lastActiveDocId:null,_cache:{},getDocId:function(){var e=this._docId;return this._docId+=1,e},cacheConfig:function(e){this._lastActiveDocId=e._id,this._cache[e._id]={clientInfo:Object.assign({},this.clientInfo),options:Object.assign({},this.options),platform:Object.assign({},this.platform)}},restoreConfig:function(e){var t=this._cache[e._id];this._lastActiveDocId!==e._id&&t&&(this.setClientInfo(t.clientInfo),this.setOptions(t.options),this.setPlatformFunctions(t.platform))}}},function(e,t,n){var i=n(5).Class,o=n(8).Span,r=n(10).canForceModifier,a=t.Command=i.extend({__init__:function(e){this.doc=e},exec:function(e){throw new Error("Sub-classes should implement this method.")},shouldExec:function(e){return!0},run:function(e){return!this.shouldExec(e)||this.exec.apply(this,arguments)}});t.spanModifierToggle=function(e){return a.extend({exec:function(){return this.doc.saveState(),this.doc.toggleModifier(e)},shouldExec:function(){var t;if(this.doc.caret.isCollapsed()){var n=new o(this.doc.caret.end.span.getText(),this.doc.formattingState._modifiers);n.parent=this.doc.caret.end.span.parent,t=[n]}else t=this.doc.caret.getCoveringSpans();return t.some(function(t){return t.hasModifier(e)||r(t,e)})}})},t.sectionTypeToggle=function(e){return a.extend({exec:function(){return this.doc.saveState(),this.doc.toggleSectionType(e)}})}},function(e,t,n){var i=n(27).isValidEmail,o=["keydown","keyup","keypress"],r=n(32),a=/^https?\:\/\//,s=n(9),d={},c={assert:function(e){if(!e){var t=Array.prototype.slice.call(arguments,1);throw new Error(t)}},create:function(e){return document.createElement(e)},objectIntersection:function(e,t){for(var n=Object.keys(e),i={},o=0;o<n.length;o++){var r=n[o];s.jsonEqual(e[r],t[r])&&(i[r]=e[r])}return i},removeNullValues:function(e){for(var t,n=Object.keys(e),i=0;i<n.length;i++)if(null===e[t=n[i]])delete e[t];else if("[object Object]"===Object.prototype.toString.call(e[t]))c.removeNullValues(e[t]);else if("[object Array]"===Object.prototype.toString.call(e[t]))for(var o=0;o<e[t].length;o++)c.removeNullValues(e[t][o]);return e},getData:function(e,t){return e.getAttribute("data-"+t)},setData:function(e,t,n){e.setAttribute("data-"+t,n)},removeData:function(e,t){e.removeAttribute("data-"+t)},isTextNode:function(e){return e&&3==e.nodeType},safeRemoveChild:function(e,t){e&&e.parentNode&&e.parentNode==t&&t.removeChild(e)},on:function(e,t,n){(e=e instanceof Array?e:[e]).forEach(function(e){t&&t.addEventListener(e,function(t){var i;return-1!=o.indexOf(e)&&(t.which=t.charCode!==undefined?t.charCode:t.keyCode),!1===(i=n(t,e))&&(t.preventDefault(),t.stopPropagation()),i})})},ensureProtocol:function(e){return i(e)?e:(a.test(e)||(e="http://"+e),e)},isValidUrl:function(e){var t=c.linkify(e);return 1===t.length&&t[0].href},splitLines:function(e){return e.split(/\n|\r\n?/)},splitByRegex:function(e,t){for(var n,i=[];e;)(n=e.match(t))?(n.index&&i.push({text:e.slice(0,n.index)}),i.push({text:n[0],match:n}),e=e.slice(n.index+n[0].length)):(i.push({text:e}),e="");return i},linkify:function(e){var t=[];return r.linkify(e,{callback:function(e,n){0!==e.length&&t.push({text:e,href:n})}}),t},firstScrollingParent:s.firstScrollingParent,closestRelativeAncestor:s.closestRelativeAncestor,getContainerOffset:function(e,t){var n=c.getOffset(e),i=t||c.firstScrollingParent(e);if(i!==document.body){var o=c.getOffset(i);n.left+=i.scrollLeft-o.left,n.top+=i.scrollTop-o.top}return n},getOffset:function(e){var t=e?e.getBoundingClientRect():{top:0,left:0};return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}},getSize:function(e){var t=e.getBoundingClientRect();return{height:t.height,width:t.width}},setPixelVal:function(e,t,n){e&&t&&!isNaN(n)&&(e.style[t]=n+"px")},isAstralSymbol:function(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e)},createPlainIframe:function(e){var t=document.createElement("iframe"),n=["<html>","<head>","<style>html, body {margin: 0; padding 0;}</style>","</head>","<body>",e.outerHTML,"</body>","</html>"];return t.srcdoc=n.join(""),t},h:function(e,t){for(var n,i=new Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];n=null===e?document.createDocumentFragment():document.createElement(e),Object.keys(t||{}).forEach(function(e){n.setAttribute(e,t[e])});for(var r=0;r<i.length;r++){var a=i[r];a&&(Array.isArray(a)&&(a=c.h.apply(null,[null,null].concat(a))),"string"==typeof a&&(a=document.createTextNode(a)),n.appendChild(a))}return n},loadCss:function(e,t){if(!d.hasOwnProperty(e)){var n=document.createElement("style");n.type="text/css",n.setAttribute("data-id",e),n.innerText=t,d[e]=n,(document.querySelector("head")||document.querySelector("body")).appendChild(n)}}};t.Util=c},function(e,t){t.CONTENT_TYPES={TEXT:"text/plain",HTML:"text/html",PUBLIC_HTML:"public.html",TEXT_URI:"text/uri-list"},t.FRACTIONS={"\u2150":[1,7],"\u2151":[1,9],"\u2152":[1,10],"\u2153":[1,3],"\u2154":[2,3],"\u2155":[1,5],"\u2156":[2,5],"\u2157":[3,5],"\u2158":[4,5],"\u2159":[1,6],"\u215a":[5,6],"\u215b":[1,8],"\u215c":[3,8],"\u215d":[5,8],"\u215e":[7,8]},t.ELLIPSIS="\u2026",t.OPEN_SINGLE_QUOTE="\u2018",t.CLOSE_SINGLE_QUOTE="\u2019",t.OPEN_DOUBLE_QUOTE="\u201c",t.CLOSE_DOUBLE_QUOTE="\u201d",t.SINGLE_PRIME="\u2032",t.DOUBLE_PRIME="\u2033",t.EN_DASH="\u2013",t.EM_DASH="\u2014",t.LEFT_ARROW="\u2190",t.RIGHT_ARROW="\u2192",t.WORD_START_REGEX=/\s|[({[]/,t.ENTER_KEY=13},function(e,t,n){var i=n(5).Class.extend({__init__:function(e,t){this.span=e,this.offset=t},toJSON:function(){var e=this.span.parent;return{spanIdx:e.children.indexOf(this.span),sectionIdx:e.parent.children.indexOf(e),offset:this.offset}},clone:function(){return new i(this.span,this.offset)},atSpanStart:function(){return 0===this.offset},atSpanEnd:function(){return this.offset==this.span.getLength()},atSectionStart:function(){var e=this.span.parent;return this.atSpanStart()&&this.span==e.firstChild()},atSectionEnd:function(){var e=this.span.parent;return this.atSpanEnd()&&this.span==e.lastChild()},atDocStart:function(){var e=this.span.parent,t=e.parent;return this.atSectionStart()&&e==t.firstChild()},atDocEnd:function(){var e=this.span.parent,t=e.parent;return this.atSectionEnd()&&e==t.lastChild()},equals:function(e){return e.span===this.span&&e.offset===this.offset},charBefore:function(){return this.atSectionStart()?null:this.prevPositionInSection().charAfter()},hasCharBefore:function(){var e=this.charBefore();return!!e&&0!==e.trim().length},charAfter:function(){if(this.atSectionEnd())return null;var e=this.span,t=this.offset;return this.atSpanEnd()&&(e=e.nextSibling(),t=0),e.getText()[t]},hasCharAfter:function(){var e=this.charAfter();return!!e&&0!==e.trim().length},previousWordBoundary:function(e){e=e||/\W/;var t=this.span,n=this.offset-1,o=t.getText();if(this.atDocStart())return this;if(this.atSectionStart())return t.previous().last();for(;t;){for(;n>0;){if(o[n-1].match(e))return new i(t,n);n--}(t=t.previousSibling())&&(n=(o=t.getText()).length)}return this.span.parent.first()},nextWordBoundary:function(e){e=e||/\W/;var t=this.span,n=this.offset+1,o=t.getText();if(this.atDocEnd())return this;if(this.atSectionEnd())return t.next().first();for(;t;){for(;n<o.length;){if(o[n].match(e))return new i(t,n);n++}(t=t.nextSibling())&&(o=t.getText(),n=0)}return this.span.parent.last()},relativePositionInSection:function(e){if(0===e)return this;var t=this.span,n=this.offset,o=t.getLength(),r=t.previousSibling(),a=t.nextSibling(),s=e+n;return 0<=s&&s<=o?new i(t,s):s<0&&r?r.last().relativePositionInSection(e+n):s>o&&a?a.first().relativePositionInSection(e-(o-n)):null},prevPositionInSection:function(e){return e=e||1,this.relativePositionInSection(-1*e)},nextPositionInSection:function(e){return this.relativePositionInSection(e||1)},alternatePosition:function(){if(this.atSpanStart()){var e=this.span.previousSibling();if(e)return e.last()}else if(this.atSpanEnd()){var t=this.span.nextSibling();if(t)return t.first()}return this}});t.Position=i},function(e,t){var n=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,i=function(){},o={};function r(e,t){var n,r=i.prototype=e.prototype,d=new i;function c(){if(n||(e.call(o),function(e,t,n){for(var i in t)t.hasOwnProperty(i)&&(e[i]=n?a(i,t,n):t[i])}(d,t,r),n=!0,t=null),this!==o){var i=this.__init__;i&&i.apply(this,arguments)}}return c.prototype=d,c.extend=s,d.constructor=c,c}function a(e,t,i){var o=t[e],r=i[e];return"function"===typeof o&&"function"===typeof r&&o!==r&&n.test(o)?function(){var t=this._super;this._super=i[e];try{return o.apply(this,arguments)}finally{this._super=t}}:o}function s(e){return r(this,e)}t.Class=s.call(function(){},{})},function(e,t,n){var i=n(22).Container,o=n(3).CONTENT_TYPES,r=n(10),a=n(8).Span,s=n(4).Position,d=n(28).tweetsEnabled,c=n(23).hyperlinkEmbedsEnabled,l=n(2).Util,u=n(18),h=function(){var e={};e.plain=n(7).PlainSection,e.code=n(12).CodeSection,e.image=n(14).ImageSection,n(0).config.options.lightWeightContentToolbar&&(e.heading=n(25).H1Section);var t=n(17);e["horizontal-rule"]=t.HorizontalRuleSection;var i=n(13);e["ordered-list"]=i.OrderedListSection,e["unordered-list"]=i.UnorderedListSection;var o=n(15);return e.embed=o.EmbedSection,e["yt-embed"]=o.YouTubeEmbedSection,e.oembedly=o.OEmbedlySection,d()&&(e.tweet=o.TweetSection),c()&&(e.hyperlink_embed=o.HyperlinkEmbedSection),e},f=i.create("section",{init:function(e,t,n,i,o){var r=this;(t=t&&0!==t.length?t:[new a]).slice().forEach(function(e){r.appendChild(e)}),l.setData(this.node,"type",e),o!==undefined?this.setRTL(o):this.resetRTL(),this.setIndent(n||0),this.setQuoted(i)},getType:function(){return l.getData(this.node,"type")},getLength:function(){var e=0;return this.children.forEach(function(t){e+=t.getLength()}),e},getIndent:function(){return parseInt(l.getData(this.node,"indent"))},setIndent:function(e){return e=Math.min(this.maxIndent(),Math.max(0,e)),l.setData(this.node,"indent",e),0!==this.maxIndent()},getDirection:function(){var e=l.getData(this.node,"dir");return e||(e=this.determineDirection(),l.setData(this.node,"dir",e),l.setData(this.node,"dir-confirmed",this.getLength()>0)),e},isRTL:function(){return"RTL"==this.getDirection()},isDirectionConfirmed:function(){return"true"===l.getData(this.node,"dir-confirmed")},setRTL:function(e){if(null!=e){var t=e?"RTL":"LTR";l.setData(this.node,"dir",t),l.setData(this.node,"dir-confirmed",!0)}},resetRTL:function(){var e=this.determineDirection();e&&"NEUTRAL"!==e&&l.setData(this.node,"dir",e),l.setData(this.node,"dir-confirmed",!this.isEmpty())},setQuoted:function(e){e?l.setData(this.node,"quoted","true"):l.removeData(this.node,"quoted")},isQuoted:function(){return!!l.getData(this.node,"quoted")},isEditable:function(){return!this.children.some(function(e){return!e.isEditable()})},hasSectionRemoveButton:function(){return!this.isEditable()&&this.children.some(function(e){return e._content.className.includes("section_content_container")})},allowsMultipleSoftReturns:function(){return!1},allowedModifiers:function(){return r.editableSet()},toContent:function(e,t){var n=[];return n.push(this.getContentPrefix(e,t)),n.push(this.getChildrenContents(e)),n.push(this.getContentSuffix(e,t)),n=n.join("")},getChildrenContents:function(e){return this.children.map(function(t){return t.toContent(e)}).join("")},determineDirection:function(){return u.getGlobalDir()},toJSON:function(e){var t={type:this.getType(),indent:this.getIndent(),quoted:this.isQuoted(),is_rtl:this.isRTL(),spans:[]};return this.children.forEach(function(n){t.spans.push(n.toJSON(e))}),t},first:function(){return this.firstChild().first()},last:function(){return this.lastChild().last()},getText:function(){var e="";return this.children.forEach(function(t){e+=t.getText()}),e},deleteText:function(e,t){if(e.span==t.span)e.span.deleteText(e.offset,t.offset);else{for(e.span.deleteText(e.offset,e.span.getLength());e.span.nextSibling()!=t.span;)this.removeChild(e.span.nextSibling());t.span&&t.span.deleteText(0,t.offset)}t.span.isEmpty()&&this.children.length>1&&this.removeChild(t.span),e.span.isEmpty()&&this.children.length>1&&this.removeChild(e.span),1==this.children.length&&this.firstChild()==e.span&&e.span.isEmpty()&&e.span.removeAllModifiers()},replaceText:function(e,t,n){if(""===n)return this.deleteText(e,t);var i=e.span.getText(),o=i.substr(0,e.offset)+n;e.span==t.span?o+=i.substr(t.offset):this.deleteText(e.span.nextSibling().first(),t),e.span.setText(o)},isEmpty:function(){return 1==this.children.length&&this.children[0].isEmpty()},isOnlyWhiteSpace:function(){return this.children.every(function(e){return e.isOnlyWhiteSpace()})},isOneLineOnly:function(){return!1},_createSplitSection:function(e){return this.isOneLineOnly()?new(0,h().plain)(e,this.getIndent(),this.isQuoted(),this.isRTL()):new this.constructor(e,this.getIndent(),this.isQuoted(),this.isRTL())},split:function(e){var t,n,i,o,r=e.span,s=e.offset;return 0===s?(r==this.firstChild()&&this.insertBefore(new a,r),o=r):s===r.getLength()?r==this.lastChild()?(o=new a,this.appendChild(o)):o=r.nextSibling():o=r.split(s,!0),t=this.children.indexOf(o)+1,(i=this.children.slice(t)).unshift(o),n=this._createSplitSection(i),this.parent.insertBefore(n,this.nextSibling()),o.first()},merge:function(e){var t,n,i;if(e.isEditable())if(e.isEmpty())e.parent&&e.parent.removeChild(e),t=this.last();else if(this.isEditable()){for(this.isEmpty()?(this.removeChild(this.firstChild()),this.setIndent(e.getIndent()),this.setQuoted(e.isQuoted()),this.setRTL(e.isRTL()),t=e.first()):t=this.last();e.children.length;)this.appendChild(e.firstChild());for(n=this.firstChild();n;)if((i=n.nextSibling())&&n.hasSameModifiers(i)){var o=n.getLength();n=n.merge(i),i==t.span&&(t=new s(n,o+t.offset))}else n=i;e.parent&&e.parent.removeChild(e)}else this.parent&&this.parent.removeChild(this),t=e.first();else this.isEmpty()&&this.parent&&this.parent.removeChild(this),t=e.first();return t},changeType:function(e){var t=new e(this.children,this.getIndent(),this.isQuoted(),this.isRTL());return t.shouldRemoveChildrenModifiers()&&t.removeAllChildrenModifiers(),this.parent&&(this.parent.insertBefore(t,this),this.parent.removeChild(this)),t},getContentPrefix:function(e,t){return e==o.TEXT?this._getTextPrefix(t):e==o.HTML?this._getHTMLPrefix(t):void 0},getContentSuffix:function(e,t){return e==o.TEXT?this._getTextSuffix(t):e==o.HTML?this._getHTMLSuffix(t):void 0},shouldRemoveChildrenModifiers:function(){return!1},removeAllChildrenModifiers:function(){this.children.forEach(function(e){e.removeAllModifiers()})},_getTextPrefix:function(){var e,t="";for(e=0;e<4*this.getIndent();e++)t+=" ";return this.isQuoted()&&(t+=">"),t},_getTextSuffix:function(){return"\n"},_getHTMLPrefix:function(e){var t,n="",i=e.indexOf(this),o=this.getIndent(),r=-1;for(i>0?((t=e[i-1])instanceof this.constructor&&(r=t.getIndent()),this.isQuoted()&&!t.isQuoted()&&(n+="<blockquote>")):this.isQuoted()&&(n+="<blockquote>");o>r;)n+=this.htmlIndentPrefix,o--;return n+this.htmlPrefix},_getHTMLSuffix:function(e){var t,n=this.htmlSuffix,i=e.indexOf(this),o=this.getIndent(),r=-1;for(i<e.length-1&&(t=e[i+1])instanceof this.constructor&&(r=t.getIndent());o>r;)o--,n+=this.htmlIndentSuffix;return!this.isQuoted()||t&&t.isQuoted()||(n+="</blockquote>"),n},maxIndent:function(){return 0}});f.fromJSON=function(e){var t=[],n=h()[e.type];return e.spans.forEach(function(e){t.push(new a(e.text,e.modifiers))}),n&&"function"===typeof n?new n(t,e.indent,e.quoted,e.is_rtl):(console.warn("Invalid section type: ".concat(e.type)),null)},t.Section=f},function(e,t,n){var i=n(6).Section,o=n(24),r=i.extend({init:function(e,t,n,i){this._super("plain",e,t,n,i)},htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<p>",htmlSuffix:"</p>",determineDirection:function(){var e=this.firstChild();return e&&!e.isEmpty()?o.resolveBlockDir(e.getText()):this._super()}});t.PlainSection=r},function(e,t,n){var i=n(22).Container,o=n(4).Position,r=n(3).CONTENT_TYPES,a=n(10),s=n(0).config,d=n(9),c=d.extend,l=n(2).Util,u=i.create("span",{init:function(e,t){t=t||{},this.modifiers={},this._content=this.createContentNode(),this.node.appendChild(this._content),this._image=null,this.setText(e);var n=this;d.iterItems(t,function(e,t){n.setModifier(e,t,!0)})},createContentNode:function(){var e=l.create("div");return e.className="content",e.qtextSpanContent=!0,e},merge:function(e){if(this.isEditable()&&e.isEditable()&&this.hasSameModifiers(e))return this.setText(this.getText()+e.getText()),e.parent.removeChild(e),this},hasSameModifiers:function(e){var t=this.modifiers,n=e.modifiers,i=Object.getOwnPropertyNames(t),o=Object.getOwnPropertyNames(n);return i.length==o.length&&i.every(function(e){if("link"==e&&n.link){var i=t.link.url;i&&"/"!=i.substr(-1)&&(i+="/");var o=n.link.url;return o&&"/"!=o.substr(-1)&&(o+="/"),i==o}return t[e]==n[e]})},toJSON:function(e,t,n){var i=c({},this.modifiers);return e||(delete i.iframe,delete i.react_placeholder),{modifiers:i,text:this.getText().slice(t,n)}},previous:function(){return this.previousSibling()||this.parent.previousSibling()&&this.parent.previousSibling().lastChild()},next:function(){return this.nextSibling()||this.parent.nextSibling()&&this.parent.nextSibling().firstChild()},first:function(){return new o(this,0)},last:function(){return new o(this,this.getLength())},updateModifiers:function(e,t){var n,i,o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],this.setModifier(n,e[n],t);this._updateClass()},setModifier:function(e,t,n){if(a.canSetModifier(this,e))this._setModifier(e,t);else if(n&&a.canForceModifier(this,e)){var i=this.modifiers;this.modifiers={},this._setModifier(e,t);var o=this;Object.keys(i).forEach(function(e){o.setModifier(e,i[e])})}},_setModifier:function(e,t){if(this.modifiers[e]=t||!0,"image"==e){if(this._image||(this._image=l.create("img")),this.modifiers.uploading&&this.modifiers.external_source)return void(this._image.src=t);if(this.setText(""),this._removePlaceholder(),s.clientInfo.isFirefox&&this._image.setAttribute("contenteditable","false"),t!==n(17).horizontalRuleImg){var i=this;this._image.addEventListener("load",function(){i._addSectionRemoveButton()})}this._content.appendChild(this._image),this._image.src=t}"upload_failed"===e&&(this._content.className+=" react_upload_failed_container",this._addReactContainerForRetryButton(),this._addReactContainerForRetryBanner()),"iframe"==e&&(this.setText(""),this._removePlaceholder(),this._addSectionRemoveButton(),this._content.appendChild(t)),"underline"==e&&(this._content.style.textDecoration="underline"),"react_placeholder"===e&&(this.setText(""),this._removePlaceholder(),this._addSectionRemoveButton(),this._reactPlaceholder=l.create("div"),this._reactPlaceholder.className="react_placeholder",this._content.setAttribute("contenteditable","false"),this._content.appendChild(this._reactPlaceholder)),this._updateClass()},_addSectionRemoveButton:function(){s.options.imageRemoveButtonEnabled&&(this._removeButton=l.create("div"),this._removeButton.className+="section_remove_btn",this._removeButton.setAttribute("contenteditable","false"),this._content.className+=" section_content_container",this._content.appendChild(this._removeButton))},_addReactContainerForRetryButton:function(){this._retryButton=l.create("div"),this._retryButton.className="react_retry_button_container",this._retryButton.setAttribute("contenteditable","false"),this._content.appendChild(this._retryButton)},_addReactContainerForRetryBanner:function(){this._retryBanner=l.create("div"),this._retryBanner.className="react_upload_failed_message_container",this._retryBanner.setAttribute("contenteditable","false"),this._content.appendChild(this._retryBanner)},isEditable:function(){var e=this;return!a.nonEditableSet().some(function(t){return e.hasModifier(t)})},hasAnyModifier:function(e){return Object.keys(this.modifiers).some(function(t){return-1!=e.indexOf(t)})},hasDifferentModifier:function(e){return Object.keys(this.modifiers).some(function(t){return-1==e.indexOf(t)})},removeAllModifiers:function(){this.modifiers={},this._updateClass()},removeModifier:function(e){delete this.modifiers[e],this._updateClass()},getModifier:function(e){return this.modifiers[e]},getModifiers:function(){return c({},this.modifiers)},hasModifier:function(e){return e in this.modifiers},_updateClass:function(){for(var e in this.node.className="span",this.modifiers)this.modifiers.hasOwnProperty(e)&&this.modifiers[e]&&(this.node.className+=" "+e)},isEmpty:function(){return!!this.isEditable()&&(""===this.node.textContent||""===this.node.innerHTML||"<br>"==this.node.innerHTML)},getText:function(){return this._content.textContent},setText:function(e){this._content.textContent=e,e||this._setPlaceholder()},_removePlaceholder:function(){this._content.textContent=this.getText()},insertText:function(e,t){var n=this.getText();this.setText(n.slice(0,t)+e+n.slice(t))},deleteText:function(e,t){this.setText(this.getText().slice(0,e)+this.getText().slice(t))},getLength:function(){return this.isEditable()?this.getText().length:1},isOnlyWhiteSpace:function(){return!!this.isEditable()&&(!this.hasModifier("citation")&&0==this.getText().trim().length)},getFocusNode:function(){return l.isTextNode(this._content.firstChild)?this._content.firstChild:this._content},_setPlaceholder:function(){this._content.innerHTML="<br/>"},shouldAvoidSplitting:function(){return this.hasModifier("link")||this.hasModifier("code")||this.hasModifier("math")},split:function(e,t){var n;return!t&&this.shouldAvoidSplitting()?this:(this.isEmpty()?n=new u(null,this.modifiers):0===e?(n=new u(this.getText(),this.modifiers),this.setText("")):(n=new u(this.getText().slice(e),this.modifiers),this.setText(this.getText().slice(0,e))),this.parent.insertBefore(n,this.nextSibling()),n)},_toText:function(){var e;return e=this.getText(),this.hasModifier("math")&&(e="$"+e+"$"),this.hasModifier("italic")&&(e="*"+e+"*"),this.hasModifier("bold")&&(e="**"+e+"**"),this.hasModifier("underline")&&(e="_"+e+"_"),this.hasModifier("link")&&(e+=" ("+this.getModifier("link").url+")"),e},_toHTML:function(){var e;return this.hasModifier("image")?'<img src="'+this.getModifier("image")+'"/>':this.hasModifier("video")?'<video src="'+this.getModifier("video")+'"/>':(e=this.getText(),e=(e=d.escapeHTML(e)).replace(/\n/gi,"<br>"),this.hasModifier("italic")&&(e="<i>"+e+"</i>"),this.hasModifier("bold")&&(e="<b>"+e+"</b>"),this.hasModifier("underline")&&(e="<u>"+e+"</u>"),this.hasModifier("link")&&(e='<a href="'+this.getModifier("link").url+'">'+e+"</a>"),this.hasModifier("code")?e="<code>"+e+"</code>":this.hasModifier("math")&&(e="<math>"+e+"</math>"),e)},toContent:function(e){return e==r.TEXT?this._toText():e==r.HTML?this._toHTML():void 0}});t.Span=u},function(e,t,n){var i=n(0).config;t.extend=function(e,t){e=e||{};for(var n=1;n<arguments.length;n++)if(arguments[n])for(var i in arguments[n])arguments[n].hasOwnProperty(i)&&(e[i]=arguments[n][i]);return e},t.documentFragmentFromString=function(e){var t=document.createElement("div");t.innerHTML=e;for(var n=document.createDocumentFragment(),i=t.firstChild,o=null;i;)o=i.nextSibling,n.appendChild(i),i=o;return n};var o=t.isPlainObject=function(e){if("[object Object]"!=Object.prototype.toString.call(e))return!1;var t=e.constructor;if("function"!==typeof t)return!1;var n=t.prototype;return"[object Object]"==Object.prototype.toString.call(n)&&!1!==n.hasOwnProperty("isPrototypeOf")},r=t.cloneObject=function(e){if(!Array.isArray(e)&&!o(e))return e;for(var t=e.constructor(),n=Object.keys(e),i=0;i<n.length;i++){var a=n[i];t[a]=r(e[a])}return t};t.firstScrollingParent=function(e){var t=null;for(e&&(t=e.parentNode);t&&t!==document.body;){var n=window.getComputedStyle(t);if(n){var i=n.getPropertyValue("overflow-y");if("scroll"==i||"auto"==i)return t}t=t.parentNode}return document.body},t.closestRelativeAncestor=function(e){var t=null;for(e&&(t=e.parentNode);t&&t!==document.body;){var n=window.getComputedStyle(t);if(n)if("relative"==n.getPropertyValue("position"))return t;t=t.parentNode}return document.body},t.hasAncestor=function(e,t){return!(!e.closest||"function"!==typeof e.closest)&&null!==e.closest(t)},t.makeEnum=function(e){var t={},n=Array.isArray(e);for(var i in e)e.hasOwnProperty(i)&&(t[i=n?e[i]:i]=i);return t};var a=t.once=function(e){var t,n;return function(){return n||(n=!0,t=e.apply(this,arguments)),t}},s=0;t.randomId=function(e){return[e=e||"",s++,Math.floor(4294967296*Math.random())].join("-")},t.uuid4=function(){var e=Date.now();return"undefined"!==typeof window.performance&&"function"===typeof window.performance.now&&(e+=window.performance.now()),"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})},t.escapeHTML=function(e){return e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")},t.iterItems=function(e,t){if(o(e))for(var n=Object.keys(e),r=0;r<n.length;r++)t.call(null,n[r],e[n[r]]);else i.platform.logJsError("util.iterItems expects a plain object. got "+e)},t.getLocation=function(e){var t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);return t&&{protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7]}};var d=t.jsonEqual=function(e,t){var n,i;if(e===t)return!0;if("object"!=typeof e||"object"!=typeof t)return e===t;if(null===e||e===undefined||null===t||t===undefined)return!1;if(typeof e!==typeof t)return!1;if(e instanceof Array){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(!d(e[o],t[o]))return!1;return!0}return n=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t),n.length==i.length&&n.every(function(n){return d(e[n],t[n])})};t.formatBytes=function(e,t){if(0==e)return"0 Bytes";var n=t<=0?0:t||2,i=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,i)).toFixed(n))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][i]},t.utoa=function(e){return window.btoa(unescape(encodeURIComponent(e)))},t.atou=function(e){return decodeURIComponent(escape(window.atob(e)))},t.isNewTabModifierDown=function(e){var t="MacIntel"===window.navigator.platform;return t&&e.metaKey||!t&&e.ctrlKey},t.isInModal=function(e){return t.hasAncestor(e,".Modal")},t.loadJS=function(e,t){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,t&&(n.onload=n.onreadystatechange=a(t));var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i)},t.loadJSIntoIFrame=function(e,t,n){var i=t.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,n&&(i.onload=i.onreadystatechange=a(n)),t.head.appendChild(i)}},function(e,t){t.allModifiers=function(){return["bold","italic","underline","link","citation","math","code","image","video","embed","tweet","playable","iframe","external_source","uploading","hyperlink_embed","react_placeholder","upload_failed"]};var n=t.mutuallyExclusiveSet=function(){return["link","citation"]};t.nonEditableSet=function(){return["video","image","embed","tweet","playable","iframe","external_source","uploading","upload_failed","hyperlink_embed","react_placeholder"]},t.editableSet=function(){return["bold","italic","underline","link","citation","math","code"]};var i=t.restrictedSets=function(){return[["image","embed","tweet","video","playable","iframe","external_source","uploading","upload_failed","hyperlink_embed","react_placeholder"],["math"],["code"]]},o=t.canSetModifier=function(e,t){var o=e.parent;return(!o||-1!=o.allowedModifiers().indexOf(t))&&((-1==n().indexOf(t)||!n().some(function(n){return n!=t&&e.hasModifier(n)}))&&!i().some(function(n){return!(-1==n.indexOf(t)||!e.hasDifferentModifier(n))||!(-1!=n.indexOf(t)||!e.hasAnyModifier(n))}))};t.canForceModifier=function(e,t){if(o(e,t))return!0;var r=e.parent;return(!r||-1!=r.allowedModifiers().indexOf(t))&&(-1!=n().indexOf(t)||i().some(function(e){return-1!=e.indexOf(t)}))}},function(e,t,n){var i=n(5).Class;t.Extension=i.extend({__init__:function(e){this.doc=e},install:function(){throw new Error("Sub-classes should implement this method.")},destroy:function(){}})},function(e,t,n){var i=n(6).Section,o=n(18),r=i.extend({init:function(e,t,n){this._super("code",e,t,n)},allowedModifiers:function(){return[]},htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<pre>",htmlSuffix:"</pre>",determineDirection:function(){return o.LTR},shouldRemoveChildrenModifiers:function(){return!0}});t.CodeSection=r},function(e,t,n){var i=n(6).Section,o=n(24),r=t.isListSection=function(e){return e instanceof a},a=i.extend({allowsMultipleSoftReturns:function(){return!0},maxIndent:function(){if(this.parent){var e=this.previousSibling();return e&&r(e)?Math.min(2,e.getIndent()+1):0}return 2},htmlPrefix:"<li>",htmlSuffix:"</li>",determineDirection:function(){var e=this.firstChild();return e&&!e.isEmpty()?o.resolveBlockDir(e.getText()):null}});t.UnorderedListSection=a.extend({init:function(e,t,n,i){this._super("unordered-list",e,t,n,i)},_getTextPrefix:function(e){return this._super(e)+"* "},htmlIndentPrefix:"<ul>",htmlIndentSuffix:"</ul>"}),t.OrderedListSection=a.extend({init:function(e,t,n,i){this._super("ordered-list",e,t,n,i)},_getTextPrefix:function(e){for(var t,n=this._super(e),i=this.getIndent(),o=e.indexOf(this)-1,r=1;o>=0&&!(i>(t=e[o]).getIndent())&&t instanceof this.constructor;)i==t.getIndent()&&r++,o--;return n+r+". "},htmlIndentPrefix:"<ol>",htmlIndentSuffix:"</ol>"})},function(e,t,n){var i=n(6).Section,o=n(8).Span,r=n(2).Util,a=(n(0).config,i.extend({init:function(e,t,n,i,o){r.assert(1==e.length,"ImageSections should have exactly one child:",e),r.assert(e[0].hasModifier("image"),"missing image modifier on image span: ",e[0],e[0].getModifiers()),this._super("image",e,t,n),this.isPending=o||!1,this.isPending&&this.children[0].setModifier("external_source","eager_image_upload")},allowedModifiers:function(){return["image","external_source","uploading","upload_failed"]},toJSON:function(e){return this.isPending?null:this._super(e)},toContent:function(e,t){return this.isPending?null:this._super(e,t)},setUploadSuccess:function(e){this.isPending&&(this.isPending=!1,this.children[0].updateModifiers({image:e}),this.children[0].removeModifier("external_source"),this.children[0].removeModifier("uploading"),this.removeRetryButton())},setUploadFailed:function(){this.children[0].hasModifier("upload_failed")||(this.children[0].setModifier("upload_failed"),this.parent.insertUploadRetryButton(this))},removeRetryButton:function(){this.children[0].hasModifier("upload_failed")&&(this.children[0].removeModifier("upload_failed"),this.reactUnmountCallback&&this.reactUnmountCallback())},registerReactUnmountCallback:function(e){this.reactUnmountCallback=e},removeChild:function(e){this._super(e),this.removeRetryButton()},htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<p>",htmlSuffix:"</p>"}));a.fromURL=function(e,t,n){var i={image:e};return t&&(i.external_source=t),new a([new o("",i)],undefined,undefined,undefined,n)},t.ImageSection=a},function(e,t,n){var i=n(8).Span,o=n(6).Section,r=n(10),a=n(7).PlainSection,s=n(2).Util,d=n(3).CONTENT_TYPES,c=n(28),l=n(23).hyperlinkEmbedsEnabled,u=c.tweetsEnabled,h=c.getTweetData,f=n(0).config,p=o.extend({init:function(e,t,n,i,o){s.assert(1==e.length,"EmbedSections should have exactly one child:",e),s.assert(e[0].hasModifier("embed"),"missing embed modifier on embed span"),this._super(this.type,e,t,n),this.clipboardPending=o,this.clipboardPending?e[0].setModifier("react_placeholder"):this.setEmbed()},setEmbed:function(){if(this.showLoadingDots){var e=S();this.children[0]._content.appendChild(e)}var t=this.children[0].getModifier("embed").url;this._setEmbed(t)},acceptClipboardSuggestion:function(){this.clipboardPending&&(this.clipboardPending=!1,this.children[0].removeModifier("react_placeholder"),this.children[0]._content.classList.remove("section_content_container"),this.children[0].setText(""),this._onRemove&&this._onRemove(),this.setEmbed())},toContent:function(e,t){if(this.clipboardPending)return null;var n=this.children[0].getModifier("embed").url;return e==d.TEXT?n:new i(n,{link:{type:"url",url:n}}).toContent(e)},toJSON:function(e){return this.clipboardPending?null:{type:this.getType(),indent:this.getIndent(),quoted:this.isQuoted(),spans:this.children.map(function(t){return e?t.toJSON(e):{modifiers:{embed:t.getModifier("embed")}}})}},_setEmbed:function(){},allowedModifiers:function(){return r.nonEditableSet()},_onEmbedSectionCallbackError:function(){var e=this.children[0].getModifier("embed").url,t=this.changeType(a);t.children[0].removeModifier("embed"),t.children[0].setText(e),t.parent&&t.parent.linkifySections([t])},setOnRemoveCallback:function(e){this._onRemove=e},removeChild:function(e){this._super(e),this._onRemove&&this._onRemove()}});p.getValidRegex=function(e){var t=[];e._VALID_REGEXES.forEach(function(e){t.push("(?:"+e.source+")")});var n=t.join("|");return new RegExp(n)},p.fromOtherSection=function(e,t){var n=null;return e.isEditable()?(Object.keys(y()).some(function(o){var r=y()[o],a=!0,d="",c=0,l=p.getValidRegex(r);return e.children.forEach(function(e){if(e.hasModifier("link")){var t=e.getModifier("link").url;t&&t.match(l)?(c+=1,d=e.getModifier("link").url):a=!1}else{var n=e.getText();s.splitByRegex(n,l).forEach(function(e){e.match?(c+=1,d=e.text):e.text.match(/^ *$/)||(a=!1)})}}),!(1!=c||!a)&&(n=new r([new i("",{embed:{url:d}})],null,null,null,t),!0)}),n):null};var m=p.extend({init:function(){this._super.apply(this,arguments),this.children[0].setModifier("playable")},_onOEmbedCallbackSuccess:function(e,t,n,i){var o=this.children[0].getModifier("embed");if(n!==undefined&&null!==n){s.assert(i===undefined||null===i,"If iframe_html is supplied, iframe_url has to be null / undefined.");var r=s.create("div");r.innerHTML=n,i=r.children[0].src}s.assert(null!==i,"For OEmbedSection, we have to have the iframe URL."),o.thumbnail_url=t,o.content_type=e,o.iframe={url:i},this.children[0].setModifier("embed",o),this.children[0].setModifier("image",t)}}).extend({_setEmbed:function(e){var t=this,i=this.children[0].getModifier("embed");i.thumbnail_url&&i.content_type&&i.iframe&&i.iframe.url?t._onOEmbedCallbackSuccess(i.content_type,i.thumbnail_url,null,i.iframe.url):n(35).getOEmbedlyData(e,function(e){var n=e&&e.data&&e.data.value;n?t._onOEmbedCallbackSuccess(n.type,n.thumbnail_url,n.html):t._onEmbedSectionCallbackError()})},type:"oembedly"});m._VALID_REGEXES=[/https?:\/\/www.vimeo.com\/groups\/*\/videos\/.*/,/https?:\/\/www.vimeo.com\/.*/,/https?:\/\/vimeo.com\/groups\/.*\/videos\/.*/,/https?:\/\/vimeo.com\/.*/,/https?:\/\/vimeo.com\/m\/#\/.*/,/https?:\/\/player.vimeo.com\/.*/,/http:\/\/www.hulu.com\/watch.*/,/http:\/\/www.hulu.com\/w\/.*/,/http:\/\/www.hulu.com\/embed\/.*/,/http:\/\/hulu.com\/watch.*/,/http:\/\/hulu.com\/w\/.*/,/http:\/\/hulu.tv\/.*/,/http:\/\/www.ustream.tv\/recorded\/.*/,/http:\/\/www.ustream.tv\/channel\/.*/,/http:\/\/www.ustream.tv\/.*/,/http:\/\/ustre.am\/.*/,/http:\/\/link.brightcove.com\/services\/player\/bcpid.*/,/http:\/\/bcove.me\/.*/,/http:\/\/www.vevo.com\/watch\/.*/,/http:\/\/www.vevo.com\/video\/.*/,/http:\/\/video.google.com\/videoplay\?.*/,/https?:\/\/.*.dailymotion.com\/video\/.*/,/https?:\/\/.*.dailymotion.com\/.*\/video\/.*/,/http:\/\/khanacademy.org\/*/,/http:\/\/www.khanacademy.org\/*/,/https:\/\/khanacademy.org\/*/,/https:\/\/www.khanacademy.org\/*/,/https?:\/\/www.ted.com\/talks\/.*.html.*/,/https?:\/\/www.ted.com\/talks\/lang\/.*\/.*.html*/,/https?:\/\/www.ted.com\/index.php\/talks\/.*.html.*/,/https?:\/\/www.ted.com\/index.php\/talks\/lang\/.*\/.*.html/,/https?:\/\/www.ted.com\/talks\/.*/];var g=p.extend({init:function(){this._super.apply(this,arguments),this.children[0].setModifier("playable")},_setEmbed:function(e){var t,n;(n=p.getValidRegex(g).exec(e))?t=n[1]:(console.error(new Error("YouTubeEmbedSection: url did not match regex: "+e)),t=""),this.children[0].setModifier("image","https://img.youtube.com/vi/"+t+"/0.jpg")},type:"yt-embed",htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<p>",htmlSuffix:"</p>"});g._VALID_REGEXES=[/(?:https?:\/{2})?(?:w{3}\.)?(?:youtube\.com\/watch.+v=|youtu.be\/|m\.youtube\.com\/|youtube.com\/embed\/)([^\s?&]+)(\?[^\s]+)?(\&[^\s]+)?/];var v=p.extend({_onTweetCallbackSuccess:function(e,t){this.children[0].setModifier("tweet",!0),this.children[0].setModifier("iframe",e),t&&c.renderTweetIFrame(e)},_setEmbed:function(e){var t=this;h(e,function(e,n){e?t._onTweetCallbackSuccess(e,n):t._onEmbedSectionCallbackError()},function(){t._onEmbedSectionCallbackError()})},type:"tweet",htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<p>",htmlSuffix:"</p>"});v._VALID_REGEXES=[/https:\/\/(.*\.)?twitter.com\/.*\/status\/.*/];var b=p.extend({_onEmbedCallbackSuccess:function(e){e.scrolling="no",this.children[0].setModifier("hyperlink_embed",!0),this.children[0].setModifier("iframe",e),e.onload=function(){var t=(e.contentDocument||e.contentWindow.document).querySelector(".HyperLinkPreview").offsetHeight;e.style.height=t+10+"px"}},_setEmbed:function(e){var t=this;f.options.qtextReactHyperlinkEmbed?f.platform.makeRpc("/hyperlink/get_embed_data_POST",{formkey:f.platform.getFormkey(),json:JSON.stringify({args:[],kwargs:{url:e}})}).then(function(e){e&&e.data?(t.data=e.data.value,t.children[0].setModifier("hyperlink_embed",!0),t.children[0].setModifier("react_placeholder"),t.parent.insertHyperlinkEmbedPreview(t)):t._onEmbedSectionCallbackError})["catch"](this._onEmbedSectionCallbackError):t._getEmbedData(e,function(e){e?t._onEmbedCallbackSuccess(e):t._onEmbedSectionCallbackError()},function(e){console.log("error",e)})},_getEmbedData:function(e,t,n){f.platform.makeRpc("/hyperlink/get_embed_POST",{formkey:f.platform.getFormkey(),json:JSON.stringify({args:[],kwargs:{url:e}})}).then(function(e){if("error"in e)n(e);else{var i=document.createElement("iframe");i.className="hyperlink-embed styleable",i.srcdoc=e.data.value.html,t(i)}})["catch"](n)},type:"hyperlink_embed",htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<p>",htmlSuffix:"</p>",showLoadingDots:!0});b._VALID_REGEXES=[/https?:\/\/.*/];var y=function(){var e={};return e["yt-embed"]=g,e.oembedly=m,u()&&(e.tweet=v),l()&&(e.hyperlink_embed=b),e},S=function(){var e=s.create("div");e.className+="loading_dot_container";for(var t=0;t<3;t++){var n=s.create("div");n.className+="loading_dot",0===t?n.className+=" first":1===t&&(n.className+=" second"),e.appendChild(n)}return e};t.EmbedSection=p,t.OEmbedlySection=m,t.YouTubeEmbedSection=g,t.TweetSection=v,t.HyperlinkEmbedSection=b,t.getEmbedSectionTypes=y},function(e,t,n){var i=n(5).Class,o=t.Selection=i.extend({__init__:function(e,t,n){this.start=e,this.end=t,this.doc=n},toJSON:function(){return{start:this.start.toJSON(),end:this.end.toJSON()}},equals:function(e){return this.start.equals(e.start)&&this.end.equals(e.end)},getStartNode:function(){return this.start.span.getFocusNode()},getEndNode:function(){return this.end.span.getFocusNode()},moveStart:function(e){this.start.span=e.span,this.start.offset=e.offset},moveEnd:function(e){this.end.span=e.span,this.end.offset=e.offset},isCollapsed:function(){return this.start.equals(this.end)},charBefore:function(){return this.start.charBefore()},hasCharBefore:function(){return this.start.hasCharBefore()},previousTextUntil:function(e){for(var t=this.start.span,n=this.start.offset,i="";t&&t!=e.span;)i=t.getText().substring(0,n)+i,(t=t.previousSibling())&&(n=t.getLength());return t&&(i=t.getText().substring(e.offset,n)+i),i},hasCharAfter:function(){return this.start.hasCharAfter()},charAfter:function(){return this.end.charAfter()},charPosition:function(){for(var e=this.start.offset,t=this.start.span.previousSibling();t;)e+=t.getLength(),t=t.previousSibling();for(var n=this.start.span.parent.previousSibling();n;)e+=n.getLength()+1,n=n.previousSibling();return e},containsEntireSection:function(e){var t,n=this.start,i=this.end;for(t=n.span.parent;t&&t.previousSibling()!=i.span.parent;){if(e==t&&(n.span.parent!=e||n.atSectionStart())&&(i.span.parent!=e||i.atSectionEnd()))return!0;t=t.nextSibling()}return!1},getCoveringSpans:function(){for(var e=this.start.span,t=[];e&&e!=this.end.span;)t.push(e),e=e.next();return t.push(e),t},getText:function(){var e="";if(this.start.span.parent!=this.end.span.parent){var t=this.start.span.parent,n=this.end.span.parent,i=new o(this.start,t.last()),r=new o(n.first(),this.end);e+=i.getText();for(var a=t.nextSibling();a&&a!=n;a=a.nextSibling())e+=a.getText();return e+=r.getText()}for(var s=this.start.span,d=this.start.offset;s&&s!=this.end.span;)e+=s.getText().substring(d,s.getLength()),d=0,s=s.nextSibling();return s&&(e+=s.getText().substring(d,this.end.offset)),e}})},function(e,t,n){var i=n(6).Section,o=n(8).Span,r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJQAAAACCAYAAAC+A/WKAAAAIElEQVQ4EWM8c+bMf4ZRMBoCVAoBJiqZM2rMaAiAQwAAtqkDZ/wM/6kAAAAASUVORK5CYII=",a=i.extend({init:function(){var e=[new o("",{image:r})];this._super("horizontal-rule",e,0,!1)},allowedModifiers:function(){return["image"]},getChildrenContents:function(){return""},_getHTMLPrefix:function(){return"<hr>"},_getHTMLSuffix:function(){return"</hr>"},determineDirection:function(){return null}});t.HorizontalRuleSection=a,t.horizontalRuleImg=r},function(e,t,n){"use strict";var i="LTR",o="RTL",r=null;function a(e){return e===i?"ltr":"rtl"}function s(e){r=e}e.exports.NEUTRAL="NEUTRAL",e.exports.LTR=i,e.exports.RTL=o,e.exports.isStrong=function(e){return e===i||e===o},e.exports.getHTMLDir=a,e.exports.getHTMLDirIfDifferent=function(e,t){return e===t?null:a(e)},e.exports.setGlobalDir=s,e.exports.initGlobalDir=function(){s(i)},e.exports.getGlobalDir=function(){return r||this.initGlobalDir(),r}},function(e,t,n){var i=n(11).Extension,o=n(12).CodeSection;t.TypingExtension=i.extend({install:function(){},isActive:function(e){return e||(e=this.doc.caret.selection),!(e.start.span.parent instanceof o)&&(!e.getCoveringSpans().some(function(e){return e.hasModifier("code")||e.hasModifier("math")})&&(!this.doc.formattingState.is("code")&&!this.doc.formattingState.is("math")))}})},function(e,t,n){var i=n(21),o=n(3).CONTENT_TYPES,r=n(2).Util,a=n(33),s=n(9),d=s.extend,c=n(22).Container,l=n(4).Position,u=n(8).Span,h=n(29).Quirks,f=n(27).isValidEmail,p=n(36).UndoManager,m=n(30),g=n(37).SHORTCUTS,v=n(6).Section,b=n(7).PlainSection,y=n(13),S=y.UnorderedListSection,x=y.OrderedListSection,_=n(25).H1Section,C=n(12).CodeSection,E=n(14).ImageSection,T=n(17).HorizontalRuleSection,k=n(38).FormattingState,w=n(39).Caret,I=n(15).EmbedSection,O=n(10).canSetModifier,M=n(0).config,R=n(40),N=n(41).qtextDocStyles,L=n(18),A=c.create("doc",{init:function(e,t,o,a){i.rangy.init(),r.loadCss("qtext-doc",N),this.disabledCommands=[],M.setClientInfo(t),M.setOptions(o),M.setPlatformFunctions(a),L.setGlobalDir(M.options.defaultDirection),this.fromJSON(e,!0),r.setData(this.node,"placeholder",M.options.placeholder),M.options.isDarkModeOn&&this.node.classList.add("dark_mode"),M.options.minHeight&&(this.node.style["min-height"]=M.options.minHeight),this._id=M.getDocId(),this._originalJson=this.toJSON(),this._hasBeenModified=!1,this._emitter=new R.EventEmitter,this._allEmitter=new R.EventEmitter,this.enable(),this._attachEventListeners(),this._commands={},this._attachCommands(),this._extensions=[],this._initExtensions();var s=n(42).MutationFixer;this.mutationFixer=new s(this);var d=this.firstChild().firstChild();this.caret=new w(d.first(),d.first(),this),this.formattingState=new k(this.caret),this.undoManager=new p(this._originalJson),this.linkSelector=null,this.imageUploader=null,this.photoSearch=null,this.hyperlinkEmbedManager=null,this._contentType=null,this._backspaceCount=0,this._updatePlaceholder(),this.on("meaningfulChange",this._updatePlaceholder.bind(this)),this.linkInputFocus=!0,this._pendingImages={}},setSendMessageFn:function(e){M.setSendMessageFn(e)},setRpcSupport:function(e,t){M.setRpcFn(e),M.setGetFormkeyFn(t)},setLinkInputFocus:function(e){this.linkInputFocus=e},destroy:function(){this._destroyed=!0,r.safeRemoveChild(this.node,this.node.parentElement),this._extensions.forEach(function(e){e.destroy()})},contains:function(e){return this.node.contains(e)},isEmpty:function(){return 1==this.children.length&&this.children[0].isEmpty()},isInModal:function(){return s.hasAncestor(this.node,".Modal")},isOnlyWhiteSpace:function(){return this.children.every(function(e){return e.isOnlyWhiteSpace()})},getLength:function(){var e=0;return this.children.forEach(function(t){e+=t.getLength()}),e},disableCommands:function(e){this.disabledCommands=e||[]},isDisabledCommand:function(e){return e.startsWith("video")?this.disabledCommands.includes("video"):this.disabledCommands.includes(e)},allowsMultipleSections:function(){return!this.isDisabledCommand("return")},disable:function(){this.node.removeAttribute("contenteditable"),this.disabled=!0},enable:function(){this.node.setAttribute("contenteditable","true"),this.disabled=!1},focus:function(){if(this.node){var e=window.scrollX,t=window.scrollY;if(this.node.focus(),window.scrollTo(e,t),this.moveCaret(this.caret.start,this.caret.end,!0),M.clientInfo.isIOSApp){var n=this;setTimeout(function(){n.caret.scrollIntoViewIfNeeded()},500)}}},clear:function(){this.fromJSON({})},forceDomReflow:function(){for(var e=this.caret.toJSON(),t=this.children.slice(),n=0;n<t.length;n++){var i=t[n];if(!(i instanceof E||i instanceof I)){var o=v.fromJSON(i.toJSON(!0));this.insertAfter(o,i),this.removeChild(i)}}this._caretFromJSON(e)},toJSON:function(e){var t={sections:[],caret:this.caret&&this.caret.toJSON()};return this.children.forEach(function(n){var i=n.toJSON(e);i&&t.sections.push(i)}),r.removeNullValues(t)},fromJSON:function(e,t){for(var n=e.sections||[],i=this.toJSON().sections,o=this.children.slice(),r=a.lineDiff(i,n,s.jsonEqual),d=0;d<r.length;d++){var c=r[d];if("insert"==c.type){var l=v.fromJSON(n[c.index]);l?this.insertBefore(l,this.children[c.index]):console.debug("Not supported yet: ".concat(n[c.index].type))}else"remove"==c.type&&this.removeChild(o[c.index])}n.length&&this.children.length||this.appendChild(new b),this._caretFromJSON(t?null:e.caret),M.options.lightWeightContentToolbar&&t&&1===this.children.length&&(this.children[0]instanceof I||this.children[0]instanceof E)&&this.insertBefore(new b,this.children[0])},_caretFromJSON:function(e){if(e){var t=e.start,n=e.end;-1!=t.sectionIdx&&-1!=t.spanIdx&&-1!=n.sectionIdx&&-1!=n.spanIdx?this.moveCaret(new l(this.children[t.sectionIdx].children[t.spanIdx],t.offset),new l(this.children[n.sectionIdx].children[n.spanIdx],n.offset)):this.caret=new w(this.lastChild().last(),this.lastChild().last(),this)}else this.caret=new w(this.lastChild().last(),this.lastChild().last(),this)},getVideos:function(){return[]},hasBeenModified:function(){return this._hasBeenModified||(this._hasBeenModified=this.hasChanged(this._originalJson)),this._hasBeenModified},hasChanged:function(e){var t=this.toJSON();return!s.jsonEqual(t.sections,e.sections)},on:function(e,t){this._emitter.on(e,t)},onAll:function(e){this._allEmitter.on("all",e)},trigger:function(e){for(var t=new Array(arguments.length-1),n=1;n<arguments.length;++n)t[n-1]=arguments[n];return this._allEmitter.trigger("all",[e].concat(t)),!this._emitter.trigger(e,t).some(function(e){return!1===e})&&null},_getToolbarFormattingState:function(e){var t=this.caret.start.span,n=t.parent,i=this.caret.isCollapsed()&&this.caret.hasCharBefore(),o=this.formattingState.is("bold"),a=this.formattingState.is("italic"),d=this.formattingState.is("link"),c=this.formattingState.is("math"),l=this.formattingState.is("code")||n instanceof C,u=n instanceof _,h=n instanceof x,f=n instanceof S,p=h||f,m=t.isEditable(),g=l||c||u||!m,v={span:t,section:n,isMidWord:i,isBold:o,isItalic:a,isLink:d,isMath:c,isCode:l,isH1Tag:u,isOrderedList:h,isUnorderedList:f,isList:p,isEditable:m,disableFormatting:g,disableStyle:g,disableUndo:!(this.undoManager.canUndo()||!s.jsonEqual(this.toJSON(),this.undoManager.state())),disableRedo:!this.undoManager.canRedo()};return r.assert(e in v,"state name not found: "+e),v[e]},_getToolbarItem:function(e){var t=this._getToolbarFormattingState("section"),n=this._getToolbarFormattingState("isMidWord"),i=this._getToolbarFormattingState("isBold"),o=this._getToolbarFormattingState("isItalic"),a=this._getToolbarFormattingState("isLink"),s=this._getToolbarFormattingState("isMath"),d=this._getToolbarFormattingState("isCode"),c=this._getToolbarFormattingState("isH1Tag"),l=this._getToolbarFormattingState("isOrderedList"),u=this._getToolbarFormattingState("isUnorderedList"),h=this._getToolbarFormattingState("isEditable"),f=this._getToolbarFormattingState("disableStyle"),p=this._getToolbarFormattingState("disableUndo"),m=this._getToolbarFormattingState("disableRedo");M.clientInfo.isAndroid&&(f=n||f);var g={bold:{name:"bold",pressed:i,disabled:f},italic:{name:"italic",pressed:o,disabled:f},h1:{name:"h1",pressed:c,disabled:!c&&f},orderedList:{name:"ordered_list",pressed:l,disabled:!h},unorderedList:{name:"unordered_list",pressed:u,disabled:!h},indent:{name:"indent"},deindent:{name:"deindent"},mention:{name:"mention",disabled:a||d||s||!h},quote:{name:"quote",pressed:t.isQuoted(),disabled:!1},code:{name:"code",pressed:d,disabled:!h||s},math:{name:"math",pressed:s,disabled:!h||d},undo:{name:"undo",disabled:p},redo:{name:"redo",disabled:m}};return r.assert(e in g,"item name not found: "+e),c&&!["h1","undo","redo"].includes(e)&&(g[e].disabled=!0),g[e]},_getToolbarLinkItems:function(){var e=[];return M.clientInfo.isNativeApp||e.push({name:"link_input_icon"}),e.concat([{name:"link_input",focused:this.linkInputFocus},{name:"space"},{name:"cite"},{name:"link_save"}])},_isVideoEnabled:function(){return!(!this._isImageEnabled()||!this._isVideoEnabledForUser()||this.isDisabledCommand("video"))},_isVideoEnabledForUser:function(){return M.options.videoEnabled&&(M.options.videoEditorSupported||M.clientInfo.debug)},_isImageEnabled:function(){var e=this._getToolbarFormattingState("isList");return!(M.clientInfo.isMobile&&e)},_getToolbarContentItems:function(){var e=this._getToolbarFormattingState("disableFormatting"),t=this._getToolbarFormattingState("isLink"),n=[],i=this._isImageEnabled(),o=this._isVideoEnabled();return M.options.tabbedEditorToolbar?(!this.isDisabledCommand("video")&&this._isVideoEnabledForUser()&&n.push({name:"video-tab",disabled:!o}),this.isDisabledCommand("image")||n.push({name:"photos-tab",disabled:!i})):(o&&n.push({name:"video"}),i&&n.push({name:"image"})),n.push({name:"link",pressed:t,disabled:e}),n},_getToolbarIndentItems:function(){var e=[];return this._getToolbarFormattingState("isList")&&(e=e.concat([this._getToolbarItem("indent"),this._getToolbarItem("deindent")])),e},_getToolbarTabbedItems:function(){var e=[this._getToolbarItem("italic"),this._getToolbarItem("bold"),this._getToolbarItem("mention"),this._getToolbarItem("undo"),this._getToolbarItem("orderedList"),this._getToolbarItem("unorderedList"),this._getToolbarItem("quote"),this._getToolbarItem("code"),this._getToolbarItem("math")];return e=(e=e.concat(this._getToolbarIndentItems())).concat(this._getToolbarContentItems())},getToolbarState:function(e){if(M.options.lightWeightContentToolbar){var t=this,n=this._getToolbarFormattingState("isList");return 0===e?i=[{name:"text_formatting"},{name:"image"},{name:"space"},{name:"rules"}]:1===e?(i=[{name:"dismiss"},t._getToolbarItem("h1"),t._getToolbarItem("bold"),t._getToolbarItem("italic"),t._getToolbarItem("orderedList"),t._getToolbarItem("unorderedList")],n&&(i=i.concat([{name:"indent",disabled:!1},{name:"deindent",disabled:!1}])),i=(i=i.concat(t._getToolbarContentItems().filter(function(e){return"image"!==e.name}))).concat([t._getToolbarItem("mention"),t._getToolbarItem("quote"),t._getToolbarItem("code"),t._getToolbarItem("math"),t._getToolbarItem("undo"),t._getToolbarItem("redo")])):2===e&&(i=t._getToolbarLinkItems()),i.forEach(function(e){t.isDisabledCommand(e.name)&&(e.pressed=!1,e.disabled=!0)}),i}var i;t=this;return 0===e?i=t._getToolbarLinkItems():M.options.tabbedEditorToolbar?i=t._getToolbarTabbedItems():1===e?((i=(i=[t._getToolbarItem("bold"),t._getToolbarItem("italic"),t._getToolbarItem("orderedList"),t._getToolbarItem("unorderedList")]).concat(t._getToolbarIndentItems())).push({name:"space"}),(i=i.concat(t._getToolbarContentItems())).push({name:"overflow_show",grayBackground:!0})):2===e&&(i=[t._getToolbarItem("mention"),t._getToolbarItem("quote"),t._getToolbarItem("code"),t._getToolbarItem("math"),{name:"space"},t._getToolbarItem("undo"),t._getToolbarItem("redo"),{name:"overflow_hide"}]),i.forEach(function(e){t.isDisabledCommand(e.name)&&(e.pressed=!1,e.disabled=!0)}),i},updateSpellingSuggestions:function(){M.clientInfo.isIOSApp&&setTimeout(function(){M.platform.sendMessage("selectionChanged")},0)},flushTextInput:function(){M.clientInfo.isIOSApp&&M.clientInfo.buildNumber>=860&&M.platform.sendMessage("flushTextInput")},handleCommand:function(e){if(this.isDisabledCommand(e))return!1;for(var t=e,n=new Array(arguments.length-1),i=1;i<arguments.length;++i)n[i]=arguments[i];return M.clientInfo.isIOS&&this._backspaceCount>20&&"backspace"==t&&(t="delete-previous-word"),n[0]="command-"+t,this.trigger.apply(this,n)},progressivelyExitSection:function(e,t){if(e.getIndent()>0)e.setIndent(e.getIndent()-1);else if(e instanceof b||t)e.isQuoted()&&e.setQuoted(!1);else for(var n=(e=e.changeType(b)).previousSibling();n&&n.isEditable()&&(n.isEmpty()||""===n.node.textContent.trim());){var i=n;n=n.previousSibling(),this.removeChild(i)}return e},toggleModifier:function(e){var t,n;return this.formattingState.toggleModifier(this.caret,e),this.caret.isCollapsed()?(this.focus(),this.updateSpellingSuggestions(),!1):(t=this._getSelectedSpans(!1),n=t.every(function(t){return t.hasModifier(e)||!O(t,e)}),t.forEach(function(t){t.isEditable()&&(n?t.removeModifier(e):t.setModifier(e,!0))}),this.focus(),!1)},toggleSectionType:function(e){var t=this._getSelectedSections(),n=t[0]instanceof e,i=this.caret.start.clone(),o=this.caret.end.clone();return t.forEach(function(t){t.isEditable()&&(n?t.changeType(b):t.changeType(e))}),this.moveCaret(i,o),n||this.forceDomReflow(),!1},cloneSelection:function(){var e,t,n=this,i=this._getSelectedSpans(!1),o=[];return i.forEach(function(i){e!=i.parent&&(e=i.parent,(t=i.parent.toJSON()).spans=[],n.caret.containsEntireSection(e)||(t.type="plain"),o.push(t)),t.spans.push(i.toJSON())}),o.map(function(e){return v.fromJSON(e)})},sanitizeContent:function(e){var t=this,n=e.filter(function(e){return!(e instanceof E&&t.isDisabledCommand("image"))&&(!(e instanceof I&&t.isDisabledCommand("embed"))&&!(e instanceof T&&t.isDisabledCommand("horizontal-rule")))});return!t.allowsMultipleSections()&&e.length>0&&(n=[n.reduce(function(e,t){return e.merge(t),e})]),n=n.map(function(e){var n=e instanceof C&&t.isDisabledCommand("code");return(n=(n=n||e instanceof S&&t.isDisabledCommand("unordered_list"))||e instanceof x&&t.isDisabledCommand("ordered_list"))&&(e=e.changeType(b)),e.setQuoted(e.isQuoted()&&!t.isDisabledCommand("quote")),e.children.forEach(function(e){for(var n in e.modifiers)t.isDisabledCommand(n)&&e.removeModifier(n)}),e})},saveState:function(){this.undoManager.add(this.toJSON()),this.trigger("meaningfulChange")},setImageUploader:function(e){this.imageUploader=e},setHyperlinkEmbedManager:function(e){this.hyperlinkEmbedManager=e},setUploadRetryManager:function(e){this.uploadRetryManager=e},setLinkSelector:function(e){var t=this;t.linkSelector=e,e.onSubmit(function(n){var i=n.target||{type:"url",url:n.url};!i.url&&n.url&&(i.url=n.url);var o=t._insertOrModifyLink(n.text,i);e.hide(),t.focus(),t.moveCaret(o.nextSibling().last()),setTimeout(function(){t.focus(),t.caret.scrollIntoViewIfNeeded(),t._focusAfterHidingLinkSelectorOnIOS()},0),t.saveState()}),e.onCancel(function(n){if(e.hide(),t.focus(),n){var i=t.caret.start.span.modifiers,o=new u(n,i);t.insertSpan(t.caret.start,o),t.moveCaret(o.last())}})},_focusAfterHidingLinkSelectorOnIOS:function(){if(M.clientInfo.isIOSApp){var e=this;setTimeout(function(){e.node&&e.node.blur(),setTimeout(function(){e.focus(),e.caret.scrollIntoViewIfNeeded()},300)},300)}},setPhotoSearch:function(e){var t=this;t.photoSearch=e,e.onInsert(function(n){t.insertAndUploadImageUrl(n,"photosearch"),e.hide(),t.focus()}),e.onCancel(function(){e.hide(),t.focus()})},setContentType:function(e){this._contentType=e},getContentType:function(){return this._contentType||"unknown"},getCurrentDirection:function(){return this.caret.start.span.parent.getDirection()},_parseAndLinkifySections:function(e){var t=[];return e.forEach(function(e){e.children.forEach(function(n){if(O(n,"link")&&!n.hasModifier("link")){var i=r.linkify(n.getText());if(0!==i.length&&(1!=i.length||i[0].href)){var o=n.modifiers;i.forEach(function(i){var r=i.text,a=i.href,s=new u(r,o);a&&(s.setModifier("link",{type:"url",url:a},!0),t.push(s)),e.insertBefore(s,n)}),e.removeChild(n)}}})}),t},linkifySections:function(e){this.fetchLinkPreviews(this._parseAndLinkifySections(e))},insertAndUploadImageUrl:function(e,t,n){if(this.imageUploader){var i=this;this.imageUploader.showUploading(),this.imageUploader.uploadImageUrl(e,function(e){n&&(n.previousSibling()?i.moveCaret(n.previousSibling().last()):n.nextSibling()?i.moveCaret(n.nextSibling().first()):(n.parent.insertBefore(new u(" "),n),i.moveCaret(n.previousSibling().first())),n.parent.removeChild(n)),i.insertImages([e],{source:t}),i.imageUploader.hideDropZone()})}},uploadPendingImages:function(e){if(this.imageUploader){this.imageUploader.uploadPendingImages(e,this.replaceTempUrls.bind(this),this.markFailedUrls.bind(this))}},replaceTempUrls:function(e){this.children.forEach(function(t){if(t instanceof E&&t.isPending){var n=t.children[0].getModifier("image"),i=e[n];i&&t.setUploadSuccess(i)}})},markFailedUrls:function(e){this.children.forEach(function(t){if(t instanceof E&&t.isPending){var n=t.children[0].getModifier("image");e.includes(n)&&t.setUploadFailed()}})},insertSpan:function(e,t){var n;return n=e.atSpanStart()?e.span:e.atSpanEnd()?e.span.nextSibling():e.span.split(e.offset),e.span.parent.insertBefore(t,n),""===e.span.getText()&&e.span.parent.removeChild(e.span),t.last()},insertImages:function(e,t,n){this.handleCommand("image",e,t,n)},insertClipboardSuggestion:function(e,t,i){if(e){var r=n(26).parse(e,o.TEXT);r=this.sanitizeContent(r);var a=n(15).EmbedSection.fromOtherSection(r[0],!0);if(a){var s=this;this.children.forEach(function(e){e.clipboardPending&&s.removeChild(e)}),a.setOnRemoveCallback(i),this.insertSections([a]),setTimeout(function(){t(a.children[0]._reactPlaceholder)},1)}}},insertHyperlinkEmbedPreview:function(e){var t=this;if(t.hyperlinkEmbedManager){var n={data:e.data,placeholder:e.children[0]._reactPlaceholder};t.hyperlinkEmbedManager.insertHyperlinkEmbedPreview(n),e.setOnRemoveCallback(function(){t.hyperlinkEmbedManager.removeHyperlinkEmbedPreview(n)})}},insertUploadRetryButton:function(e){var t=this;if(t.uploadRetryManager){var n={button:e.children[0]._retryButton,banner:e.children[0]._retryBanner};t.uploadRetryManager.insertButtonAndBanner(n),e.registerReactUnmountCallback(function(){t.uploadRetryManager.removeButtonAndBanner(n)})}},retryUpload:function(){this.imageUploader&&(this.children.forEach(function(e){e instanceof E&&e.isPending&&e.removeRetryButton()}),this.imageUploader.retryUpload(this.replaceTempUrls.bind(this),this.markFailedUrls.bind(this)))},moveCaret:function(e,t,n){var i=this.caret.move(e,t,n);return this.trigger("caretMoved"),i},moveCaretEnd:function(e){var t=this.caret.moveEnd(e);return this.trigger("caretMoved"),t},moveCaretStart:function(e){var t=this.caret.moveStart(e);return this.trigger("caretMoved"),t},_updatePlaceholder:function(){this.isEmpty()&&this.children[0]instanceof b&&!this.children[0].isQuoted()?this.node.classList.add("empty"):this.node.classList.remove("empty")},_handleEmptySpan:function(e){var t,n,i;return e.parent.firstChild()==e&&1==e.parent.children.length?(e.setText(""),e.removeAllModifiers(),e.first()):(n=e.previousSibling(),i=e.nextSibling(),e.parent.removeChild(e),n?(e=n,t=n.getLength()):(e=i,t=0),new l(e,t))},updateCaret:function(){var e=this.caret.update();return e&&(this.trigger("caretMoved"),this.trigger("meaningfulChange")),this._updateActiveSpans(),e},_updateCaretAndFormattingState:function(){this.updateCaret()&&this._updateFormattingState()},_updateActiveSpans:function(){var e,t,n=this.node.querySelectorAll(".active"),i=this.caret.start.span,o=this.caret.end.span;for(e=0;e<n.length;e++)n[e].classList.remove("active");for(t=i;t!=o;t=t.next())t.node.classList.add("active");t.node.classList.add("active")},_debugEvent:function(e,t){},_attachEventListeners:function(){var e,t=this,n=this._debugEvent.bind(this),i=new m.Hub(this.node);s.iterItems(g,function(e,n){var o={source:"keyboard",shortcut:e};i.on(e,function(e){return t.handleCommand(n,e,o)})}),["Left","Up","Home"].forEach(function(e){i.on(e,function(){return!(t.caret.isCollapsed()&&t.caret.start.atDocStart())})}),["Right","Down","End"].forEach(function(e){i.on(e,function(){return!(t.caret.isCollapsed()&&t.caret.start.atDocEnd())})}),r.on("input",this.node,function(e){if(n("input",e),M.clientInfo.isAndroid&&"@"==e.data)return t.handleCommand("mention","@",{source:"keyboard"})}),r.on("keydown",this.node,function(o){var r;return n("keydown",o),m.isNavigation(o)&&!t.caret.isCollapsed()||t.updateCaret(),m.isOnlyShiftKey(o)||t.caret.scrollIntoViewIfNeeded(),M.clientInfo.isIOS&&(8===o.which?t._backspaceCount+=1:t._backspaceCount=0,e<+new Date-500&&(t._backspaceCount=0)),r=i.trigger(o),t.trigger("keydown",o.which),setTimeout(t.trigger.bind(t,"meaningfulChange"),0),r}),r.on("keypress",this.node,function(e){if(n("keypress",e),t.updateCaret(),!e||0===e.which||e.ctrlKey||e.metaKey||e.altKey||t._beforeTextInput(e),"@"==String.fromCharCode(e.which))return t.handleCommand("mention","@",{source:"keyboard"});var i=String.fromCharCode(e.which);return i==e.key?t.trigger("keypress",i):void 0}),r.on("keyup",this.node,function(i){return n("keyup",i),!t.caret.isCollapsed()&&m.isNavigation(i)&&i.shiftKey&&!m.isOnlyShiftKey(i)||t.updateCaret(),M.clientInfo.isIOS&&(e=+new Date),m.isNavigation(i)||!t.caret.isCollapsed()?t._updateFormattingState():t._afterTextInput(),!1}),r.on("compositionstart",this.node,function(e){n("compositionstart",e)}),r.on(["textInput","compositionupdate"],this.node,function(e,i){if(n(i,e),M.clientInfo.isAndroid||t.updateCaret(),t._beforeTextInput(e),"textInput"==i&&h.usesCompositionEvents())return!0;if("compositionupdate"==i&&!h.usesCompositionEvents())return!0;if(!t.caret.isCollapsed())return!0;var o=e.data;if(" "==o&&!1===t.handleCommand("space")||o&&!1===t.trigger("keypress",o))return!1;setTimeout(function(){t.updateCaret(),t.caret.scrollIntoViewIfNeeded(),t._afterTextInput()},0)}),r.on("compositionend",this.node,function(e){n("compositionend",e)}),r.on("focus",this.node,function(){M.restoreConfig(t),t.linkSelector&&t.linkSelector.hide(),t.photoSearch&&t.photoSearch.hide(),t.trigger("focus")}),r.on("blur",this.node,function(){M.cacheConfig(t),t.trigger("blur")}),(M.clientInfo.isMobile||M.clientInfo.isIPad)&&t._runForever(function(){t.updateCaret()}),this._attachMouseAndTouchEvents(),this._attachClipboardEvents(),this._attachDragAndDropListeners()},_attachClipboardEvents:function(){r.on("copy",this.node,this.handleCommand.bind(this,"copy")),r.on("cut",this.node,this.handleCommand.bind(this,"cut")),r.on("paste",this.node,this.handleCommand.bind(this,"paste"))},_attachMouseAndTouchEvents:function(){var e=this,t=null,n=this.trigger.bind(this,"longpress"),i=this._debugEvent.bind(this);r.on(["mousedown","touchstart"],this.node,function(o,r){t||(t=setTimeout(function(){n(o)},500)),i(r,o),setTimeout(e._updateCaretAndFormattingState.bind(e),0),e.trigger(r,o)}),r.on(["mouseup","touchend"],this.node,function(n,o){t&&(clearTimeout(t),t=null),i(o,n),setTimeout(e._updateCaretAndFormattingState.bind(e),0),e.trigger(o,n)}),r.on(["mousemove","touchmove"],this.node,function(t,n){setTimeout(e._updateCaretAndFormattingState.bind(e),0),e.trigger(n,t)})},_attachDragAndDropListeners:function(){if(!M.clientInfo.isMobile){var e=this,t=!1,a=this._debugEvent.bind(this);r.on(["dragstart","dragend"],this.node,function(n,i){a(i,n),t="dragstart"==i;var o=e.caret.start.span.parent;e.caret.isCollapsed()&&(o.isEditable()?"IMG"==n.target.nodeName&&(o=u.get(n.target.parentElement.parentElement).parent,e.moveCaret(o.first(),o.last())):e.moveCaret(o.first(),o.last()))}),r.on("drop",this.node,function(r){a("drop",r);var s,d,c,l,u,h=[o.PUBLIC_HTML,o.HTML];if(t)t=!1,c=e.cloneSelection();else{for(l=0;l<h.length;l++)if(u=r.dataTransfer.getData(h[l])){c=n(26).parse(u,h[l]),c=e.sanitizeContent(c);break}c=c||[]}try{s=i.rangeFromPoint(r.clientX,r.clientY),d=e.caret._fromNode(s.startContainer,s.startOffset),e.saveState(),e._deleteSelection(),e.moveCaret(d),e.insertSections(c),r.preventDefault()}catch(f){console.error(f)}})}},_attachCommands:function(){var e,t,i,o=n(45).COMMANDS,r=Object.keys(o);for(i=0;i<r.length;i++)t=r[i],this.isDisabledCommand(t)||(e=new(0,o[t])(this),this._commands[t]=e,this._emitter.on("command-"+t,e.run.bind(e,t)))},_initExtensions:function(){var e,t,i=n(61).EXTENSIONS;for(t=0;t<i.length;t++)(e=new(0,i[t])(this)).install(),this._extensions.push(e)},_runForever:function(e){var t=this;window.requestAnimationFrame(function n(){if(!t._destroyed)try{e()}catch(i){}finally{window.requestAnimationFrame(n)}})},_beforeTextInput:function(e){var t=this.caret.start.span.parent;if(this.caret.isCollapsed()||(this.saveState(),this._deleteSelection(),t=this.caret.start.span.parent),!t.isEditable()){var n=new b;this.caret.start.atSectionStart()?this.insertBefore(n,t):this.insertAfter(n,t),this.moveCaret(n.first()),this.caret.updateAndroidCaretPosition(1)}this.formattingState.updatePosition(this.caret)},_afterTextInput:function(){this.formattingState.hasChanged(this.caret)&&this._applyFormattingChange();var e=this.caret.start.span.parent,t=e.getLength();(t>0&&!e.isDirectionConfirmed()||0==t)&&e.resetRTL()},_updateFormattingState:function(){this.formattingState.update(this.caret),this.trigger("updateToolbar")},_applyFormattingChange:function(){var e=this.caret.start.span,t=this.formattingState.position.offset,n=this.caret.start.offset;e===this.formattingState.position.span?n>t?(n<e.getLength()&&e.split(n,!0),t>0&&(e=e.split(t,!0)),this.formattingState.apply(e),this.moveCaret(e.last()),this._updateFormattingState()):n<t&&this._updateFormattingState():this._updateFormattingState()},_deleteSelection:function(){var e,t,n=this.caret.start,i=this.caret.end,o=n.span.parent,r=i.span.parent;if(o.isEditable()&&(n.atSpanStart()?n.atSectionStart()||(t=n.alternatePosition()):t=n),o==r)if(o.isEditable())o.deleteText(n,i);else{var a=n.span.next(),s=n.span.previous();a?t=a.first():s?t=s.last():(e=new b,this.insertAfter(e,o),t=e.first()),this.removeChild(o)}else{for(o.isEditable()?o.deleteText(n,o.last()):(e=new b,this.insertBefore(e,o),this.removeChild(o),o=e);o.nextSibling()!=r;)this.removeChild(o.nextSibling());r.isEditable()?r.deleteText(r.first(),i):(e=new b,this.insertBefore(e,r),this.removeChild(r),r=e),t=o.merge(r)}t||(t=o.first()),this.moveCaret(t,t,!0)},_getSelectedSpans:function(e,t){t||this.updateCaret();var n=[],i=this.caret.start,o=this.caret.end;if(this.caret.isCollapsed())return[];if(i.span==o.span)o.offset<o.span.getLength()&&o.span.split(o.offset,e),i.offset>0&&(o.span=i.span=i.span.split(i.offset,e)),n=[i.span];else{i.offset>0&&(i.offset==i.span.getLength()?i.span=i.span.next():i.span=i.span.split(i.offset,e)),o.offset<o.span.getLength()&&(0===o.offset?o.span=o.span.previous():o.span.split(o.offset,e));for(var r=i.span;r!=o.span;r=r.next())n.push(r);n.push(o.span)}return this.moveCaret(i.span.first(),o.span.last()),n},_toggleMathOrCodeModifier:function(e){if(!this.caret.isCollapsed()){var t=this._getSelectedSpans(!0);t[0].getModifier(e)?t.forEach(function(t){t.removeModifier(e)}):((t=this._mergeSpansBySection(t)).forEach(function(t){t.setModifier(e,!0,!0)}),this.moveCaret(t[0].first(),t[t.length-1].last())),this._updateFormattingState()}},_getSelectedSections:function(){this.updateCaret();var e,t=[],n=this.caret.start,i=this.caret.end;if(this.caret.isCollapsed())t.push(n.span.parent);else{for(e=n.span.parent;e!=i.span.parent;e=e.nextSibling())t.push(e);t.push(i.span.parent)}return t},insertSections:function(e){var t,n,i,o,r,a,s,c=this;if(0!==e.length){var l=this.caret.doc.isEmpty();if(c.caret.isCollapsed()||c._deleteSelection(!0),this.handleCommand("embed",e),t=c.caret.start,!(i=t.span.parent).isEditable()){var u=new b;c.caret.start.atSectionStart()?c.insertBefore(u,i):c.insertAfter(u,i),c.moveCaret(u.first()),i=u,t=u.first()}s=d({},t.span.modifiers),i.split(t),o=i.nextSibling(),e.forEach(function(e){e.children.forEach(function(t){e.isEditable()&&t.updateModifiers(s,!0)}),c.insertBefore(e,o),i instanceof C&&e.isEditable()&&e.changeType(C),e.setIndent(e.getIndent())});var h=this._parseAndLinkifySections(e);r=i.nextSibling();var f=M.options.lightWeightContentToolbar&&l&&(r instanceof I||r instanceof E);r.constructor==i.constructor||r instanceof b?i.merge(r):i.isEmpty()&&(f||this.removeChild(i)),(a=o.previousSibling()).isEditable()&&(a.constructor==o.constructor||o instanceof b)?(n=a.last(),a.merge(o)):n=f?i.first():o.first(),this.moveCaret(n),this.fetchLinkPreviews(h),a instanceof E&&o instanceof x&&this.forceDomReflow()}},_shouldAllowLinks:function(e){var t=(e=e||this.caret.start.span).parent;return!!this.caret.isCollapsed()&&(!e.hasModifier("link")&&(!(t instanceof C||e.hasModifier("code"))&&(!e.hasModifier("math")&&!(t instanceof _))))},_insertOrModifyLink:function(e,t,n,i){var o=this.caret.start,r=!i&&o.span.hasAnyModifier(["link","citation"]),a=r?o.span:new u(e),s=new u(" ");return r||a.updateModifiers(o.span.modifiers),a.removeModifier("link"),a.removeModifier("citation"),s.updateModifiers(a.modifiers),r||(o=this.insertSpan(o,a)),n?(a.setModifier("citation",{target:t}),a.setText(" ")):(a.setModifier("link",t),a.setText(e)),o=a.last(),this.caret.move(o)," "!==this.caret.charAfter()&&(o=this.insertSpan(o,s),this.caret.move(o)),a},_previewLink:function(e,t){var n,i,o,a=this;t=t||this.saveState.bind(this),e.hasModifier("link")?o=e.getModifier("link").url:e.hasModifier("citation")?(i="target"in(n=e.getModifier("citation"))?n.target:n,o=i.url):o=e.getText(),o.startsWith("mailto:")&&f(o.slice(7))||(o=r.ensureProtocol(o),this.linkSelector&&this.linkSelector.getLinkPreview(o,function(n){a.disabled||(t(),e.hasModifier("citation")?e.setModifier("citation",d({title:n.title},e.getModifier("citation"))):"image"==n.type?a.insertAndUploadImageUrl(o,"link",e):(e.setText(n.title),a.caret.start.span==e&&(a.moveCaret(e.last()),a._updateFormattingState())))},function(){}))},fetchLinkPreviews:function(e){var t=this,n=s.once(function(){t.saveState()});e.forEach(function(e){t._previewLink(e,n)})},_mergeSpansBySection:function(e){var t,n=null,i=null,o=[];return e.forEach(function(e){e.parent!=i?(n=e,i=e.parent,o.push(e)):(t=r.objectIntersection(n.modifiers,e.modifiers),n.removeAllModifiers(),n.updateModifiers(t),n.setText(n.getText()+e.getText()),e.parent.removeChild(e))}),o}});t.Doc=A},function(e,t){var n=t.rangy={getSelection:function(){return window.getSelection()},createRange:function(){return document.createRange()},init:function(){}};t.rangeFromPoint=function(e,t){var i,o,r,a,s;return document.caretPositionFromPoint?(r=(i=document.caretPositionFromPoint(e,t)).offsetNode,a=i.offset):document.caretRangeFromPoint?(r=(o=document.caretRangeFromPoint(e,t)).startContainer,a=o.startOffset):document.elementFromPoint&&(r=document.elementFromPoint(e,t),a=0),r&&a!==undefined?((s=n.createRange()).setStart(r,a),s.setEnd(r,a),s.collapse(!0),s):null}},function(e,t,n){var i=n(5).Class,o=n(2).Util,r=i.extend({__init__:function(e){this.kind=e,this.node=o.create("DIV"),this.node.className=this.kind,this.children=[]},init:function(){},insertAfter:function(e,t){if(e.parent&&e.parent.removeChild(e),t){var n=t.node.nextSibling;this.node.insertBefore(e.node,n),this.children.splice(this.children.indexOf(t)+1,0,e)}else this.node.appendChild(e.node),this.children.push(e);e.parent=this},insertBefore:function(e,t){e.parent&&e.parent.removeChild(e),t?(this.node.insertBefore(e.node,t.node),this.children.splice(this.children.indexOf(t),0,e)):(this.node.appendChild(e.node),this.children.push(e)),e.parent=this},appendChild:function(e){this.insertBefore(e)},appendChildren:function(e){e.forEach(this.appendChild.bind(this))},hasChild:function(e){return-1!==this.children.indexOf(e)},removeChild:function(e){if(this.hasChild(e)){var t=this.children.indexOf(e);this.children.splice(t,1),o.safeRemoveChild(e.node,this.node)}},removeChildren:function(){for(var e,t=this.firstChild();t;)e=t.nextSibling(),this.removeChild(t),t=e},previousSibling:function(){return this.node.previousSibling&&this.Class.get(this.node.previousSibling)},nextSibling:function(){return this.node.nextSibling&&this.Class.get(this.node.nextSibling)},firstChild:function(){return 0===this.children.length?null:this.children[0]},lastChild:function(){return 0===this.children.length?null:this.children[this.children.length-1]}});r.create=function(e,t){var n;return o.assert(!t.__init__,"Do not override __init__"),t.__init__=function(){this._super(e),this.init.apply(this,arguments),this.Class=n,n.add(this,this.node)},(n=r.extend(t)).add=function(e,t){o.setData(t,"kind",e.kind),t.qtextContainer=e},n.get=function(e){return o.assert(n.is(e)),e.qtextContainer},n.is=function(t){return!!t&&(1==t.nodeType&&o.getData(t,"kind")==e)},n},t.Container=r},function(e,t,n){var i=n(0).config;t.hyperlinkEmbedsEnabled=function(){return i.options.qtext_hyperlink_embed}},function(e,t,n){"use strict";var i=n(18),o="\u0590\u05be\u05c0\u05c3\u05c6\u05c8-\u05cf\u05d0-\u05ea\u05eb-\u05ef\u05f0-\u05f2\u05f3-\u05f4\u05f5-\u05ff\u07c0-\u07c9\u07ca-\u07ea\u07f4-\u07f5\u07fa\u07fb-\u07ff\u0800-\u0815\u081a\u0824\u0828\u082e-\u082f\u0830-\u083e\u083f\u0840-\u0858\u085c-\u085d\u085e\u085f-\u089f\u200f\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb37\ufb38-\ufb3c\ufb3d\ufb3e\ufb3f\ufb40-\ufb41\ufb42\ufb43-\ufb44\ufb45\ufb46-\ufb4f",r="\u0608\u060b\u060d\u061b\u061c\u061d\u061e-\u061f\u0620-\u063f\u0640\u0641-\u064a\u066d\u066e-\u066f\u0671-\u06d3\u06d4\u06d5\u06e5-\u06e6\u06ee-\u06ef\u06fa-\u06fc\u06fd-\u06fe\u06ff\u0700-\u070d\u070e\u070f\u0710\u0712-\u072f\u074b-\u074c\u074d-\u07a5\u07b1\u07b2-\u07bf\u08a0-\u08b2\u08b3-\u08e3\ufb50-\ufbb1\ufbb2-\ufbc1\ufbc2-\ufbd2\ufbd3-\ufd3d\ufd40-\ufd4f\ufd50-\ufd8f\ufd90-\ufd91\ufd92-\ufdc7\ufdc8-\ufdcf\ufdf0-\ufdfb\ufdfc\ufdfe-\ufdff\ufe70-\ufe74\ufe75\ufe76-\ufefc\ufefd-\ufefe",a=new RegExp("["+"A-Za-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u01ba\u01bb\u01bc-\u01bf\u01c0-\u01c3\u01c4-\u0293\u0294\u0295-\u02af\u02b0-\u02b8\u02bb-\u02c1\u02d0-\u02d1\u02e0-\u02e4\u02ee\u0370-\u0373\u0376-\u0377\u037a\u037b-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0482\u048a-\u052f\u0531-\u0556\u0559\u055a-\u055f\u0561-\u0587\u0589\u0903\u0904-\u0939\u093b\u093d\u093e-\u0940\u0949-\u094c\u094e-\u094f\u0950\u0958-\u0961\u0964-\u0965\u0966-\u096f\u0970\u0971\u0972-\u0980\u0982-\u0983\u0985-\u098c\u098f-\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09be-\u09c0\u09c7-\u09c8\u09cb-\u09cc\u09ce\u09d7\u09dc-\u09dd\u09df-\u09e1\u09e6-\u09ef\u09f0-\u09f1\u09f4-\u09f9\u09fa\u0a03\u0a05-\u0a0a\u0a0f-\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32-\u0a33\u0a35-\u0a36\u0a38-\u0a39\u0a3e-\u0a40\u0a59-\u0a5c\u0a5e\u0a66-\u0a6f\u0a72-\u0a74\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2-\u0ab3\u0ab5-\u0ab9\u0abd\u0abe-\u0ac0\u0ac9\u0acb-\u0acc\u0ad0\u0ae0-\u0ae1\u0ae6-\u0aef\u0af0\u0b02-\u0b03\u0b05-\u0b0c\u0b0f-\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32-\u0b33\u0b35-\u0b39\u0b3d\u0b3e\u0b40\u0b47-\u0b48\u0b4b-\u0b4c\u0b57\u0b5c-\u0b5d\u0b5f-\u0b61\u0b66-\u0b6f\u0b70\u0b71\u0b72-\u0b77\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99-\u0b9a\u0b9c\u0b9e-\u0b9f\u0ba3-\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bbf\u0bc1-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcc\u0bd0\u0bd7\u0be6-\u0bef\u0bf0-\u0bf2\u0c01-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c41-\u0c44\u0c58-\u0c59\u0c60-\u0c61\u0c66-\u0c6f\u0c7f\u0c82-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cbe\u0cbf\u0cc0-\u0cc4\u0cc6\u0cc7-\u0cc8\u0cca-\u0ccb\u0cd5-\u0cd6\u0cde\u0ce0-\u0ce1\u0ce6-\u0cef\u0cf1-\u0cf2\u0d02-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d3e-\u0d40\u0d46-\u0d48\u0d4a-\u0d4c\u0d4e\u0d57\u0d60-\u0d61\u0d66-\u0d6f\u0d70-\u0d75\u0d79\u0d7a-\u0d7f\u0d82-\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dcf-\u0dd1\u0dd8-\u0ddf\u0de6-\u0def\u0df2-\u0df3\u0df4\u0e01-\u0e30\u0e32-\u0e33\u0e40-\u0e45\u0e46\u0e4f\u0e50-\u0e59\u0e5a-\u0e5b\u0e81-\u0e82\u0e84\u0e87-\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa-\u0eab\u0ead-\u0eb0\u0eb2-\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f01-\u0f03\u0f04-\u0f12\u0f13\u0f14\u0f15-\u0f17\u0f1a-\u0f1f\u0f20-\u0f29\u0f2a-\u0f33\u0f34\u0f36\u0f38\u0f3e-\u0f3f\u0f40-\u0f47\u0f49-\u0f6c\u0f7f\u0f85\u0f88-\u0f8c\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce-\u0fcf\u0fd0-\u0fd4\u0fd5-\u0fd8\u0fd9-\u0fda\u1000-\u102a\u102b-\u102c\u1031\u1038\u103b-\u103c\u103f\u1040-\u1049\u104a-\u104f\u1050-\u1055\u1056-\u1057\u105a-\u105d\u1061\u1062-\u1064\u1065-\u1066\u1067-\u106d\u106e-\u1070\u1075-\u1081\u1083-\u1084\u1087-\u108c\u108e\u108f\u1090-\u1099\u109a-\u109c\u109e-\u109f\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fb\u10fc\u10fd-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1360-\u1368\u1369-\u137c\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166d-\u166e\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16eb-\u16ed\u16ee-\u16f0\u16f1-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1735-\u1736\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17b6\u17be-\u17c5\u17c7-\u17c8\u17d4-\u17d6\u17d7\u17d8-\u17da\u17dc\u17e0-\u17e9\u1810-\u1819\u1820-\u1842\u1843\u1844-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1923-\u1926\u1929-\u192b\u1930-\u1931\u1933-\u1938\u1946-\u194f\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c0\u19c1-\u19c7\u19c8-\u19c9\u19d0-\u19d9\u19da\u1a00-\u1a16\u1a19-\u1a1a\u1a1e-\u1a1f\u1a20-\u1a54\u1a55\u1a57\u1a61\u1a63-\u1a64\u1a6d-\u1a72\u1a80-\u1a89\u1a90-\u1a99\u1aa0-\u1aa6\u1aa7\u1aa8-\u1aad\u1b04\u1b05-\u1b33\u1b35\u1b3b\u1b3d-\u1b41\u1b43-\u1b44\u1b45-\u1b4b\u1b50-\u1b59\u1b5a-\u1b60\u1b61-\u1b6a\u1b74-\u1b7c\u1b82\u1b83-\u1ba0\u1ba1\u1ba6-\u1ba7\u1baa\u1bae-\u1baf\u1bb0-\u1bb9\u1bba-\u1be5\u1be7\u1bea-\u1bec\u1bee\u1bf2-\u1bf3\u1bfc-\u1bff\u1c00-\u1c23\u1c24-\u1c2b\u1c34-\u1c35\u1c3b-\u1c3f\u1c40-\u1c49\u1c4d-\u1c4f\u1c50-\u1c59\u1c5a-\u1c77\u1c78-\u1c7d\u1c7e-\u1c7f\u1cc0-\u1cc7\u1cd3\u1ce1\u1ce9-\u1cec\u1cee-\u1cf1\u1cf2-\u1cf3\u1cf5-\u1cf6\u1d00-\u1d2b\u1d2c-\u1d6a\u1d6b-\u1d77\u1d78\u1d79-\u1d9a\u1d9b-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200e\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2134\u2135-\u2138\u2139\u213c-\u213f\u2145-\u2149\u214e\u214f\u2160-\u2182\u2183-\u2184\u2185-\u2188\u2336-\u237a\u2395\u249c-\u24e9\u26ac\u2800-\u28ff\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2c7b\u2c7c-\u2c7d\u2c7e-\u2ce4\u2ceb-\u2cee\u2cf2-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d70\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u3005\u3006\u3007\u3021-\u3029\u302e-\u302f\u3031-\u3035\u3038-\u303a\u303b\u303c\u3041-\u3096\u309d-\u309e\u309f\u30a1-\u30fa\u30fc-\u30fe\u30ff\u3105-\u312d\u3131-\u318e\u3190-\u3191\u3192-\u3195\u3196-\u319f\u31a0-\u31ba\u31f0-\u31ff\u3200-\u321c\u3220-\u3229\u322a-\u3247\u3248-\u324f\u3260-\u327b\u327f\u3280-\u3289\u328a-\u32b0\u32c0-\u32cb\u32d0-\u32fe\u3300-\u3376\u337b-\u33dd\u33e0-\u33fe\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua014\ua015\ua016-\ua48c\ua4d0-\ua4f7\ua4f8-\ua4fd\ua4fe-\ua4ff\ua500-\ua60b\ua60c\ua610-\ua61f\ua620-\ua629\ua62a-\ua62b\ua640-\ua66d\ua66e\ua680-\ua69b\ua69c-\ua69d\ua6a0-\ua6e5\ua6e6-\ua6ef\ua6f2-\ua6f7\ua722-\ua76f\ua770\ua771-\ua787\ua789-\ua78a\ua78b-\ua78e\ua790-\ua7ad\ua7b0-\ua7b1\ua7f7\ua7f8-\ua7f9\ua7fa\ua7fb-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua823-\ua824\ua827\ua830-\ua835\ua836-\ua837\ua840-\ua873\ua880-\ua881\ua882-\ua8b3\ua8b4-\ua8c3\ua8ce-\ua8cf\ua8d0-\ua8d9\ua8f2-\ua8f7\ua8f8-\ua8fa\ua8fb\ua900-\ua909\ua90a-\ua925\ua92e-\ua92f\ua930-\ua946\ua952-\ua953\ua95f\ua960-\ua97c\ua983\ua984-\ua9b2\ua9b4-\ua9b5\ua9ba-\ua9bb\ua9bd-\ua9c0\ua9c1-\ua9cd\ua9cf\ua9d0-\ua9d9\ua9de-\ua9df\ua9e0-\ua9e4\ua9e6\ua9e7-\ua9ef\ua9f0-\ua9f9\ua9fa-\ua9fe\uaa00-\uaa28\uaa2f-\uaa30\uaa33-\uaa34\uaa40-\uaa42\uaa44-\uaa4b\uaa4d\uaa50-\uaa59\uaa5c-\uaa5f\uaa60-\uaa6f\uaa70\uaa71-\uaa76\uaa77-\uaa79\uaa7a\uaa7b\uaa7d\uaa7e-\uaaaf\uaab1\uaab5-\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadc\uaadd\uaade-\uaadf\uaae0-\uaaea\uaaeb\uaaee-\uaaef\uaaf0-\uaaf1\uaaf2\uaaf3-\uaaf4\uaaf5\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5b\uab5c-\uab5f\uab64-\uab65\uabc0-\uabe2\uabe3-\uabe4\uabe6-\uabe7\uabe9-\uabea\uabeb\uabec\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\ue000-\uf8ff\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\uff21-\uff3a\uff41-\uff5a\uff66-\uff6f\uff70\uff71-\uff9d\uff9e-\uff9f\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc"+o+r+"]"),s=new RegExp("["+o+r+"]");function d(e){var t=a.exec(e);return null==t?null:t[0]}function c(e){var t=d(e);return null==t?i.NEUTRAL:s.exec(t)?i.RTL:i.LTR}function l(e,t){if(t=t||i.NEUTRAL,!e.length)return t;var n=c(e);return n===i.NEUTRAL?t:n}function u(e,t){return t||(t=i.getGlobalDir()),l(e,t)}e.exports.firstStrongChar=d,e.exports.firstStrongCharDir=c,e.exports.resolveBlockDir=l,e.exports.getDirection=u,e.exports.isDirectionLTR=function(e,t){return u(e,t)===i.LTR},e.exports.isDirectionRTL=function(e,t){return u(e,t)===i.RTL}},function(e,t,n){var i=n(6).Section,o=n(24),r=i.extend({init:function(e,t,n,i){this._super("heading",e,t,n,i)},htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<h1>",htmlSuffix:"</h1>",determineDirection:function(){var e=this.firstChild();return e&&!e.isEmpty()?o.resolveBlockDir(e.getText()):null},isOneLineOnly:function(){return!0},allowedModifiers:function(){return[]},shouldRemoveChildrenModifiers:function(){return!0}});t.H1Section=r},function(e,t,n){var i=n(5).Class,o=n(2).Util,r=n(0).config,a=n(9),s=n(4).Position,d=n(44).htmlToNode,c=n(8).Span,l=n(20).Doc,u=n(3).CONTENT_TYPES,h=n(7).PlainSection,f=n(12).CodeSection,p=n(13).UnorderedListSection,m=n(13).OrderedListSection,g=n(14).ImageSection,v=n(17).HorizontalRuleSection,b=function(e){return-1!=["OL","UL"].indexOf(e)},y=function(e){return-1!=["H1","H2","H3","H4","H5"].indexOf(e)},S=function(e){return"BLOCKQUOTE"==e},x=function(e){return e.nodeType==e.COMMENT_NODE||-1!=["STYLE","LINK","SCRIPT","TITLE"].indexOf(e.nodeName)},_=i.extend({__init__:function(e,t){this.spans=t||[],this.modifiers=a.extend(e,{}),this.indent=0,this.content=""},visit:function(e){this._enter(e),this._exit(e)},_visitChildren:function(e){for(var t=e.firstChild;null!==t;t=t.nextSibling)this.visit(t)},_enter:function(e){if(o.isTextNode(e)){var t=e.textContent;return t=(t=t.replace(/\n/g," ")).replace(/ {2,}/g," "),void(this.content+=t)}"BR"!=e.nodeName.toUpperCase()?(C(e)&&(this.modifiers[C(e)]=E(e)),this._visitChildren(e)):this.content+="\n"},_exit:function(e){o.isTextNode(e)||"BR"==e.nodeName.toUpperCase()?this._createSpan():C(e)&&delete this.modifiers[C(e)]},_createSpan:function(){var e=this.content;if(e.length){if(e=e.replace(/(\u00a0)+/gm," "),this.spans.length>0){var t=this.spans[this.spans.length-1];if(a.jsonEqual(t.modifiers,this.modifiers)){var n=t.getText();return t.setText(n+e),void(this.content="")}}this.spans.push(new c(e,this.modifiers)),this.content=""}}}),C=function(e){return{B:"bold",STRONG:"bold",I:"italic",EM:"italic",U:"italic",A:"link",CODE:"code",MATH:"math"}[e.nodeName.toUpperCase()]},E=function(e){return{B:!0,I:!0,EM:!0,U:!0,A:{type:"url",url:e.href},CODE:!0,MATH:!0}[e.nodeName.toUpperCase()]},T=function(e,t,n){var i=new _(t,n);return i.visit(e),i.spans},k=function M(e,t,n){var i,r,a="OL"==e.nodeName.toUpperCase()?m:p,s=[];n=n||0,t=t||{},o.assert(b(e.nodeName),"Unknown list type",e);for(var d=e.firstElementChild;d;d=d.nextElementSibling)"LI"==(i=d.nodeName.toUpperCase())?((r=new a(T(d,t))).setIndent(n),s.push(r)):b(i)&&(s=s.concat(M(d,t,n+1)));return s},w=function(e){var t,n,i=[],o=new f;for(i.push(o),n=e.firstChild;n;n=n.nextSibling)"BR"==n.nodeName.toUpperCase()?(o=new f,i.push(o)):(t=o.firstChild()).setText(t.getText()+n.textContent);return i},I=function(e){return function t(e,n,i,d){var c,u,f=new l({},r.clientInfo,r.options,r.platform);n=n||{},i=i||[],d=!!d;for(var p=function(){if(i.length){var e=new h(i);if(/\S/.test(e.getText())){f.appendChild(e);for(var t=e.firstChild();t;){var n=t.getText(),o=n.indexOf("\n\n");-1!=o?(t.setText(n.replace("\n\n","")),t.parent.split(new s(t,o)),t=f.lastChild().firstChild()):t=t.nextSibling()}}i.length=[]}},m=e.firstChild;m;m=m.nextSibling)if("SPAN"==(c=m.nodeName.toUpperCase())&&0!==m.textContent.length||o.isTextNode(m)||"BR"==c)T(m,n,i);else if(-1!=["B","I","U","A","EM","STRONG","MATH","CODE"].indexOf(c)){var _={};_[C(m)]=E(m),_=a.extend(_,n),f.appendChildren(t(m,_,i))}else p(),x(m)||(b(c)?f.appendChildren(k(m,n)):y(c)?f.appendChildren(t(m,a.extend({bold:!0},n),i,!0)):S(c)?((u=t(m,n,i,!0)).forEach(function(e){e.setQuoted(!0)}),f.appendChildren(u)):"HR"==c?f.appendChild(new v):"PRE"==c?f.appendChildren(w(m)):"IMG"==c?o.isValidUrl(m.src)&&m.src.startsWith("http")&&f.appendChild(g.fromURL(m.src,"html_paste")):f.appendChildren(t(m,n,i,!0)));return d&&p(),f.destroy(),f.children.slice(1,f.children.length)}(d(e),{},[],!0)},O=function(e){var t=[];return 0===e.length?[]:(o.splitLines(e).forEach(function(e){t.push(new h([new c(e)]))}),t)};t.parseHTML=I,t.parseText=O,t.parse=function(e,t){return t==u.HTML||t==u.PUBLIC_HTML?I(e):t==u.TEXT||t==u.TEXT_URI?O(e):[]}},function(e,t){t.isValidEmail=function(){var e=new RegExp("^([^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+|\\x22([^\\x0d\\x22\\x5c\\x80-\\xff]|\\x5c[\\x00-\\x7f])*\\x22)(\\x2e([^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+|\\x22([^\\x0d\\x22\\x5c\\x80-\\xff]|\\x5c[\\x00-\\x7f])*\\x22))*\\x40([^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+|\\x5b([^\\x0d\\x5b-\\x5d\\x80-\\xff]|\\x5c[\\x00-\\x7f])*\\x5d)(\\x2e([^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+|\\x5b([^\\x0d\\x5b-\\x5d\\x80-\\xff]|\\x5c[\\x00-\\x7f])*\\x5d))*$");return function(t){return e.test(t)}}()},function(e,t,n){var i=n(34),o=n(0).config,r={};t.getTweetData=function(e,t,n){var i=function(e){for(var t=r[e]||[],n=0;n<t.length;n++){var i=t[n],o=i.getElementsByTagName("twitterwidget");if(!i.isConnected&&o.length>0)return i}return null}(e);i?t(i,!1):function(e,t,n){o.platform.makeRpc("/twitter/get_twitter_oembed_json_POST",{formkey:o.platform.getFormkey(),json:JSON.stringify({args:[],kwargs:{url:e}})}).then(function(e){"error"in e?n(e):t(e)})["catch"](n)}(e,function(i){if(i){var o=document.createElement("iframe");o.className="tweet-content styleable",o.srcdoc=i.data.value.html,t(o,!0),function(e,t){var n=r[e];n?n.push(t):r[e]=[t]}(e,o)}else n(null)},n)};var a=t.loadEmbeds=function(e,t){s()&&i.onInit(t,function(t){t&&t.widgets?t.widgets.load(e):o.platform.logJsError("Twitter","Error: Twitter JS initialized but widgets not available")})};t.renderTweetIFrame=function(e){e.onload=function(){var t,n,r=e.contentDocument||e.contentWindow.document;e.contentWindow._id=i.getIframeWindowId(),t=e.contentWindow,n=function(){e.style.height=r.body.scrollHeight+10+"px"},i.onInit(t,function(e){e&&e.events?e.events.bind("loaded",n):o.platform.logJsError("Twitter","Error: Twitter JS initialized but events not available")}),a(r.body,e.contentWindow)}};var s=t.tweetsEnabled=function(){return!(o.clientInfo.isIOSApp&&o.clientInfo.buildNumber<742)}},function(e,t,n){var i=n(0).config,o={usesCompositionEvents:function(){return i.clientInfo.isGecko||i.clientInfo.isWebkit&&i.clientInfo.webkitVersion>532},dragEventContainsFile:function(e){var t=e.dataTransfer;return!!t&&(!!(t.files&&t.files.length>0)||!!t.types&&(!(!t.types.indexOf||-1==t.types.indexOf("Files"))||!(!t.types.contains||!t.types.contains("application/x-moz-file"))))},insertsPeriodWithDoubleSpace:function(){return i.clientInfo.isIOS}};t.Quirks=o},function(e,t,n){var i=n(5).Class,o=n(0).config,r=t.isMac=/Mac/.test(window.navigator.platform),a={8:"BACKSPACE",9:"TAB",13:"RETURN",27:"ESCAPE",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",46:"DELETE",106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s=i.extend({__init__:function(e){e=e.toUpperCase(),this.alt=/ALT-/.test(e),this.ctrl=/CTRL-/.test(e)||!r&&/CMD-/.test(e),this.meta=/META-/.test(e)||r&&/CMD-/.test(e),this.shift=/SHIFT-/.test(e),this.character=e.split("-").pop()},toString:function(){var e="";return this.alt&&(e+="ALT-"),this.ctrl&&(e+="CTRL-"),this.meta&&(e+="META-"),this.shift&&(e+="SHIFT-"),e+=this.character}}),d=i.extend({__init__:function(){this._handlers=[]},on:function(e,t){var n=new s(e);if(n in this._handlers)throw new Error("Already attached handler for "+n);this._handlers[n]=t},trigger:function(e){var t=function(e){var t=a[e.which]||String.fromCharCode(e.which).toUpperCase(),n="";return e.altKey&&(n+="ALT-"),e.ctrlKey&&(n+="CTRL-"),e.metaKey&&(n+="META-"),e.shiftKey&&(n+="SHIFT-"),n+=t}(e);o.clientInfo.isIOSApp&&"SHIFT-RETURN"===t&&(t="RETURN");var n=this._handlers[t];return!n||n(e)}});t.getShortcutHint=function(e){var t=new s(e),n="";return r?(t.meta&&(n+="&#x2318;"),t.ctrl&&(n+="^"),t.alt&&(n+="&#x2325;"),t.shift&&(n+="&#x21E7;")):(t.ctrl&&(n+="Ctrl-"),t.alt&&(n+="Alt-"),t.shift&&(n+="Shift-")),n+t.character[0]+t.character.slice(1).toLowerCase()},t.isNavigation=function(e){return-1!=[35,36,37,38,39,40].indexOf(e.which)},t.isOnlyShiftKey=function(e){return e.shiftKey&&16==e.which},t.Hub=d,t.SPECIAL_KEYS=a},function(e,t,n){var i=n(20);e.exports={Doc:i.Doc}},function(e,t){t.iterLinks=function(e,t){n(e,{callback:function(e,n){return n&&t(n,e),""}})};var n=t.linkify=function(){var e=new RegExp("(?:\\b[a-z\\d.-]+://[^<>\\s\\[\\]]+|\\b(?:(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw))(?:[;/][^#?<>\\s\\[\\]]*)?(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?(?!\\w)|(?:mailto:)?[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw))(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?(?!\\w))","ig"),t=new RegExp("^[a-z\\d.-]+://","i"),n={"'":"`",">":"<",")":"(","]":"[","}":"{","\xbb":"\xab","\u203a":"\u2039"},i={callback:function(e,t){return t?'<a href="'+t+'" title="'+t+'">'+e+"</a>":e},punct_regexp:/(?:[!?.,:;'"]|(?:&|&amp;)(?:lt|gt|quot|apos|raquo|laquo|rsaquo|lsaquo);)$/};return function(o,r){r=r||{};var a,s,d,c,l,u,h,f,p,m,g,v,b="",y=[];for(s in i)r[s]===undefined&&(r[s]=i[s]);for(;a=e.exec(o);)if(d=a[0],h=(u=e.lastIndex)-d.length,!/[\/:]/.test(o.charAt(h-1))){do{f=d,v=d.substr(-1),(g=n[v])&&(p=d.match(new RegExp("\\"+g+"(?!$)","g")),m=d.match(new RegExp("\\"+v,"g")),(p?p.length:0)<(m?m.length:0)&&(d=d.substr(0,d.length-1),u--)),r.punct_regexp&&(d=d.replace(r.punct_regexp,function(e){return u-=e.length,""}))}while(d.length&&d!==f);c=d,t.test(c)||(c=(-1!==c.indexOf("@")?c.indexOf("mailto:")?"mailto:":"":c.indexOf("irc.")?c.indexOf("ftp.")?"http://":"ftp://":"irc://")+c),l!=h&&(y.push([o.slice(l,h)]),l=u),y.push([d,c])}for(y.push([o.substr(l)]),s=0;s<y.length;s++)b+=r.callback.apply(window,y[s]);return b||o}}()},function(e,t){t.lineDiff=function(e,t,n){for(var i=e.length,o=t.length,r=[],a=0;a<=i;a++)r[a]=[];n=n||function(e,t){return e==t};for(var s=0,d=[[i,o]];s<d.length;){var c=d[s++],l=c[0],u=c[1],h=null,f=null;r[l][u]||(l>=i&&u>=o?r[l][u]=[]:(l<i&&u<o&&n(e[l],t[u])?h=r[l+1][u+1]:(l<i&&(h=[{type:"remove",index:l}].concat(r[l+1][u])),u<o&&(f=[{type:"insert",index:u}].concat(r[l][u+1]),(!h||f.length<h.length)&&(h=f))),r[l][u]=h),l>0&&!r[l-1][u]&&d.push([l-1,u]),u>0&&!r[l][u-1]&&d.push([l,u-1]),l>0&&u>0&&!r[l-1][u-1]&&d.push([l-1,u-1]))}return r[0][0]}},function(e,t,n){var i=n(9),o=1,r={};t.getIframeWindowId=function(){var e=o;return o+=1,e};t.onInit=function(e,t){!function(e,t){var n=e.twttr={_events:[],ready:function(e){n._events.push(e)}};r[e._id]||(r[e._id]=[]),r[e._id].push(t),i.loadJSIntoIFrame("//platform.twitter.com/widgets.js",e.document,function(){n.ready(function(t){r[e._id].forEach(function(e){e.call(t,t)}),r[e._id]=[]})})}(e,t)}},function(e,t,n){var i=n(0).config;t.getOEmbedlyData=function(e,t){!function(e,t){i.platform.makeRpc("/embedly_/get_oembedly_json_POST",{formkey:i.platform.getFormkey(),json:JSON.stringify({args:[],kwargs:{url:e}})}).then(function(e){"error"in e||e.data&&e.data.value&&"error"in e.data.value?t(null):t(e)})["catch"](function(){t(null)})}(e,function(e){t(e||null)})}},function(e,t,n){var i=n(5).Class.extend({__init__:function(e){this.current={state:e,next:null,prev:null}},state:function(){return this.current.state},add:function(e){this.current.next&&(this.current.next.prev=null),this.current.next={state:e,prev:this.current,next:null},this.current=this.current.next},undo:function(){this.current.prev&&(this.current=this.current.prev)},redo:function(){this.current.next&&(this.current=this.current.next)},canUndo:function(){return!!this.current.prev},canRedo:function(){return!!this.current.next}});t.UndoManager=i},function(e,t,n){var i=n(30),o=n(9).extend,r={Backspace:"backspace",Delete:"delete",Return:"return","Alt-Return":"return","Ctrl-Return":"return","Shift-Return":"soft-return"," ":"space",Tab:"indent","Shift-Tab":"deindent","Cmd-B":"bold","Cmd-I":"italic","Cmd-U":"underline","Cmd-K":"link","Cmd-Shift-7":"ordered_list","Cmd-Shift-8":"unordered_list","Cmd-Shift-9":"quote","Cmd-Shift-K":"code","Cmd-Shift-L":"math","Cmd-Z":"undo","Cmd-Shift-Z":"redo"};i.isMac?o(r,{"Ctrl-H":"backspace","Ctrl-D":"delete","Ctrl-K":"delete-forward","Cmd-Backspace":"delete-backward","Ctrl-T":"transpose","Ctrl-Backspace":"backspace","Ctrl-Delete":"delete","Shift-Backspace":"backspace","Shift-Delete":"delete","Alt-Backspace":"delete-previous-word","Alt-Delete":"delete-next-word","Ctrl-U":"underline"}):o(r,{"Ctrl-Backspace":"delete-previous-word","Ctrl-Delete":"delete-next-word","Shift-Backspace":"backspace","Shift-Delete":"delete","Alt-Backspace":"backspace","Alt-Delete":"delete"}),t.SHORTCUTS=r},function(e,t,n){var i=n(5).Class,o=n(10).canForceModifier,r=n(9);t.FormattingState=i.extend({__init__:function(e){this._modifiers={},this.update(e)},is:function(e){return e in this._modifiers},update:function(e){this.updatePosition(e);var t=e.getCoveringSpans(),n=Object.keys(e.start.span.getModifiers()).filter(function(e){return t.every(function(t){return t.hasModifier(e)||!o(t,e)})});this._modifiers={};var i=this;n.forEach(function(t){i._modifiers[t]=e.start.span.getModifier(t)}),this._isLinked()||(delete this._modifiers.link,delete this._modifiers.citation)},updatePosition:function(e){this.caret=e,this.position=e.start.clone(),this.spanText=e.start.span.getText()},_isLinked:function(){var e=this.caret.start.span;return!(!e.hasModifier("link")&&!e.hasModifier("citation"))&&(this.caret.isCollapsed()?!this.caret.start.atSpanStart()&&!this.caret.start.atSpanEnd():e==this.caret.end.span)},toggleModifier:function(e,t){t in this._modifiers?delete this._modifiers[t]:"link"!=t&&"citation"!=t&&(this._modifiers[t]=!0),this.position=e.start.clone()},hasChanged:function(e){return!r.jsonEqual(this._modifiers,e.start.span.getModifiers())&&this.spanText!=e.start.span.getText()},apply:function(e){var t=!r.jsonEqual(e.modifiers,this._modifiers);return e.removeAllModifiers(),e.updateModifiers(this._modifiers),t}})},function(e,t,n){var i=n(5).Class,o=n(2).Util,r=n(9),a=n(21).rangy,s=n(8).Span,d=n(6).Section,c=n(20),l=n(4).Position,u=n(16).Selection,h=n(0).config,f=function(e,t,n){var i="Failed to set range safe="+n+": ";i+="("+(o.isTextNode(e)?e.textContent:e.outerHTML)+") "+t,h.platform.logJsError("IndexSizeError",i)},p=function(e,t,n){try{try{e.setStart(t,n)}catch(i){0==t.textContent.length&&e.setStart(t,0),f(t,n,!1)}}catch(i){f(t,n,!0)}},m=function(e,t,n){try{try{e.setEnd(t,n)}catch(i){0==t.textContent.length&&e.setEnd(t,0),f(t,n,!1)}}catch(i){f(t,n,!0)}};t.Caret=i.extend({__init__:function(e,t,n){this.selection=new u(e,t,n),this.doc=n;var i=this;Object.defineProperty(i,"start",{get:function(){return i.selection.start},set:function(e){i.selection=new u(e,i.end)}}),Object.defineProperty(i,"end",{get:function(){return i.selection.end},set:function(e){i.selection=new u(i.start,e)}})},toJSON:function(){return this.selection.toJSON()},getStartNode:function(){return this.selection.getStartNode()},getEndNode:function(){return this.selection.getEndNode()},moveStart:function(e){return this.selection.moveStart(e)},moveEnd:function(e){return this.selection.moveEnd(e)},move:function(e,t,n){t=t||e;var i=!0;return this.start.equals(e)&&this.end.equals(t)&&(i=!1),this.start.span=e.span,this.start.offset=e.offset,this.end.span=t.span,this.end.offset=t.offset,this._apply(n),i},isCollapsed:function(){return this.selection.isCollapsed()},charBefore:function(){return this.selection.charBefore()},hasCharBefore:function(){return this.selection.hasCharBefore()},previousTextUntil:function(e){return this.selection.previousTextUntil(e)},charAfter:function(){return this.selection.charAfter()},charPosition:function(){return this.selection.charPosition()},hasCharAfter:function(){return this.selection.hasCharAfter()},updateAndroidCaretPosition:function(e){e=e||0,h.clientInfo.isMobile&&h.clientInfo.isAndroidApp&&h.platform.sendMesage&&h.platform.sendMesage("setCaretPos",{selectionStart:this.charPosition()+e})},update:function(e){var t,n,i,o=a.getSelection();return!!o.anchorNode&&(o.isCollapsed?t=n=this._fromNode(o.anchorNode,o.anchorOffset):(i=o.getRangeAt(0),t=this._fromNode(i.startContainer,i.startOffset),n=this._fromNode(i.endContainer,i.endOffset)),!(!t||!n)&&this.move(t,n,e))},_fromNode:function(e,t){var n,i,o,r;if(!this.doc.contains(e)){if(!(h.clientInfo.isMobile&&h.clientInfo.isAndroidApp&&h.clientInfo.osVersion<4.4))return null;for(var a=e;a&&!c.Doc.is(a);)a=a.parentNode;if(!a)return null}if(c.Doc.is(e))r=c.Doc.get(e),0===t?(i=r.firstChild().firstChild(),o=0):o=(i=r.lastChild().lastChild()).getLength();else if(d.is(e))n=d.get(e),0===t?(i=n.firstChild(),o=0):o=(i=n.lastChild()).getLength();else if(!s.is(e.parentNode)||1!==t&&0!==t){for(;e&&!s.is(e);)e=e.parentNode;if(!e)return null;i=s.get(e),o=t}else i=s.get(e.parentNode),o=0===t?0:i.getLength();return new l(i,o)},_apply:function(e){var t,n,i,o,r=a.getSelection(),s=this.getStartNode();if(this.isCollapsed()){if(!e&&r.isCollapsed&&s==r.anchorNode&&this.start.offset==r.anchorOffset)return;o=a.createRange(),p(o,s,this.start.offset),m(o,s,this.start.offset),o.collapse(!0),r.removeAllRanges(),r.addRange(o)}else{if(t=this.end.span.getFocusNode(),r.isCollapsed)o=a.createRange();else if(o=r.getRangeAt(0),n=this._fromNode(o.startContainer,o.startOffset),i=this._fromNode(o.endContainer,o.endOffset),!e&&n&&i&&this.start.equals(n)&&this.end.equals(i))return;p(o,s,this.start.offset),m(o,t,this.end.offset),r.removeAllRanges(),r.addRange(o)}},getAbsolutePosition:function(e){var t=window.getSelection(),n=o.firstScrollingParent(this.doc.node),i=o.closestRelativeAncestor(this.doc.node),r=document.body.parentElement,s=t.rangeCount>0&&t.getRangeAt(0),d=s?s.getClientRects():[];if(s&&0===d.length&&(d=s.startContainer.getClientRects()),d.length>0){var c={top:d[0].top,left:d[0].left};if(e&&i){var l=o.getOffset(i);c.top-=l.top,c.left-=l.left}else c.top+=n.scrollTop||r.scrollTop,c.left+=n.scrollLeft||r.scrollLeft;return c}var u=a.getSelection().anchorNode;return o.isTextNode(u)&&(u=this.start.span.parent.node),u&&u.children.length&&"img"==u.children[0].tagName.toLowerCase()?o.getOffset(u.children[0]):o.getContainerOffset(u,n)},scrollIntoViewIfNeeded:function(){if(this.isCollapsed()&&a.getSelection().anchorNode){var e=o.firstScrollingParent(this.doc.node),t=e.clientHeight||window.innerHeight;if(h.clientInfo.isIOS&&!h.clientInfo.isUIWebView&&(t=Math.max(document.documentElement.clientHeight,t)),h.clientInfo.isIOSMobileWeb){var n=window.innerHeight>window.innerWidth;window.navigator.userAgent.indexOf("iPad")>=0?t-=n?325:410:t-=n?265:200}var i,r,s=this.getAbsolutePosition(),d=document.body.parentElement,c=e.scrollTop||d.scrollTop,l=c+t;h.clientInfo.isMobile||(l-=50),s&&(i=s.top,r=i+36,setTimeout(function(){i<c?e?e.scrollTop+=i-c:d.scrollTop+=i-c:r>l&&(e?e.scrollTop+=r-l:d.scrollTop+=r-l)},0))}},containsEntireSection:function(e){return this.selection.containsEntireSection(e)},mergeAdjacentSpans:function(){if(this.isCollapsed()){var e=this.start.span,t=e.nextSibling(),n=e.previousSibling(),i=this.start.offset;t&&r.jsonEqual(e.modifiers,t.modifiers)&&(e.setText(e.getText()+t.getText()),t.parent.removeChild(t),this.move(new l(e,i))),n&&r.jsonEqual(e.modifiers,n.modifiers)&&(i+=n.getLength(),e.setText(n.getText()+e.getText()),n.parent.removeChild(n),this.move(new l(e,i)))}},getCoveringSpans:function(){return this.selection.getCoveringSpans()}})},function(e,t,n){var i=n(5).Class;t.EventEmitter=i.extend({on:function(e,t){this.__handlers=this.__handlers||{},this.__handlers[e]=this.__handlers[e]||[],this.__handlers[e].push(t)},off:function(e,t){if(this.__handlers&&this.__handlers[e]){var n=this.__handlers[e].indexOf(t);-1!=n&&this.__handlers[e].splice(n,1)}},once:function(e,t){this.__onceHandlers=this.__onceHandlers||{},this.__onceHandlers[e]=this.__onceHandlers[e]||[],this.__onceHandlers[e].push(t)},trigger:function(e,t){for(var n=this.__handlers&&this.__handlers[e]||[],i=[],o=0;o<n.length;o++)try{i.push(n[o].apply(null,t||[]))}catch(a){console.error(a)}for(var r=this.__onceHandlers&&this.__onceHandlers[e]||[];0!==r.length;)try{i.push(r.pop().apply(null,t||[]))}catch(a){console.error(a)}return i}})},function(e,t){t.qtextDocStyles='\n.doc {\n  /* We disable selection on mobile by default, so have to reset here */\n  -webkit-user-select: auto;\n  min-height: 100px;\n  background-color: transparent;\n  counter-reset: indent0 indent1 indent2 citation;\n}\n.doc div {\n  -webkit-user-select: auto;\n}\n.doc.empty:before {\n  content: attr(data-placeholder);\n  color: #949494;\n  position: absolute;\n}\n\n.u-layout-direction--ltr .editor_padding_reset .doc.empty:before {\n  left: 0;\n}\n\n.u-layout-direction--rtl .editor_padding_reset .doc.empty:before {\n  right: 0;\n}\n\n.doc:focus {\n  outline: none;\n}\n\n.doc .section {\n  position: relative;\n  counter-reset: indent0 indent1 indent2;\n  padding: 1em 0 0;\n}\n.doc .section:first-child {\n  padding-top: 0;\n}\n.doc .section[data-type="unordered-list"],\n.doc .section[data-type="ordered-list"],\n.doc .section[data-type="math"],\n.doc .section[data-type="code"] {\n  padding: 0;\n}\n.doc .section[data-type="yt-embed"] .span.image img {\n  margin-top: -45px;\n}\n.doc .section:not([data-type="math"]) + [data-type="math"] {\n  margin-top: 1em;\n}\n.doc .section:not([data-type="code"]) + [data-type="code"] {\n  counter-reset: indent0 indent1 indent2 linenumber;\n  padding-top: 1em;\n}\n.doc .section:not([data-type="code"]) + [data-type="code"]:before {\n  top: 1em;\n}\n.doc .section:not([data-type="code"]) + [data-type="code"]:after {\n  content: \'\';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 1em;\n  background: #fff;\n}\n.doc .section:not([data-quoted="true"]) + [data-quoted="true"] {\n  margin-top: 1em;\n  padding-top: 0;\n}\n.doc .section:not([data-type="unordered-list"]) + [data-type="unordered-list"],\n.doc .section:not([data-type="ordered-list"]) + [data-type="ordered-list"] {\n  padding-top: 1em;\n}\n.doc .section[data-type="unordered-list"],\n.doc .section[data-type="ordered-list"] {\n  margin-right: 2em;\n  padding-top: 0.7em;\n}\n.doc .section[data-type="unordered-list"][data-indent="0"][data-dir=\'LTR\'],\n.doc .section[data-type="ordered-list"][data-indent="0"][data-dir=\'LTR\'] {\n  margin-left: 2em;\n}\n.doc .section[data-type="unordered-list"][data-indent="1"][data-dir=\'LTR\'],\n.doc .section[data-type="ordered-list"][data-indent="1"][data-dir=\'LTR\'] {\n  margin-left: 4em;\n}\n.doc .section[data-type="unordered-list"][data-indent="2"][data-dir=\'LTR\'],\n.doc .section[data-type="ordered-list"][data-indent="2"][data-dir=\'LTR\'] {\n  margin-left: 6em;\n}\n.doc .section[data-type="unordered-list"][data-indent="0"][data-dir=\'RTL\'],\n.doc .section[data-type="ordered-list"][data-indent="0"][data-dir=\'RTL\'] {\n  margin-right: 2em;\n}\n.doc .section[data-type="unordered-list"][data-indent="1"][data-dir=\'RTL\'],\n.doc .section[data-type="ordered-list"][data-indent="1"][data-dir=\'RTL\'] {\n  margin-right: 4em;\n}\n.doc .section[data-type="unordered-list"][data-indent="2"][data-dir=\'RTL\'],\n.doc .section[data-type="ordered-list"][data-indent="2"][data-dir=\'RTL\'] {\n  margin-right: 6em;\n}\n.doc .section[data-type="unordered-list"] {\n  display: list-item;\n}\n.doc .section[data-type="unordered-list"][data-indent="0"] {\n  list-style-type: disc;\n}\n.doc .section[data-type="unordered-list"][data-indent="1"] {\n  list-style-type: circle;\n}\n.doc .section[data-type="unordered-list"][data-indent="2"] {\n  list-style-type: square;\n}\n.doc .section[data-type="ordered-list"] {\n  counter-reset: indent0;\n}\n.doc .section[data-type="ordered-list"]:before {\n  box-sizing: border-box;\n  position: absolute;\n  width: 3em;\n}\n.doc .section[data-type="ordered-list"][data-dir=\'LTR\']:before {\n  left: -3em;\n  padding-right: 0.5em;\n  text-align: right;\n  direction: ltr;\n}\n.doc .section[data-type="ordered-list"][data-dir=\'RTL\']:before {\n  right: -3em;\n  padding-left: 0.5em;\n  text-align: left;\n  direction: rtl;\n}\n.doc .section[data-type="ordered-list"][data-indent="0"] {\n  counter-increment: indent0;\n  counter-reset: indent1;\n}\n.doc .section[data-type="ordered-list"][data-indent="0"]::before {\n  content: counter(indent0, decimal) ".";\n}\n.doc .section[data-type="ordered-list"][data-indent="1"] {\n  counter-increment: indent1;\n  counter-reset: indent2;\n}\n.doc .section[data-type="ordered-list"][data-indent="1"]::before {\n  content: counter(indent1, lower-alpha) ".";\n}\n.doc .section[data-type="ordered-list"][data-indent="2"] {\n  counter-increment: indent2;\n  counter-reset: none;\n}\n.doc .section[data-type="ordered-list"][data-indent="2"]:before {\n  content: counter(indent2, lower-roman) ".";\n}\n.doc .section[data-quoted="true"][data-dir=\'LTR\'] {\n  color: #666;\n  border-left: 2px solid #e2e2e2;\n  padding-left: 1em;\n}\n.doc .section[data-quoted=\'true\'][data-dir=\'RTL\'] {\n  color: #666;\n  border-right: 2px solid #e2e2e2;\n  padding-right: 1em;\n}\n\n.q-color-mode--dark .doc .section[data-quoted=\'true\'] {\n    border-color: rgba(255, 255, 255, .5);\n    color: inherit;\n    opacity: .8;\n}\n\n.doc .section[data-quoted="true"][data-type="code"][data-dir=\'LTR\'] {\n  padding-left: 1.4em;\n}\n.doc .section[data-quoted="true"][data-type="code"][data-dir=\'RTL\'] {\n  padding-right: 1.4em;\n}\n.doc .section[data-quoted="true"][data-type="code"]:before {\n  content: \'\';\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  background-color: #fff;\n  width: 1em;\n}\n.doc .section[data-quoted="true"][data-type="code"]:after {\n  content: none;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-dir=\'LTR\'] {\n  margin-left: 2em;\n  padding-left: 0;\n  border-left: 0;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-dir=\'RTL\'] {\n  margin-right:2em;\n  padding-right:0;\n  border-right:0\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"]:before {\n  content: \'\';\n  position: absolute;\n  top: 0;\n  bottom: 0;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-dir=\'LTR\']:before {\n  border-left: 2px solid #e2e2e2;\n  left: 0;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-dir=\'RTL\']:before {\n  border-right:2px solid #e2e2e2;\n  right:0;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="0"][data-dir=\'LTR\'] {\n  margin-left: 3em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="0"][data-dir=\'RTL\'] {\n  margin-right: 3em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="0"][data-dir=\'LTR\']:before {\n  left: -3em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="0"][data-dir=\'RTL\']:before {\n  right: -3em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="1"][data-dir=\'LTR\'] {\n  margin-left: 5em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="1"][data-dir=\'RTL\'] {\n  margin-right: 5em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="1"][data-dir=\'LTR\']:before {\n  left: -5em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="1"][data-dir=\'RTL\']:before {\n  right: -5em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="2"][data-dir=\'LTR\'] {\n  margin-left: 7em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="2"][data-dir=\'RTL\'] {\n  margin-right: 7em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="2"][data-dir=\'LTR\']:before {\n  left: -7em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="2"][data-dir=\'RTL\']:before {\n  right: -7em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-dir=\'LTR\'] {\n  margin-left: 0;\n  border-left: 2px solid #e2e2e2;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-dir=\'RTL\'] {\n  margin-right: 0;\n  border-right: 2px solid #e2e2e2;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="0"][data-dir=\'LTR\'] {\n  padding-left: 3em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="0"][data-dir=\'RTL\'] {\n  padding-right: 3em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="0"][data-dir=\'LTR\']:before {\n  left: 0;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="0"][data-dir=\'RTL\']:before {\n  right: 0;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="1"][data-dir=\'LTR\'] {\n  padding-left: 5em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="1"][data-dir=\'RTL\'] {\n  padding-right: 5em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="1"][data-dir=\'LTR\']:before {\n  left: 2em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="1"][data-dir=\'RTL\']:before {\n  right: 2em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="2"][data-dir=\'LTR\'] {\n  padding-left: 7em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="2"][data-dir=\'RTL\'] {\n  padding-right: 7em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="2"][data-dir=\'LTR\']:before {\n  left: 4em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="2"][data-dir=\'RTL\']:before {\n  right: 4em;\n}\n.doc .section[data-type="horizontal-rule"] {\n  text-align: center;\n}\n.doc .section[data-type="horizontal-rule"] .span.image {\n  padding: 5px;\n}\n.doc .section[data-type="image"] .span.image.uploading img {\n  opacity: 0.3;\n}\n.doc .span {\n  display: inline;\n}\n.doc .span .content {\n  display: inline;\n}\n.doc .span.bold {\n  font-weight: bold;\n}\n.doc .span.italic {\n  font-style: italic;\n}\n.doc .span.link {\n  color: #2b6dad;\n}\n.doc .span.citation {\n  color: #28d;\n  counter-increment: citation;\n}\n.doc .span.citation:before {\n  content: "[" counter(citation) "]";\n  font-size: 13px;\n  vertical-align: super;\n  line-height: 1;\n}\n.doc .span.link.active,\n.doc .span.citation.active {\n  text-decoration: underline;\n}\n.doc .span.image {\n  display: inline-block;\n  color: inherit;\n  cursor: pointer;\n  line-height: 0;\n  position: relative;\n  max-width: 100%;\n}\n.doc .span.image img {\n  max-width: 100%;\n}\n.doc .span.image.active:after {\n  background-color: rgba(0, 140, 255, 0.3);\n  border: 3px solid #28D;\n}\n.doc .span.playable .content {\n  padding-bottom: 56.25%;\n  height: 0;\n  overflow: hidden;\n  display: inline-block;\n}\n.doc .span.playable .content:before {\n  content: "";\n  display: block;\n  position: absolute;\n  background: url(/static/ans_frontend_assets/images/play3.png) center center no-repeat;\n  height: 100%;\n  width: 100%;\n  left: 0;\n  top: 0;\n  z-index: 10;\n}\n.doc .span.playable .content iframe,\n.doc .span.playable .content .embed {\n  position: absolute;\n  top: 0;\n  left: 0;\n  border: none;\n  width: 100%;\n  height: 100%;\n}\n.doc .span.playable .content img {\n  width: 100%;\n}\n.doc .span.iframe iframe {\n  border: none;\n  width: 100%;\n  display: block;\n  margin: 0 auto;\n  pointer-events: none;\n}\n.doc .section[data-type=\'heading\'] {\n  /* TODO(ewan) this is temp styling. confirm with design later */\n  font-size: 20px;\n  font-weight: 700;\n}\n.doc .section[data-type=\'code\'],\n.doc .span.code {\n  font-family: monospace;\n  background-color: #f6f6f6;\n  color: #666;\n  font-size: 13px;\n}\n.q-color-mode--dark .doc .section[data-type=\'code\'],\n.q-color-mode--dark .doc .span.code {\n  background-color: rgba(255, 255, 255, .1);\n  color: inherit;\n}\n\n.doc .section[data-dir=\'LTR\'] {\n  direction: ltr;\n  text-align: left;\n}\n.doc .section[data-dir=\'RTL\'] {\n  direction: rtl;\n  text-align: right;\n}\n.doc .section[data-type=\'code\'] {\n  padding-left: 3em;\n  counter-increment: linenumber;\n}\n.doc .section[data-type=\'code\']:before {\n  content: counter(linenumber);\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  width: 2em;\n  padding-right: 0.3em;\n  text-align: right;\n  color: #949494;\n  background: #e6e6e6;\n}\n.q-color-mode--dark .doc .section[data-type=\'code\']:before {\n  color: inherit;\n  background: rgba(255, 255, 255, .05);\n}\n\n.doc .section[data-type=\'math\'],\n.doc .span.math {\n  font-family: monospace;\n  background-color: #fffce0;\n  padding: 2px;\n}\n.q-color-mode--dark .doc .section[data-type=\'math\'],\n.q-color-mode--dark .doc .span.math {\n  background-color: rgba(255, 252, 224, .1);\n}\n\n.doc .section[data-type=\'math\'],\n.doc .section[data-type=\'code\'],\n.doc .span.math,\n.doc .span.code {\n  direction: ltr;\n  text-align: left;\n  unicode-bidi: isolate;\n}\n.doc .section[data-type=\'math\'].bold,\n.doc .section[data-type=\'code\'].bold,\n.doc .span.math.bold,\n.doc .span.code.bold,\n.doc .section[data-type=\'math\'].italic,\n.doc .section[data-type=\'code\'].italic,\n.doc .span.math.italic,\n.doc .span.code.italic,\n.doc .section[data-type=\'math\'].link,\n.doc .section[data-type=\'code\'].link,\n.doc .span.math.link,\n.doc .span.code.link,\n.doc .section[data-type=\'math\'] .bold,\n.doc .section[data-type=\'code\'] .bold,\n.doc .span.math .bold,\n.doc .span.code .bold,\n.doc .section[data-type=\'math\'] .italic,\n.doc .section[data-type=\'code\'] .italic,\n.doc .span.math .italic,\n.doc .span.code .italic,\n.doc .section[data-type=\'math\'] .link,\n.doc .section[data-type=\'code\'] .link,\n.doc .span.math .link,\n.doc .span.code .link {\n  font-weight: normal;\n  font-style: normal;\n  text-decoration: none;\n  color: inherit;\n  background: inherit;\n  padding: 0;\n  margin: 0;\n}\n\n.qtext2_tooltip {\n  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n  font-weight: bold;\n  position: absolute;\n  padding: 4px 8px;\n  font-size: 12px;\n  background: #000;\n  color: #fff;\n  border-radius: 2px;\n  white-space: nowrap;\n  max-width: 400px;\n  overflow: hidden;\n  box-sizing: border-box;\n  z-index: 1650;\n\n  direction: ltr;\n  unicode-bidi: isolate;\n\n  opacity: 0;\n  -webkit-transition: opacity 55ms ease-in;\n  -o-transition: opacity 55ms ease-in;\n  transition: opacity 55ms ease-in;\n}\n\n.qtext2_tooltip.visible {\n  opacity: 1;\n}\n\n.qtext2_tooltip a {\n  color: #ddd;\n}\n\n.doc .span .content.section_content_container {\n  position: relative;\n  display: inline-block;\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n.doc .span.hyperlink_embed .content.section_content_container,\n.doc .span.tweet .content.section_content_container,\n.doc .span.react_placeholder .content.section_content_container {\n  width: 100%;\n}\n\n.doc .span .content.section_content_container.react_upload_failed_container {\n  position: relative;\n}\n\n.doc .span .content.section_content_container .section_remove_btn {\n  position: absolute;\n  top: 0;\n  right: 0;\n  cursor: pointer;\n  background-color: #000;\n  color: #fff;\n  border: 1px #000 solid;\n  text-align: center;\n  width: 24px;\n  height: 24px;\n  line-height: 24px;\n  border-radius: 100%;\n  user-select: none;\n  -webkit-user-select: none;\n  z-index: 10;\n}\n\n.doc.dark_mode .span .content.section_content_container .section_remove_btn {\n  background-color: #ccc;\n  color: #000;\n}\n\n.doc .span .content.section_content_container .section_remove_btn:after {\n  content: \'\\2715\';\n  user-select: none;\n  -webkit-user-select: none;\n  font-size: 22px;\n}\n\n.doc .span .content .title_wrapper {\n  display: flex;\n  justify-content: space-between;\n  padding: 4px 8px;\n}\n\n.doc .span .content .buttons_container {\n  display: flex;\n}\n\n.loading_dot_container {\n  display: flex;\n  justify-content: center;\n}\n\n.loading_dot {\n  width: 10px;\n  height: 10px;\n  background-color: #ccc;\n  border-radius: 100%;\n  display: inline-block;\n  -webkit-animation: sk-three-bounce 1.4s ease-in-out 0s infinite both;\n  animation: sk-three-bounce 1.4s ease-in-out 0s infinite both;\n  width: 8px;\n  height: 8px;\n  margin-left: 2px;\n  margin-right: 2px;\n}\n\n@-webkit-keyframes sk-three-bounce {\n  0%,\n  80%,\n  100% {\n    -webkit-transform: scale(0);\n    transform: scale(0);\n  }\n  40% {\n    -webkit-transform: scale(1);\n    transform: scale(1);\n  }\n}\n\n@keyframes sk-three-bounce {\n  0%,\n  80%,\n  100% {\n    -webkit-transform: scale(0);\n    transform: scale(0);\n  }\n  40% {\n    -webkit-transform: scale(1);\n    transform: scale(1);\n  }\n}\n\n.loading_dot.first {\n  -webkit-animation-delay: -0.32s;\n  animation-delay: -0.32s;\n}\n\n.loading_dot.second {\n  -webkit-animation-delay: -0.16s;\n  animation-delay: -0.16s;\n}\n'},function(e,t,n){var i=n(20).Doc,o=n(6).Section,r=n(7).PlainSection,a=n(8).Span,s=n(4).Position,d=n(2).Util,c=n(9).extend,l=n(5).Class,u=n(0).config;t.MutationFixer=l.extend({__init__:function(e){this.doc=e;try{var t=n(43);this.mutationSummary=new t.MutationSummary({rootNode:e.node,observeOwnChanges:!1,queries:[{all:!0}],callback:this.handleMutationSummaries.bind(this)})}catch(i){}},pause:function(){this.mutationSummary.disconnect()},resume:function(){this.mutationSummary.reconnect()},handleMutationSummaries:function(e){var t=e[0];this.handleNodesAdded(t),this.handleNodesRemoved(t),this.handleNodeAttributeChanges(t),this.doc.hasBeenModified()&&this.doc.trigger("meaningfulChange")},handleNodesAdded:function(e){var t=e.added;if(t&&0!==t.length){var n=this;t.forEach(function(e){try{n._handleNodeAdded(e)}catch(t){t.stack}})}},_handleNodeAdded:function(e){var t;(3==e.nodeType&&this.isQText2SpanContent(e.parentElement)&&!u.clientInfo.isIOSApp&&e.parentElement.normalize(),this.isValidQText2Node(e))||e.parentElement&&(this.isValidQText2Node(e.parentElement)?(e.parentElement,this.isQText2SpanContent(e.parentElement)?t=this._handleNodeAddedToSpanContent(e):this.isQText2Span(e.parentElement)?t=this._handleNodeAddedToSpan(e,this.getQText2Span(e.parentElement)):this.isQText2Container(e.parentElement)?t=this._handleNodeAddedToContainer(e,this.getQText2Container(e.parentElement)):e.parentElement,t&&this.doc.moveCaret(t)):e.parentElement)},_handleNodeAddedToSpanContent:function(e){var t,n,i,o,r,s=this.getQText2Span(e.parentElement.parentElement),d=this._getModifiersFromNode(e);if(this.nodeShouldBeSingleChild(e))return t=s.parent,i=(n=s.previous())?n.last():s.next().first(),t.removeChild(s),i;for(t=s.parent,o=e.parentElement.childNodes[0],r=!0;o;)o==e?r=!1:t.insertBefore(new a(o.textContent,s.modifiers),r?s:s.nextSibling()),o=o.nextSibling;return s.setText(e.textContent),this._applyModifier(s,d),this.safeRemoveNodeFromDom(e),s.last()},_handleNodeAddedToSpan:function(e,t,n){n=c(this._getModifiersFromNode(e),n||{});for(var i=t.node.textContent,o=e,r=e.textContent.length;o.previousSibling;)r+=(o=o.previousSibling).textContent.length;for(var a=Array.prototype.slice.call(t.node.childNodes),d=0;d<a.length;d++)a[d]!=t._content&&this.safeRemoveNodeFromDom(a[d]);return t._content||(t._content=t.createContentNode()),t.node!=t._content.parentElement&&t.node.appendChild(t._content),t.setText(i),this._applyModifier(t,n),new s(t,r)},_handleNodeAddedToContainer:function(e,t,n){n=c(this._getModifiersFromNode(e),n||{});var i,o,s,l,u=this.doc;if(!t.hasChild(this.getQText2Container(e))){t.children.forEach(function(e){u.contains(e.node)||t.removeChild(e)}),d.isTextNode(e)?("section"==t.kind?o=i=new a(e.textContent,n):"doc"==t.kind&&(i=new a(e.textContent,n),o=new r([i])),this._replaceNodeWithContainer(e,o,t),l=o.last()):"BR"==e.nodeName&&("section"==t.kind?l=this._splitSectionAtNode(e,t):"doc"==t.kind&&(o=new r,this._replaceNodeWithContainer(e,o,t),l=o.first())),s=this._emptyNodeContents(e);for(var h=0;h<s.length;h++)l=this._handleNodeAddedToContainer(s[h],t,n);return l}this._applyModifiersToContainer(this.getQText2Container(e),n)},_emptyNodeContents:function(e){for(var t=Array.prototype.slice.call(e.childNodes),n=0;n<t.length;n++)e.parentElement.insertBefore(t[n],e);return this.safeRemoveNodeFromDom(e),t},_splitSectionAtNode:function(e,t){var n,i;return(n=this.getQText2Span(e.nextSibling))&&(i=n.first()),(n=this.getQText2Span(e.previousSibling))&&(i=n.last()),this.safeRemoveNodeFromDom(e),i=i||t.last(),t.split(i)},_replaceNodeWithContainer:function(e,t,n){var i;return(i=this.getQText2Container(e.nextSibling,t.Class))?(n.insertBefore(t,i),void this.safeRemoveNodeFromDom(e)):(i=this.getQText2Container(e.previousSibling,t.Class))?(n.insertAfter(t,i),void this.safeRemoveNodeFromDom(e)):(n.appendChild(t),n.node.insertBefore(t.node,n.node.firstElementChild),void this.safeRemoveNodeFromDom(e))},safeRemoveNodeFromDom:function(e){e.parentElement&&d.safeRemoveChild(e,e.parentElement)},_getQText2ContainerType:function(e,t){return t.is(e)&&t.get(e)},isQText2SpanContent:function(e){return!!e.qtextSpanContent},getQText2Span:function(e){return this._getQText2ContainerType(e,a)},isQText2Span:function(e){return!!this.getQText2Span(e)},getQText2Section:function(e){return this._getQText2ContainerType(e,o)},isQText2Section:function(e){return!!this.getQText2Section(e)},getQText2Doc:function(e){return this._getQText2ContainerType(e,i)},isQText2Doc:function(e){return!!this.getQText2Doc(e)},isValidQText2Node:function(e){if(!e)return!1;if(this.isQText2Container(e))return!0;if(this.isQText2SpanContent(e))return!0;if("loading_dot_container"===e.className||"loading_dot_container"===e.parentElement.className)return!0;if(!e.parentElement)return!1;if("react_placeholder"===e.className||"react_placeholder"===e.parentElement.className)return!0;if(e.className.includes("react_upload_failed_container")||e.parentElement.className.includes("react_upload_failed_container"))return!0;if(this.isQText2SpanContent(e.parentElement)){if(d.isTextNode(e))return!0;if(this.nodeShouldBeSingleChild(e)){var t=this.getQText2Span(e.parentElement.parentElement);return t&&1==t.parent.children.length}if("section_remove_btn"===e.className)return!0}return!1},nodeShouldBeSingleChild:function(e){return e&&("IMG"==e.nodeName||"BR"==e.nodeName||"IFRAME"==e.nodeName)},nodeCanBeStyled:function(e){return e&&e.className.includes("styleable")},getQText2Container:function(e){for(var t,n=[a,o,i],r=0;r<n.length&&!(t=this._getQText2ContainerType(e,n[r]));r++);return t},isQText2Container:function(e){return!!this.getQText2Container(e)},handleNodesRemoved:function(e){var t=e.removed;if(t&&0!==t.length){var n=this;t.forEach(function(t){try{n._handleNodeRemoved(t,e.getOldParentNode(t))}catch(i){i.stack}})}},_handleNodeRemoved:function(e,t){var n,r;if(a.is(t))r=(n=a.get(t)).parent,(this.doc.contains(t)||this.doc.hasChild(r)&&r.hasChild(n))&&(r.removeChild(n),0===r.children.length&&this.doc.removeChild(r));else if(o.is(t)){if(!(r=o.get(t)))return;a.is(e)&&(n=a.get(e),r.hasChild(n)&&r.removeChild(n)),0===r.children.length&&this.doc.removeChild(r)}else i.is(t)&&o.is(e)&&(r=o.get(e),this.doc.hasChild(r)&&this.doc.removeChild(r));this.doc.node.firstElementChild||(this.doc.clear(),this.doc.focus())},handleNodeAttributeChanges:function(e){var t=e.attributeChanged;t.style&&t.style.length&&t.style.forEach(this._handleNodeStyleAttributeChanged.bind(this))},_handleNodeStyleAttributeChanged:function(e){if(!this.nodeCanBeStyled(e)){var t=this._getModifiersFromNode(e);e.style.cssText="";var n=[];if(a.is(e))n.push(a.get(e));else if(a.is(e.parentElement))n.push(a.get(e.parentElement));else if(o.is(e))for(var i=o.get(e).firstChild();i;)n.push(i),i=i.nextSibling();this._applyModifiers(n,t)}},_getModifiersFromNode:function(e){var t={};if(e.style){var n=e.style.cssText;"font-weight:bold"==(n=n.replace(/\s|;/g,""))?t.bold=!0:"font-weight:normal"==n?t.bold=!1:"text-decoration:none"==n?t.underline=!1:"text-decoration:underline"==n&&(t.underline=!1)}var i={B:"bold",STRONG:"bold",I:"italic",EM:"italic"}[e.nodeName];return i&&(t[i]=!0),t},_applyModifiers:function(e,t){var n=this;e.forEach(function(e){n._applyModifier(e,t)})},_applyModifiersToContainer:function(e,t){var n=[];"span"==e.kind?n=[e]:"section"==e.kind?n=e.children:"doc"==e.kind&&e.children.forEach(function(e){n.push.apply(n,e.children)}),this._applyModifiers(n,t)},_applyModifier:function(e,t){for(var n=Object.keys(t),i=0;i<n.length;i++){var o=n[i];t[o]?e.setModifier(o,!0):e.removeModifier(o)}}})},function(e,t){var n,i=this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i};if((n="undefined"!==typeof WebKitMutationObserver?WebKitMutationObserver:MutationObserver)===undefined)throw console.error("DOM Mutation Observers are required."),console.error("https://developer.mozilla.org/en-US/docs/DOM/MutationObserver"),Error("DOM Mutation Observers are required");var o,r=function(){function e(){this.nodes=[],this.values=[]}return e.prototype.isIndex=function(e){return+e===e>>>0},e.prototype.nodeId=function(t){var n=t[e.ID_PROP];return n||(n=t[e.ID_PROP]=e.nextId_++),n},e.prototype.set=function(e,t){var n=this.nodeId(e);this.nodes[n]=e,this.values[n]=t},e.prototype.get=function(e){var t=this.nodeId(e);return this.values[t]},e.prototype.has=function(e){return this.nodeId(e)in this.nodes},e.prototype["delete"]=function(e){var t=this.nodeId(e);delete this.nodes[t],this.values[t]=undefined},e.prototype.keys=function(){var e=[];for(var t in this.nodes)this.isIndex(t)&&e.push(this.nodes[t]);return e},e.ID_PROP="__mutation_summary_node_map_id__",e.nextId_=1,e}();!function(e){e[e.STAYED_OUT=0]="STAYED_OUT",e[e.ENTERED=1]="ENTERED",e[e.STAYED_IN=2]="STAYED_IN",e[e.REPARENTED=3]="REPARENTED",e[e.REORDERED=4]="REORDERED",e[e.EXITED=5]="EXITED"}(o||(o={}));var a=function(){function e(e,t,n,i,o,r,a,s){void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===o&&(o=null),void 0===r&&(r=!1),void 0===a&&(a=null),void 0===s&&(s=null),this.node=e,this.childList=t,this.attributes=n,this.characterData=i,this.oldParentNode=o,this.added=r,this.attributeOldValues=a,this.characterDataOldValue=s,this.isCaseInsensitive=this.node.nodeType===window.Node.ELEMENT_NODE&&this.node instanceof window.HTMLElement&&this.node.ownerDocument instanceof window.HTMLDocument}return e.prototype.getAttributeOldValue=function(e){return this.attributeOldValues?(this.isCaseInsensitive&&(e=e.toLowerCase()),this.attributeOldValues[e]):undefined},e.prototype.getAttributeNamesMutated=function(){var e=[];if(!this.attributeOldValues)return e;for(var t in this.attributeOldValues)e.push(t);return e},e.prototype.attributeMutated=function(e,t){this.attributes=!0,this.attributeOldValues=this.attributeOldValues||{},e in this.attributeOldValues||(this.attributeOldValues[e]=t)},e.prototype.characterDataMutated=function(e){this.characterData||(this.characterData=!0,this.characterDataOldValue=e)},e.prototype.removedFromParent=function(e){this.childList=!0,this.added||this.oldParentNode?this.added=!1:this.oldParentNode=e},e.prototype.insertedIntoParent=function(){this.childList=!0,this.added=!0},e.prototype.getOldParent=function(){if(this.childList){if(this.oldParentNode)return this.oldParentNode;if(this.added)return null}return this.node.parentNode},e}(),s=function(){return function(){this.added=new r,this.removed=new r,this.maybeMoved=new r,this.oldPrevious=new r,this.moved=undefined}}(),d=function(e){function t(t,n){e.call(this),this.rootNode=t,this.reachableCache=undefined,this.wasReachableCache=undefined,this.anyParentsChanged=!1,this.anyAttributesChanged=!1,this.anyCharacterDataChanged=!1;for(var i=0;i<n.length;i++){var o=n[i];switch(o.type){case"childList":this.anyParentsChanged=!0;for(var r=0;r<o.removedNodes.length;r++){var a=o.removedNodes[r];this.getChange(a).removedFromParent(o.target)}for(r=0;r<o.addedNodes.length;r++){a=o.addedNodes[r];this.getChange(a).insertedIntoParent()}break;case"attributes":this.anyAttributesChanged=!0,this.getChange(o.target).attributeMutated(o.attributeName,o.oldValue);break;case"characterData":this.anyCharacterDataChanged=!0,this.getChange(o.target).characterDataMutated(o.oldValue)}}}return i(t,e),t.prototype.getChange=function(e){var t=this.get(e);return t||(t=new a(e),this.set(e,t)),t},t.prototype.getOldParent=function(e){var t=this.get(e);return t?t.getOldParent():e.parentNode},t.prototype.getIsReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.reachableCache=this.reachableCache||new r;var t=this.reachableCache.get(e);return t===undefined&&(t=this.getIsReachable(e.parentNode),this.reachableCache.set(e,t)),t},t.prototype.getWasReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.wasReachableCache=this.wasReachableCache||new r;var t=this.wasReachableCache.get(e);return t===undefined&&(t=this.getWasReachable(this.getOldParent(e)),this.wasReachableCache.set(e,t)),t},t.prototype.reachabilityChange=function(e){return this.getIsReachable(e)?this.getWasReachable(e)?o.STAYED_IN:o.ENTERED:this.getWasReachable(e)?o.EXITED:o.STAYED_OUT},t}(r),c=function(){function e(e,t,n,i,o){this.rootNode=e,this.mutations=t,this.selectors=n,this.calcReordered=i,this.calcOldPreviousSibling=o,this.treeChanges=new d(e,t),this.entered=[],this.exited=[],this.stayedIn=new r,this.visited=new r,this.childListChangeMap=undefined,this.characterDataOnly=undefined,this.matchCache=undefined,this.processMutations()}return e.prototype.processMutations=function(){if(this.treeChanges.anyParentsChanged||this.treeChanges.anyAttributesChanged)for(var e=this.treeChanges.keys(),t=0;t<e.length;t++)this.visitNode(e[t],undefined)},e.prototype.visitNode=function(e,t){if(!this.visited.has(e)){this.visited.set(e,!0);var n=this.treeChanges.get(e),i=t;if((n&&n.childList||i==undefined)&&(i=this.treeChanges.reachabilityChange(e)),i!==o.STAYED_OUT){if(this.matchabilityChange(e),i===o.ENTERED)this.entered.push(e);else if(i===o.EXITED)this.exited.push(e),this.ensureHasOldPreviousSiblingIfNeeded(e);else if(i===o.STAYED_IN){var r=o.STAYED_IN;n&&n.childList&&(n.oldParentNode!==e.parentNode?(r=o.REPARENTED,this.ensureHasOldPreviousSiblingIfNeeded(e)):this.calcReordered&&this.wasReordered(e)&&(r=o.REORDERED)),this.stayedIn.set(e,r)}if(i!==o.STAYED_IN)for(var a=e.firstChild;a;a=a.nextSibling)this.visitNode(a,i)}}},e.prototype.ensureHasOldPreviousSiblingIfNeeded=function(e){if(this.calcOldPreviousSibling){this.processChildlistChanges();var t=e.parentNode,n=this.treeChanges.get(e);n&&n.oldParentNode&&(t=n.oldParentNode);var i=this.childListChangeMap.get(t);i||(i=new s,this.childListChangeMap.set(t,i)),i.oldPrevious.has(e)||i.oldPrevious.set(e,e.previousSibling)}},e.prototype.getChanged=function(e,t,n){this.selectors=t,this.characterDataOnly=n;for(var i=0;i<this.entered.length;i++){var r=this.entered[i];(d=this.matchabilityChange(r))!==o.ENTERED&&d!==o.STAYED_IN||e.added.push(r)}var a=this.stayedIn.keys();for(i=0;i<a.length;i++){r=a[i];if((d=this.matchabilityChange(r))===o.ENTERED)e.added.push(r);else if(d===o.EXITED)e.removed.push(r);else if(d===o.STAYED_IN&&(e.reparented||e.reordered)){var s=this.stayedIn.get(r);e.reparented&&s===o.REPARENTED?e.reparented.push(r):e.reordered&&s===o.REORDERED&&e.reordered.push(r)}}for(i=0;i<this.exited.length;i++){var d;r=this.exited[i];(d=this.matchabilityChange(r))!==o.EXITED&&d!==o.STAYED_IN||e.removed.push(r)}},e.prototype.getOldParentNode=function(e){var t=this.treeChanges.get(e);if(t&&t.childList)return t.oldParentNode?t.oldParentNode:null;var n=this.treeChanges.reachabilityChange(e);if(n===o.STAYED_OUT||n===o.ENTERED)throw Error("getOldParentNode requested on invalid node.");return e.parentNode},e.prototype.getOldPreviousSibling=function(e){var t=e.parentNode,n=this.treeChanges.get(e);n&&n.oldParentNode&&(t=n.oldParentNode);var i=this.childListChangeMap.get(t);if(!i)throw Error("getOldPreviousSibling requested on invalid node.");return i.oldPrevious.get(e)},e.prototype.getOldAttribute=function(e,t){var n=this.treeChanges.get(e);if(!n||!n.attributes)throw Error("getOldAttribute requested on invalid node.");var i=n.getAttributeOldValue(t);if(i===undefined)throw Error("getOldAttribute requested for unchanged attribute name.");return i},e.prototype.attributeChangedNodes=function(e){if(!this.treeChanges.anyAttributesChanged)return{};var t,n;if(e){t={},n={};for(var i=0;i<e.length;i++){t[h=e[i]]=!0,n[h.toLowerCase()]=h}}var r={},a=this.treeChanges.keys();for(i=0;i<a.length;i++){var s=a[i],d=this.treeChanges.get(s);if(d.attributes&&(o.STAYED_IN===this.treeChanges.reachabilityChange(s)&&o.STAYED_IN===this.matchabilityChange(s)))for(var c=s,l=d.getAttributeNamesMutated(),u=0;u<l.length;u++){var h=l[u];if(!t||t[h]||d.isCaseInsensitive&&n[h])d.getAttributeOldValue(h)!==c.getAttribute(h)&&(n&&d.isCaseInsensitive&&(h=n[h]),r[h]=r[h]||[],r[h].push(c))}}return r},e.prototype.getOldCharacterData=function(e){var t=this.treeChanges.get(e);if(!t||!t.characterData)throw Error("getOldCharacterData requested on invalid node.");return t.characterDataOldValue},e.prototype.getCharacterDataChanged=function(){if(!this.treeChanges.anyCharacterDataChanged)return[];for(var e=this.treeChanges.keys(),t=[],n=0;n<e.length;n++){var i=e[n];if(o.STAYED_IN===this.treeChanges.reachabilityChange(i)){var r=this.treeChanges.get(i);r.characterData&&i.textContent!=r.characterDataOldValue&&t.push(i)}}return t},e.prototype.computeMatchabilityChange=function(e,t){this.matchCache||(this.matchCache=[]),this.matchCache[e.uid]||(this.matchCache[e.uid]=new r);var n=this.matchCache[e.uid],i=n.get(t);return i===undefined&&(i=e.matchabilityChange(t,this.treeChanges.get(t)),n.set(t,i)),i},e.prototype.matchabilityChange=function(e){var t=this;if(this.characterDataOnly)switch(e.nodeType){case Node.COMMENT_NODE:case Node.TEXT_NODE:return o.STAYED_IN;default:return o.STAYED_OUT}if(!this.selectors)return o.STAYED_IN;if(e.nodeType!==Node.ELEMENT_NODE)return o.STAYED_OUT;for(var n=e,i=this.selectors.map(function(e){return t.computeMatchabilityChange(e,n)}),r=o.STAYED_OUT,a=0;r!==o.STAYED_IN&&a<i.length;){switch(i[a]){case o.STAYED_IN:r=o.STAYED_IN;break;case o.ENTERED:r=r===o.EXITED?o.STAYED_IN:o.ENTERED;break;case o.EXITED:r=r===o.ENTERED?o.STAYED_IN:o.EXITED}a++}return r},e.prototype.getChildlistChange=function(e){var t=this.childListChangeMap.get(e);return t||(t=new s,this.childListChangeMap.set(e,t)),t},e.prototype.processChildlistChanges=function(){if(!this.childListChangeMap){this.childListChangeMap=new r;for(var e=0;e<this.mutations.length;e++){var t=function(e,t){!e||i.oldPrevious.has(e)||i.added.has(e)||i.maybeMoved.has(e)||t&&(i.added.has(t)||i.maybeMoved.has(t))||i.oldPrevious.set(e,t)},n=this.mutations[e];if("childList"==n.type&&(this.treeChanges.reachabilityChange(n.target)===o.STAYED_IN||this.calcOldPreviousSibling)){for(var i=this.getChildlistChange(n.target),a=n.previousSibling,s=0;s<n.removedNodes.length;s++){t(d=n.removedNodes[s],a),i.added.has(d)?i.added["delete"](d):(i.removed.set(d,!0),i.maybeMoved["delete"](d)),a=d}t(n.nextSibling,a);for(s=0;s<n.addedNodes.length;s++){var d=n.addedNodes[s];i.removed.has(d)?(i.removed["delete"](d),i.maybeMoved.set(d,!0)):i.added.set(d,!0)}}}}},e.prototype.wasReordered=function(e){if(!this.treeChanges.anyParentsChanged)return!1;this.processChildlistChanges();var t=e.parentNode,n=this.treeChanges.get(e);n&&n.oldParentNode&&(t=n.oldParentNode);var i=this.childListChangeMap.get(t);if(!i)return!1;if(i.moved)return i.moved.get(e);i.moved=new r;var o=new r;function a(e){if(!e)return!1;if(!i.maybeMoved.has(e))return!1;var t=i.moved.get(e);return t!==undefined?t:(o.has(e)?t=!0:(o.set(e,!0),t=function(e){if(d.has(e))return d.get(e);var t=e.previousSibling;for(;t&&(i.added.has(t)||a(t));)t=t.previousSibling;return d.set(e,t),t}(e)!==function n(e){var t=s.get(e);if(t!==undefined)return t;t=i.oldPrevious.get(e);for(;t&&(i.removed.has(t)||a(t));)t=n(t);t===undefined&&(t=e.previousSibling);s.set(e,t);return t}(e)),o.has(e)?(o["delete"](e),i.moved.set(e,t)):t=i.moved.get(e),t)}var s=new r;var d=new r;return i.maybeMoved.keys().forEach(a),i.moved.get(e)},e}(),l=function(){function e(e,t){var n=this;if(this.projection=e,this.added=[],this.removed=[],this.reparented=t.all||t.element||t.characterData?[]:undefined,this.reordered=t.all?[]:undefined,e.getChanged(this,t.elementFilter,t.characterData),t.all||t.attribute||t.attributeList){var i=t.attribute?[t.attribute]:t.attributeList,o=e.attributeChangedNodes(i);t.attribute?this.valueChanged=o[t.attribute]||[]:(this.attributeChanged=o,t.attributeList&&t.attributeList.forEach(function(e){n.attributeChanged.hasOwnProperty(e)||(n.attributeChanged[e]=[])}))}if(t.all||t.characterData){var r=e.getCharacterDataChanged();t.characterData?this.valueChanged=r:this.characterDataChanged=r}this.reordered&&(this.getOldPreviousSibling=e.getOldPreviousSibling.bind(e))}return e.prototype.getOldParentNode=function(e){return this.projection.getOldParentNode(e)},e.prototype.getOldAttribute=function(e,t){return this.projection.getOldAttribute(e,t)},e.prototype.getOldCharacterData=function(e){return this.projection.getOldCharacterData(e)},e.prototype.getOldPreviousSibling=function(e){return this.projection.getOldPreviousSibling(e)},e}(),u=/[a-zA-Z_]+/,h=/[a-zA-Z0-9_\-]+/;function f(e){return'"'+e.replace(/"/,'\\"')+'"'}var p=function(){function e(){}return e.prototype.matches=function(e){if(null===e)return!1;if(this.attrValue===undefined)return!0;if(!this.contains)return this.attrValue==e;for(var t=e.split(" "),n=0;n<t.length;n++)if(this.attrValue===t[n])return!0;return!1},e.prototype.toString=function(){return"class"===this.attrName&&this.contains?"."+this.attrValue:"id"!==this.attrName||this.contains?this.contains?"["+this.attrName+"~="+f(this.attrValue)+"]":"attrValue"in this?"["+this.attrName+"="+f(this.attrValue)+"]":"["+this.attrName+"]":"#"+this.attrValue},e}(),m=function(){function e(){this.uid=e.nextUid++,this.qualifiers=[]}return Object.defineProperty(e.prototype,"caseInsensitiveTagName",{get:function(){return this.tagName.toUpperCase()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectorString",{get:function(){return this.tagName+this.qualifiers.join("")},enumerable:!0,configurable:!0}),e.prototype.isMatching=function(t){return t[e.matchesSelector](this.selectorString)},e.prototype.wasMatching=function(e,t,n){if(!t||!t.attributes)return n;var i=t.isCaseInsensitive?this.caseInsensitiveTagName:this.tagName;if("*"!==i&&i!==e.tagName)return!1;for(var o=[],r=!1,a=0;a<this.qualifiers.length;a++){var s=this.qualifiers[a],d=t.getAttributeOldValue(s.attrName);o.push(d),r=r||d!==undefined}if(!r)return n;for(a=0;a<this.qualifiers.length;a++){s=this.qualifiers[a];if((d=o[a])===undefined&&(d=e.getAttribute(s.attrName)),!s.matches(d))return!1}return!0},e.prototype.matchabilityChange=function(e,t){var n=this.isMatching(e);return n?this.wasMatching(e,t,n)?o.STAYED_IN:o.ENTERED:this.wasMatching(e,t,n)?o.EXITED:o.STAYED_OUT},e.parseSelectors=function(t){var n,i,o=[];function r(){n&&(i&&(n.qualifiers.push(i),i=undefined),o.push(n)),n=new e}function a(){i&&n.qualifiers.push(i),i=new p}for(var s,d=/\s/,c="Invalid or unsupported selector syntax.",l=1,f=0;f<t.length;){var m=t[f++];switch(l){case 1:if(m.match(u)){r(),n.tagName=m,l=2;break}if("*"==m){r(),n.tagName="*",l=3;break}if("."==m){r(),a(),n.tagName="*",i.attrName="class",i.contains=!0,l=4;break}if("#"==m){r(),a(),n.tagName="*",i.attrName="id",l=4;break}if("["==m){r(),a(),n.tagName="*",i.attrName="",l=6;break}if(m.match(d))break;throw Error(c);case 2:if(m.match(h)){n.tagName+=m;break}if("."==m){a(),i.attrName="class",i.contains=!0,l=4;break}if("#"==m){a(),i.attrName="id",l=4;break}if("["==m){a(),i.attrName="",l=6;break}if(m.match(d)){l=14;break}if(","==m){l=1;break}throw Error(c);case 3:if("."==m){a(),i.attrName="class",i.contains=!0,l=4;break}if("#"==m){a(),i.attrName="id",l=4;break}if("["==m){a(),i.attrName="",l=6;break}if(m.match(d)){l=14;break}if(","==m){l=1;break}throw Error(c);case 4:if(m.match(u)){i.attrValue=m,l=5;break}throw Error(c);case 5:if(m.match(h)){i.attrValue+=m;break}if("."==m){a(),i.attrName="class",i.contains=!0,l=4;break}if("#"==m){a(),i.attrName="id",l=4;break}if("["==m){a(),l=6;break}if(m.match(d)){l=14;break}if(","==m){l=1;break}throw Error(c);case 6:if(m.match(u)){i.attrName=m,l=7;break}if(m.match(d))break;throw Error(c);case 7:if(m.match(h)){i.attrName+=m;break}if(m.match(d)){l=8;break}if("~"==m){i.contains=!0,l=9;break}if("="==m){i.attrValue="",l=11;break}if("]"==m){l=3;break}throw Error(c);case 8:if("~"==m){i.contains=!0,l=9;break}if("="==m){i.attrValue="",l=11;break}if("]"==m){l=3;break}if(m.match(d))break;throw Error(c);case 9:if("="==m){i.attrValue="",l=11;break}throw Error(c);case 10:if("]"==m){l=3;break}if(m.match(d))break;throw Error(c);case 11:if(m.match(d))break;if('"'==m||"'"==m){s=m,l=13;break}i.attrValue+=m,l=12;break;case 12:if(m.match(d)){l=10;break}if("]"==m){l=3;break}if("'"==m||'"'==m)throw Error(c);i.attrValue+=m;break;case 13:if(m==s){l=10;break}i.attrValue+=m;break;case 14:if(m.match(d))break;if(","==m){l=1;break}throw Error(c)}}switch(l){case 1:case 2:case 3:case 5:case 14:r();break;default:throw Error(c)}if(!o.length)throw Error(c);return o},e.nextUid=1,e.matchesSelector=function(){var e=document.createElement("div");return"function"===typeof e.webkitMatchesSelector?"webkitMatchesSelector":"function"===typeof e.mozMatchesSelector?"mozMatchesSelector":"function"===typeof e.msMatchesSelector?"msMatchesSelector":"matchesSelector"}(),e}(),g=/^([a-zA-Z:_]+[a-zA-Z0-9_\-:\.]*)$/;function v(e){if("string"!=typeof e)throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!(e=e.trim()))throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!e.match(g))throw Error("Invalid request option. invalid attribute name: "+e);return e}function b(e){if(!e.trim().length)throw Error("Invalid request option: elementAttributes must contain at least one attribute.");for(var t={},n={},i=e.split(/\s+/),o=0;o<i.length;o++){if(r=i[o]){var r,a=(r=v(r)).toLowerCase();if(t[a])throw Error("Invalid request option: observing multiple case variations of the same attribute is not supported.");n[r]=!0,t[a]=!0}}return Object.keys(n)}var y=function(){function e(t){var i=this;this.connected=!1,this.options=e.validateOptions(t),this.observerOptions=e.createObserverOptions(this.options.queries),this.root=this.options.rootNode,this.callback=this.options.callback,this.elementFilter=Array.prototype.concat.apply([],this.options.queries.map(function(e){return e.elementFilter?e.elementFilter:[]})),this.elementFilter.length||(this.elementFilter=undefined),this.calcReordered=this.options.queries.some(function(e){return e.all}),this.queryValidators=[],e.createQueryValidator&&(this.queryValidators=this.options.queries.map(function(t){return e.createQueryValidator(i.root,t)})),this.observer=new n(function(e){i.observerCallback(e)}),this.reconnect()}return e.createObserverOptions=function(e){var t,n={childList:!0,subtree:!0};function i(e){n.attributes&&!t||(n.attributes=!0,n.attributeOldValue=!0,e?(t=t||{},e.forEach(function(e){t[e]=!0,t[e.toLowerCase()]=!0})):t=undefined)}return e.forEach(function(e){if(e.characterData)return n.characterData=!0,void(n.characterDataOldValue=!0);if(e.all)return i(),n.characterData=!0,void(n.characterDataOldValue=!0);if(e.attribute)i([e.attribute.trim()]);else{var t=function(e){var t={};return e.forEach(function(e){e.qualifiers.forEach(function(e){t[e.attrName]=!0})}),Object.keys(t)}(e.elementFilter).concat(e.attributeList||[]);t.length&&i(t)}}),t&&(n.attributeFilter=Object.keys(t)),n},e.validateOptions=function(t){for(var n in t)if(!(n in e.optionKeys))throw Error("Invalid option: "+n);if("function"!==typeof t.callback)throw Error("Invalid options: callback is required and must be a function");if(!t.queries||!t.queries.length)throw Error("Invalid options: queries must contain at least one query request object.");for(var i={callback:t.callback,rootNode:t.rootNode||document,observeOwnChanges:!!t.observeOwnChanges,oldPreviousSibling:!!t.oldPreviousSibling,queries:[]},o=0;o<t.queries.length;o++){var r=t.queries[o];if(r.all){if(Object.keys(r).length>1)throw Error("Invalid request option. all has no options.");i.queries.push({all:!0})}else if("attribute"in r){if((s={attribute:v(r.attribute)}).elementFilter=m.parseSelectors("*["+s.attribute+"]"),Object.keys(r).length>1)throw Error("Invalid request option. attribute has no options.");i.queries.push(s)}else if("element"in r){var a=Object.keys(r).length,s={element:r.element,elementFilter:m.parseSelectors(r.element)};if(r.hasOwnProperty("elementAttributes")&&(s.attributeList=b(r.elementAttributes),a--),a>1)throw Error("Invalid request option. element only allows elementAttributes option.");i.queries.push(s)}else{if(!r.characterData)throw Error("Invalid request option. Unknown query request.");if(Object.keys(r).length>1)throw Error("Invalid request option. characterData has no options.");i.queries.push({characterData:!0})}}return i},e.prototype.createSummaries=function(e){if(!e||!e.length)return[];for(var t=new c(this.root,e,this.elementFilter,this.calcReordered,this.options.oldPreviousSibling),n=[],i=0;i<this.options.queries.length;i++)n.push(new l(t,this.options.queries[i]));return n},e.prototype.checkpointQueryValidators=function(){this.queryValidators.forEach(function(e){e&&e.recordPreviousState()})},e.prototype.runQueryValidators=function(e){this.queryValidators.forEach(function(t,n){t&&t.validate(e[n])})},e.prototype.changesToReport=function(e){return e.some(function(e){if(["added","removed","reordered","reparented","valueChanged","characterDataChanged"].some(function(t){return e[t]&&e[t].length}))return!0;if(e.attributeChanged&&Object.keys(e.attributeChanged).some(function(t){return!!e.attributeChanged[t].length}))return!0;return!1})},e.prototype.observerCallback=function(e){this.options.observeOwnChanges||this.observer.disconnect();var t=this.createSummaries(e);this.runQueryValidators(t),this.options.observeOwnChanges&&this.checkpointQueryValidators(),this.changesToReport(t)&&this.callback(t),!this.options.observeOwnChanges&&this.connected&&(this.checkpointQueryValidators(),this.observer.observe(this.root,this.observerOptions))},e.prototype.reconnect=function(){if(this.connected)throw Error("Already connected");this.observer.observe(this.root,this.observerOptions),this.connected=!0,this.checkpointQueryValidators()},e.prototype.takeSummaries=function(){if(!this.connected)throw Error("Not connected");var e=this.createSummaries(this.observer.takeRecords());return this.changesToReport(e)?e:undefined},e.prototype.disconnect=function(){var e=this.takeSummaries();return this.observer.disconnect(),this.connected=!1,e},e.NodeMap=r,e.parseElementFilter=m.parseSelectors,e.optionKeys={callback:!0,queries:!0,rootNode:!0,oldPreviousSibling:!0,observeOwnChanges:!0},e}();t.MutationSummary=y},function(e,t,n){var i=n(0).config;t.htmlToNode=function(e){var t;i.clientInfo.isMSIE&&i.clientInfo.version<9||!document.implementation||!document.implementation.createHTMLDocument?t=document.createElement("DIV"):t=document.implementation.createHTMLDocument("title for old FF versions").createElement("DIV");return t.innerHTML=e,t}},function(e,t,n){var i=n(1),o=n(46).Backspace,r=n(47).Code,a=n(48).Copy,s=n(49).Delete,d=n(50).Indent,c=n(51).Image,l=n(52).Link,u=n(53).Math,h=n(54).Mention,f=n(55).Paste,p=n(56).Quote,m=n(57).Return,g=n(58).SoftReturn,v=n(59).UndoRedo,b=n(60).Embed,y=n(13),S=y.OrderedListSection,x=y.UnorderedListSection,_=n(25).H1Section;t.COMMANDS={backspace:o,cite:l,code:r,copy:a,cut:a,deindent:d,"delete":s,"delete-backward":s,"delete-forward":s,"delete-next-word":s,"delete-previous-word":s,indent:d,image:c,link:l,math:u,mention:h,paste:f,quote:p,redo:v,"return":m,"soft-return":g,undo:v,embed:b,bold:i.spanModifierToggle("bold"),italic:i.spanModifierToggle("italic"),ordered_list:i.sectionTypeToggle(S),unordered_list:i.sectionTypeToggle(x),h1:i.sectionTypeToggle(_)}},function(e,t,n){var i=n(1).Command,o=n(4).Position,r=n(2).Util,a=n(7).PlainSection;n(0).config;t.Backspace=i.extend({exec:function(){var e=this._actualBackspace();return e||this.doc.updateSpellingSuggestions(),this.doc.caret.scrollIntoViewIfNeeded(),e},_actualBackspace:function(){var e,t,n,i;if(!this.doc.caret.isCollapsed())return this.doc.saveState(),this.doc._deleteSelection(),!1;if(s=(e=(n=this.doc.caret.start.clone()).span.parent).previousSibling(),i=n.span.getText(),(n.atSectionStart()&&!n.atDocStart()||!e.isEditable()&&!n.atSectionStart()||"\n"==n.charBefore()||"."==n.charBefore()||","==n.charBefore())&&this.doc.saveState(),!e.isEditable())return this.doc.caret.start.atSectionStart()?s&&s.isEmpty()&&this.doc.removeChild(s):(s||(s=new a,this.doc.insertBefore(s,e)),this.doc.removeChild(e),this.doc.moveCaret(s.last()),this.doc.caret.updateAndroidCaretPosition()),!1;if(n.atDocStart())return(t=this.doc.progressivelyExitSection(e))!=e&&this.doc.saveState(),this.doc.moveCaret(t.first(),t.first(),!0),!1;if(n.atSectionStart()){if(e.getIndent()>0)e.setIndent(e.getIndent()-1),this.doc.caret.updateAndroidCaretPosition();else if(s.hasSectionRemoveButton()){this.doc.removeChild(s);var s=e.previousSibling()}else s.isEditable()||e.isEmpty()?(this.doc.moveCaret(s.merge(e)),this.doc.caret.mergeAdjacentSpans()):this.doc.moveCaret(s.last());return!1}var d=!1;n.atSpanStart()&&(n.span=n.span.previous(),n.offset=n.span.getLength(),i=n.span.getText(),d=!0);for(var c=i.slice(0,n.offset),l=i.slice(n.offset),u=0,h=c.length;h>0&&"\n"==c[h-1];h--)u+=1;return 1==u&&l.startsWith("\n")&&(l=l.slice(1),d=!0),r.isAstralSymbol(c.slice(c.length-2))?(c=c.slice(0,-2),d=!0):c=c.slice(0,-1),n.atSectionEnd()&&c.endsWith("\n")&&(0===u?c+="\n":c=c.slice(0,-1),d=!0),c+l===""&&(d=!0),!d||(this.doc.flushTextInput(),n.span.setText(c+l),n.span.isEmpty()?(n=this.doc._handleEmptySpan(n.span),this.doc.moveCaret(n,n,!0)):this.doc.moveCaret(new o(n.span,c.length)),!1)}})},function(e,t,n){var i=n(1).Command,o=n(12).CodeSection,r=n(10).canForceModifier;t.Code=i.extend({exec:function(){return this.doc.saveState(),this.doc.caret.isCollapsed()?(this.doc.formattingState.is("code")||!this.doc.allowsMultipleSections()?this.doc.toggleModifier("code"):this.doc.toggleSectionType(o),!1):(!this.doc._getSelectedSections().some(function(e){return!e.isEditable()})&&this.doc.caret.start.atSectionStart()&&this.doc.caret.end.atSectionEnd()?this.doc.toggleSectionType(o):this.doc._toggleMathOrCodeModifier("code"),!1)},shouldExec:function(){return this.doc.caret.isCollapsed()?this.doc.caret.start.span.parent.isEditable():!(this.doc._getSelectedSections().some(function(e){return!e.isEditable()})||!this.doc.caret.start.atSectionStart()||!this.doc.caret.end.atSectionEnd())||this.doc.caret.getCoveringSpans().some(function(e){return r(e,"code")})}})},function(e,t,n){var i=n(1).Command,o=n(6).Section,r=n(3).CONTENT_TYPES,a=n(0).config;t.Copy=i.extend({exec:function(e,t){if(!(a.clientInfo.isMobile&&a.clientInfo.isIOSMobileWeb&&a.clientInfo.osVersion<11)&&!a.clientInfo.isMSEdge){var n=this._selectedSectionsJSON().map(o.fromJSON),i=this.getContentForType(n,r.TEXT),s=this.getContentForType(n,r.HTML);t.clipboardData.setData(r.TEXT,i),t.clipboardData.setData(r.HTML,s),t.preventDefault(),t.stopPropagation(),a.clientInfo.isMobile&&a.clientInfo.osVersion<11&&a.clientInfo.isIOSApp&&a.platform.sendMessage("setClipboard",{text:i,html:s}),"cut"==e&&this.doc._deleteSelection()}},getContentForType:function(e,t){return e.map(function(n){return n.toContent(t,e)}).join("")},_selectedSectionsJSON:function(){if(this.doc.caret.isCollapsed())return[];var e,t,n=[],i=this.doc.caret.start.clone(),o=this.doc.caret.end.clone(),r=i.span;for(r=i.span;r&&r.previous()!=o.span;r=r.next())if(!(i.span===r&&i.atSpanEnd()||o.span===r&&o.atSpanStart())){if(e!=r.parent){if(!(t=(e=r.parent).toJSON()))continue;t.spans=[],n.push(t)}var a=i.span===r?i.offset:undefined,s=o.span===r?o.offset:undefined;t.spans.push(r.toJSON(!1,a,s))}return n}})},function(e,t,n){var i=n(1).Command,o=n(2).Util,r=n(7).PlainSection;t.Delete=i.extend({exec:function(e){if(this.doc.saveState(),this.doc.caret.isCollapsed()){if("delete"==e)return this._deleteSingle();"delete-forward"==e?this.doc.moveCaretEnd(this.doc.caret.start.span.parent.last()):"delete-backward"==e?this.doc.moveCaretStart(this.doc.caret.start.span.parent.first()):"delete-next-word"==e?this.doc.moveCaretEnd(this.doc.caret.start.nextWordBoundary()):"delete-previous-word"==e&&this.doc.moveCaretStart(this.doc.caret.start.previousWordBoundary())}return this._deleteSelection()},_deleteSelection:function(){if(!this.doc.caret.isCollapsed())return this.doc._deleteSelection(),!1},_deleteSingle:function(){var e,t,n;if(t=(e=(n=this.doc.caret.start.clone()).span.parent).nextSibling(),this.doc.caret.isCollapsed()){if(!e.isEditable())return this.doc.caret.start.atSectionEnd()?t&&t.isEmpty()&&this.doc.removeChild(t):(t||(t=new r,this.doc.insertBefore(t,e)),this.doc.removeChild(e),this.doc.moveCaret(t.first()),this.doc.caret.updateAndroidCaretPosition()),!1;if(n.atDocEnd())return!1;if(n.atSectionEnd())return e=n.span.parent,this.doc.moveCaret(e.merge(e.nextSibling())),!1;n.atSpanEnd()&&(n.span=n.span.next(),n.offset=0);var i=n.span.getText();return o.isAstralSymbol(i.slice(n.offset,n.offset+2))?n.span.deleteText(n.offset,n.offset+2):n.span.deleteText(n.offset,n.offset+1),n.span.isEmpty()?this.doc.moveCaret(this.doc._handleEmptySpan(n.span)):this.doc.moveCaret(n),!1}}})},function(e,t,n){var i=n(1).Command,o=n(12).CodeSection,r=n(4).Position;t.Indent=i.extend({exec:function(e){return"indent"==e?this._indent():this._deindent()},_maybeInsertTab:function(){var e=this.doc.caret.isCollapsed(),t=this.doc.caret.start.clone(),n=t.span,i=n.parent,a=n.getText(),s=t.offset;return!!(e&&i instanceof o)&&(n.setText(a.slice(0,s)+"\t"+a.slice(s)),this.doc.moveCaret(new r(n,s+1)),!0)},_afterIndent:function(e){e&&this.doc.forceDomReflow(),this.doc.updateCaret()},_indent:function(){if(this._maybeInsertTab())return!1;var e=this.doc._getSelectedSections(),t=!1;return e.forEach(function(e){e.setIndent(e.getIndent()+1)&&(t=!0)}),this._afterIndent(t),!t},_deindent:function(){var e=this.doc._getSelectedSections(),t=!1;return e.forEach(function(e){e.setIndent(e.getIndent()-1)&&(t=!0)}),this._afterIndent(t),!t}})},function(e,t,n){var i=n(1).Command,o=n(14).ImageSection,r=n(0).config;t.Image=i.extend({exec:function(e,t,n){if(0!==t.length){var i=t.map(function(e){return r.options.eagerImageUploading?o.fromURL(e,null,n):o.fromURL(e)});this.doc.saveState(),this.doc.insertSections(i),this.doc.saveState()}}})},function(e,t,n){var i=n(1).Command,o=n(8).Span,r=n(2).Util,a=n(4).Position,s=n(10).canForceModifier;t.Link=i.extend({exec:function(){var e=this;this.doc.linkStart=this.doc.caret.start.clone();var t,n,i,o=this.doc.caret.start.span;return!!o.isEditable()&&(o.hasModifier("link")?(this.doc.caret.isCollapsed()||this.doc.saveState(),this.doc.formattingState.toggleModifier(this.doc.caret,"link"),this.doc._getSelectedSpans(!0).forEach(function(e){e.removeModifier("link")}),!1):(o.hasModifier("citation")&&(t=o.getModifier("citation").target,i=!0),t&&(n=t.url),this.doc.linkSelector.getExternalURL(function(t){setTimeout(function(){return e.onLinkInput(t)},200)},n,i),!1))},shouldExec:function(){return s(this.doc.caret.start.span,"link")},onLinkInput:function(e){this.doc.moveCaretStart(this.doc.linkStart,!0);var t,n,i,s=this.doc.caret.isCollapsed(),d=this.doc.caret.start.clone(),c=this.doc._getSelectedSpans(!0,!0),l=e.url,u=e.isCitation,h=this.doc.caret.start.span,f=u&&h.hasModifier("citation")||!u&&h.hasModifier("link"),p=f?h.getText():l;this.doc.saveState(),l&&(l=r.ensureProtocol(l),t={type:"url",url:l},u||(c=this.doc._mergeSpansBySection(c)),s?(n=this.doc._insertOrModifyLink(p,t,u,!0),d=new a(n.nextSibling(),1)):u?(n=new o(" ",{citation:{target:t}}),(i=c[c.length-1]).parent.insertAfter(n,i)):c.forEach(function(e){e.setModifier("link",t)}),!n||h.hasModifier("link")&&f||this.doc.fetchLinkPreviews([n])),this.doc.node.focus(),s?this.doc.moveCaret(d):this.doc.moveCaret(c[0].first(),c[c.length-1].last()),this.doc.caret.scrollIntoViewIfNeeded()}})},function(e,t,n){var i=n(1).Command,o=n(10).canForceModifier;t.Math=i.extend({exec:function(){return this.doc.saveState(),this.doc.caret.isCollapsed()?this.doc.formattingState.toggleModifier(this.doc.caret,"math"):this.doc._toggleMathOrCodeModifier("math"),!1},shouldExec:function(){return this.doc.caret.getCoveringSpans().some(function(e){return o(e,"math")})}})},function(e,t,n){var i=n(1).Command,o=n(3),r=n(0).config,a=n(18);t.Mention=i.extend({exec:function(e,t){if(this.doc._shouldAllowLinks()&&!this.doc.linkSelector.isActive()){if("@"==t){var n=this.doc.caret.charBefore();if(n&&!o.WORD_START_REGEX.test(n))return}var i=this.doc.getCurrentDirection()==a.RTL;if(this.doc.focus(),r.clientInfo.isMobile)this.doc.linkSelector.show(t);else{var s=this.doc.caret.getAbsolutePosition(!0)||{};this.doc.linkSelector.show(t,s.left,s.top,i)}return!1}}})},function(e,t,n){var i=n(1).Command,o=n(26),r=n(3).CONTENT_TYPES,a=[r.PUBLIC_HTML,r.HTML,r.TEXT,r.TEXT_URI],s=/href=(['"])([^'">]*)\1[^>]*>\2/im;t.Paste=i.extend({exec:function(e,t){if(!t.clipboardData||!t.clipboardData.types||!t.clipboardData.getData)return!1;var n,i=this,o=!0;return a.some(function(e){for(var a=0;a<t.clipboardData.types.length;a++)if(t.clipboardData.types[a]==e&&(n=t.clipboardData.getData(e))&&i.allowClipboardData(e,n)&&(e!==r.TEXT||0===t.clipboardData.files.length)){t.stopImmediatePropagation(),i.doc.saveState(),i._paste(n,e),i.doc.trigger("paste_event",t),o=!1;break}if(!o)return!0}),o&&this.doc.trigger("paste",t),!1},allowClipboardData:function(e,t){return e!==r.HTML||!s.test(t)},_paste:function(e,t){var n=o.parse(e,t);n=this.doc.sanitizeContent(n),this.doc.insertSections(n)}})},function(e,t,n){var i=n(1).Command,o=n(13).isListSection;t.Quote=i.extend({exec:function(){var e,t,n=this.doc._getSelectedSections(),i=n[0],r=i.isQuoted(),a=[];for(this.doc.saveState();o(i)&&(e=i.previousSibling())&&e.getType()==i.getType();)a.push(e),i=e;for(i=n[n.length-1];o(i)&&(t=i.nextSibling())&&t.getType()==i.getType();)a.push(t),i=t;return(n=n.concat(a)).forEach(function(e){e.setQuoted(!r)}),!1}})},function(e,t,n){var i=n(1).Command,o=n(7).PlainSection,r=n(12).CodeSection;t.Return=i.extend({exec:function(){this.doc.saveState();var e=this._actualReturn();return this.doc.updateSpellingSuggestions(),this.doc.caret.scrollIntoViewIfNeeded(),this.doc.caret.updateAndroidCaretPosition(),e},_actualReturn:function(){var e,t,n,i,a;return this.doc.caret.isCollapsed()||this.doc._deleteSelection(),n=(t=(e=this.doc.caret.start.span.parent).previousSibling())&&t.isEmpty(),a=this.doc.caret.start.clone(),e.isEditable()?(a=e.isEmpty()||""===e.node.textContent.trim()?e instanceof r&&t instanceof r&&!n?e.split(a):e instanceof o&&!e.isQuoted()&&0===e.getIndent()?e.split(a):(e=this.doc.progressivelyExitSection(e)).first():e.split(a),this.doc.moveCaret(a),!1):(i=new o,this.doc.caret.start.atSectionStart()?this.doc.insertBefore(i,e):(this.doc.insertBefore(i,e.nextSibling()),this.doc.moveCaret(i.first())),!1)}})},function(e,t,n){var i=n(1).Command,o=n(12).CodeSection,r=n(4).Position;t.SoftReturn=i.extend({exec:function(){var e=this.doc.caret.start,t=e.span,n=e.offset,i=t.parent,a=t.getText(),s="\n"==this.doc.caret.charBefore();if(!i.isEditable())return this.doc.handleCommand("return");if(this.doc.saveState(),i instanceof o){var d=i.split(e);return this.doc.moveCaret(d),!1}if(!i.allowsMultipleSoftReturns()&&s){for(;a.endsWith("\n");)a=a.slice(0,-1);return t.setText(a),this.doc.handleCommand("return")}return e.atSectionEnd()?(t.setText(a+"\n\n"),this.doc.moveCaret(t.last())):(t.setText(a.slice(0,n)+"\n"+a.slice(n)),this.doc.moveCaret(new r(t,n+1))),this.doc.moveCaret(new r(t,n+1)),!1}})},function(e,t,n){var i=n(1).Command,o=n(9);t.UndoRedo=i.extend({exec:function(e){return"undo"==e?this._undo():this._redo()},_undo:function(){return this.doc.undoManager.canRedo()||o.jsonEqual(this.doc.toJSON(!0),this.doc.undoManager.state())||this.doc.saveState(),this.doc.undoManager.undo(),this.doc.fromJSON(this.doc.undoManager.state()),!1},_redo:function(){return this.doc.undoManager.redo(),this.doc.fromJSON(this.doc.undoManager.state()),!1}})},function(e,t,n){var i=n(1).Command,o=n(15).EmbedSection;t.Embed=i.extend({exec:function(e,t){t.forEach(function(e,n){var i=o.fromOtherSection(e);null!==i&&(t[n]=i)})}})},function(e,t,n){var i=n(62).Tooltips,o=n(64).Autolist,r=n(65).Autolink,a=n(66).Ellipses,s=n(67).HR,d=n(68).UndoState,c=n(69).Mention,l=n(70).NonEditableCursors,u=n(71).SmartQuotes,h=n(72).DoubleSpace,f=n(73).Dashes,p=n(74).Arrows,m=n(75).ExternalImageUpload;t.EXTENSIONS=[s,i,r,o,a,d,c,l,u,h,f,p,m]},function(e,t,n){var i=n(11).Extension,o=n(2).Util,r=n(63);t.Tooltips=i.extend({install:function(){this._activeLinkSpan=null,this.doc.on("caretMoved",this.onCaretMoved.bind(this)),this.doc.on("blur",this.onDocBlur.bind(this))},destroy:function(){this._hideTooltip()},onDocBlur:function(){this._hideTooltip()},onCaretMoved:function(){this._maybeShowTooltip()},_maybeShowTooltip:function(){this._shouldShowTooltip()?this._showTooltip():this._hideTooltip()},_shouldShowTooltip:function(){var e=this.doc.caret.start.span;return e.hasModifier("link")||e.hasModifier("citation")},_showTooltip:function(){var e,t=this.doc.caret.start.span;if(t.hasModifier("link")?e=t.getModifier("link"):t.hasModifier("citation")&&(e=t.getModifier("citation").target),e&&e.url){this._activeLinkSpan=t;var n=o.create("a");n.target="_blank",n.rel="noreferrer nofollow",n.href=e.url,n.textContent=e.url,r.show(t.node,n,t.parent.node)}},_hideTooltip:function(){this._activeLinkSpan=null,r.hide()}})},function(e,t,n){var i,o,r=null,a=n(2).Util;t.show=function(e,t,n){i||((i=document.createElement("div")).className="qtext2_tooltip",document.body.appendChild(i),(o=document.createElement("div")).style.overflow="hidden",o.style.textOverflow="ellipsis",o.style.whiteSpace="nowrap",i.appendChild(o));var s=n.offsetWidth;o.innerHTML=t,i.style.maxWidth=s;var d=a.getOffset(e),c=a.getSize(e),l=d.left+.5*c.width,u=a.getOffset(n).left,h=u+s;d.top<30?a.setPixelVal(i,"top",c.height+20):a.setPixelVal(i,"top",d.top-30);var f=i.offsetWidth,p=l-f/2,m=l+f/2;p<u?a.setPixelVal(i,"left",u):m>h?a.setPixelVal(i,"left",h-f):a.setPixelVal(i,"left",p),clearTimeout(r),r=setTimeout(function(){i.classList.add("visible")},500)},t.hide=function(){i&&(clearTimeout(r),r=setTimeout(function(){i.classList.remove("visible")},100))}},function(e,t,n){var i=n(11).Extension,o=n(4).Position,r=n(7).PlainSection,a=n(13),s=a.UnorderedListSection,d=a.OrderedListSection,c=n(3);t.Autolist=i.extend({install:function(){this.doc.on("command-space",this.onSpace.bind(this))},onSpace:function(){if(this.shouldAutoList()){var e=this.doc.caret.start.clone(),t=e.span,n=t.parent,i=e.offset,r=t.getText(),a=r.slice(0,i),l=new RegExp("^([-*+]|--|"+c.EM_DASH+")$"),u=/^1[.)]$/;if(n.firstChild()==t&&(l.test(a)||u.test(a))){var h=l.exec(a)||u.exec(a);return h=h[0],t.setText(r.slice(0,h.length)+" "+r.slice(h.length)),this.doc.moveCaret(new o(t,h.length+1)),this.doc.saveState(),t.setText(r.slice(h.length)),this.doc.moveCaret(t.first(),null,!0),l.test(a)?this.doc.toggleSectionType(s):this.doc.toggleSectionType(d),!1}}},shouldAutoList:function(){if(this.doc.isDisabledCommand("ordered_list")||this.doc.isDisabledCommand("unordered_list"))return!1;var e=this.doc.caret.isCollapsed(),t=this.doc.caret.start.span,n=t.parent;return!!e&&(!(t.hasModifier("link")||t.hasModifier("math")||t.hasModifier("code"))&&n instanceof r)}})},function(e,t,n){var i=n(11).Extension,o=n(8).Span,r=n(2).Util,a=n(4).Position,s=n(7).PlainSection,d=n(15).EmbedSection,c=n(23).hyperlinkEmbedsEnabled,l=["m.in"];t.Autolink=i.extend({install:function(){this.doc.on("command-space",this.onSpace.bind(this)),this.doc.on("command-return",this.onReturn.bind(this))},onSpace:function(){return this.detectLinksBeforeCaret()},onReturn:function(){return this.detectLinksBeforeCaret(!0)},detectLinksBeforeCaret:function(e){var t=this.doc.caret.start,n=t.span;if(e&&t.atSectionStart()){if(!(n=n.previous()))return!1;t=n.last()}return!this._detectLinks(n,t,!e)},_detectLinks:function(e,t,n){if(!this.doc._shouldAllowLinks(e))return!1;var i,u=e.parent,h=t||e.last(),f=h.offset,p=h.previousWordBoundary(/\s/),m=e.getText(),g=m.slice(p.offset,f);if(r.linkify(g).forEach(function(e){var t=e.text,n=e.href;n&&t==g&&!l.includes(g)?i=new o(g,{link:{type:"url",url:n}}):g=g.slice(t.length)}),!i)return!1;n&&(e.setText(m.slice(0,f)+" "+m.slice(f)),this.doc.moveCaret(new a(e,f+1))),this.doc.saveState();var v,b,y=e;if((p=new a(h.span,f-g.length)).equals(e.first())&&h.equals(e.last())?n?(y.setText(" "),b=new a(y,1)):y=null:(p.equals(e.first())||(v=new o(e.getText().slice(0,p.offset),e.modifiers)),n?(y.setText(" "+y.getText().slice(h.offset)),b=new a(y,1)):h.equals(e.last())?y=null:y.setText(y.getText().slice(h.offset))),v&&u.insertBefore(v,e),u.insertBefore(i,e),y||u.removeChild(e),b&&n&&this.doc.moveCaret(b),this.doc.fetchLinkPreviews([i]),c()){var S=d.fromOtherSection(u);if(null!==S){this.doc.insertBefore(S,u),this.doc.removeChild(u);var x=new s;this.doc.insertAfter(x,S)}}return!0}})},function(e,t,n){var i=n(19).TypingExtension,o=n(16).Selection,r=n(3).ELLIPSIS;t.Ellipses=i.extend({install:function(){this.doc.on("keypress",this.onKeypress.bind(this))},onKeypress:function(e){if("."==e&&this.isActive()){var t=this.doc.caret.start.prevPositionInSection(2);if(t){var n=new o(t,this.doc.caret.start);if(this.isActive(n))if(".."==n.getText())return n.start.span.parent.deleteText(n.start,n.end),n.start.span.insertText(r,n.start.offset),this.doc.moveCaret(n.start.nextPositionInSection()),this.doc.updateSpellingSuggestions(),this.doc.caret.updateAndroidCaretPosition(),this.doc.saveState(),!1}}}})},function(e,t,n){var i=n(11).Extension,o=n(7).PlainSection,r=n(17).HorizontalRuleSection,a=n(3);t.HR=i.extend({install:function(){this.doc.on("command-return",this.onReturn.bind(this))},onReturn:function(){if(this.isActive()){var e=new RegExp("^([-*+_=]{3,}|["+a.EM_DASH+"-]{2,})$"),t=this.doc.caret.start.clone().span.parent.previousSibling();t&&t instanceof o&&e.test(t.getText().trim())&&!t.isQuoted()&&(this.doc.insertBefore(new r,t),this.doc.removeChild(t))}},isActive:function(){return!this.doc.isDisabledCommand("horizontal-rule")}})},function(e,t,n){var i=n(11).Extension;t.UndoState=i.extend({install:function(){this.doc.on("keypress",this.onKeypress.bind(this))},onKeypress:function(e){"."!=e&&","!=e||this.doc.saveState()}})},function(e,t,n){var i=n(11).Extension;t.Mention=i.extend({install:function(){this.doc.on("keypress",this.onKeypress.bind(this))},onKeypress:function(e){"@"==e&&this.doc.handleCommand("mention",e,{source:"keyboard"})}})},function(e,t,n){var i=n(11).Extension,o=n(6).Section,r=n(0).config,a=n(21),s=n(7).PlainSection,d=n(15).EmbedSection,c=n(14).ImageSection;t.NonEditableCursors=i.extend({install:function(){if(this.doc.on("mousedown",this.onMousedown.bind(this)),this.doc.on("mouseup",this._closeMobileKeyboard.bind(this)),this.doc.on("longpress",this.onLongpress.bind(this)),r.clientInfo.isNativeApp){var e=this,t=!1;this.doc.on("touchstart",function(n){e._maybeRemoveSectionOnClick(n)||(e._isClickingImageContainer(n)&&(t=!0),e._maybeRetryImageUpload(n))}),this.doc.on("touchend",function(n){t&&(t=!1,n.preventDefault(),e._closeMobileKeyboard(n))}),this.doc.on("touchmove",function(){t=!1})}},onLongpress:function(e){var t=this._sectionFromNode(e.target);t&&(t.isEditable()||(this.doc.moveCaret(t.first(),t.last()),this.doc.updateCaret()))},onMousedown:function(e){var t=this._sectionFromNode(e.target);if(t){if(t.isEditable()){if(r.clientInfo.isIOSApp&&!this.doc.contains(document.activeElement)){var n=a.rangeFromPoint(e.clientX,e.clientY),i=this.doc.caret._fromNode(n.startContainer,n.startOffset),o=document.createElement("input");o.style.position="fixed",o.style.top=0,o.style.left=0,o.style.height=0,o.style.opacity=0,document.body.appendChild(o),o.focus(),e.preventDefault();var l=this;setTimeout(function(){l.doc.moveCaret(i),l.doc.updateCaret(),l.doc.focus(),l.doc.caret.scrollIntoViewIfNeeded(),document.body.removeChild(o)},300)}}else if(!(!r.clientInfo.isNativeApp&&this._maybeRemoveSectionOnClick(e))){r.clientInfo.isNativeApp||this._maybeRetryImageUpload(e),t instanceof d&&this._isClickingReactPlaceholder(e)&&t.acceptClipboardSuggestion&&t.acceptClipboardSuggestion(),this._preventKeyboardOpening(e);var u=e.target.getBoundingClientRect().left+document.body.scrollLeft,h=e.pageX-u;e.target.width/2>h?this.doc.moveCaret(t.first()):this.doc.moveCaret(t.last()),this.doc.updateCaret()}}else{var f=new s,p=this.doc.lastChild();(p instanceof c||p instanceof d)&&(this.doc.insertAfter(f,p),this.doc.moveCaret(f.first()),this.doc.updateCaret())}},onMouseup:function(e){this._isClickingImageContainer(e)&&this.doc.node&&this.doc.node.blur()},_isClickingImageContainer:function(e){return r.options.imageRemoveButtonEnabled&&e.target.parentElement&&e.target.parentElement.className.includes("section_content_container")},_isClickingReactPlaceholder:function(e){if(!r.options.lightWeightContentToolbar)return!1;return function t(e){return!!e.classList.contains("react_placeholder")||!e.classList.contains("content")&&!e.classList.contains("doc")&&e.parentElement&&t(e.parentElement)}(e.target)},_isClickingReactRetryButton:function(e){return function t(e){return!!e.classList.contains("react_retry_button_container")||!e.classList.contains("content")&&!e.classList.contains("doc")&&e.parentElement&&t(e.parentElement)}(e.target)},_preventKeyboardOpening:function(e){this._isClickingImageContainer(e)&&document.body===document.activeElement&&this.doc.node&&e.preventDefault()},_closeMobileKeyboard:function(e){this._isClickingImageContainer(e)&&this.doc.node&&this.doc.node.blur()},_maybeRemoveSectionOnClick:function(e){if("section_remove_btn"===e.target.className){this.doc.saveState();var t=this._sectionFromNode(e.target),n=t.previousSibling();return n||(n=new s,this.doc.insertBefore(n,t)),this.doc.removeChild(t),this.doc.moveCaret(n.last()),this.doc.updateCaret(),this.doc.caret.updateAndroidCaretPosition(),this.doc.isOnlyWhiteSpace()&&(this.doc.clear(),this.doc.focus()),this.doc.trigger("imageRemoved"),!0}},_maybeRetryImageUpload:function(e){this._sectionFromNode(e.target)instanceof c&&this._isClickingReactRetryButton(e)&&this.doc.retryUpload()},_sectionFromNode:function(e){for(var t=e;t;){if(o.is(t))return o.get(t);t=t.parentElement}return null}})},function(e,t,n){var i=n(19).TypingExtension,o=n(4).Position,r=n(16).Selection,a=n(0).config,s=n(3);t.SmartQuotes=i.extend({install:function(){!a.clientInfo.isIOS&&a.options.enableSmartQuotes&&(this.initializeConstants(),this.doc.on("keypress",this.onKeypress.bind(this)),this.doc.on("command-space",this.onSpace.bind(this)))},onSpace:function(){if(this.isActive()){var e=this.doc.caret.start.previousWordBoundary(/\s/),t=e.charAfter(),n=this.doc.caret.start;if(null!==t&&e.atSpanEnd()&&(e=e.span.nextSibling().first()),t===s.OPEN_SINGLE_QUOTE){var i=this.doc.caret.previousTextUntil(e).slice(1);if(this.frontApostropheRegex.test(i)){var o=e.span.getText();e.span.setText(o.slice(0,e.offset)+s.CLOSE_SINGLE_QUOTE+o.slice(e.offset+1)),this.doc.moveCaret(n)}}}},onKeypress:function(e){if(this.isActive()){if("'"==e)return this.handleSingleQuote(),!1;if('"'==e)return this.handleDoubleQuote(),!1;if("S"==e.toUpperCase()&&this.doc.caret.start.charBefore()==s.SINGLE_PRIME){var t=this.doc.caret.start.prevPositionInSection();return this.doc.caret.start.span.parent.deleteText(t,this.doc.caret.start),t.span.insertText(s.CLOSE_SINGLE_QUOTE,t.offset),this.doc.moveCaret(t.nextPositionInSection()),void this.doc.updateSpellingSuggestions()}}},handleSingleQuote:function(){var e=this.doc.caret.charBefore(),t=s.CLOSE_SINGLE_QUOTE,n=this.doc.caret,i=n.start.span.parent,o=new r(i.first(),n.start);null===e||s.WORD_START_REGEX.test(e)?t=s.OPEN_SINGLE_QUOTE:this.primeRegex.test(e)&&(this.unclosedSingleQuoteRegex.test(o.getText())||(t=s.SINGLE_PRIME)),this.insertChar(t)},handleDoubleQuote:function(){var e=this.doc.caret.charBefore(),t=s.CLOSE_DOUBLE_QUOTE,n=this.doc.caret,i=n.start.span.parent,o=new r(i.first(),n.start);null===e||/\s|[({[]/.test(e)?t=s.OPEN_DOUBLE_QUOTE:this.primeRegex.test(e)&&(this.unclosedDoubleQuoteRegex.test(o.getText())||(t=s.DOUBLE_PRIME)),this.insertChar(t)},insertChar:function(e){var t=this.doc.caret.start,n=t.span,i=n.getText(),r=t.offset;n.setText(i.slice(0,r)+e+i.slice(r)),this.doc.moveCaret(new o(n,r+1))},initializeConstants:function(){var e=Object.keys(s.FRACTIONS).join("");this.primeRegex=new RegExp("\\d|["+e+"]");for(var t=["bout","cause","course","d","e_ll","em","er","ere","e_s","fraid","fro","kay","lo","m","n","n_","pon","round","sblood","scuse","sfar","sfoot","sup","t","taint","tain_t","til","tis","tisn_t","tshall","twas","twasn_t","tween","twere","tweren_t","twill","twixt","twon_t","twou_d","twou_dn_t","twould","twouldn_t","um","ve"],n="",i=0;i<t.length;++i)n+="|"+t[i].replace(/_/g,"['\u2018\u2019\u2032]");this.frontApostropheRegex=new RegExp("^(\\d\\ds?"+n+")$","i"),this.unclosedSingleQuoteRegex=new RegExp(s.OPEN_SINGLE_QUOTE+"[^"+s.CLOSE_SINGLE_QUOTE+"]*$"),this.unclosedDoubleQuoteRegex=new RegExp(s.OPEN_DOUBLE_QUOTE+"[^"+s.CLOSE_DOUBLE_QUOTE+"]*$")}})},function(e,t,n){var i=n(19).TypingExtension,o=n(16).Selection,r=n(29).Quirks;t.DoubleSpace=i.extend({install:function(){this.doc.on("command-space",this.onSpace.bind(this)),this.MAX_SPACES=2,this.spacesExp=new RegExp("\\s{"+this.MAX_SPACES+"}")},onSpace:function(){if(this.isActive()){var e=this.doc.caret,t=e.start.prevPositionInSection(this.MAX_SPACES)||e.start.span.parent.first(),n=new o(t,e.start),i=e.start.nextPositionInSection(this.MAX_SPACES)||e.start.span.parent.last(),a=new o(e.start,i),s=e.start.nextPositionInSection(),d=n.getText(),c=a.getText(),l=e.charAfter();return/\s/.test(l)&&"\n"!=l&&s&&!s.span.hasModifier("citation")&&this.spacesExp.test(d+c)&&!r.insertsPeriodWithDoubleSpace()?(this.doc.moveCaret(s),this.doc.caret.updateAndroidCaretPosition(),!1):this.spacesExp.test(d)?(this.doc.caret.updateAndroidCaretPosition(),!1):void 0}}})},function(e,t,n){var i=n(19).TypingExtension,o=n(16).Selection,r=n(0).config,a=n(3);t.Dashes=i.extend({install:function(){this.doc.on("keypress",this.onKeypress.bind(this))},onKeypress:function(e){var t=this.doc.caret.start,n=t.span,i=n.parent;if(t.atSpanStart()){if(!(n=n.previousSibling()))return;t=n.last()}var s=t.prevPositionInSection();if(s){var d=Object.keys(a.FRACTIONS).join(""),c=new RegExp("(\\d|["+d+"])[-"+a.EM_DASH+"]");if(/\d/.test(e)){var l=s.prevPositionInSection();if(!l)return;var u=new o(l,this.doc.caret.start);if(!this.isActive(u))return;c.test(u.getText())&&(i.replaceText(s,this.doc.caret.start,a.EN_DASH),this.doc.moveCaret(s.nextPositionInSection()))}else if("-"==e){if(!this.isActive(new o(s,this.doc.caret.start)))return;return"-"==this.doc.caret.charBefore()?(i.replaceText(s,this.doc.caret.start,a.EM_DASH),this.doc.moveCaret(s.nextPositionInSection()),this.doc.caret.updateAndroidCaretPosition(),!1):r.clientInfo.isIOS&&this.doc.caret.charBefore()==a.EM_DASH?(i.replaceText(t,t,"-"),this.doc.moveCaret(t.nextPositionInSection()),!1):void 0}}}})},function(e,t,n){var i=n(19).TypingExtension,o=n(16).Selection,r=n(3);t.Arrows=i.extend({install:function(){this.doc.on("keypress",this.onKeypress.bind(this))},onKeypress:function(e){if(this.isActive()){var t,n=this.doc.caret.start.span.parent,i=this.doc.caret.start.prevPositionInSection();if(i){if(">"==e){if(t=new o(i,this.doc.caret.start),!this.isActive(t))return;return t.getText()==r.EM_DASH?(n.replaceText(i,this.doc.caret.start,r.RIGHT_ARROW),this.doc.moveCaret(i.nextPositionInSection()),this.doc.caret.updateAndroidCaretPosition(),!1):void 0}if("-"==e){var a=i.prevPositionInSection();if(!a)return;if(t=new o(a,this.doc.caret.start),!this.isActive(t))return;var s=t.getText();if(s=="<"+r.EM_DASH||"<-"==s)return n.replaceText(t.start,t.end,r.LEFT_ARROW),this.doc.moveCaret(a.nextPositionInSection()),this.doc.caret.updateAndroidCaretPosition(),!1}}}}})},function(e,t,n){var i=n(11).Extension,o=n(14).ImageSection,r=n(0).config;t.ExternalImageUpload=i.extend({install:function(){this.doc.on("meaningfulChange",this.uploadExternalImages.bind(this))},uploadExternalImages:function(){var e=[],t=this;t.doc.children.forEach(function(n){if(n instanceof o){var i=n.firstChild();if(i.hasModifier("external_source")&&!i.hasModifier("uploading")){i.setModifier("uploading",!0);var r=i.getModifier("image"),a=i.getModifier("external_source");n.isPending?e.push(r):t.doc.insertAndUploadImageUrl(r,a,n)}}}),r.options.eagerImageUploading&&e.length>0&&t.doc.uploadPendingImages(e)}})}])},"object"===typeof t&&"object"===typeof e?e.exports=i():"function"===typeof define&&define.amd?define([],i):"object"===typeof t?t.qtext2=i():n.qtext2=i()},"ut/Y":function(e,t,n){var i=n("ZCpW"),o=n("GDhZ"),r=n("zZ0H"),a=n("Z0cm"),s=n("+c4W");e.exports=function(e){return"function"==typeof e?e:null==e?r:"object"==typeof e?a(e)?o(e[0],e[1]):i(e):s(e)}},zoYe:function(e,t,n){var i=n("nmnc"),o=n("eUgh"),r=n("Z0cm"),a=n("/9aa"),s=1/0,d=i?i.prototype:undefined,c=d?d.toString:undefined;e.exports=function l(e){if("string"==typeof e)return e;if(r(e))return o(e,l)+"";if(a(e))return c?c.call(e):"";var t=e+"";return"0"==t&&1/e==-s?"-0":t}}}]);